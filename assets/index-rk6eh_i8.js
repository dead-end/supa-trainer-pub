var Mr=Object.defineProperty;var Fr=(i,e,n)=>e in i?Mr(i,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):i[e]=n;var Ot=(i,e,n)=>(Fr(i,typeof e!="symbol"?e+"":e,n),n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))t(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&t(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function t(s){if(s.ep)return;s.ep=!0;const r=n(s);fetch(s.href,r)}})();function D(){}function nt(i,e){for(const n in e)i[n]=e[n];return i}function hr(i){return i()}function cn(){return Object.create(null)}function Ve(i){i.forEach(hr)}function We(i){return typeof i=="function"}function U(i,e){return i!=i?e==e:i!==e||i&&typeof i=="object"||typeof i=="function"}function zr(i){return Object.keys(i).length===0}function dr(i,...e){if(i==null){for(const t of e)t(void 0);return D}const n=i.subscribe(...e);return n.unsubscribe?()=>n.unsubscribe():n}function Hr(i,e,n){i.$$.on_destroy.push(dr(e,n))}function ye(i,e,n,t){if(i){const s=pr(i,e,n,t);return i[0](s)}}function pr(i,e,n,t){return i[1]&&t?nt(n.ctx.slice(),i[1](t(e))):n.ctx}function Ce(i,e,n,t){if(i[2]&&t){const s=i[2](t(n));if(e.dirty===void 0)return s;if(typeof s=="object"){const r=[],o=Math.max(e.dirty.length,s.length);for(let l=0;l<o;l+=1)r[l]=e.dirty[l]|s[l];return r}return e.dirty|s}return e.dirty}function Se(i,e,n,t,s,r){if(s){const o=pr(e,n,t,r);i.p(o,s)}}function Ee(i){if(i.ctx.length>32){const e=[],n=i.ctx.length/32;for(let t=0;t<n;t++)e[t]=-1;return e}return-1}function k(i,e){i.appendChild(e)}function S(i,e,n){i.insertBefore(e,n||null)}function C(i){i.parentNode&&i.parentNode.removeChild(i)}function Ie(i,e){for(let n=0;n<i.length;n+=1)i[n]&&i[n].d(e)}function A(i){return document.createElement(i)}function ee(i){return document.createElementNS("http://www.w3.org/2000/svg",i)}function L(i){return document.createTextNode(i)}function O(){return L(" ")}function X(){return L("")}function Qe(i,e,n,t){return i.addEventListener(e,n,t),()=>i.removeEventListener(e,n,t)}function Jr(i){return function(e){return e.preventDefault(),i.call(this,e)}}function v(i,e,n){n==null?i.removeAttribute(e):i.getAttribute(e)!==n&&i.setAttribute(e,n)}function Kr(i){return Array.from(i.childNodes)}function B(i,e){e=""+e,i.data!==e&&(i.data=e)}function Je(i,e){i.value=e??""}function fn(i,e,n){for(let t=0;t<i.options.length;t+=1){const s=i.options[t];if(s.__value===e){s.selected=!0;return}}(!n||e!==void 0)&&(i.selectedIndex=-1)}function Gr(i){const e=i.querySelector(":checked");return e&&e.__value}function Vr(i,e,{bubbles:n=!1,cancelable:t=!1}={}){return new CustomEvent(i,{detail:e,bubbles:n,cancelable:t})}function mt(i,e){return new i(e)}let rt;function xe(i){rt=i}function bt(){if(!rt)throw new Error("Function called outside component initialization");return rt}function pe(i){bt().$$.on_mount.push(i)}function Wr(i){bt().$$.after_update.push(i)}function Qr(i){bt().$$.on_destroy.push(i)}function Yr(){const i=bt();return(e,n,{cancelable:t=!1}={})=>{const s=i.$$.callbacks[e];if(s){const r=Vr(e,n,{cancelable:t});return s.slice().forEach(o=>{o.call(i,r)}),!r.defaultPrevented}return!0}}function hn(i,e){const n=i.$$.callbacks[e.type];n&&n.slice().forEach(t=>t.call(this,e))}const Me=[],Z=[];let ze=[];const Ut=[],mr=Promise.resolve();let qt=!1;function _r(){qt||(qt=!0,mr.then($r))}function gr(){return _r(),mr}function _t(i){ze.push(i)}function te(i){Ut.push(i)}const At=new Set;let De=0;function $r(){if(De!==0)return;const i=rt;do{try{for(;De<Me.length;){const e=Me[De];De++,xe(e),Xr(e.$$)}}catch(e){throw Me.length=0,De=0,e}for(xe(null),Me.length=0,De=0;Z.length;)Z.pop()();for(let e=0;e<ze.length;e+=1){const n=ze[e];At.has(n)||(At.add(n),n())}ze.length=0}while(Me.length);for(;Ut.length;)Ut.pop()();qt=!1,At.clear(),xe(i)}function Xr(i){if(i.fragment!==null){i.update(),Ve(i.before_update);const e=i.dirty;i.dirty=[-1],i.fragment&&i.fragment.p(i.ctx,e),i.after_update.forEach(_t)}}function Zr(i){const e=[],n=[];ze.forEach(t=>i.indexOf(t)===-1?e.push(t):n.push(t)),n.forEach(t=>t()),ze=e}const pt=new Set;let Pe;function G(){Pe={r:0,c:[],p:Pe}}function V(){Pe.r||Ve(Pe.c),Pe=Pe.p}function m(i,e){i&&i.i&&(pt.delete(i),i.i(e))}function _(i,e,n,t){if(i&&i.o){if(pt.has(i))return;pt.add(i),Pe.c.push(()=>{pt.delete(i),t&&(n&&i.d(1),t())}),i.o(e)}else t&&t()}function ae(i){return(i==null?void 0:i.length)!==void 0?i:Array.from(i)}function gt(i,e){const n={},t={},s={$$scope:1};let r=i.length;for(;r--;){const o=i[r],l=e[r];if(l){for(const a in o)a in l||(t[a]=1);for(const a in l)s[a]||(n[a]=l[a],s[a]=1);i[r]=l}else for(const a in o)s[a]=1}for(const o in t)o in n||(n[o]=void 0);return n}function $t(i){return typeof i=="object"&&i!==null?i:{}}function ne(i,e,n){const t=i.$$.props[e];t!==void 0&&(i.$$.bound[t]=n,n(i.$$.ctx[t]))}function w(i){i&&i.c()}function $(i,e,n){const{fragment:t,after_update:s}=i.$$;t&&t.m(e,n),_t(()=>{const r=i.$$.on_mount.map(hr).filter(We);i.$$.on_destroy?i.$$.on_destroy.push(...r):Ve(r),i.$$.on_mount=[]}),s.forEach(_t)}function b(i,e){const n=i.$$;n.fragment!==null&&(Zr(n.after_update),Ve(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function xr(i,e){i.$$.dirty[0]===-1&&(Me.push(i),_r(),i.$$.dirty.fill(0)),i.$$.dirty[e/31|0]|=1<<e%31}function q(i,e,n,t,s,r,o=null,l=[-1]){const a=rt;xe(i);const u=i.$$={fragment:null,ctx:[],props:r,update:D,not_equal:s,bound:cn(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(a?a.$$.context:[])),callbacks:cn(),dirty:l,skip_bound:!1,root:e.target||a.$$.root};o&&o(u.root);let c=!1;if(u.ctx=n?n(i,e.props||{},(h,d,...f)=>{const p=f.length?f[0]:d;return u.ctx&&s(u.ctx[h],u.ctx[h]=p)&&(!u.skip_bound&&u.bound[h]&&u.bound[h](p),c&&xr(i,h)),d}):[],u.update(),c=!0,Ve(u.before_update),u.fragment=t?t(u.ctx):!1,e.target){if(e.hydrate){const h=Kr(e.target);u.fragment&&u.fragment.l(h),h.forEach(C)}else u.fragment&&u.fragment.c();e.intro&&m(i.$$.fragment),$(i,e.target,e.anchor),$r()}xe(a)}class N{constructor(){Ot(this,"$$");Ot(this,"$$set")}$destroy(){b(this,1),this.$destroy=D}$on(e,n){if(!We(n))return D;const t=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return t.push(n),()=>{const s=t.indexOf(n);s!==-1&&t.splice(s,1)}}$set(e){this.$$set&&!zr(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const es="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(es);const Ue=[];function br(i,e){return{subscribe:Kt(i,e).subscribe}}function Kt(i,e=D){let n;const t=new Set;function s(l){if(U(i,l)&&(i=l,n)){const a=!Ue.length;for(const u of t)u[1](),Ue.push(u,i);if(a){for(let u=0;u<Ue.length;u+=2)Ue[u][0](Ue[u+1]);Ue.length=0}}}function r(l){s(l(i))}function o(l,a=D){const u=[l,a];return t.add(u),t.size===1&&(n=e(s,r)||D),l(i),()=>{t.delete(u),t.size===0&&n&&(n(),n=null)}}return{set:s,update:r,subscribe:o}}function wr(i,e,n){const t=!Array.isArray(i),s=t?[i]:i;if(!s.every(Boolean))throw new Error("derived() expects stores as input, got a falsy value");const r=e.length<2;return br(n,(o,l)=>{let a=!1;const u=[];let c=0,h=D;const d=()=>{if(c)return;h();const p=e(t?u[0]:u,o,l);r?o(p):h=We(p)?p:D},f=s.map((p,g)=>dr(p,y=>{u[g]=y,c&=~(1<<g),a&&d()},()=>{c|=1<<g}));return a=!0,d(),function(){Ve(f),h(),a=!1}})}function ts(i,e){if(i instanceof RegExp)return{keys:!1,pattern:i};var n,t,s,r,o=[],l="",a=i.split("/");for(a[0]||a.shift();s=a.shift();)n=s[0],n==="*"?(o.push("wild"),l+="/(.*)"):n===":"?(t=s.indexOf("?",1),r=s.indexOf(".",1),o.push(s.substring(1,~t?t:~r?r:s.length)),l+=~t&&!~r?"(?:/([^/]+?))?":"/([^/]+?)",~r&&(l+=(~t?"?":"")+"\\"+s.substring(r))):l+="/"+s;return{keys:o,pattern:new RegExp("^"+l+"/?$","i")}}function ns(i){let e,n,t;const s=[i[2]];var r=i[0];function o(l,a){let u={};for(let c=0;c<s.length;c+=1)u=nt(u,s[c]);return a!==void 0&&a&4&&(u=nt(u,gt(s,[$t(l[2])]))),{props:u}}return r&&(e=mt(r,o(i)),e.$on("routeEvent",i[7])),{c(){e&&w(e.$$.fragment),n=X()},m(l,a){e&&$(e,l,a),S(l,n,a),t=!0},p(l,a){if(a&1&&r!==(r=l[0])){if(e){G();const u=e;_(u.$$.fragment,1,0,()=>{b(u,1)}),V()}r?(e=mt(r,o(l,a)),e.$on("routeEvent",l[7]),w(e.$$.fragment),m(e.$$.fragment,1),$(e,n.parentNode,n)):e=null}else if(r){const u=a&4?gt(s,[$t(l[2])]):{};e.$set(u)}},i(l){t||(e&&m(e.$$.fragment,l),t=!0)},o(l){e&&_(e.$$.fragment,l),t=!1},d(l){l&&C(n),e&&b(e,l)}}}function rs(i){let e,n,t;const s=[{params:i[1]},i[2]];var r=i[0];function o(l,a){let u={};for(let c=0;c<s.length;c+=1)u=nt(u,s[c]);return a!==void 0&&a&6&&(u=nt(u,gt(s,[a&2&&{params:l[1]},a&4&&$t(l[2])]))),{props:u}}return r&&(e=mt(r,o(i)),e.$on("routeEvent",i[6])),{c(){e&&w(e.$$.fragment),n=X()},m(l,a){e&&$(e,l,a),S(l,n,a),t=!0},p(l,a){if(a&1&&r!==(r=l[0])){if(e){G();const u=e;_(u.$$.fragment,1,0,()=>{b(u,1)}),V()}r?(e=mt(r,o(l,a)),e.$on("routeEvent",l[6]),w(e.$$.fragment),m(e.$$.fragment,1),$(e,n.parentNode,n)):e=null}else if(r){const u=a&6?gt(s,[a&2&&{params:l[1]},a&4&&$t(l[2])]):{};e.$set(u)}},i(l){t||(e&&m(e.$$.fragment,l),t=!0)},o(l){e&&_(e.$$.fragment,l),t=!1},d(l){l&&C(n),e&&b(e,l)}}}function ss(i){let e,n,t,s;const r=[rs,ns],o=[];function l(a,u){return a[1]?0:1}return e=l(i),n=o[e]=r[e](i),{c(){n.c(),t=X()},m(a,u){o[e].m(a,u),S(a,t,u),s=!0},p(a,[u]){let c=e;e=l(a),e===c?o[e].p(a,u):(G(),_(o[c],1,1,()=>{o[c]=null}),V(),n=o[e],n?n.p(a,u):(n=o[e]=r[e](a),n.c()),m(n,1),n.m(t.parentNode,t))},i(a){s||(m(n),s=!0)},o(a){_(n),s=!1},d(a){a&&C(t),o[e].d(a)}}}function dn(){const i=window.location.href.indexOf("#/");let e=i>-1?window.location.href.substr(i+1):"/";const n=e.indexOf("?");let t="";return n>-1&&(t=e.substr(n+1),e=e.substr(0,n)),{location:e,querystring:t}}const Gt=br(null,function(e){e(dn());const n=()=>{e(dn())};return window.addEventListener("hashchange",n,!1),function(){window.removeEventListener("hashchange",n,!1)}});wr(Gt,i=>i.location);wr(Gt,i=>i.querystring);const pn=Kt(void 0);async function J(i){if(!i||i.length<1||i.charAt(0)!="/"&&i.indexOf("#/")!==0)throw Error("Invalid parameter location");await gr(),history.replaceState({...history.state,__svelte_spa_router_scrollX:window.scrollX,__svelte_spa_router_scrollY:window.scrollY},void 0),window.location.hash=(i.charAt(0)=="#"?"":"#")+i}function is(i){i?window.scrollTo(i.__svelte_spa_router_scrollX,i.__svelte_spa_router_scrollY):window.scrollTo(0,0)}function os(i,e,n){let{routes:t={}}=e,{prefix:s=""}=e,{restoreScrollState:r=!1}=e;class o{constructor(I,R){if(!R||typeof R!="function"&&(typeof R!="object"||R._sveltesparouter!==!0))throw Error("Invalid component object");if(!I||typeof I=="string"&&(I.length<1||I.charAt(0)!="/"&&I.charAt(0)!="*")||typeof I=="object"&&!(I instanceof RegExp))throw Error('Invalid value for "path" argument - strings must start with / or *');const{pattern:M,keys:W}=ts(I);this.path=I,typeof R=="object"&&R._sveltesparouter===!0?(this.component=R.component,this.conditions=R.conditions||[],this.userData=R.userData,this.props=R.props||{}):(this.component=()=>Promise.resolve(R),this.conditions=[],this.props={}),this._pattern=M,this._keys=W}match(I){if(s){if(typeof s=="string")if(I.startsWith(s))I=I.substr(s.length)||"/";else return null;else if(s instanceof RegExp){const le=I.match(s);if(le&&le[0])I=I.substr(le[0].length)||"/";else return null}}const R=this._pattern.exec(I);if(R===null)return null;if(this._keys===!1)return R;const M={};let W=0;for(;W<this._keys.length;){try{M[this._keys[W]]=decodeURIComponent(R[W+1]||"")||null}catch{M[this._keys[W]]=null}W++}return M}async checkConditions(I){for(let R=0;R<this.conditions.length;R++)if(!await this.conditions[R](I))return!1;return!0}}const l=[];t instanceof Map?t.forEach((P,I)=>{l.push(new o(I,P))}):Object.keys(t).forEach(P=>{l.push(new o(P,t[P]))});let a=null,u=null,c={};const h=Yr();async function d(P,I){await gr(),h(P,I)}let f=null,p=null;r&&(p=P=>{P.state&&(P.state.__svelte_spa_router_scrollY||P.state.__svelte_spa_router_scrollX)?f=P.state:f=null},window.addEventListener("popstate",p),Wr(()=>{is(f)}));let g=null,y=null;const T=Gt.subscribe(async P=>{g=P;let I=0;for(;I<l.length;){const R=l[I].match(P.location);if(!R){I++;continue}const M={route:l[I].path,location:P.location,querystring:P.querystring,userData:l[I].userData,params:R&&typeof R=="object"&&Object.keys(R).length?R:null};if(!await l[I].checkConditions(M)){n(0,a=null),y=null,d("conditionsFailed",M);return}d("routeLoading",Object.assign({},M));const W=l[I].component;if(y!=W){W.loading?(n(0,a=W.loading),y=W,n(1,u=W.loadingParams),n(2,c={}),d("routeLoaded",Object.assign({},M,{component:a,name:a.name,params:u}))):(n(0,a=null),y=null);const le=await W();if(P!=g)return;n(0,a=le&&le.default||le),y=W}R&&typeof R=="object"&&Object.keys(R).length?n(1,u=R):n(1,u=null),n(2,c=l[I].props),d("routeLoaded",Object.assign({},M,{component:a,name:a.name,params:u})).then(()=>{pn.set(u)});return}n(0,a=null),y=null,pn.set(void 0)});Qr(()=>{T(),p&&window.removeEventListener("popstate",p)});function E(P){hn.call(this,i,P)}function j(P){hn.call(this,i,P)}return i.$$set=P=>{"routes"in P&&n(3,t=P.routes),"prefix"in P&&n(4,s=P.prefix),"restoreScrollState"in P&&n(5,r=P.restoreScrollState)},i.$$.update=()=>{i.$$.dirty&32&&(history.scrollRestoration=r?"manual":"auto")},[a,u,c,t,s,r,E,j]}class as extends N{constructor(e){super(),q(this,e,os,ss,U,{routes:3,prefix:4,restoreScrollState:5})}}function ls(){const{subscribe:i,set:e,update:n}=Kt(null);return{subscribe:i,setDBError:t=>e({msg:t.message,details:t.details}),setAuthError:t=>{e({msg:t.message})},setString:(t,s)=>e({msg:t,details:s}),reset:()=>e(null)}}const Q=ls();function us(i){let e,n,t,s;return{c(){e=A("button"),n=L(i[0]),v(e,"class","btn"),e.disabled=i[2],v(e,"type","button")},m(r,o){S(r,e,o),k(e,n),t||(s=Qe(e,"click",function(){We(i[1])&&i[1].apply(this,arguments)}),t=!0)},p(r,o){i=r,o&1&&B(n,i[0]),o&4&&(e.disabled=i[2])},d(r){r&&C(e),t=!1,s()}}}function cs(i){let e,n;return{c(){e=A("button"),n=L(i[0]),v(e,"class","btn"),e.disabled=i[2],v(e,"type","submit")},m(t,s){S(t,e,s),k(e,n)},p(t,s){s&1&&B(n,t[0]),s&4&&(e.disabled=t[2])},d(t){t&&C(e)}}}function fs(i){let e;function n(r,o){return r[1]==null?cs:us}let t=n(i),s=t(i);return{c(){s.c(),e=X()},m(r,o){s.m(r,o),S(r,e,o)},p(r,[o]){t===(t=n(r))&&s?s.p(r,o):(s.d(1),s=t(r),s&&(s.c(),s.m(e.parentNode,e)))},i:D,o:D,d(r){r&&C(e),s.d(r)}}}function hs(i,e,n){let{label:t}=e,{onClick:s=null}=e,{disabled:r=!1}=e;return i.$$set=o=>{"label"in o&&n(0,t=o.label),"onClick"in o&&n(1,s=o.onClick),"disabled"in o&&n(2,r=o.disabled)},[t,s,r]}class H extends N{constructor(e){super(),q(this,e,hs,fs,U,{label:0,onClick:1,disabled:2})}}function ds(i){let e,n;const t=i[1].default,s=ye(t,i,i[0],null);return{c(){e=A("div"),s&&s.c(),v(e,"class","flex gap-4")},m(r,o){S(r,e,o),s&&s.m(e,null),n=!0},p(r,[o]){s&&s.p&&(!n||o&1)&&Se(s,t,r,r[0],n?Ce(t,r[0],o,null):Ee(r[0]),null)},i(r){n||(m(s,r),n=!0)},o(r){_(s,r),n=!1},d(r){r&&C(e),s&&s.d(r)}}}function ps(i,e,n){let{$$slots:t={},$$scope:s}=e;return i.$$set=r=>{"$$scope"in r&&n(0,s=r.$$scope)},[s,t]}class x extends N{constructor(e){super(),q(this,e,ps,ds,U,{})}}function mn(i,e,n){const t=i.slice();return t[5]=e[n],t}function _n(i){let e,n;return e=new H({props:{label:i[5].label,onClick:i[5].onclick}}),{c(){w(e.$$.fragment)},m(t,s){$(e,t,s),n=!0},p(t,s){const r={};s&2&&(r.label=t[5].label),s&2&&(r.onClick=t[5].onclick),e.$set(r)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function ms(i){let e,n,t=ae(i[1]),s=[];for(let o=0;o<t.length;o+=1)s[o]=_n(mn(i,t,o));const r=o=>_(s[o],1,1,()=>{s[o]=null});return{c(){for(let o=0;o<s.length;o+=1)s[o].c();e=X()},m(o,l){for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(o,l);S(o,e,l),n=!0},p(o,l){if(l&2){t=ae(o[1]);let a;for(a=0;a<t.length;a+=1){const u=mn(o,t,a);s[a]?(s[a].p(u,l),m(s[a],1)):(s[a]=_n(u),s[a].c(),m(s[a],1),s[a].m(e.parentNode,e))}for(G(),a=t.length;a<s.length;a+=1)r(a);V()}},i(o){if(!n){for(let l=0;l<t.length;l+=1)m(s[l]);n=!0}},o(o){s=s.filter(Boolean);for(let l=0;l<s.length;l+=1)_(s[l]);n=!1},d(o){o&&C(e),Ie(s,o)}}}function _s(i){let e,n,t,s,r,o,l,a,u,c,h;const d=i[3].default,f=ye(d,i,i[4],null);return c=new x({props:{$$slots:{default:[ms]},$$scope:{ctx:i}}}),{c(){e=A("div"),n=A("div"),t=A("div"),s=L(i[0]),o=O(),l=A("div"),f&&f.c(),a=O(),u=A("div"),w(c.$$.fragment),v(t,"class",r="text-lg pb-2 border-b "+(i[2]==="error"?"text-red-900":"")),v(l,"class","my-6"),v(n,"class","relative top-1/3 mx-auto max-w-md bg-white rounded shadow p-6"),v(e,"class","fixed z-50 inset-0 bg-black bg-opacity-50 overflow-y-auto h-full w-full")},m(p,g){S(p,e,g),k(e,n),k(n,t),k(t,s),k(n,o),k(n,l),f&&f.m(l,null),k(n,a),k(n,u),$(c,u,null),h=!0},p(p,[g]){(!h||g&1)&&B(s,p[0]),(!h||g&4&&r!==(r="text-lg pb-2 border-b "+(p[2]==="error"?"text-red-900":"")))&&v(t,"class",r),f&&f.p&&(!h||g&16)&&Se(f,d,p,p[4],h?Ce(d,p[4],g,null):Ee(p[4]),null);const y={};g&18&&(y.$$scope={dirty:g,ctx:p}),c.$set(y)},i(p){h||(m(f,p),m(c.$$.fragment,p),h=!0)},o(p){_(f,p),_(c.$$.fragment,p),h=!1},d(p){p&&C(e),f&&f.d(p),b(c)}}}function gs(i,e,n){let{$$slots:t={},$$scope:s}=e,{title:r}=e,{buttons:o}=e,{type:l="ok"}=e;return i.$$set=a=>{"title"in a&&n(0,r=a.title),"buttons"in a&&n(1,o=a.buttons),"type"in a&&n(2,l=a.type),"$$scope"in a&&n(4,s=a.$$scope)},[r,o,l,t,s]}class vr extends N{constructor(e){super(),q(this,e,gs,_s,U,{title:0,buttons:1,type:2})}}function gn(i){let e,n;return e=new vr({props:{title:"Errors",buttons:i[1],type:"error",$$slots:{default:[$s]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,s){$(e,t,s),n=!0},p(t,s){const r={};s&5&&(r.$$scope={dirty:s,ctx:t}),e.$set(r)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function $n(i){let e,n=i[0].msg+"",t;return{c(){e=A("p"),t=L(n),v(e,"class","text-sm pt-3")},m(s,r){S(s,e,r),k(e,t)},p(s,r){r&1&&n!==(n=s[0].msg+"")&&B(t,n)},d(s){s&&C(e)}}}function $s(i){let e=i[0].msg+"",n,t,s,r=i[0].details&&$n(i);return{c(){n=L(e),t=O(),r&&r.c(),s=X()},m(o,l){S(o,n,l),S(o,t,l),r&&r.m(o,l),S(o,s,l)},p(o,l){l&1&&e!==(e=o[0].msg+"")&&B(n,e),o[0].details?r?r.p(o,l):(r=$n(o),r.c(),r.m(s.parentNode,s)):r&&(r.d(1),r=null)},d(o){o&&(C(n),C(t),C(s)),r&&r.d(o)}}}function bs(i){let e,n,t=i[0]!==null&&gn(i);return{c(){t&&t.c(),e=X()},m(s,r){t&&t.m(s,r),S(s,e,r),n=!0},p(s,[r]){s[0]!==null?t?(t.p(s,r),r&1&&m(t,1)):(t=gn(s),t.c(),m(t,1),t.m(e.parentNode,e)):t&&(G(),_(t,1,1,()=>{t=null}),V())},i(s){n||(m(t),n=!0)},o(s){_(t),n=!1},d(s){s&&C(e),t&&t.d(s)}}}function ws(i,e,n){let t;return Hr(i,Q,r=>n(0,t=r)),[t,[{label:"OK",onclick:()=>{Q.reset()}}]]}class vs extends N{constructor(e){super(),q(this,e,ws,bs,U,{})}}const ks="modulepreload",ys=function(i,e){return new URL(i,e).href},bn={},Ke=function(e,n,t){let s=Promise.resolve();if(n&&n.length>0){const r=document.getElementsByTagName("link"),o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));s=Promise.all(n.map(a=>{if(a=ys(a,t),a in bn)return;bn[a]=!0;const u=a.endsWith(".css"),c=u?'[rel="stylesheet"]':"";if(!!t)for(let f=r.length-1;f>=0;f--){const p=r[f];if(p.href===a&&(!u||p.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${a}"]${c}`))return;const d=document.createElement("link");if(d.rel=u?"stylesheet":ks,u||(d.as="script",d.crossOrigin=""),d.href=a,l&&d.setAttribute("nonce",l),document.head.appendChild(d),u)return new Promise((f,p)=>{d.addEventListener("load",f),d.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${a}`)))})}))}return s.then(()=>e()).catch(r=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=r,window.dispatchEvent(o),!o.defaultPrevented)throw r})},Cs=i=>{let e;return i?e=i:typeof fetch>"u"?e=(...n)=>Ke(()=>Promise.resolve().then(()=>at),void 0,import.meta.url).then(({default:t})=>t(...n)):e=fetch,(...n)=>e(...n)};class Vt extends Error{constructor(e,n="FunctionsError",t){super(e),this.name=n,this.context=t}}class Ss extends Vt{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Es extends Vt{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Os extends Vt{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Nt;(function(i){i.Any="any",i.ApNortheast1="ap-northeast-1",i.ApNortheast2="ap-northeast-2",i.ApSouth1="ap-south-1",i.ApSoutheast1="ap-southeast-1",i.ApSoutheast2="ap-southeast-2",i.CaCentral1="ca-central-1",i.EuCentral1="eu-central-1",i.EuWest1="eu-west-1",i.EuWest2="eu-west-2",i.EuWest3="eu-west-3",i.SaEast1="sa-east-1",i.UsEast1="us-east-1",i.UsWest1="us-west-1",i.UsWest2="us-west-2"})(Nt||(Nt={}));var As=function(i,e,n,t){function s(r){return r instanceof n?r:new n(function(o){o(r)})}return new(n||(n=Promise))(function(r,o){function l(c){try{u(t.next(c))}catch(h){o(h)}}function a(c){try{u(t.throw(c))}catch(h){o(h)}}function u(c){c.done?r(c.value):s(c.value).then(l,a)}u((t=t.apply(i,e||[])).next())})};class Ts{constructor(e,{headers:n={},customFetch:t,region:s=Nt.Any}={}){this.url=e,this.headers=n,this.region=s,this.fetch=Cs(t)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,n={}){var t;return As(this,void 0,void 0,function*(){try{const{headers:s,method:r,body:o}=n;let l={},{region:a}=n;a||(a=this.region),a&&a!=="any"&&(l["x-region"]=a);let u;o&&(s&&!Object.prototype.hasOwnProperty.call(s,"Content-Type")||!s)&&(typeof Blob<"u"&&o instanceof Blob||o instanceof ArrayBuffer?(l["Content-Type"]="application/octet-stream",u=o):typeof o=="string"?(l["Content-Type"]="text/plain",u=o):typeof FormData<"u"&&o instanceof FormData?u=o:(l["Content-Type"]="application/json",u=JSON.stringify(o)));const c=yield this.fetch(`${this.url}/${e}`,{method:r||"POST",headers:Object.assign(Object.assign(Object.assign({},l),this.headers),s),body:u}).catch(p=>{throw new Ss(p)}),h=c.headers.get("x-relay-error");if(h&&h==="true")throw new Es(c);if(!c.ok)throw new Os(c);let d=((t=c.headers.get("Content-Type"))!==null&&t!==void 0?t:"text/plain").split(";")[0].trim(),f;return d==="application/json"?f=yield c.json():d==="application/octet-stream"?f=yield c.blob():d==="text/event-stream"?f=c:d==="multipart/form-data"?f=yield c.formData():f=yield c.text(),{data:f,error:null}}catch(s){return{data:null,error:s}}})}}var js=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Ge=js();const Ps=Ge.fetch,Wt=Ge.fetch.bind(Ge),kr=Ge.Headers,Is=Ge.Request,Rs=Ge.Response,at=Object.freeze(Object.defineProperty({__proto__:null,Headers:kr,Request:Is,Response:Rs,default:Wt,fetch:Ps},Symbol.toStringTag,{value:"Module"}));class Ls extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}}class Ds{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=Wt:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}then(e,n){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const t=this.fetch;let s=t(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async r=>{var o,l,a;let u=null,c=null,h=null,d=r.status,f=r.statusText;if(r.ok){if(this.method!=="HEAD"){const T=await r.text();T===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?c=T:c=JSON.parse(T))}const g=(o=this.headers.Prefer)===null||o===void 0?void 0:o.match(/count=(exact|planned|estimated)/),y=(l=r.headers.get("content-range"))===null||l===void 0?void 0:l.split("/");g&&y&&y.length>1&&(h=parseInt(y[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(c)&&(c.length>1?(u={code:"PGRST116",details:`Results contain ${c.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},c=null,h=null,d=406,f="Not Acceptable"):c.length===1?c=c[0]:c=null)}else{const g=await r.text();try{u=JSON.parse(g),Array.isArray(u)&&r.status===404&&(c=[],u=null,d=200,f="OK")}catch{r.status===404&&g===""?(d=204,f="No Content"):u={message:g}}if(u&&this.isMaybeSingle&&(!((a=u==null?void 0:u.details)===null||a===void 0)&&a.includes("0 rows"))&&(u=null,d=200,f="OK"),u&&this.shouldThrowOnError)throw new Ls(u)}return{error:u,data:c,count:h,status:d,statusText:f}});return this.shouldThrowOnError||(s=s.catch(r=>{var o,l,a;return{error:{message:`${(o=r==null?void 0:r.name)!==null&&o!==void 0?o:"FetchError"}: ${r==null?void 0:r.message}`,details:`${(l=r==null?void 0:r.stack)!==null&&l!==void 0?l:""}`,hint:"",code:`${(a=r==null?void 0:r.code)!==null&&a!==void 0?a:""}`},data:null,count:null,status:0,statusText:""}})),s.then(e,n)}}class Us extends Ds{select(e){let n=!1;const t=(e??"*").split("").map(s=>/\s/.test(s)&&!n?"":(s==='"'&&(n=!n),s)).join("");return this.url.searchParams.set("select",t),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e,{ascending:n=!0,nullsFirst:t,foreignTable:s,referencedTable:r=s}={}){const o=r?`${r}.order`:"order",l=this.url.searchParams.get(o);return this.url.searchParams.set(o,`${l?`${l},`:""}${e}.${n?"asc":"desc"}${t===void 0?"":t?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:n,referencedTable:t=n}={}){const s=typeof t>"u"?"limit":`${t}.limit`;return this.url.searchParams.set(s,`${e}`),this}range(e,n,{foreignTable:t,referencedTable:s=t}={}){const r=typeof s>"u"?"offset":`${s}.offset`,o=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(r,`${e}`),this.url.searchParams.set(o,`${n-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:e=!1,verbose:n=!1,settings:t=!1,buffers:s=!1,wal:r=!1,format:o="text"}={}){var l;const a=[e?"analyze":null,n?"verbose":null,t?"settings":null,s?"buffers":null,r?"wal":null].filter(Boolean).join("|"),u=(l=this.headers.Accept)!==null&&l!==void 0?l:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${o}; for="${u}"; options=${a};`,o==="json"?this:this}rollback(){var e;return((e=this.headers.Prefer)!==null&&e!==void 0?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}class Fe extends Us{eq(e,n){return this.url.searchParams.append(e,`eq.${n}`),this}neq(e,n){return this.url.searchParams.append(e,`neq.${n}`),this}gt(e,n){return this.url.searchParams.append(e,`gt.${n}`),this}gte(e,n){return this.url.searchParams.append(e,`gte.${n}`),this}lt(e,n){return this.url.searchParams.append(e,`lt.${n}`),this}lte(e,n){return this.url.searchParams.append(e,`lte.${n}`),this}like(e,n){return this.url.searchParams.append(e,`like.${n}`),this}likeAllOf(e,n){return this.url.searchParams.append(e,`like(all).{${n.join(",")}}`),this}likeAnyOf(e,n){return this.url.searchParams.append(e,`like(any).{${n.join(",")}}`),this}ilike(e,n){return this.url.searchParams.append(e,`ilike.${n}`),this}ilikeAllOf(e,n){return this.url.searchParams.append(e,`ilike(all).{${n.join(",")}}`),this}ilikeAnyOf(e,n){return this.url.searchParams.append(e,`ilike(any).{${n.join(",")}}`),this}is(e,n){return this.url.searchParams.append(e,`is.${n}`),this}in(e,n){const t=Array.from(new Set(n)).map(s=>typeof s=="string"&&new RegExp("[,()]").test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(e,`in.(${t})`),this}contains(e,n){return typeof n=="string"?this.url.searchParams.append(e,`cs.${n}`):Array.isArray(n)?this.url.searchParams.append(e,`cs.{${n.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(n)}`),this}containedBy(e,n){return typeof n=="string"?this.url.searchParams.append(e,`cd.${n}`):Array.isArray(n)?this.url.searchParams.append(e,`cd.{${n.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(n)}`),this}rangeGt(e,n){return this.url.searchParams.append(e,`sr.${n}`),this}rangeGte(e,n){return this.url.searchParams.append(e,`nxl.${n}`),this}rangeLt(e,n){return this.url.searchParams.append(e,`sl.${n}`),this}rangeLte(e,n){return this.url.searchParams.append(e,`nxr.${n}`),this}rangeAdjacent(e,n){return this.url.searchParams.append(e,`adj.${n}`),this}overlaps(e,n){return typeof n=="string"?this.url.searchParams.append(e,`ov.${n}`):this.url.searchParams.append(e,`ov.{${n.join(",")}}`),this}textSearch(e,n,{config:t,type:s}={}){let r="";s==="plain"?r="pl":s==="phrase"?r="ph":s==="websearch"&&(r="w");const o=t===void 0?"":`(${t})`;return this.url.searchParams.append(e,`${r}fts${o}.${n}`),this}match(e){return Object.entries(e).forEach(([n,t])=>{this.url.searchParams.append(n,`eq.${t}`)}),this}not(e,n,t){return this.url.searchParams.append(e,`not.${n}.${t}`),this}or(e,{foreignTable:n,referencedTable:t=n}={}){const s=t?`${t}.or`:"or";return this.url.searchParams.append(s,`(${e})`),this}filter(e,n,t){return this.url.searchParams.append(e,`${n}.${t}`),this}}class qs{constructor(e,{headers:n={},schema:t,fetch:s}){this.url=e,this.headers=n,this.schema=t,this.fetch=s}select(e,{head:n=!1,count:t}={}){const s=n?"HEAD":"GET";let r=!1;const o=(e??"*").split("").map(l=>/\s/.test(l)&&!r?"":(l==='"'&&(r=!r),l)).join("");return this.url.searchParams.set("select",o),t&&(this.headers.Prefer=`count=${t}`),new Fe({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e,{count:n,defaultToNull:t=!0}={}){const s="POST",r=[];if(this.headers.Prefer&&r.push(this.headers.Prefer),n&&r.push(`count=${n}`),t||r.push("missing=default"),this.headers.Prefer=r.join(","),Array.isArray(e)){const o=e.reduce((l,a)=>l.concat(Object.keys(a)),[]);if(o.length>0){const l=[...new Set(o)].map(a=>`"${a}"`);this.url.searchParams.set("columns",l.join(","))}}return new Fe({method:s,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e,{onConflict:n,ignoreDuplicates:t=!1,count:s,defaultToNull:r=!0}={}){const o="POST",l=[`resolution=${t?"ignore":"merge"}-duplicates`];if(n!==void 0&&this.url.searchParams.set("on_conflict",n),this.headers.Prefer&&l.push(this.headers.Prefer),s&&l.push(`count=${s}`),r||l.push("missing=default"),this.headers.Prefer=l.join(","),Array.isArray(e)){const a=e.reduce((u,c)=>u.concat(Object.keys(c)),[]);if(a.length>0){const u=[...new Set(a)].map(c=>`"${c}"`);this.url.searchParams.set("columns",u.join(","))}}return new Fe({method:o,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e,{count:n}={}){const t="PATCH",s=[];return this.headers.Prefer&&s.push(this.headers.Prefer),n&&s.push(`count=${n}`),this.headers.Prefer=s.join(","),new Fe({method:t,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete({count:e}={}){const n="DELETE",t=[];return e&&t.push(`count=${e}`),this.headers.Prefer&&t.unshift(this.headers.Prefer),this.headers.Prefer=t.join(","),new Fe({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}const Ns="1.15.2",Bs={"X-Client-Info":`postgrest-js/${Ns}`};class Qt{constructor(e,{headers:n={},schema:t,fetch:s}={}){this.url=e,this.headers=Object.assign(Object.assign({},Bs),n),this.schemaName=t,this.fetch=s}from(e){const n=new URL(`${this.url}/${e}`);return new qs(n,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new Qt(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,n={},{head:t=!1,get:s=!1,count:r}={}){let o;const l=new URL(`${this.url}/rpc/${e}`);let a;t||s?(o=t?"HEAD":"GET",Object.entries(n).filter(([c,h])=>h!==void 0).map(([c,h])=>[c,Array.isArray(h)?`{${h.join(",")}}`:`${h}`]).forEach(([c,h])=>{l.searchParams.append(c,h)})):(o="POST",a=n);const u=Object.assign({},this.headers);return r&&(u.Prefer=`count=${r}`),new Fe({method:o,url:l,headers:u,schema:this.schemaName,body:a,fetch:this.fetch,allowEmpty:!1})}}const Ms="2.9.5",Fs={"X-Client-Info":`realtime-js/${Ms}`},zs="1.0.0",yr=1e4,Hs=1e3;var He;(function(i){i[i.connecting=0]="connecting",i[i.open=1]="open",i[i.closing=2]="closing",i[i.closed=3]="closed"})(He||(He={}));var ue;(function(i){i.closed="closed",i.errored="errored",i.joined="joined",i.joining="joining",i.leaving="leaving"})(ue||(ue={}));var de;(function(i){i.close="phx_close",i.error="phx_error",i.join="phx_join",i.reply="phx_reply",i.leave="phx_leave",i.access_token="access_token"})(de||(de={}));var Bt;(function(i){i.websocket="websocket"})(Bt||(Bt={}));var je;(function(i){i.Connecting="connecting",i.Open="open",i.Closing="closing",i.Closed="closed"})(je||(je={}));class Cr{constructor(e,n){this.callback=e,this.timerCalc=n,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=n}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}class Js{constructor(){this.HEADER_LENGTH=1}decode(e,n){return e.constructor===ArrayBuffer?n(this._binaryDecode(e)):n(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const n=new DataView(e),t=new TextDecoder;return this._decodeBroadcast(e,n,t)}_decodeBroadcast(e,n,t){const s=n.getUint8(1),r=n.getUint8(2);let o=this.HEADER_LENGTH+2;const l=t.decode(e.slice(o,o+s));o=o+s;const a=t.decode(e.slice(o,o+r));o=o+r;const u=JSON.parse(t.decode(e.slice(o,e.byteLength)));return{ref:null,topic:l,event:a,payload:u}}}class Tt{constructor(e,n,t={},s=yr){this.channel=e,this.event=n,this.payload=t,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,n){var t;return this._hasReceived(e)&&n((t=this.receivedResp)===null||t===void 0?void 0:t.response),this.recHooks.push({status:e,callback:n}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=n=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=n,this._matchReceive(n)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,n){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:n})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:n}){this.recHooks.filter(t=>t.status===e).forEach(t=>t.callback(n))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var wn;(function(i){i.SYNC="sync",i.JOIN="join",i.LEAVE="leave"})(wn||(wn={}));class et{constructor(e,n){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const t=(n==null?void 0:n.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(t.state,{},s=>{const{onJoin:r,onLeave:o,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=et.syncState(this.state,s,r,o),this.pendingDiffs.forEach(a=>{this.state=et.syncDiff(this.state,a,r,o)}),this.pendingDiffs=[],l()}),this.channel._on(t.diff,{},s=>{const{onJoin:r,onLeave:o,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=et.syncDiff(this.state,s,r,o),l())}),this.onJoin((s,r,o)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:r,newPresences:o})}),this.onLeave((s,r,o)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:r,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,n,t,s){const r=this.cloneDeep(e),o=this.transformState(n),l={},a={};return this.map(r,(u,c)=>{o[u]||(a[u]=c)}),this.map(o,(u,c)=>{const h=r[u];if(h){const d=c.map(y=>y.presence_ref),f=h.map(y=>y.presence_ref),p=c.filter(y=>f.indexOf(y.presence_ref)<0),g=h.filter(y=>d.indexOf(y.presence_ref)<0);p.length>0&&(l[u]=p),g.length>0&&(a[u]=g)}else l[u]=c}),this.syncDiff(r,{joins:l,leaves:a},t,s)}static syncDiff(e,n,t,s){const{joins:r,leaves:o}={joins:this.transformState(n.joins),leaves:this.transformState(n.leaves)};return t||(t=()=>{}),s||(s=()=>{}),this.map(r,(l,a)=>{var u;const c=(u=e[l])!==null&&u!==void 0?u:[];if(e[l]=this.cloneDeep(a),c.length>0){const h=e[l].map(f=>f.presence_ref),d=c.filter(f=>h.indexOf(f.presence_ref)<0);e[l].unshift(...d)}t(l,c,a)}),this.map(o,(l,a)=>{let u=e[l];if(!u)return;const c=a.map(h=>h.presence_ref);u=u.filter(h=>c.indexOf(h.presence_ref)<0),e[l]=u,s(l,u,a),u.length===0&&delete e[l]}),e}static map(e,n){return Object.getOwnPropertyNames(e).map(t=>n(t,e[t]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((n,t)=>{const s=e[t];return"metas"in s?n[t]=s.metas.map(r=>(r.presence_ref=r.phx_ref,delete r.phx_ref,delete r.phx_ref_prev,r)):n[t]=s,n},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var K;(function(i){i.abstime="abstime",i.bool="bool",i.date="date",i.daterange="daterange",i.float4="float4",i.float8="float8",i.int2="int2",i.int4="int4",i.int4range="int4range",i.int8="int8",i.int8range="int8range",i.json="json",i.jsonb="jsonb",i.money="money",i.numeric="numeric",i.oid="oid",i.reltime="reltime",i.text="text",i.time="time",i.timestamp="timestamp",i.timestamptz="timestamptz",i.timetz="timetz",i.tsrange="tsrange",i.tstzrange="tstzrange"})(K||(K={}));const vn=(i,e,n={})=>{var t;const s=(t=n.skipTypes)!==null&&t!==void 0?t:[];return Object.keys(e).reduce((r,o)=>(r[o]=Ks(o,i,e,s),r),{})},Ks=(i,e,n,t)=>{const s=e.find(l=>l.name===i),r=s==null?void 0:s.type,o=n[i];return r&&!t.includes(r)?Sr(r,o):Mt(o)},Sr=(i,e)=>{if(i.charAt(0)==="_"){const n=i.slice(1,i.length);return Qs(e,n)}switch(i){case K.bool:return Gs(e);case K.float4:case K.float8:case K.int2:case K.int4:case K.int8:case K.numeric:case K.oid:return Vs(e);case K.json:case K.jsonb:return Ws(e);case K.timestamp:return Ys(e);case K.abstime:case K.date:case K.daterange:case K.int4range:case K.int8range:case K.money:case K.reltime:case K.text:case K.time:case K.timestamptz:case K.timetz:case K.tsrange:case K.tstzrange:return Mt(e);default:return Mt(e)}},Mt=i=>i,Gs=i=>{switch(i){case"t":return!0;case"f":return!1;default:return i}},Vs=i=>{if(typeof i=="string"){const e=parseFloat(i);if(!Number.isNaN(e))return e}return i},Ws=i=>{if(typeof i=="string")try{return JSON.parse(i)}catch(e){return console.log(`JSON parse error: ${e}`),i}return i},Qs=(i,e)=>{if(typeof i!="string")return i;const n=i.length-1,t=i[n];if(i[0]==="{"&&t==="}"){let r;const o=i.slice(1,n);try{r=JSON.parse("["+o+"]")}catch{r=o?o.split(","):[]}return r.map(l=>Sr(e,l))}return i},Ys=i=>typeof i=="string"?i.replace(" ","T"):i;var kn;(function(i){i.ALL="*",i.INSERT="INSERT",i.UPDATE="UPDATE",i.DELETE="DELETE"})(kn||(kn={}));var yn;(function(i){i.BROADCAST="broadcast",i.PRESENCE="presence",i.POSTGRES_CHANGES="postgres_changes"})(yn||(yn={}));var Cn;(function(i){i.SUBSCRIBED="SUBSCRIBED",i.TIMED_OUT="TIMED_OUT",i.CLOSED="CLOSED",i.CHANNEL_ERROR="CHANNEL_ERROR"})(Cn||(Cn={}));class Yt{constructor(e,n={config:{}},t){this.topic=e,this.params=n,this.socket=t,this.bindings={},this.state=ue.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""}},n.config),this.timeout=this.socket.timeout,this.joinPush=new Tt(this,de.join,this.params,this.timeout),this.rejoinTimer=new Cr(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=ue.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(s=>s.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=ue.closed,this.socket._remove(this)}),this._onError(s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=ue.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=ue.errored,this.rejoinTimer.scheduleTimeout())}),this._on(de.reply,{},(s,r)=>{this._trigger(this._replyEventName(r),s)}),this.presence=new et(this),this.broadcastEndpointURL=this._broadcastEndpointURL()}subscribe(e,n=this.timeout){var t,s;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:r,presence:o}}=this.params;this._onError(u=>e&&e("CHANNEL_ERROR",u)),this._onClose(()=>e&&e("CLOSED"));const l={},a={broadcast:r,presence:o,postgres_changes:(s=(t=this.bindings.postgres_changes)===null||t===void 0?void 0:t.map(u=>u.filter))!==null&&s!==void 0?s:[]};this.socket.accessToken&&(l.access_token=this.socket.accessToken),this.updateJoinPayload(Object.assign({config:a},l)),this.joinedOnce=!0,this._rejoin(n),this.joinPush.receive("ok",({postgres_changes:u})=>{var c;if(this.socket.accessToken&&this.socket.setAuth(this.socket.accessToken),u===void 0){e&&e("SUBSCRIBED");return}else{const h=this.bindings.postgres_changes,d=(c=h==null?void 0:h.length)!==null&&c!==void 0?c:0,f=[];for(let p=0;p<d;p++){const g=h[p],{filter:{event:y,schema:T,table:E,filter:j}}=g,P=u&&u[p];if(P&&P.event===y&&P.schema===T&&P.table===E&&P.filter===j)f.push(Object.assign(Object.assign({},g),{id:P.id}));else{this.unsubscribe(),e&&e("CHANNEL_ERROR",new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=f,e&&e("SUBSCRIBED");return}}).receive("error",u=>{e&&e("CHANNEL_ERROR",new Error(JSON.stringify(Object.values(u).join(", ")||"error")))}).receive("timeout",()=>{e&&e("TIMED_OUT")})}return this}presenceState(){return this.presence.state}async track(e,n={}){return await this.send({type:"presence",event:"track",payload:e},n.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,n,t){return this._on(e,n,t)}async send(e,n={}){var t,s;if(!this._canPush()&&e.type==="broadcast"){const{event:r,payload:o}=e,l={method:"POST",headers:{apikey:(t=this.socket.apiKey)!==null&&t!==void 0?t:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:r,payload:o}]})};try{return(await this._fetchWithTimeout(this.broadcastEndpointURL,l,(s=n.timeout)!==null&&s!==void 0?s:this.timeout)).ok?"ok":"error"}catch(a){return a.name==="AbortError"?"timed out":"error"}}else return new Promise(r=>{var o,l,a;const u=this._push(e.type,e,n.timeout||this.timeout);e.type==="broadcast"&&!(!((a=(l=(o=this.params)===null||o===void 0?void 0:o.config)===null||l===void 0?void 0:l.broadcast)===null||a===void 0)&&a.ack)&&r("ok"),u.receive("ok",()=>r("ok")),u.receive("error",()=>r("error")),u.receive("timeout",()=>r("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=ue.leaving;const n=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(de.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(t=>{const s=new Tt(this,de.leave,{},e);s.receive("ok",()=>{n(),t("ok")}).receive("timeout",()=>{n(),t("timed out")}).receive("error",()=>{t("error")}),s.send(),this._canPush()||s.trigger("ok",{})})}_broadcastEndpointURL(){let e=this.socket.endPoint;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")+"/api/broadcast"}async _fetchWithTimeout(e,n,t){const s=new AbortController,r=setTimeout(()=>s.abort(),t),o=await this.socket.fetch(e,Object.assign(Object.assign({},n),{signal:s.signal}));return clearTimeout(r),o}_push(e,n,t=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new Tt(this,e,n,t);return this._canPush()?s.send():(s.startTimeout(),this.pushBuffer.push(s)),s}_onMessage(e,n,t){return n}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,n,t){var s,r;const o=e.toLocaleLowerCase(),{close:l,error:a,leave:u,join:c}=de;if(t&&[l,a,u,c].indexOf(o)>=0&&t!==this._joinRef())return;let d=this._onMessage(o,n,t);if(n&&!d)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(f=>{var p,g,y;return((p=f.filter)===null||p===void 0?void 0:p.event)==="*"||((y=(g=f.filter)===null||g===void 0?void 0:g.event)===null||y===void 0?void 0:y.toLocaleLowerCase())===o}).map(f=>f.callback(d,t)):(r=this.bindings[o])===null||r===void 0||r.filter(f=>{var p,g,y,T,E,j;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in f){const P=f.id,I=(p=f.filter)===null||p===void 0?void 0:p.event;return P&&((g=n.ids)===null||g===void 0?void 0:g.includes(P))&&(I==="*"||(I==null?void 0:I.toLocaleLowerCase())===((y=n.data)===null||y===void 0?void 0:y.type.toLocaleLowerCase()))}else{const P=(E=(T=f==null?void 0:f.filter)===null||T===void 0?void 0:T.event)===null||E===void 0?void 0:E.toLocaleLowerCase();return P==="*"||P===((j=n==null?void 0:n.event)===null||j===void 0?void 0:j.toLocaleLowerCase())}else return f.type.toLocaleLowerCase()===o}).map(f=>{if(typeof d=="object"&&"ids"in d){const p=d.data,{schema:g,table:y,commit_timestamp:T,type:E,errors:j}=p;d=Object.assign(Object.assign({},{schema:g,table:y,commit_timestamp:T,eventType:E,new:{},old:{},errors:j}),this._getPayloadRecords(p))}f.callback(d,t)})}_isClosed(){return this.state===ue.closed}_isJoined(){return this.state===ue.joined}_isJoining(){return this.state===ue.joining}_isLeaving(){return this.state===ue.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,n,t){const s=e.toLocaleLowerCase(),r={type:s,filter:n,callback:t};return this.bindings[s]?this.bindings[s].push(r):this.bindings[s]=[r],this}_off(e,n){const t=e.toLocaleLowerCase();return this.bindings[t]=this.bindings[t].filter(s=>{var r;return!(((r=s.type)===null||r===void 0?void 0:r.toLocaleLowerCase())===t&&Yt.isEqual(s.filter,n))}),this}static isEqual(e,n){if(Object.keys(e).length!==Object.keys(n).length)return!1;for(const t in e)if(e[t]!==n[t])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(de.close,{},e)}_onError(e){this._on(de.error,{},n=>e(n))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=ue.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const n={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(n.new=vn(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(n.old=vn(e.columns,e.old_record)),n}}const Xs=()=>{},Zs=typeof WebSocket<"u";class xs{constructor(e,n){var t;this.accessToken=null,this.apiKey=null,this.channels=[],this.endPoint="",this.headers=Fs,this.params={},this.timeout=yr,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=Xs,this.conn=null,this.sendBuffer=[],this.serializer=new Js,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this._resolveFetch=r=>{let o;return r?o=r:typeof fetch>"u"?o=(...l)=>Ke(()=>Promise.resolve().then(()=>at),void 0,import.meta.url).then(({default:a})=>a(...l)):o=fetch,(...l)=>o(...l)},this.endPoint=`${e}/${Bt.websocket}`,n!=null&&n.transport?this.transport=n.transport:this.transport=null,n!=null&&n.params&&(this.params=n.params),n!=null&&n.headers&&(this.headers=Object.assign(Object.assign({},this.headers),n.headers)),n!=null&&n.timeout&&(this.timeout=n.timeout),n!=null&&n.logger&&(this.logger=n.logger),n!=null&&n.heartbeatIntervalMs&&(this.heartbeatIntervalMs=n.heartbeatIntervalMs);const s=(t=n==null?void 0:n.params)===null||t===void 0?void 0:t.apikey;s&&(this.accessToken=s,this.apiKey=s),this.reconnectAfterMs=n!=null&&n.reconnectAfterMs?n.reconnectAfterMs:r=>[1e3,2e3,5e3,1e4][r-1]||1e4,this.encode=n!=null&&n.encode?n.encode:(r,o)=>o(JSON.stringify(r)),this.decode=n!=null&&n.decode?n.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new Cr(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(n==null?void 0:n.fetch)}connect(){if(!this.conn){if(this.transport){this.conn=new this.transport(this._endPointURL(),void 0,{headers:this.headers});return}if(Zs){this.conn=new WebSocket(this._endPointURL()),this.setupConnection();return}this.conn=new ei(this._endPointURL(),void 0,{close:()=>{this.conn=null}}),Ke(()=>import("./browser-BImCA5dO.js").then(e=>e.b),[],import.meta.url).then(({default:e})=>{this.conn=new e(this._endPointURL(),void 0,{headers:this.headers}),this.setupConnection()})}}disconnect(e,n){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,n??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(e){const n=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),n}async removeAllChannels(){const e=await Promise.all(this.channels.map(n=>n.unsubscribe()));return this.disconnect(),e}log(e,n,t){this.logger(e,n,t)}connectionState(){switch(this.conn&&this.conn.readyState){case He.connecting:return je.Connecting;case He.open:return je.Open;case He.closing:return je.Closing;default:return je.Closed}}isConnected(){return this.connectionState()===je.Open}channel(e,n={config:{}}){const t=new Yt(`realtime:${e}`,n,this);return this.channels.push(t),t}push(e){const{topic:n,event:t,payload:s,ref:r}=e,o=()=>{this.encode(e,l=>{var a;(a=this.conn)===null||a===void 0||a.send(l)})};this.log("push",`${n} ${t} (${r})`,s),this.isConnected()?o():this.sendBuffer.push(o)}setAuth(e){this.accessToken=e,this.channels.forEach(n=>{e&&n.updateJoinPayload({access_token:e}),n.joinedOnce&&n._isJoined()&&n._push(de.access_token,{access_token:e})})}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let n=this.channels.find(t=>t.topic===e&&(t._isJoined()||t._isJoining()));n&&(this.log("transport",`leaving duplicate topic "${e}"`),n.unsubscribe())}_remove(e){this.channels=this.channels.filter(n=>n._joinRef()!==e._joinRef())}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_endPointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:zs}))}_onConnMessage(e){this.decode(e.data,n=>{let{topic:t,event:s,payload:r,ref:o}=n;(o&&o===this.pendingHeartbeatRef||s===(r==null?void 0:r.type))&&(this.pendingHeartbeatRef=null),this.log("receive",`${r.status||""} ${t} ${s} ${o&&"("+o+")"||""}`,r),this.channels.filter(l=>l._isMember(t)).forEach(l=>l._trigger(s,r,o)),this.stateChangeCallbacks.message.forEach(l=>l(n))})}_onConnOpen(){this.log("transport",`connected to ${this._endPointURL()}`),this._flushSendBuffer(),this.reconnectTimer.reset(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this._sendHeartbeat(),this.heartbeatIntervalMs),this.stateChangeCallbacks.open.forEach(e=>e())}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(n=>n(e))}_onConnError(e){this.log("transport",e.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(n=>n(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(de.error))}_appendParams(e,n){if(Object.keys(n).length===0)return e;const t=e.match(/\?/)?"&":"?",s=new URLSearchParams(n);return`${e}${t}${s}`}_flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(e=this.conn)===null||e===void 0||e.close(Hs,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth(this.accessToken)}}}class ei{constructor(e,n,t){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=He.connecting,this.send=()=>{},this.url=null,this.url=e,this.close=t.close}}class Xt extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function re(i){return typeof i=="object"&&i!==null&&"__isStorageError"in i}class ti extends Xt{constructor(e,n){super(e),this.name="StorageApiError",this.status=n}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class Sn extends Xt{constructor(e,n){super(e),this.name="StorageUnknownError",this.originalError=n}}var ni=function(i,e,n,t){function s(r){return r instanceof n?r:new n(function(o){o(r)})}return new(n||(n=Promise))(function(r,o){function l(c){try{u(t.next(c))}catch(h){o(h)}}function a(c){try{u(t.throw(c))}catch(h){o(h)}}function u(c){c.done?r(c.value):s(c.value).then(l,a)}u((t=t.apply(i,e||[])).next())})};const Er=i=>{let e;return i?e=i:typeof fetch>"u"?e=(...n)=>Ke(()=>Promise.resolve().then(()=>at),void 0,import.meta.url).then(({default:t})=>t(...n)):e=fetch,(...n)=>e(...n)},ri=()=>ni(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Ke(()=>Promise.resolve().then(()=>at),void 0,import.meta.url)).Response:Response});var Ye=function(i,e,n,t){function s(r){return r instanceof n?r:new n(function(o){o(r)})}return new(n||(n=Promise))(function(r,o){function l(c){try{u(t.next(c))}catch(h){o(h)}}function a(c){try{u(t.throw(c))}catch(h){o(h)}}function u(c){c.done?r(c.value):s(c.value).then(l,a)}u((t=t.apply(i,e||[])).next())})};const jt=i=>i.msg||i.message||i.error_description||i.error||JSON.stringify(i),si=(i,e)=>Ye(void 0,void 0,void 0,function*(){const n=yield ri();i instanceof n?i.json().then(t=>{e(new ti(jt(t),i.status||500))}).catch(t=>{e(new Sn(jt(t),t))}):e(new Sn(jt(i),i))}),ii=(i,e,n,t)=>{const s={method:i,headers:(e==null?void 0:e.headers)||{}};return i==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),s.body=JSON.stringify(t),Object.assign(Object.assign({},s),n))};function wt(i,e,n,t,s,r){return Ye(this,void 0,void 0,function*(){return new Promise((o,l)=>{i(n,ii(e,t,s,r)).then(a=>{if(!a.ok)throw a;return t!=null&&t.noResolveJson?a:a.json()}).then(a=>o(a)).catch(a=>si(a,l))})})}function Ft(i,e,n,t){return Ye(this,void 0,void 0,function*(){return wt(i,"GET",e,n,t)})}function be(i,e,n,t,s){return Ye(this,void 0,void 0,function*(){return wt(i,"POST",e,t,s,n)})}function oi(i,e,n,t,s){return Ye(this,void 0,void 0,function*(){return wt(i,"PUT",e,t,s,n)})}function Or(i,e,n,t,s){return Ye(this,void 0,void 0,function*(){return wt(i,"DELETE",e,t,s,n)})}var fe=function(i,e,n,t){function s(r){return r instanceof n?r:new n(function(o){o(r)})}return new(n||(n=Promise))(function(r,o){function l(c){try{u(t.next(c))}catch(h){o(h)}}function a(c){try{u(t.throw(c))}catch(h){o(h)}}function u(c){c.done?r(c.value):s(c.value).then(l,a)}u((t=t.apply(i,e||[])).next())})};const ai={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},En={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class li{constructor(e,n={},t,s){this.url=e,this.headers=n,this.bucketId=t,this.fetch=Er(s)}uploadOrUpdate(e,n,t,s){return fe(this,void 0,void 0,function*(){try{let r;const o=Object.assign(Object.assign({},En),s),l=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(o.upsert)});typeof Blob<"u"&&t instanceof Blob?(r=new FormData,r.append("cacheControl",o.cacheControl),r.append("",t)):typeof FormData<"u"&&t instanceof FormData?(r=t,r.append("cacheControl",o.cacheControl)):(r=t,l["cache-control"]=`max-age=${o.cacheControl}`,l["content-type"]=o.contentType);const a=this._removeEmptyFolders(n),u=this._getFinalPath(a),c=yield this.fetch(`${this.url}/object/${u}`,Object.assign({method:e,body:r,headers:l},o!=null&&o.duplex?{duplex:o.duplex}:{})),h=yield c.json();return c.ok?{data:{path:a,id:h.Id,fullPath:h.Key},error:null}:{data:null,error:h}}catch(r){if(re(r))return{data:null,error:r};throw r}})}upload(e,n,t){return fe(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,n,t)})}uploadToSignedUrl(e,n,t,s){return fe(this,void 0,void 0,function*(){const r=this._removeEmptyFolders(e),o=this._getFinalPath(r),l=new URL(this.url+`/object/upload/sign/${o}`);l.searchParams.set("token",n);try{let a;const u=Object.assign({upsert:En.upsert},s),c=Object.assign(Object.assign({},this.headers),{"x-upsert":String(u.upsert)});typeof Blob<"u"&&t instanceof Blob?(a=new FormData,a.append("cacheControl",u.cacheControl),a.append("",t)):typeof FormData<"u"&&t instanceof FormData?(a=t,a.append("cacheControl",u.cacheControl)):(a=t,c["cache-control"]=`max-age=${u.cacheControl}`,c["content-type"]=u.contentType);const h=yield this.fetch(l.toString(),{method:"PUT",body:a,headers:c}),d=yield h.json();return h.ok?{data:{path:r,fullPath:d.Key},error:null}:{data:null,error:d}}catch(a){if(re(a))return{data:null,error:a};throw a}})}createSignedUploadUrl(e){return fe(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e);const t=yield be(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:this.headers}),s=new URL(this.url+t.url),r=s.searchParams.get("token");if(!r)throw new Xt("No token returned by API");return{data:{signedUrl:s.toString(),path:e,token:r},error:null}}catch(n){if(re(n))return{data:null,error:n};throw n}})}update(e,n,t){return fe(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,n,t)})}move(e,n){return fe(this,void 0,void 0,function*(){try{return{data:yield be(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n},{headers:this.headers}),error:null}}catch(t){if(re(t))return{data:null,error:t};throw t}})}copy(e,n){return fe(this,void 0,void 0,function*(){try{return{data:{path:(yield be(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n},{headers:this.headers})).Key},error:null}}catch(t){if(re(t))return{data:null,error:t};throw t}})}createSignedUrl(e,n,t){return fe(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e),r=yield be(this.fetch,`${this.url}/object/sign/${s}`,Object.assign({expiresIn:n},t!=null&&t.transform?{transform:t.transform}:{}),{headers:this.headers});const o=t!=null&&t.download?`&download=${t.download===!0?"":t.download}`:"";return r={signedUrl:encodeURI(`${this.url}${r.signedURL}${o}`)},{data:r,error:null}}catch(s){if(re(s))return{data:null,error:s};throw s}})}createSignedUrls(e,n,t){return fe(this,void 0,void 0,function*(){try{const s=yield be(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:n,paths:e},{headers:this.headers}),r=t!=null&&t.download?`&download=${t.download===!0?"":t.download}`:"";return{data:s.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${r}`):null})),error:null}}catch(s){if(re(s))return{data:null,error:s};throw s}})}download(e,n){return fe(this,void 0,void 0,function*(){const s=typeof(n==null?void 0:n.transform)<"u"?"render/image/authenticated":"object",r=this.transformOptsToQueryString((n==null?void 0:n.transform)||{}),o=r?`?${r}`:"";try{const l=this._getFinalPath(e);return{data:yield(yield Ft(this.fetch,`${this.url}/${s}/${l}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(l){if(re(l))return{data:null,error:l};throw l}})}getPublicUrl(e,n){const t=this._getFinalPath(e),s=[],r=n!=null&&n.download?`download=${n.download===!0?"":n.download}`:"";r!==""&&s.push(r);const l=typeof(n==null?void 0:n.transform)<"u"?"render/image":"object",a=this.transformOptsToQueryString((n==null?void 0:n.transform)||{});a!==""&&s.push(a);let u=s.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${t}${u}`)}}}remove(e){return fe(this,void 0,void 0,function*(){try{return{data:yield Or(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(n){if(re(n))return{data:null,error:n};throw n}})}list(e,n,t){return fe(this,void 0,void 0,function*(){try{const s=Object.assign(Object.assign(Object.assign({},ai),n),{prefix:e||""});return{data:yield be(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},t),error:null}}catch(s){if(re(s))return{data:null,error:s};throw s}})}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const n=[];return e.width&&n.push(`width=${e.width}`),e.height&&n.push(`height=${e.height}`),e.resize&&n.push(`resize=${e.resize}`),e.format&&n.push(`format=${e.format}`),e.quality&&n.push(`quality=${e.quality}`),n.join("&")}}const ui="2.5.5",ci={"X-Client-Info":`storage-js/${ui}`};var qe=function(i,e,n,t){function s(r){return r instanceof n?r:new n(function(o){o(r)})}return new(n||(n=Promise))(function(r,o){function l(c){try{u(t.next(c))}catch(h){o(h)}}function a(c){try{u(t.throw(c))}catch(h){o(h)}}function u(c){c.done?r(c.value):s(c.value).then(l,a)}u((t=t.apply(i,e||[])).next())})};class fi{constructor(e,n={},t){this.url=e,this.headers=Object.assign(Object.assign({},ci),n),this.fetch=Er(t)}listBuckets(){return qe(this,void 0,void 0,function*(){try{return{data:yield Ft(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(re(e))return{data:null,error:e};throw e}})}getBucket(e){return qe(this,void 0,void 0,function*(){try{return{data:yield Ft(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(n){if(re(n))return{data:null,error:n};throw n}})}createBucket(e,n={public:!1}){return qe(this,void 0,void 0,function*(){try{return{data:yield be(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(t){if(re(t))return{data:null,error:t};throw t}})}updateBucket(e,n){return qe(this,void 0,void 0,function*(){try{return{data:yield oi(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(t){if(re(t))return{data:null,error:t};throw t}})}emptyBucket(e){return qe(this,void 0,void 0,function*(){try{return{data:yield be(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(n){if(re(n))return{data:null,error:n};throw n}})}deleteBucket(e){return qe(this,void 0,void 0,function*(){try{return{data:yield Or(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(n){if(re(n))return{data:null,error:n};throw n}})}}class hi extends fi{constructor(e,n={},t){super(e,n,t)}from(e){return new li(this.url,this.headers,e,this.fetch)}}const di="2.43.4";let Ze="";typeof Deno<"u"?Ze="deno":typeof document<"u"?Ze="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Ze="react-native":Ze="node";const pi={"X-Client-Info":`supabase-js-${Ze}/${di}`},mi={headers:pi},_i={schema:"public"},gi={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},$i={};var bi=function(i,e,n,t){function s(r){return r instanceof n?r:new n(function(o){o(r)})}return new(n||(n=Promise))(function(r,o){function l(c){try{u(t.next(c))}catch(h){o(h)}}function a(c){try{u(t.throw(c))}catch(h){o(h)}}function u(c){c.done?r(c.value):s(c.value).then(l,a)}u((t=t.apply(i,e||[])).next())})};const wi=i=>{let e;return i?e=i:typeof fetch>"u"?e=Wt:e=fetch,(...n)=>e(...n)},vi=()=>typeof Headers>"u"?kr:Headers,ki=(i,e,n)=>{const t=wi(n),s=vi();return(r,o)=>bi(void 0,void 0,void 0,function*(){var l;const a=(l=yield e())!==null&&l!==void 0?l:i;let u=new s(o==null?void 0:o.headers);return u.has("apikey")||u.set("apikey",i),u.has("Authorization")||u.set("Authorization",`Bearer ${a}`),t(r,Object.assign(Object.assign({},o),{headers:u}))})};function yi(i){return i.replace(/\/$/,"")}function Ci(i,e){const{db:n,auth:t,realtime:s,global:r}=i,{db:o,auth:l,realtime:a,global:u}=e;return{db:Object.assign(Object.assign({},o),n),auth:Object.assign(Object.assign({},l),t),realtime:Object.assign(Object.assign({},a),s),global:Object.assign(Object.assign({},u),r)}}const Ar="2.64.2",Si="http://localhost:9999",Ei="supabase.auth.token",Oi={"X-Client-Info":`gotrue-js/${Ar}`},On=10,zt="X-Supabase-Api-Version",Tr={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}};function Ai(i){return Math.round(Date.now()/1e3)+i}function Ti(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(i){const e=Math.random()*16|0;return(i=="x"?e:e&3|8).toString(16)})}const he=()=>typeof document<"u",Oe={tested:!1,writable:!1},tt=()=>{if(!he())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Oe.tested)return Oe.writable;const i=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(i,i),globalThis.localStorage.removeItem(i),Oe.tested=!0,Oe.writable=!0}catch{Oe.tested=!0,Oe.writable=!1}return Oe.writable};function Pt(i){const e={},n=new URL(i);if(n.hash&&n.hash[0]==="#")try{new URLSearchParams(n.hash.substring(1)).forEach((s,r)=>{e[r]=s})}catch{}return n.searchParams.forEach((t,s)=>{e[s]=t}),e}const jr=i=>{let e;return i?e=i:typeof fetch>"u"?e=(...n)=>Ke(()=>Promise.resolve().then(()=>at),void 0,import.meta.url).then(({default:t})=>t(...n)):e=fetch,(...n)=>e(...n)},ji=i=>typeof i=="object"&&i!==null&&"status"in i&&"ok"in i&&"json"in i&&typeof i.json=="function",Pr=async(i,e,n)=>{await i.setItem(e,JSON.stringify(n))},ft=async(i,e)=>{const n=await i.getItem(e);if(!n)return null;try{return JSON.parse(n)}catch{return n}},It=async(i,e)=>{await i.removeItem(e)};function Pi(i){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let n="",t,s,r,o,l,a,u,c=0;for(i=i.replace("-","+").replace("_","/");c<i.length;)o=e.indexOf(i.charAt(c++)),l=e.indexOf(i.charAt(c++)),a=e.indexOf(i.charAt(c++)),u=e.indexOf(i.charAt(c++)),t=o<<2|l>>4,s=(l&15)<<4|a>>2,r=(a&3)<<6|u,n=n+String.fromCharCode(t),a!=64&&s!=0&&(n=n+String.fromCharCode(s)),u!=64&&r!=0&&(n=n+String.fromCharCode(r));return n}class vt{constructor(){this.promise=new vt.promiseConstructor((e,n)=>{this.resolve=e,this.reject=n})}}vt.promiseConstructor=Promise;function An(i){const e=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}=?$|[a-z0-9_-]{2}(==)?$)$/i,n=i.split(".");if(n.length!==3)throw new Error("JWT is not valid: not a JWT structure");if(!e.test(n[1]))throw new Error("JWT is not valid: payload is not in base64url format");const t=n[1];return JSON.parse(Pi(t))}async function Ii(i){return await new Promise(e=>{setTimeout(()=>e(null),i)})}function Ri(i,e){return new Promise((t,s)=>{(async()=>{for(let r=0;r<1/0;r++)try{const o=await i(r);if(!e(r,null,o)){t(o);return}}catch(o){if(!e(r,o)){s(o);return}}})()})}function Li(i){return("0"+i.toString(16)).substr(-2)}function Di(){const e=new Uint32Array(56);if(typeof crypto>"u"){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",t=n.length;let s="";for(let r=0;r<56;r++)s+=n.charAt(Math.floor(Math.random()*t));return s}return crypto.getRandomValues(e),Array.from(e,Li).join("")}async function Ui(i){const n=new TextEncoder().encode(i),t=await crypto.subtle.digest("SHA-256",n),s=new Uint8Array(t);return Array.from(s).map(r=>String.fromCharCode(r)).join("")}function qi(i){return btoa(i).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Ni(i){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),i;const n=await Ui(i);return qi(n)}async function Ne(i,e,n=!1){const t=Di();let s=t;n&&(s+="/PASSWORD_RECOVERY"),await Pr(i,`${e}-code-verifier`,s);const r=await Ni(t);return[r,t===r?"plain":"s256"]}const Bi=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Mi(i){const e=i.headers.get(zt);if(!e||!e.match(Bi))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}class Zt extends Error{constructor(e,n,t){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=n,this.code=t}}function F(i){return typeof i=="object"&&i!==null&&"__isAuthError"in i}class Fi extends Zt{constructor(e,n,t){super(e,n,t),this.name="AuthApiError",this.status=n,this.code=t}}function zi(i){return F(i)&&i.name==="AuthApiError"}class Ir extends Zt{constructor(e,n){super(e),this.name="AuthUnknownError",this.originalError=n}}class Re extends Zt{constructor(e,n,t,s){super(e,t,s),this.name=n,this.status=t}}class Ae extends Re{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}class Rt extends Re{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class ht extends Re{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class dt extends Re{constructor(e,n=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Tn extends Re{constructor(e,n=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Ht extends Re{constructor(e,n){super(e,"AuthRetryableFetchError",n,void 0)}}function Lt(i){return F(i)&&i.name==="AuthRetryableFetchError"}class jn extends Re{constructor(e,n,t){super(e,"AuthWeakPasswordError",n,"weak_password"),this.reasons=t}}var Hi=function(i,e){var n={};for(var t in i)Object.prototype.hasOwnProperty.call(i,t)&&e.indexOf(t)<0&&(n[t]=i[t]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,t=Object.getOwnPropertySymbols(i);s<t.length;s++)e.indexOf(t[s])<0&&Object.prototype.propertyIsEnumerable.call(i,t[s])&&(n[t[s]]=i[t[s]]);return n};const Te=i=>i.msg||i.message||i.error_description||i.error||JSON.stringify(i),Ji=[502,503,504];async function Pn(i){var e;if(!ji(i))throw new Ht(Te(i),0);if(Ji.includes(i.status))throw new Ht(Te(i),i.status);let n;try{n=await i.json()}catch(r){throw new Ir(Te(r),r)}let t;const s=Mi(i);if(s&&s.getTime()>=Tr["2024-01-01"].timestamp&&typeof n=="object"&&n&&typeof n.code=="string"?t=n.code:typeof n=="object"&&n&&typeof n.error_code=="string"&&(t=n.error_code),t){if(t==="weak_password")throw new jn(Te(n),i.status,((e=n.weak_password)===null||e===void 0?void 0:e.reasons)||[])}else if(typeof n=="object"&&n&&typeof n.weak_password=="object"&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((r,o)=>r&&typeof o=="string",!0))throw new jn(Te(n),i.status,n.weak_password.reasons);throw new Fi(Te(n),i.status||500,t)}const Ki=(i,e,n,t)=>{const s={method:i,headers:(e==null?void 0:e.headers)||{}};return i==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),s.body=JSON.stringify(t),Object.assign(Object.assign({},s),n))};async function z(i,e,n,t){var s;const r=Object.assign({},t==null?void 0:t.headers);r[zt]||(r[zt]=Tr["2024-01-01"].name),t!=null&&t.jwt&&(r.Authorization=`Bearer ${t.jwt}`);const o=(s=t==null?void 0:t.query)!==null&&s!==void 0?s:{};t!=null&&t.redirectTo&&(o.redirect_to=t.redirectTo);const l=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",a=await Gi(i,e,n+l,{headers:r,noResolveJson:t==null?void 0:t.noResolveJson},{},t==null?void 0:t.body);return t!=null&&t.xform?t==null?void 0:t.xform(a):{data:Object.assign({},a),error:null}}async function Gi(i,e,n,t,s,r){const o=Ki(e,t,s,r);let l;try{l=await i(n,Object.assign({},o))}catch(a){throw console.error(a),new Ht(Te(a),0)}if(l.ok||await Pn(l),t!=null&&t.noResolveJson)return l;try{return await l.json()}catch(a){await Pn(a)}}function $e(i){var e;let n=null;Yi(i)&&(n=Object.assign({},i),i.expires_at||(n.expires_at=Ai(i.expires_in)));const t=(e=i.user)!==null&&e!==void 0?e:i;return{data:{session:n,user:t},error:null}}function In(i){const e=$e(i);return!e.error&&i.weak_password&&typeof i.weak_password=="object"&&Array.isArray(i.weak_password.reasons)&&i.weak_password.reasons.length&&i.weak_password.message&&typeof i.weak_password.message=="string"&&i.weak_password.reasons.reduce((n,t)=>n&&typeof t=="string",!0)&&(e.data.weak_password=i.weak_password),e}function we(i){var e;return{data:{user:(e=i.user)!==null&&e!==void 0?e:i},error:null}}function Vi(i){return{data:i,error:null}}function Wi(i){const{action_link:e,email_otp:n,hashed_token:t,redirect_to:s,verification_type:r}=i,o=Hi(i,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:e,email_otp:n,hashed_token:t,redirect_to:s,verification_type:r},a=Object.assign({},o);return{data:{properties:l,user:a},error:null}}function Qi(i){return i}function Yi(i){return i.access_token&&i.refresh_token&&i.expires_in}var Xi=function(i,e){var n={};for(var t in i)Object.prototype.hasOwnProperty.call(i,t)&&e.indexOf(t)<0&&(n[t]=i[t]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,t=Object.getOwnPropertySymbols(i);s<t.length;s++)e.indexOf(t[s])<0&&Object.prototype.propertyIsEnumerable.call(i,t[s])&&(n[t[s]]=i[t[s]]);return n};class Zi{constructor({url:e="",headers:n={},fetch:t}){this.url=e,this.headers=n,this.fetch=jr(t),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,n="global"){try{return await z(this.fetch,"POST",`${this.url}/logout?scope=${n}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(t){if(F(t))return{data:null,error:t};throw t}}async inviteUserByEmail(e,n={}){try{return await z(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:n.data},headers:this.headers,redirectTo:n.redirectTo,xform:we})}catch(t){if(F(t))return{data:{user:null},error:t};throw t}}async generateLink(e){try{const{options:n}=e,t=Xi(e,["options"]),s=Object.assign(Object.assign({},t),n);return"newEmail"in t&&(s.new_email=t==null?void 0:t.newEmail,delete s.newEmail),await z(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:Wi,redirectTo:n==null?void 0:n.redirectTo})}catch(n){if(F(n))return{data:{properties:null,user:null},error:n};throw n}}async createUser(e){try{return await z(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:we})}catch(n){if(F(n))return{data:{user:null},error:n};throw n}}async listUsers(e){var n,t,s,r,o,l,a;try{const u={nextPage:null,lastPage:0,total:0},c=await z(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(t=(n=e==null?void 0:e.page)===null||n===void 0?void 0:n.toString())!==null&&t!==void 0?t:"",per_page:(r=(s=e==null?void 0:e.perPage)===null||s===void 0?void 0:s.toString())!==null&&r!==void 0?r:""},xform:Qi});if(c.error)throw c.error;const h=await c.json(),d=(o=c.headers.get("x-total-count"))!==null&&o!==void 0?o:0,f=(a=(l=c.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&a!==void 0?a:[];return f.length>0&&(f.forEach(p=>{const g=parseInt(p.split(";")[0].split("=")[1].substring(0,1)),y=JSON.parse(p.split(";")[1].split("=")[1]);u[`${y}Page`]=g}),u.total=parseInt(d)),{data:Object.assign(Object.assign({},h),u),error:null}}catch(u){if(F(u))return{data:{users:[]},error:u};throw u}}async getUserById(e){try{return await z(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:we})}catch(n){if(F(n))return{data:{user:null},error:n};throw n}}async updateUserById(e,n){try{return await z(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:n,headers:this.headers,xform:we})}catch(t){if(F(t))return{data:{user:null},error:t};throw t}}async deleteUser(e,n=!1){try{return await z(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:n},xform:we})}catch(t){if(F(t))return{data:{user:null},error:t};throw t}}async _listFactors(e){try{const{data:n,error:t}=await z(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:n,error:t}}catch(n){if(F(n))return{data:null,error:n};throw n}}async _deleteFactor(e){try{return{data:await z(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(n){if(F(n))return{data:null,error:n};throw n}}}const xi={getItem:i=>tt()?globalThis.localStorage.getItem(i):null,setItem:(i,e)=>{tt()&&globalThis.localStorage.setItem(i,e)},removeItem:i=>{tt()&&globalThis.localStorage.removeItem(i)}};function Rn(i={}){return{getItem:e=>i[e]||null,setItem:(e,n)=>{i[e]=n},removeItem:e=>{delete i[e]}}}function eo(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Be={debug:!!(globalThis&&tt()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Rr extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class to extends Rr{}async function no(i,e,n){Be.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",i,e);const t=new globalThis.AbortController;return e>0&&setTimeout(()=>{t.abort(),Be.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",i)},e),await globalThis.navigator.locks.request(i,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:t.signal},async s=>{if(s){Be.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",i,s.name);try{return await n()}finally{Be.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",i,s.name)}}else{if(e===0)throw Be.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",i),new to(`Acquiring an exclusive Navigator LockManager lock "${i}" immediately failed`);if(Be.debug)try{const r=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(r,null,"  "))}catch(r){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",r)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}})}eo();const ro={url:Si,storageKey:Ei,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Oi,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1},Xe=30*1e3,Ln=3;async function Dn(i,e,n){return await n()}class st{constructor(e){var n,t;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=st.nextInstanceID,st.nextInstanceID+=1,this.instanceID>0&&he()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const s=Object.assign(Object.assign({},ro),e);if(this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.persistSession=s.persistSession,this.storageKey=s.storageKey,this.autoRefreshToken=s.autoRefreshToken,this.admin=new Zi({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=jr(s.fetch),this.lock=s.lock||Dn,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,s.lock?this.lock=s.lock:he()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=no:this.lock=Dn,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?s.storage?this.storage=s.storage:tt()?this.storage=xi:(this.memoryStorage={},this.storage=Rn(this.memoryStorage)):(this.memoryStorage={},this.storage=Rn(this.memoryStorage)),he()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(r){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",r)}(t=this.broadcastChannel)===null||t===void 0||t.addEventListener("message",async r=>{this._debug("received broadcast notification from other tab or client",r),await this._notifyAllSubscribers(r.data.event,r.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Ar}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){try{const e=he()?await this._isPKCEFlow():!1;if(this._debug("#_initialize()","begin","is PKCE flow",e),e||this.detectSessionInUrl&&this._isImplicitGrantFlow()){const{data:n,error:t}=await this._getSessionFromURL(e);if(t)return this._debug("#_initialize()","error detecting session from URL",t),(t==null?void 0:t.message)==="Identity is already linked"||(t==null?void 0:t.message)==="Identity is already linked to another user"?{error:t}:(await this._removeSession(),{error:t});const{session:s,redirectType:r}=n;return this._debug("#_initialize()","detected session in URL",s,"redirect type",r),await this._saveSession(s),setTimeout(async()=>{r==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",s):await this._notifyAllSubscribers("SIGNED_IN",s)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(e){return F(e)?{error:e}:{error:new Ir("Unexpected error during initialization",e)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var n,t,s;try{await this._removeSession();const r=await z(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(t=(n=e==null?void 0:e.options)===null||n===void 0?void 0:n.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:(s=e==null?void 0:e.options)===null||s===void 0?void 0:s.captchaToken}},xform:$e}),{data:o,error:l}=r;if(l||!o)return{data:{user:null,session:null},error:l};const a=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",a)),{data:{user:u,session:a},error:null}}catch(r){if(F(r))return{data:{user:null,session:null},error:r};throw r}}async signUp(e){var n,t,s;try{await this._removeSession();let r;if("email"in e){const{email:c,password:h,options:d}=e;let f=null,p=null;this.flowType==="pkce"&&([f,p]=await Ne(this.storage,this.storageKey)),r=await z(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:d==null?void 0:d.emailRedirectTo,body:{email:c,password:h,data:(n=d==null?void 0:d.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken},code_challenge:f,code_challenge_method:p},xform:$e})}else if("phone"in e){const{phone:c,password:h,options:d}=e;r=await z(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:c,password:h,data:(t=d==null?void 0:d.data)!==null&&t!==void 0?t:{},channel:(s=d==null?void 0:d.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken}},xform:$e})}else throw new ht("You must provide either an email or phone number and a password");const{data:o,error:l}=r;if(l||!o)return{data:{user:null,session:null},error:l};const a=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",a)),{data:{user:u,session:a},error:null}}catch(r){if(F(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithPassword(e){try{await this._removeSession();let n;if("email"in e){const{email:r,password:o,options:l}=e;n=await z(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:r,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:In})}else if("phone"in e){const{phone:r,password:o,options:l}=e;n=await z(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:r,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:In})}else throw new ht("You must provide either an email or phone number and a password");const{data:t,error:s}=n;return s?{data:{user:null,session:null},error:s}:!t||!t.session||!t.user?{data:{user:null,session:null},error:new Rt}:(t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),{data:Object.assign({user:t.user,session:t.session},t.weak_password?{weakPassword:t.weak_password}:null),error:s})}catch(n){if(F(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOAuth(e){var n,t,s,r;return await this._removeSession(),await this._handleProviderSignIn(e.provider,{redirectTo:(n=e.options)===null||n===void 0?void 0:n.redirectTo,scopes:(t=e.options)===null||t===void 0?void 0:t.scopes,queryParams:(s=e.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(r=e.options)===null||r===void 0?void 0:r.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async _exchangeCodeForSession(e){const n=await ft(this.storage,`${this.storageKey}-code-verifier`),[t,s]=(n??"").split("/"),{data:r,error:o}=await z(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:t},xform:$e});return await It(this.storage,`${this.storageKey}-code-verifier`),o?{data:{user:null,session:null,redirectType:null},error:o}:!r||!r.session||!r.user?{data:{user:null,session:null,redirectType:null},error:new Rt}:(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign(Object.assign({},r),{redirectType:s??null}),error:o})}async signInWithIdToken(e){await this._removeSession();try{const{options:n,provider:t,token:s,access_token:r,nonce:o}=e,l=await z(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:t,id_token:s,access_token:r,nonce:o,gotrue_meta_security:{captcha_token:n==null?void 0:n.captchaToken}},xform:$e}),{data:a,error:u}=l;return u?{data:{user:null,session:null},error:u}:!a||!a.session||!a.user?{data:{user:null,session:null},error:new Rt}:(a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),{data:a,error:u})}catch(n){if(F(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOtp(e){var n,t,s,r,o;try{if(await this._removeSession(),"email"in e){const{email:l,options:a}=e;let u=null,c=null;this.flowType==="pkce"&&([u,c]=await Ne(this.storage,this.storageKey));const{error:h}=await z(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(n=a==null?void 0:a.data)!==null&&n!==void 0?n:{},create_user:(t=a==null?void 0:a.shouldCreateUser)!==null&&t!==void 0?t:!0,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken},code_challenge:u,code_challenge_method:c},redirectTo:a==null?void 0:a.emailRedirectTo});return{data:{user:null,session:null},error:h}}if("phone"in e){const{phone:l,options:a}=e,{data:u,error:c}=await z(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(s=a==null?void 0:a.data)!==null&&s!==void 0?s:{},create_user:(r=a==null?void 0:a.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken},channel:(o=a==null?void 0:a.channel)!==null&&o!==void 0?o:"sms"}});return{data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:c}}throw new ht("You must provide either an email or phone number.")}catch(l){if(F(l))return{data:{user:null,session:null},error:l};throw l}}async verifyOtp(e){var n,t;try{e.type!=="email_change"&&e.type!=="phone_change"&&await this._removeSession();let s,r;"options"in e&&(s=(n=e.options)===null||n===void 0?void 0:n.redirectTo,r=(t=e.options)===null||t===void 0?void 0:t.captchaToken);const{data:o,error:l}=await z(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:r}}),redirectTo:s,xform:$e});if(l)throw l;if(!o)throw new Error("An error occurred on token verification.");const a=o.session,u=o.user;return a!=null&&a.access_token&&(await this._saveSession(a),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",a)),{data:{user:u,session:a},error:null}}catch(s){if(F(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithSSO(e){var n,t,s;try{await this._removeSession();let r=null,o=null;return this.flowType==="pkce"&&([r,o]=await Ne(this.storage,this.storageKey)),await z(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(t=(n=e.options)===null||n===void 0?void 0:n.redirectTo)!==null&&t!==void 0?t:void 0}),!((s=e==null?void 0:e.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:r,code_challenge_method:o}),headers:this.headers,xform:Vi})}catch(r){if(F(r))return{data:null,error:r};throw r}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:n},error:t}=e;if(t)throw t;if(!n)throw new Ae;const{error:s}=await z(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:n.access_token});return{data:{user:null,session:null},error:s}})}catch(e){if(F(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{e.type!="email_change"&&e.type!="phone_change"&&await this._removeSession();const n=`${this.url}/resend`;if("email"in e){const{email:t,type:s,options:r}=e,{error:o}=await z(this.fetch,"POST",n,{headers:this.headers,body:{email:t,type:s,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},redirectTo:r==null?void 0:r.emailRedirectTo});return{data:{user:null,session:null},error:o}}else if("phone"in e){const{phone:t,type:s,options:r}=e,{data:o,error:l}=await z(this.fetch,"POST",n,{headers:this.headers,body:{phone:t,type:s,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}}});return{data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:l}}throw new ht("You must provide either an email or phone number and a type")}catch(n){if(F(n))return{data:{user:null,session:null},error:n};throw n}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async n=>n))}async _acquireLock(e,n){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const t=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await t,await n()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const t=n();for(this.pendingInLock.push((async()=>{try{await t}catch{}})()),await t;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await t}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const n=await this.__loadSession();return await e(n)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const n=await ft(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",n),n!==null&&(this._isValidSession(n)?e=n:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const t=e.expires_at?e.expires_at<=Date.now()/1e3:!1;if(this._debug("#__loadSession()",`session has${t?"":" not"} expired`,"expires_at",e.expires_at),!t){if(this.storage.isServer){const o=this.suppressGetSessionWarning;e=new Proxy(e,{get(a,u,c){return!o&&u==="user"&&console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and many not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),Reflect.get(a,u,c)}})}return{data:{session:e},error:null}}const{session:s,error:r}=await this._callRefreshToken(e.refresh_token);return r?{data:{session:null},error:r}:{data:{session:s},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await z(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:we}):await this._useSession(async n=>{var t,s,r;const{data:o,error:l}=n;if(l)throw l;return!(!((t=o.session)===null||t===void 0)&&t.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Ae}:await z(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(r=(s=o.session)===null||s===void 0?void 0:s.access_token)!==null&&r!==void 0?r:void 0,xform:we})})}catch(n){if(F(n))return{data:{user:null},error:n};throw n}}async updateUser(e,n={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,n))}async _updateUser(e,n={}){try{return await this._useSession(async t=>{const{data:s,error:r}=t;if(r)throw r;if(!s.session)throw new Ae;const o=s.session;let l=null,a=null;this.flowType==="pkce"&&e.email!=null&&([l,a]=await Ne(this.storage,this.storageKey));const{data:u,error:c}=await z(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:n==null?void 0:n.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:l,code_challenge_method:a}),jwt:o.access_token,xform:we});if(c)throw c;return o.user=u.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}})}catch(t){if(F(t))return{data:{user:null},error:t};throw t}}_decodeJWT(e){return An(e)}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Ae;const n=Date.now()/1e3;let t=n,s=!0,r=null;const o=An(e.access_token);if(o.exp&&(t=o.exp,s=t<=n),s){const{session:l,error:a}=await this._callRefreshToken(e.refresh_token);if(a)return{data:{user:null,session:null},error:a};if(!l)return{data:{user:null,session:null},error:null};r=l}else{const{data:l,error:a}=await this._getUser(e.access_token);if(a)throw a;r={access_token:e.access_token,refresh_token:e.refresh_token,user:l.user,token_type:"bearer",expires_in:t-n,expires_at:t},await this._saveSession(r),await this._notifyAllSubscribers("SIGNED_IN",r)}return{data:{user:r.user,session:r},error:null}}catch(n){if(F(n))return{data:{session:null,user:null},error:n};throw n}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async n=>{var t;if(!e){const{data:o,error:l}=n;if(l)throw l;e=(t=o.session)!==null&&t!==void 0?t:void 0}if(!(e!=null&&e.refresh_token))throw new Ae;const{session:s,error:r}=await this._callRefreshToken(e.refresh_token);return r?{data:{user:null,session:null},error:r}:s?{data:{user:s.user,session:s},error:null}:{data:{user:null,session:null},error:null}})}catch(n){if(F(n))return{data:{user:null,session:null},error:n};throw n}}async _getSessionFromURL(e){try{if(!he())throw new dt("No browser detected.");if(this.flowType==="implicit"&&!this._isImplicitGrantFlow())throw new dt("Not a valid implicit grant flow url.");if(this.flowType=="pkce"&&!e)throw new Tn("Not a valid PKCE flow url.");const n=Pt(window.location.href);if(e){if(!n.code)throw new Tn("No code detected.");const{data:E,error:j}=await this._exchangeCodeForSession(n.code);if(j)throw j;const P=new URL(window.location.href);return P.searchParams.delete("code"),window.history.replaceState(window.history.state,"",P.toString()),{data:{session:E.session,redirectType:null},error:null}}if(n.error||n.error_description||n.error_code)throw new dt(n.error_description||"Error in URL with unspecified error_description",{error:n.error||"unspecified_error",code:n.error_code||"unspecified_code"});const{provider_token:t,provider_refresh_token:s,access_token:r,refresh_token:o,expires_in:l,expires_at:a,token_type:u}=n;if(!r||!l||!o||!u)throw new dt("No session defined in URL");const c=Math.round(Date.now()/1e3),h=parseInt(l);let d=c+h;a&&(d=parseInt(a));const f=d-c;f*1e3<=Xe&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${f}s, should have been closer to ${h}s`);const p=d-h;c-p>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",p,d,c):c-p<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clok for skew",p,d,c);const{data:g,error:y}=await this._getUser(r);if(y)throw y;const T={provider_token:t,provider_refresh_token:s,access_token:r,expires_in:h,expires_at:d,refresh_token:o,token_type:u,user:g.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:T,redirectType:n.type},error:null}}catch(n){if(F(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantFlow(){const e=Pt(window.location.href);return!!(he()&&(e.access_token||e.error_description))}async _isPKCEFlow(){const e=Pt(window.location.href),n=await ft(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&n)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async n=>{var t;const{data:s,error:r}=n;if(r)return{error:r};const o=(t=s.session)===null||t===void 0?void 0:t.access_token;if(o){const{error:l}=await this.admin.signOut(o,e);if(l&&!(zi(l)&&(l.status===404||l.status===401||l.status===403)))return{error:l}}return e!=="others"&&(await this._removeSession(),await It(this.storage,`${this.storageKey}-code-verifier`),await this._notifyAllSubscribers("SIGNED_OUT",null)),{error:null}})}onAuthStateChange(e){const n=Ti(),t={id:n,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",n),this.stateChangeEmitters.delete(n)}};return this._debug("#onAuthStateChange()","registered callback with id",n),this.stateChangeEmitters.set(n,t),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(n)})))(),{data:{subscription:t}}}async _emitInitialSession(e){return await this._useSession(async n=>{var t,s;try{const{data:{session:r},error:o}=n;if(o)throw o;await((t=this.stateChangeEmitters.get(e))===null||t===void 0?void 0:t.callback("INITIAL_SESSION",r)),this._debug("INITIAL_SESSION","callback id",e,"session",r)}catch(r){await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",r),console.error(r)}})}async resetPasswordForEmail(e,n={}){let t=null,s=null;this.flowType==="pkce"&&([t,s]=await Ne(this.storage,this.storageKey,!0));try{return await z(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:t,code_challenge_method:s,gotrue_meta_security:{captcha_token:n.captchaToken}},headers:this.headers,redirectTo:n.redirectTo})}catch(r){if(F(r))return{data:null,error:r};throw r}}async getUserIdentities(){var e;try{const{data:n,error:t}=await this.getUser();if(t)throw t;return{data:{identities:(e=n.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(n){if(F(n))return{data:null,error:n};throw n}}async linkIdentity(e){var n;try{const{data:t,error:s}=await this._useSession(async r=>{var o,l,a,u,c;const{data:h,error:d}=r;if(d)throw d;const f=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(l=e.options)===null||l===void 0?void 0:l.scopes,queryParams:(a=e.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:!0});return await z(this.fetch,"GET",f,{headers:this.headers,jwt:(c=(u=h.session)===null||u===void 0?void 0:u.access_token)!==null&&c!==void 0?c:void 0})});if(s)throw s;return he()&&!(!((n=e.options)===null||n===void 0)&&n.skipBrowserRedirect)&&window.location.assign(t==null?void 0:t.url),{data:{provider:e.provider,url:t==null?void 0:t.url},error:null}}catch(t){if(F(t))return{data:{provider:e.provider,url:null},error:t};throw t}}async unlinkIdentity(e){try{return await this._useSession(async n=>{var t,s;const{data:r,error:o}=n;if(o)throw o;return await z(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(s=(t=r.session)===null||t===void 0?void 0:t.access_token)!==null&&s!==void 0?s:void 0})})}catch(n){if(F(n))return{data:null,error:n};throw n}}async _refreshAccessToken(e){const n=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{const t=Date.now();return await Ri(async s=>(s>0&&await Ii(200*Math.pow(2,s-1)),this._debug(n,"refreshing attempt",s),await z(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:$e})),(s,r)=>{const o=200*Math.pow(2,s);return r&&Lt(r)&&Date.now()+o-t<Xe})}catch(t){if(this._debug(n,"error",t),F(t))return{data:{session:null,user:null},error:t};throw t}finally{this._debug(n,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,n){const t=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:n.redirectTo,scopes:n.scopes,queryParams:n.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",n,"url",t),he()&&!n.skipBrowserRedirect&&window.location.assign(t),{data:{provider:e,url:t},error:null}}async _recoverAndRefresh(){var e;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const t=await ft(this.storage,this.storageKey);if(this._debug(n,"session from storage",t),!this._isValidSession(t)){this._debug(n,"session is not valid"),t!==null&&await this._removeSession();return}const s=Math.round(Date.now()/1e3),r=((e=t.expires_at)!==null&&e!==void 0?e:1/0)<s+On;if(this._debug(n,`session has${r?"":" not"} expired with margin of ${On}s`),r){if(this.autoRefreshToken&&t.refresh_token){const{error:o}=await this._callRefreshToken(t.refresh_token);o&&(console.error(o),Lt(o)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",t)}catch(t){this._debug(n,"error",t),console.error(t);return}finally{this._debug(n,"end")}}async _callRefreshToken(e){var n,t;if(!e)throw new Ae;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new vt;const{data:r,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!r.session)throw new Ae;await this._saveSession(r.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",r.session);const l={session:r.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(r){if(this._debug(s,"error",r),F(r)){const o={session:null,error:r};return Lt(r)||(await this._removeSession(),await this._notifyAllSubscribers("SIGNED_OUT",null)),(n=this.refreshingDeferred)===null||n===void 0||n.resolve(o),o}throw(t=this.refreshingDeferred)===null||t===void 0||t.reject(r),r}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(e,n,t=!0){const s=`#_notifyAllSubscribers(${e})`;this._debug(s,"begin",n,`broadcast = ${t}`);try{this.broadcastChannel&&t&&this.broadcastChannel.postMessage({event:e,session:n});const r=[],o=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(e,n)}catch(a){r.push(a)}});if(await Promise.all(o),r.length>0){for(let l=0;l<r.length;l+=1)console.error(r[l]);throw r[0]}}finally{this._debug(s,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await Pr(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await It(this.storage,this.storageKey)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&he()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(n){console.error("removing visibilitychange callback failed",n)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Xe);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async n=>{const{data:{session:t}}=n;if(!t||!t.refresh_token||!t.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((t.expires_at*1e3-e)/Xe);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${Xe}ms, refresh threshold is ${Ln} ticks`),s<=Ln&&await this._callRefreshToken(t.refresh_token)})}catch(n){console.error("Auto refresh tick failed with error. This is likely a transient error.",n)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof Rr)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!he()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const n=`#_onVisibilityChanged(${e})`;this._debug(n,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(n,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,n,t){const s=[`provider=${encodeURIComponent(n)}`];if(t!=null&&t.redirectTo&&s.push(`redirect_to=${encodeURIComponent(t.redirectTo)}`),t!=null&&t.scopes&&s.push(`scopes=${encodeURIComponent(t.scopes)}`),this.flowType==="pkce"){const[r,o]=await Ne(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(r)}`,code_challenge_method:`${encodeURIComponent(o)}`});s.push(l.toString())}if(t!=null&&t.queryParams){const r=new URLSearchParams(t.queryParams);s.push(r.toString())}return t!=null&&t.skipBrowserRedirect&&s.push(`skip_http_redirect=${t.skipBrowserRedirect}`),`${e}?${s.join("&")}`}async _unenroll(e){try{return await this._useSession(async n=>{var t;const{data:s,error:r}=n;return r?{data:null,error:r}:await z(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(t=s==null?void 0:s.session)===null||t===void 0?void 0:t.access_token})})}catch(n){if(F(n))return{data:null,error:n};throw n}}async _enroll(e){try{return await this._useSession(async n=>{var t,s;const{data:r,error:o}=n;if(o)return{data:null,error:o};const{data:l,error:a}=await z(this.fetch,"POST",`${this.url}/factors`,{body:{friendly_name:e.friendlyName,factor_type:e.factorType,issuer:e.issuer},headers:this.headers,jwt:(t=r==null?void 0:r.session)===null||t===void 0?void 0:t.access_token});return a?{data:null,error:a}:(!((s=l==null?void 0:l.totp)===null||s===void 0)&&s.qr_code&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})})}catch(n){if(F(n))return{data:null,error:n};throw n}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var t;const{data:s,error:r}=n;if(r)return{data:null,error:r};const{data:o,error:l}=await z(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(t=s==null?void 0:s.session)===null||t===void 0?void 0:t.access_token});return l?{data:null,error:l}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:l})})}catch(n){if(F(n))return{data:null,error:n};throw n}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var t;const{data:s,error:r}=n;return r?{data:null,error:r}:await z(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{headers:this.headers,jwt:(t=s==null?void 0:s.session)===null||t===void 0?void 0:t.access_token})})}catch(n){if(F(n))return{data:null,error:n};throw n}})}async _challengeAndVerify(e){const{data:n,error:t}=await this._challenge({factorId:e.factorId});return t?{data:null,error:t}:await this._verify({factorId:e.factorId,challengeId:n.id,code:e.code})}async _listFactors(){const{data:{user:e},error:n}=await this.getUser();if(n)return{data:null,error:n};const t=(e==null?void 0:e.factors)||[],s=t.filter(r=>r.factor_type==="totp"&&r.status==="verified");return{data:{all:t,totp:s},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var n,t;const{data:{session:s},error:r}=e;if(r)return{data:null,error:r};if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const o=this._decodeJWT(s.access_token);let l=null;o.aal&&(l=o.aal);let a=l;((t=(n=s.user.factors)===null||n===void 0?void 0:n.filter(h=>h.status==="verified"))!==null&&t!==void 0?t:[]).length>0&&(a="aal2");const c=o.amr||[];return{data:{currentLevel:l,nextLevel:a,currentAuthenticationMethods:c},error:null}}))}}st.nextInstanceID=0;const so=st;class io extends so{constructor(e){super(e)}}var oo=function(i,e,n,t){function s(r){return r instanceof n?r:new n(function(o){o(r)})}return new(n||(n=Promise))(function(r,o){function l(c){try{u(t.next(c))}catch(h){o(h)}}function a(c){try{u(t.throw(c))}catch(h){o(h)}}function u(c){c.done?r(c.value):s(c.value).then(l,a)}u((t=t.apply(i,e||[])).next())})};class ao{constructor(e,n,t){var s,r,o;if(this.supabaseUrl=e,this.supabaseKey=n,!e)throw new Error("supabaseUrl is required.");if(!n)throw new Error("supabaseKey is required.");const l=yi(e);this.realtimeUrl=`${l}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${l}/auth/v1`,this.storageUrl=`${l}/storage/v1`,this.functionsUrl=`${l}/functions/v1`;const a=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,u={db:_i,realtime:$i,auth:Object.assign(Object.assign({},gi),{storageKey:a}),global:mi},c=Ci(t??{},u);this.storageKey=(s=c.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(r=c.global.headers)!==null&&r!==void 0?r:{},this.auth=this._initSupabaseAuthClient((o=c.auth)!==null&&o!==void 0?o:{},this.headers,c.global.fetch),this.fetch=ki(n,this._getAccessToken.bind(this),c.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers},c.realtime)),this.rest=new Qt(`${l}/rest/v1`,{headers:this.headers,schema:c.db.schema,fetch:this.fetch}),this._listenForAuthEvents()}get functions(){return new Ts(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new hi(this.storageUrl,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,n={},t={}){return this.rest.rpc(e,n,t)}channel(e,n={config:{}}){return this.realtime.channel(e,n)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,n;return oo(this,void 0,void 0,function*(){const{data:t}=yield this.auth.getSession();return(n=(e=t.session)===null||e===void 0?void 0:e.access_token)!==null&&n!==void 0?n:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:n,detectSessionInUrl:t,storage:s,storageKey:r,flowType:o,debug:l},a,u){var c;const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new io({url:this.authUrl,headers:Object.assign(Object.assign({},h),a),storageKey:r,autoRefreshToken:e,persistSession:n,detectSessionInUrl:t,storage:s,flowType:o,debug:l,fetch:u,hasCustomAuthorizationHeader:(c="Authorization"in this.headers)!==null&&c!==void 0?c:!1})}_initRealtimeClient(e){return new xs(this.realtimeUrl,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((n,t)=>{this._handleTokenChanged(n,"CLIENT",t==null?void 0:t.access_token)})}_handleTokenChanged(e,n,t){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==t?(this.realtime.setAuth(t??null),this.changedAccessToken=t):e==="SIGNED_OUT"&&(this.realtime.setAuth(this.supabaseKey),n=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const Lr=(i,e,n)=>new ao(i,e,n),Dr="supabase-config",lo=()=>{const i=localStorage.getItem(Dr);if(!i)return null;const e=JSON.parse(i);return Lr(e.supabaseUrl,e.supabaseKey)};let Y=lo();const uo=i=>{Y=Lr(i.supabaseUrl,i.supabaseKey),localStorage.setItem(Dr,JSON.stringify(i))};function co(i){let e,n,t,s;const r=i[2].default,o=ye(r,i,i[1],null);return{c(){e=A("button"),o&&o.c(),v(e,"class","text-blue-600 hover:text-blue-700")},m(l,a){S(l,e,a),o&&o.m(e,null),n=!0,t||(s=Qe(e,"click",function(){We(i[0])&&i[0].apply(this,arguments)}),t=!0)},p(l,[a]){i=l,o&&o.p&&(!n||a&2)&&Se(o,r,i,i[1],n?Ce(r,i[1],a,null):Ee(i[1]),null)},i(l){n||(m(o,l),n=!0)},o(l){_(o,l),n=!1},d(l){l&&C(e),o&&o.d(l),t=!1,s()}}}function fo(i,e,n){let{$$slots:t={},$$scope:s}=e,{onClick:r}=e;return i.$$set=o=>{"onClick"in o&&n(0,r=o.onClick),"$$scope"in o&&n(1,s=o.$$scope)},[r,s,t]}class me extends N{constructor(e){super(),q(this,e,fo,co,U,{onClick:0})}}function ho(i){let e,n;return{c(){e=ee("svg"),n=ee("path"),v(n,"stroke-linecap","round"),v(n,"stroke-linejoin","round"),v(n,"d","m2.25 12 8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25"),v(e,"xmlns","http://www.w3.org/2000/svg"),v(e,"fill","none"),v(e,"viewBox","0 0 24 24"),v(e,"stroke-width","1.5"),v(e,"stroke","currentColor"),v(e,"class","size-6 hover:stroke-2")},m(t,s){S(t,e,s),k(e,n)},p:D,d(t){t&&C(e)}}}function po(i){let e,n;return e=new me({props:{onClick:i[0],$$slots:{default:[ho]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,s){$(e,t,s),n=!0},p(t,[s]){const r={};s&1&&(r.onClick=t[0]),s&2&&(r.$$scope={dirty:s,ctx:t}),e.$set(r)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function mo(i,e,n){let{onClick:t}=e;return i.$$set=s=>{"onClick"in s&&n(0,t=s.onClick)},[t]}class _o extends N{constructor(e){super(),q(this,e,mo,po,U,{onClick:0})}}function go(i){let e,n;return{c(){e=ee("svg"),n=ee("path"),v(n,"stroke-linecap","round"),v(n,"stroke-linejoin","round"),v(n,"d","m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"),v(e,"xmlns","http://www.w3.org/2000/svg"),v(e,"fill","none"),v(e,"viewBox","0 0 24 24"),v(e,"stroke-width","1.5"),v(e,"stroke","currentColor"),v(e,"class","size-6 hover:stroke-2")},m(t,s){S(t,e,s),k(e,n)},p:D,d(t){t&&C(e)}}}function $o(i){let e,n;return e=new me({props:{onClick:i[0],$$slots:{default:[go]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,s){$(e,t,s),n=!0},p(t,[s]){const r={};s&1&&(r.onClick=t[0]),s&2&&(r.$$scope={dirty:s,ctx:t}),e.$set(r)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function bo(i,e,n){let{onClick:t}=e;return i.$$set=s=>{"onClick"in s&&n(0,t=s.onClick)},[t]}class wo extends N{constructor(e){super(),q(this,e,bo,$o,U,{onClick:0})}}function vo(i){let e,n;return{c(){e=ee("svg"),n=ee("path"),v(n,"stroke-linecap","round"),v(n,"stroke-linejoin","round"),v(n,"d","M12 6.042A8.967 8.967 0 0 0 6 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 0 1 6 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 0 1 6-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0 0 18 18a8.967 8.967 0 0 0-6 2.292m0-14.25v14.25"),v(e,"xmlns","http://www.w3.org/2000/svg"),v(e,"fill","none"),v(e,"viewBox","0 0 24 24"),v(e,"stroke-width","1.5"),v(e,"stroke","currentColor"),v(e,"class","size-6 hover:stroke-2")},m(t,s){S(t,e,s),k(e,n)},p:D,d(t){t&&C(e)}}}function ko(i){let e,n;return e=new me({props:{onClick:i[0],$$slots:{default:[vo]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,s){$(e,t,s),n=!0},p(t,[s]){const r={};s&1&&(r.onClick=t[0]),s&2&&(r.$$scope={dirty:s,ctx:t}),e.$set(r)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function yo(i,e,n){let{onClick:t}=e;return i.$$set=s=>{"onClick"in s&&n(0,t=s.onClick)},[t]}class Co extends N{constructor(e){super(),q(this,e,yo,ko,U,{onClick:0})}}function So(i){let e,n;return{c(){e=ee("svg"),n=ee("path"),v(n,"stroke-linecap","round"),v(n,"stroke-linejoin","round"),v(n,"d","M6 6.878V6a2.25 2.25 0 0 1 2.25-2.25h7.5A2.25 2.25 0 0 1 18 6v.878m-12 0c.235-.083.487-.128.75-.128h10.5c.263 0 .515.045.75.128m-12 0A2.25 2.25 0 0 0 4.5 9v.878m13.5-3A2.25 2.25 0 0 1 19.5 9v.878m0 0a2.246 2.246 0 0 0-.75-.128H5.25c-.263 0-.515.045-.75.128m15 0A2.25 2.25 0 0 1 21 12v6a2.25 2.25 0 0 1-2.25 2.25H5.25A2.25 2.25 0 0 1 3 18v-6c0-.98.626-1.813 1.5-2.122"),v(e,"xmlns","http://www.w3.org/2000/svg"),v(e,"fill","none"),v(e,"viewBox","0 0 24 24"),v(e,"stroke-width","1.5"),v(e,"stroke","currentColor"),v(e,"class","size-6 hover:stroke-2")},m(t,s){S(t,e,s),k(e,n)},p:D,d(t){t&&C(e)}}}function Eo(i){let e,n;return e=new me({props:{onClick:i[0],$$slots:{default:[So]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,s){$(e,t,s),n=!0},p(t,[s]){const r={};s&1&&(r.onClick=t[0]),s&2&&(r.$$scope={dirty:s,ctx:t}),e.$set(r)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function Oo(i,e,n){let{onClick:t}=e;return i.$$set=s=>{"onClick"in s&&n(0,t=s.onClick)},[t]}class Ao extends N{constructor(e){super(),q(this,e,Oo,Eo,U,{onClick:0})}}function To(i){let e,n;return{c(){e=ee("svg"),n=ee("path"),v(n,"stroke-linecap","round"),v(n,"stroke-linejoin","round"),v(n,"d","M15.75 9V5.25A2.25 2.25 0 0 0 13.5 3h-6a2.25 2.25 0 0 0-2.25 2.25v13.5A2.25 2.25 0 0 0 7.5 21h6a2.25 2.25 0 0 0 2.25-2.25V15m3 0 3-3m0 0-3-3m3 3H9"),v(e,"xmlns","http://www.w3.org/2000/svg"),v(e,"fill","none"),v(e,"viewBox","0 0 24 24"),v(e,"stroke-width","1.5"),v(e,"stroke","currentColor"),v(e,"class","size-6 hover:stroke-2")},m(t,s){S(t,e,s),k(e,n)},p:D,d(t){t&&C(e)}}}function jo(i){let e,n;return e=new me({props:{onClick:i[0],$$slots:{default:[To]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,s){$(e,t,s),n=!0},p(t,[s]){const r={};s&1&&(r.onClick=t[0]),s&2&&(r.$$scope={dirty:s,ctx:t}),e.$set(r)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function Po(i,e,n){let{onClick:t}=e;return i.$$set=s=>{"onClick"in s&&n(0,t=s.onClick)},[t]}class Io extends N{constructor(e){super(),q(this,e,Po,jo,U,{onClick:0})}}function Ro(i){let e,n;return{c(){e=ee("svg"),n=ee("path"),v(n,"stroke-linecap","round"),v(n,"stroke-linejoin","round"),v(n,"d","M15.75 6a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0ZM4.501 20.118a7.5 7.5 0 0 1 14.998 0A17.933 17.933 0 0 1 12 21.75c-2.676 0-5.216-.584-7.499-1.632Z"),v(e,"xmlns","http://www.w3.org/2000/svg"),v(e,"fill","none"),v(e,"viewBox","0 0 24 24"),v(e,"stroke-width","1.5"),v(e,"stroke","currentColor"),v(e,"class","size-6 hover:stroke-2")},m(t,s){S(t,e,s),k(e,n)},p:D,d(t){t&&C(e)}}}function Lo(i){let e,n;return e=new me({props:{onClick:i[0],$$slots:{default:[Ro]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,s){$(e,t,s),n=!0},p(t,[s]){const r={};s&1&&(r.onClick=t[0]),s&2&&(r.$$scope={dirty:s,ctx:t}),e.$set(r)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function Do(i,e,n){let{onClick:t}=e;return i.$$set=s=>{"onClick"in s&&n(0,t=s.onClick)},[t]}class Uo extends N{constructor(e){super(),q(this,e,Do,Lo,U,{onClick:0})}}function qo(i){let e,n,t,s,r,o,l,a,u,c,h,d,f,p,g=i[0].email+"",y,T;return n=new _o({props:{onClick:i[2]}}),s=new Co({props:{onClick:i[3]}}),o=new Ao({props:{onClick:i[4]}}),a=new wo({props:{onClick:i[5]}}),c=new Uo({props:{onClick:i[6]}}),d=new Io({props:{onClick:i[1]}}),{c(){e=A("nav"),w(n.$$.fragment),t=O(),w(s.$$.fragment),r=O(),w(o.$$.fragment),l=O(),w(a.$$.fragment),u=O(),w(c.$$.fragment),h=O(),w(d.$$.fragment),f=O(),p=A("div"),y=L(g),v(e,"class","flex justify-end items-center gap-2 mb-4")},m(E,j){S(E,e,j),$(n,e,null),k(e,t),$(s,e,null),k(e,r),$(o,e,null),k(e,l),$(a,e,null),k(e,u),$(c,e,null),k(e,h),$(d,e,null),k(e,f),k(e,p),k(p,y),T=!0},p(E,[j]){const P={};j&2&&(P.onClick=E[1]),d.$set(P),(!T||j&1)&&g!==(g=E[0].email+"")&&B(y,g)},i(E){T||(m(n.$$.fragment,E),m(s.$$.fragment,E),m(o.$$.fragment,E),m(a.$$.fragment,E),m(c.$$.fragment,E),m(d.$$.fragment,E),T=!0)},o(E){_(n.$$.fragment,E),_(s.$$.fragment,E),_(o.$$.fragment,E),_(a.$$.fragment,E),_(c.$$.fragment,E),_(d.$$.fragment,E),T=!1},d(E){E&&C(e),b(n),b(s),b(o),b(a),b(c),b(d)}}}function No(i,e,n){let{user:t}=e,{onLogout:s}=e;const r=()=>J("/"),o=()=>J("/books/list"),l=()=>J("/cache"),a=()=>J("/search"),u=()=>J("/");return i.$$set=c=>{"user"in c&&n(0,t=c.user),"onLogout"in c&&n(1,s=c.onLogout)},[t,s,r,o,l,a,u]}class Bo extends N{constructor(e){super(),q(this,e,No,qo,U,{user:0,onLogout:1})}}const se=i=>new Date(i).toLocaleString(),ce=i=>i?"":"Please enter a value!",Mo=(i,e)=>Math.floor(Math.random()*(e-i+1)+i),Fo=i=>{for(let e=0;e<i.length;e++){const n=Mo(0,i.length-1);if(e===n)continue;const t=i[e];i[e]=i[n],i[n]=t}},Ur=i=>(i=i.trim(),i||null);function zo(i){let e,n,t,s;const r=i[2].default,o=ye(r,i,i[1],null);return{c(){e=A("form"),o&&o.c(),v(e,"class","flex flex-col gap-5 max-w-md")},m(l,a){S(l,e,a),o&&o.m(e,null),n=!0,t||(s=Qe(e,"submit",Jr(function(){We(i[0])&&i[0].apply(this,arguments)})),t=!0)},p(l,[a]){i=l,o&&o.p&&(!n||a&2)&&Se(o,r,i,i[1],n?Ce(r,i[1],a,null):Ee(i[1]),null)},i(l){n||(m(o,l),n=!0)},o(l){_(o,l),n=!1},d(l){l&&C(e),o&&o.d(l),t=!1,s()}}}function Ho(i,e,n){let{$$slots:t={},$$scope:s}=e,{onSubmit:r}=e;return i.$$set=o=>{"onSubmit"in o&&n(0,r=o.onSubmit),"$$scope"in o&&n(1,s=o.$$scope)},[r,s,t]}class _e extends N{constructor(e){super(),q(this,e,Ho,zo,U,{onSubmit:0})}}function Un(i){let e,n;return{c(){e=A("p"),n=L(i[2]),v(e,"class","text-red-600 text-sm mt-1")},m(t,s){S(t,e,s),k(e,n)},p(t,s){s&4&&B(n,t[2])},d(t){t&&C(e)}}}function Jo(i){let e,n,t,s,r,o;const l=i[4].default,a=ye(l,i,i[3],null);let u=i[2]&&Un(i);return{c(){e=A("div"),n=A("label"),t=L(i[1]),s=O(),a&&a.c(),r=O(),u&&u.c(),v(n,"class","block text-gray-700 text-sm font-bold mb-2"),v(n,"for",i[0])},m(c,h){S(c,e,h),k(e,n),k(n,t),k(e,s),a&&a.m(e,null),k(e,r),u&&u.m(e,null),o=!0},p(c,[h]){(!o||h&2)&&B(t,c[1]),(!o||h&1)&&v(n,"for",c[0]),a&&a.p&&(!o||h&8)&&Se(a,l,c,c[3],o?Ce(l,c[3],h,null):Ee(c[3]),null),c[2]?u?u.p(c,h):(u=Un(c),u.c(),u.m(e,null)):u&&(u.d(1),u=null)},i(c){o||(m(a,c),o=!0)},o(c){_(a,c),o=!1},d(c){c&&C(e),a&&a.d(c),u&&u.d()}}}function Ko(i,e,n){let{$$slots:t={},$$scope:s}=e,{id:r}=e,{label:o}=e,{error:l}=e;return i.$$set=a=>{"id"in a&&n(0,r=a.id),"label"in a&&n(1,o=a.label),"error"in a&&n(2,l=a.error),"$$scope"in a&&n(3,s=a.$$scope)},[r,o,l,s,t]}class xt extends N{constructor(e){super(),q(this,e,Ko,Jo,U,{id:0,label:1,error:2})}}function Go(i){let e,n,t;return{c(){e=A("input"),v(e,"class","input"),v(e,"id",i[2])},m(s,r){S(s,e,r),Je(e,i[0]),n||(t=Qe(e,"input",i[4]),n=!0)},p(s,r){r&4&&v(e,"id",s[2]),r&1&&e.value!==s[0]&&Je(e,s[0])},d(s){s&&C(e),n=!1,t()}}}function Vo(i){let e,n;return e=new xt({props:{id:i[2],label:i[1],error:i[3],$$slots:{default:[Go]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,s){$(e,t,s),n=!0},p(t,[s]){const r={};s&4&&(r.id=t[2]),s&2&&(r.label=t[1]),s&8&&(r.error=t[3]),s&37&&(r.$$scope={dirty:s,ctx:t}),e.$set(r)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function Wo(i,e,n){let{label:t}=e,{id:s}=e,{value:r}=e,{error:o=""}=e;function l(){r=this.value,n(0,r)}return i.$$set=a=>{"label"in a&&n(1,t=a.label),"id"in a&&n(2,s=a.id),"value"in a&&n(0,r=a.value),"error"in a&&n(3,o=a.error)},[r,t,s,o,l]}class ke extends N{constructor(e){super(),q(this,e,Wo,Vo,U,{label:1,id:2,value:0,error:3})}}function Qo(i){let e,n;return e=new H({props:{label:"Save"}}),{c(){w(e.$$.fragment)},m(t,s){$(e,t,s),n=!0},p:D,i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function Yo(i){let e,n,t,s,r,o,l,a;function u(f){i[6](f)}let c={id:"url",label:"Supabase URL",error:i[1]};i[0]!==void 0&&(c.value=i[0]),e=new ke({props:c}),Z.push(()=>ne(e,"value",u));function h(f){i[7](f)}let d={id:"key",label:"Supabase key",error:i[3]};return i[2]!==void 0&&(d.value=i[2]),s=new ke({props:d}),Z.push(()=>ne(s,"value",h)),l=new x({props:{$$slots:{default:[Qo]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment),t=O(),w(s.$$.fragment),o=O(),w(l.$$.fragment)},m(f,p){$(e,f,p),S(f,t,p),$(s,f,p),S(f,o,p),$(l,f,p),a=!0},p(f,p){const g={};p&2&&(g.error=f[1]),!n&&p&1&&(n=!0,g.value=f[0],te(()=>n=!1)),e.$set(g);const y={};p&8&&(y.error=f[3]),!r&&p&4&&(r=!0,y.value=f[2],te(()=>r=!1)),s.$set(y);const T={};p&256&&(T.$$scope={dirty:p,ctx:f}),l.$set(T)},i(f){a||(m(e.$$.fragment,f),m(s.$$.fragment,f),m(l.$$.fragment,f),a=!0)},o(f){_(e.$$.fragment,f),_(s.$$.fragment,f),_(l.$$.fragment,f),a=!1},d(f){f&&(C(t),C(o)),b(e,f),b(s,f),b(l,f)}}}function Xo(i){let e,n;return e=new _e({props:{onSubmit:i[4],$$slots:{default:[Yo]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,s){$(e,t,s),n=!0},p(t,[s]){const r={};s&271&&(r.$$scope={dirty:s,ctx:t}),e.$set(r)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function Zo(i,e,n){let{onConfig:t}=e,s="",r="",o="",l="";const a=()=>{n(1,r=ce(s)),n(3,l=ce(o)),!(r||l)&&t({supabaseUrl:s,supabaseKey:o})};function u(h){s=h,n(0,s)}function c(h){o=h,n(2,o)}return i.$$set=h=>{"onConfig"in h&&n(5,t=h.onConfig)},[s,r,o,l,a,t,u,c]}class xo extends N{constructor(e){super(),q(this,e,Zo,Xo,U,{onConfig:5})}}function ea(i){let e,n;return e=new _e({props:{onSubmit:i[4],$$slots:{default:[ra]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,s){$(e,t,s),n=!0},p(t,s){const r={};s&71&&(r.$$scope={dirty:s,ctx:t}),e.$set(r)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function ta(i){let e,n,t;return{c(){e=A("div"),e.textContent="Magic link was successfully send!",n=O(),t=A("div"),t.textContent="Please check your E-Mail"},m(s,r){S(s,e,r),S(s,n,r),S(s,t,r)},p:D,i:D,o:D,d(s){s&&(C(e),C(n),C(t))}}}function na(i){let e,n;return e=new H({props:{disabled:i[2],label:"Magic Link"}}),{c(){w(e.$$.fragment)},m(t,s){$(e,t,s),n=!0},p(t,s){const r={};s&4&&(r.disabled=t[2]),e.$set(r)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function ra(i){let e,n,t,s,r;function o(a){i[5](a)}let l={id:"email",label:"E-Mail",error:i[1]};return i[0]!==void 0&&(l.value=i[0]),e=new ke({props:l}),Z.push(()=>ne(e,"value",o)),s=new x({props:{$$slots:{default:[na]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment),t=O(),w(s.$$.fragment)},m(a,u){$(e,a,u),S(a,t,u),$(s,a,u),r=!0},p(a,u){const c={};u&2&&(c.error=a[1]),!n&&u&1&&(n=!0,c.value=a[0],te(()=>n=!1)),e.$set(c);const h={};u&68&&(h.$$scope={dirty:u,ctx:a}),s.$set(h)},i(a){r||(m(e.$$.fragment,a),m(s.$$.fragment,a),r=!0)},o(a){_(e.$$.fragment,a),_(s.$$.fragment,a),r=!1},d(a){a&&C(t),b(e,a),b(s,a)}}}function sa(i){let e,n,t,s;const r=[ta,ea],o=[];function l(a,u){return a[3]?0:1}return e=l(i),n=o[e]=r[e](i),{c(){n.c(),t=X()},m(a,u){o[e].m(a,u),S(a,t,u),s=!0},p(a,[u]){let c=e;e=l(a),e===c?o[e].p(a,u):(G(),_(o[c],1,1,()=>{o[c]=null}),V(),n=o[e],n?n.p(a,u):(n=o[e]=r[e](a),n.c()),m(n,1),n.m(t.parentNode,t))},i(a){s||(m(n),s=!0)},o(a){_(n),s=!1},d(a){a&&C(t),o[e].d(a)}}}function ia(i,e,n){let t="",s="",r=!1,o=!1;const l=async()=>{if(n(1,s=ce(t)),s)return;n(2,r=!0);const{data:u,error:c}=await Y.auth.signInWithOtp({email:t});if(n(2,r=!1),c){Q.setAuthError(c);return}u&&(console.log("data",u),n(3,o=!0))};function a(u){t=u,n(0,t)}return[t,s,r,o,l,a]}class oa extends N{constructor(e){super(),q(this,e,ia,sa,U,{})}}function aa(i){let e;return{c(){e=A("div"),e.innerHTML='<svg class="h-8 w-8 animate-spin text-blue-600" viewBox="0 0 100 100"><circle fill="none" stroke-width="10" class="stroke-current opacity-40" cx="50" cy="50" r="40"></circle><circle fill="none" stroke-width="10" class="stroke-current" stroke-dasharray="250" stroke-dashoffset="210" cx="50" cy="50" r="40"></circle></svg>',v(e,"class","flex justify-center")},m(n,t){S(n,e,t)},p:D,i:D,o:D,d(n){n&&C(e)}}}class la extends N{constructor(e){super(),q(this,e,null,aa,U,{})}}function ua(i){let e,n,t;e=new Bo({props:{user:i[0],onLogout:i[4]}});const s=i[6].default,r=ye(s,i,i[5],null);return{c(){w(e.$$.fragment),n=O(),r&&r.c()},m(o,l){$(e,o,l),S(o,n,l),r&&r.m(o,l),t=!0},p(o,l){const a={};l&1&&(a.user=o[0]),e.$set(a),r&&r.p&&(!t||l&32)&&Se(r,s,o,o[5],t?Ce(s,o[5],l,null):Ee(o[5]),null)},i(o){t||(m(e.$$.fragment,o),m(r,o),t=!0)},o(o){_(e.$$.fragment,o),_(r,o),t=!1},d(o){o&&C(n),b(e,o),r&&r.d(o)}}}function ca(i){let e,n,t,s;const r=[da,ha],o=[];function l(a,u){return a[2]?0:1}return e=l(i),n=o[e]=r[e](i),{c(){n.c(),t=X()},m(a,u){o[e].m(a,u),S(a,t,u),s=!0},p(a,u){let c=e;e=l(a),e!==c&&(G(),_(o[c],1,1,()=>{o[c]=null}),V(),n=o[e],n||(n=o[e]=r[e](a),n.c()),m(n,1),n.m(t.parentNode,t))},i(a){s||(m(n),s=!0)},o(a){_(n),s=!1},d(a){a&&C(t),o[e].d(a)}}}function fa(i){let e,n;return e=new xo({props:{onConfig:i[3]}}),{c(){w(e.$$.fragment)},m(t,s){$(e,t,s),n=!0},p:D,i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function ha(i){let e,n,t,s;return e=new la({}),{c(){w(e.$$.fragment),n=O(),t=A("p"),t.textContent="Waiting for server ..."},m(r,o){$(e,r,o),S(r,n,o),S(r,t,o),s=!0},i(r){s||(m(e.$$.fragment,r),s=!0)},o(r){_(e.$$.fragment,r),s=!1},d(r){r&&(C(n),C(t)),b(e,r)}}}function da(i){let e,n;return e=new oa({}),{c(){w(e.$$.fragment)},m(t,s){$(e,t,s),n=!0},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function pa(i){let e,n,t,s;const r=[fa,ca,ua],o=[];function l(a,u){return a[1]?a[0]?2:1:0}return e=l(i),n=o[e]=r[e](i),{c(){n.c(),t=X()},m(a,u){o[e].m(a,u),S(a,t,u),s=!0},p(a,[u]){let c=e;e=l(a),e===c?o[e].p(a,u):(G(),_(o[c],1,1,()=>{o[c]=null}),V(),n=o[e],n?n.p(a,u):(n=o[e]=r[e](a),n.c()),m(n,1),n.m(t.parentNode,t))},i(a){s||(m(n),s=!0)},o(a){_(n),s=!1},d(a){a&&C(t),o[e].d(a)}}}function ma(i,e,n){let{$$slots:t={},$$scope:s}=e,r,o=!1,l=!1;const a=()=>Y?(Y.auth.onAuthStateChange((h,d)=>{console.log("auth changed:",d==null?void 0:d.user),d!=null&&d.user?n(0,r=d.user):n(0,r=null),n(2,l=!0)}),!0):(console.log("supabase is not initialized!"),!1),u=h=>{uo(h),n(1,o=a())},c=()=>{Y&&r&&Y.auth.signOut()};return pe(()=>{n(1,o=a())}),i.$$set=h=>{"$$scope"in h&&n(5,s=h.$$scope)},[r,o,l,u,c,s,t]}class _a extends N{constructor(e){super(),q(this,e,ma,pa,U,{})}}function ga(i){let e,n;return{c(){e=A("h2"),n=L(i[0]),v(e,"class","text-2xl font-extrabold")},m(t,s){S(t,e,s),k(e,n)},p(t,[s]){s&1&&B(n,t[0])},i:D,o:D,d(t){t&&C(e)}}}function $a(i,e,n){let{header:t}=e;return i.$$set=s=>{"header"in s&&n(0,t=s.header)},[t]}class ie extends N{constructor(e){super(),q(this,e,$a,ga,U,{header:0})}}const it="session",ba=(i,e,n)=>{if(i.length==0)return;const t=i.map(r=>({question:r,progress:e}));Fo(t);const s={learning:t,learned:[],reverse:n};localStorage.setItem(it,JSON.stringify(s))},qr=()=>{const i=localStorage.getItem(it);return i?JSON.parse(i):null},wa=i=>i.learning.length>0?(localStorage.setItem(it,JSON.stringify(i)),!0):(localStorage.removeItem(it),!1),va=()=>{localStorage.removeItem(it)},qn=i=>{const e=[0,0,0,i.learned.length];return i.learning.forEach(n=>{if(n.progress>2)throw Error(`Invalid progress ${n.progress}`);e[n.progress]++}),e};function ka(i){let e,n;const t=i[1].default,s=ye(t,i,i[0],null);return{c(){e=A("div"),s&&s.c(),v(e,"class","flex flex-col gap-5")},m(r,o){S(r,e,o),s&&s.m(e,null),n=!0},p(r,[o]){s&&s.p&&(!n||o&1)&&Se(s,t,r,r[0],n?Ce(t,r[0],o,null):Ee(r[0]),null)},i(r){n||(m(s,r),n=!0)},o(r){_(s,r),n=!1},d(r){r&&C(e),s&&s.d(r)}}}function ya(i,e,n){let{$$slots:t={},$$scope:s}=e;return i.$$set=r=>{"$$scope"in r&&n(0,s=r.$$scope)},[s,t]}class oe extends N{constructor(e){super(),q(this,e,ya,ka,U,{})}}function Nn(i){let e,n;return e=new x({props:{$$slots:{default:[Ca]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,s){$(e,t,s),n=!0},p(t,s){const r={};s&8&&(r.$$scope={dirty:s,ctx:t}),e.$set(r)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function Ca(i){let e,n,t,s;return e=new H({props:{label:"Continue",onClick:i[1]}}),t=new H({props:{label:"End",onClick:i[2]}}),{c(){w(e.$$.fragment),n=O(),w(t.$$.fragment)},m(r,o){$(e,r,o),S(r,n,o),$(t,r,o),s=!0},p:D,i(r){s||(m(e.$$.fragment,r),m(t.$$.fragment,r),s=!0)},o(r){_(e.$$.fragment,r),_(t.$$.fragment,r),s=!1},d(r){r&&C(n),b(e,r),b(t,r)}}}function Sa(i){let e,n,t,s;e=new ie({props:{header:"Home"}});let r=i[0]&&Nn(i);return{c(){w(e.$$.fragment),n=O(),r&&r.c(),t=X()},m(o,l){$(e,o,l),S(o,n,l),r&&r.m(o,l),S(o,t,l),s=!0},p(o,l){o[0]?r?(r.p(o,l),l&1&&m(r,1)):(r=Nn(o),r.c(),m(r,1),r.m(t.parentNode,t)):r&&(G(),_(r,1,1,()=>{r=null}),V())},i(o){s||(m(e.$$.fragment,o),m(r),s=!0)},o(o){_(e.$$.fragment,o),_(r),s=!1},d(o){o&&(C(n),C(t)),b(e,o),r&&r.d(o)}}}function Ea(i){let e,n;return e=new oe({props:{$$slots:{default:[Sa]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,s){$(e,t,s),n=!0},p(t,[s]){const r={};s&9&&(r.$$scope={dirty:s,ctx:t}),e.$set(r)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function Oa(i,e,n){let t=!1;const s=()=>{J("/lession/process")},r=()=>{va(),n(0,t=!1)};return pe(()=>{qr()&&n(0,t=!0)}),[t,s,r]}class Aa extends N{constructor(e){super(),q(this,e,Oa,Ea,U,{})}}const lt="cache-",Nr=()=>{const i=[];for(let e in localStorage)e.startsWith(lt)&&i.push(e);return i.sort()},Ta=()=>{const i=[];for(let e in localStorage)e.startsWith(lt)&&localStorage.removeItem(e);return i},ja=i=>(localStorage.removeItem(i),Nr());function Bn(i,e,n){const t=i.slice();return t[4]=e[n],t}function Pa(i){let e;return{c(){e=L("Cache is empty!")},m(n,t){S(n,e,t)},p:D,i:D,o:D,d(n){n&&C(e)}}}function Ia(i){let e,n,t,s,r,o,l,a=ae(i[0]),u=[];for(let h=0;h<a.length;h+=1)u[h]=Mn(Bn(i,a,h));const c=h=>_(u[h],1,1,()=>{u[h]=null});return o=new x({props:{$$slots:{default:[La]},$$scope:{ctx:i}}}),{c(){e=A("table"),n=A("thead"),n.innerHTML='<tr class="tb-head"><th>Cache Key</th> <th></th></tr>',t=O(),s=A("tbody");for(let h=0;h<u.length;h+=1)u[h].c();r=O(),w(o.$$.fragment),v(e,"class","bg-white shadow w-full")},m(h,d){S(h,e,d),k(e,n),k(e,t),k(e,s);for(let f=0;f<u.length;f+=1)u[f]&&u[f].m(s,null);S(h,r,d),$(o,h,d),l=!0},p(h,d){if(d&1){a=ae(h[0]);let p;for(p=0;p<a.length;p+=1){const g=Bn(h,a,p);u[p]?(u[p].p(g,d),m(u[p],1)):(u[p]=Mn(g),u[p].c(),m(u[p],1),u[p].m(s,null))}for(G(),p=a.length;p<u.length;p+=1)c(p);V()}const f={};d&129&&(f.$$scope={dirty:d,ctx:h}),o.$set(f)},i(h){if(!l){for(let d=0;d<a.length;d+=1)m(u[d]);m(o.$$.fragment,h),l=!0}},o(h){u=u.filter(Boolean);for(let d=0;d<u.length;d+=1)_(u[d]);_(o.$$.fragment,h),l=!1},d(h){h&&(C(e),C(r)),Ie(u,h),b(o,h)}}}function Ra(i){let e,n;function t(){return i[1](i[4])}return e=new H({props:{label:"Delete",onClick:t}}),{c(){w(e.$$.fragment)},m(s,r){$(e,s,r),n=!0},p(s,r){i=s;const o={};r&1&&(o.onClick=t),e.$set(o)},i(s){n||(m(e.$$.fragment,s),n=!0)},o(s){_(e.$$.fragment,s),n=!1},d(s){b(e,s)}}}function Mn(i){let e,n,t=i[4]+"",s,r,o,l,a,u;return l=new x({props:{$$slots:{default:[Ra]},$$scope:{ctx:i}}}),{c(){e=A("tr"),n=A("td"),s=L(t),r=O(),o=A("td"),w(l.$$.fragment),a=O()},m(c,h){S(c,e,h),k(e,n),k(n,s),k(e,r),k(e,o),$(l,o,null),k(e,a),u=!0},p(c,h){(!u||h&1)&&t!==(t=c[4]+"")&&B(s,t);const d={};h&129&&(d.$$scope={dirty:h,ctx:c}),l.$set(d)},i(c){u||(m(l.$$.fragment,c),u=!0)},o(c){_(l.$$.fragment,c),u=!1},d(c){c&&C(e),b(l)}}}function La(i){let e,n,t,s;return e=new H({props:{onClick:i[2],label:"Cancel"}}),t=new H({props:{onClick:i[3],label:"Delete all"}}),{c(){w(e.$$.fragment),n=O(),w(t.$$.fragment)},m(r,o){$(e,r,o),S(r,n,o),$(t,r,o),s=!0},p(r,o){const l={};o&1&&(l.onClick=r[3]),t.$set(l)},i(r){s||(m(e.$$.fragment,r),m(t.$$.fragment,r),s=!0)},o(r){_(e.$$.fragment,r),_(t.$$.fragment,r),s=!1},d(r){r&&C(n),b(e,r),b(t,r)}}}function Da(i){let e,n,t,s,r,o;e=new ie({props:{header:"Cache"}});const l=[Ia,Pa],a=[];function u(c,h){return c[0].length>0?0:1}return t=u(i),s=a[t]=l[t](i),{c(){w(e.$$.fragment),n=O(),s.c(),r=X()},m(c,h){$(e,c,h),S(c,n,h),a[t].m(c,h),S(c,r,h),o=!0},p(c,h){let d=t;t=u(c),t===d?a[t].p(c,h):(G(),_(a[d],1,1,()=>{a[d]=null}),V(),s=a[t],s?s.p(c,h):(s=a[t]=l[t](c),s.c()),m(s,1),s.m(r.parentNode,r))},i(c){o||(m(e.$$.fragment,c),m(s),o=!0)},o(c){_(e.$$.fragment,c),_(s),o=!1},d(c){c&&(C(n),C(r)),b(e,c),a[t].d(c)}}}function Ua(i){let e,n;return e=new oe({props:{$$slots:{default:[Da]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,s){$(e,t,s),n=!0},p(t,[s]){const r={};s&129&&(r.$$scope={dirty:s,ctx:t}),e.$set(r)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function qa(i,e,n){let t=[];return pe(()=>{n(0,t=Nr())}),[t,l=>{n(0,t=ja(l))},()=>J("/"),()=>n(0,t=Ta())]}class Na extends N{constructor(e){super(),q(this,e,qa,Ua,U,{})}}function Ba(i){let e,n,t,s;return e=new ie({props:{header:"Not Found"}}),{c(){w(e.$$.fragment),n=O(),t=A("div"),t.textContent="Not Found"},m(r,o){$(e,r,o),S(r,n,o),S(r,t,o),s=!0},p:D,i(r){s||(m(e.$$.fragment,r),s=!0)},o(r){_(e.$$.fragment,r),s=!1},d(r){r&&(C(n),C(t)),b(e,r)}}}function Ma(i){let e,n;return e=new oe({props:{$$slots:{default:[Ba]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,s){$(e,t,s),n=!0},p(t,[s]){const r={};s&1&&(r.$$scope={dirty:s,ctx:t}),e.$set(r)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}class Fa extends N{constructor(e){super(),q(this,e,null,Ma,U,{})}}const ot=lt+"books",kt=async i=>{let{data:e,error:n}=await Y.from("books").select("*").eq("id",i).single();return n&&Q.setDBError(n),e||null},en=async()=>{const i=localStorage.getItem(ot);if(i)return JSON.parse(i);let{data:e,error:n}=await Y.from("books").select("*");return n&&Q.setDBError(n),e?(localStorage.setItem(ot,JSON.stringify(e)),e):[]},za=async i=>{const{error:e}=await Y.from("books").delete().eq("id",i);return e?(Q.setDBError(e),[]):(localStorage.removeItem(ot),en())},Ha=async(i,e)=>{const{error:n}=await Y.from("books").insert([{name:i,description:e}]);if(n)return Q.setDBError(n),[];localStorage.removeItem(ot)},Ja=async(i,e,n)=>{const{error:t}=await Y.from("books").update({name:e,description:n}).eq("id",i);return t?(Q.setDBError(t),[]):(localStorage.removeItem(ot),en())};function Ka(i){let e,n;return{c(){e=ee("svg"),n=ee("path"),v(n,"stroke-linecap","round"),v(n,"stroke-linejoin","round"),v(n,"d","m9.75 9.75 4.5 4.5m0-4.5-4.5 4.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"),v(e,"xmlns","http://www.w3.org/2000/svg"),v(e,"fill","none"),v(e,"viewBox","0 0 24 24"),v(e,"stroke-width","1.5"),v(e,"stroke","currentColor"),v(e,"class","size-6 hover:stroke-2")},m(t,s){S(t,e,s),k(e,n)},p:D,d(t){t&&C(e)}}}function Ga(i){let e,n;return e=new me({props:{onClick:i[0],$$slots:{default:[Ka]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,s){$(e,t,s),n=!0},p(t,[s]){const r={};s&1&&(r.onClick=t[0]),s&2&&(r.$$scope={dirty:s,ctx:t}),e.$set(r)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function Va(i,e,n){let{onClick:t}=e;return i.$$set=s=>{"onClick"in s&&n(0,t=s.onClick)},[t]}class tn extends N{constructor(e){super(),q(this,e,Va,Ga,U,{onClick:0})}}function Wa(i){let e,n;return{c(){e=ee("svg"),n=ee("path"),v(n,"stroke-linecap","round"),v(n,"stroke-linejoin","round"),v(n,"d","M3.75 12h16.5m-16.5 3.75h16.5M3.75 19.5h16.5M5.625 4.5h12.75a1.875 1.875 0 0 1 0 3.75H5.625a1.875 1.875 0 0 1 0-3.75Z"),v(e,"xmlns","http://www.w3.org/2000/svg"),v(e,"fill","none"),v(e,"viewBox","0 0 24 24"),v(e,"stroke-width","1.5"),v(e,"stroke","currentColor"),v(e,"class","size-6 hover:stroke-2")},m(t,s){S(t,e,s),k(e,n)},p:D,d(t){t&&C(e)}}}function Qa(i){let e,n;return e=new me({props:{onClick:i[0],$$slots:{default:[Wa]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,s){$(e,t,s),n=!0},p(t,[s]){const r={};s&1&&(r.onClick=t[0]),s&2&&(r.$$scope={dirty:s,ctx:t}),e.$set(r)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function Ya(i,e,n){let{onClick:t}=e;return i.$$set=s=>{"onClick"in s&&n(0,t=s.onClick)},[t]}class Br extends N{constructor(e){super(),q(this,e,Ya,Qa,U,{onClick:0})}}function Xa(i){let e,n;return{c(){e=ee("svg"),n=ee("path"),v(n,"stroke-linecap","round"),v(n,"stroke-linejoin","round"),v(n,"d","m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"),v(e,"xmlns","http://www.w3.org/2000/svg"),v(e,"fill","none"),v(e,"viewBox","0 0 24 24"),v(e,"stroke-width","1.5"),v(e,"stroke","currentColor"),v(e,"class","size-6 hover:stroke-2")},m(t,s){S(t,e,s),k(e,n)},p:D,d(t){t&&C(e)}}}function Za(i){let e,n;return e=new me({props:{onClick:i[0],$$slots:{default:[Xa]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,s){$(e,t,s),n=!0},p(t,[s]){const r={};s&1&&(r.onClick=t[0]),s&2&&(r.$$scope={dirty:s,ctx:t}),e.$set(r)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function xa(i,e,n){let{onClick:t}=e;return i.$$set=s=>{"onClick"in s&&n(0,t=s.onClick)},[t]}class nn extends N{constructor(e){super(),q(this,e,xa,Za,U,{onClick:0})}}function Fn(i){let e,n;return e=new vr({props:{title:i[1],buttons:i[2],$$slots:{default:[el]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,s){$(e,t,s),n=!0},p(t,s){const r={};s&2&&(r.title=t[1]),s&9&&(r.$$scope={dirty:s,ctx:t}),e.$set(r)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function el(i){let e=i[0].getMessage(i[0])+"",n;return{c(){n=L(e)},m(t,s){S(t,n,s)},p(t,s){s&1&&e!==(e=t[0].getMessage(t[0])+"")&&B(n,e)},d(t){t&&C(n)}}}function tl(i){let e,n,t=i[0].entry&&Fn(i);return{c(){t&&t.c(),e=X()},m(s,r){t&&t.m(s,r),S(s,e,r),n=!0},p(s,[r]){s[0].entry?t?(t.p(s,r),r&1&&m(t,1)):(t=Fn(s),t.c(),m(t,1),t.m(e.parentNode,e)):t&&(G(),_(t,1,1,()=>{t=null}),V())},i(s){n||(m(t),n=!0)},o(s){_(t),n=!1},d(s){s&&C(e),t&&t.d(s)}}}function nl(i,e,n){let{title:t}=e,{deleteEntry:s}=e;const r=[{label:"Close",onclick:()=>{n(0,s.entry=null,s)}},{label:"Delete",onclick:()=>{s.entry&&(s.onDelete(s.entry),n(0,s.entry=null,s))}}];return i.$$set=o=>{"title"in o&&n(1,t=o.title),"deleteEntry"in o&&n(0,s=o.deleteEntry)},[s,t,r]}class rn extends N{constructor(e){super(),q(this,e,nl,tl,U,{title:1,deleteEntry:0})}}function zn(i,e,n){const t=i.slice();return t[7]=e[n],t}function rl(i){let e,n,t,s,r,o;function l(){return i[2](i[7])}e=new tn({props:{onClick:l}});function a(){return i[3](i[7])}t=new nn({props:{onClick:a}});function u(){return i[4](i[7])}return r=new Br({props:{onClick:u}}),{c(){w(e.$$.fragment),n=O(),w(t.$$.fragment),s=O(),w(r.$$.fragment)},m(c,h){$(e,c,h),S(c,n,h),$(t,c,h),S(c,s,h),$(r,c,h),o=!0},p(c,h){i=c;const d={};h&3&&(d.onClick=l),e.$set(d);const f={};h&1&&(f.onClick=a),t.$set(f);const p={};h&1&&(p.onClick=u),r.$set(p)},i(c){o||(m(e.$$.fragment,c),m(t.$$.fragment,c),m(r.$$.fragment,c),o=!0)},o(c){_(e.$$.fragment,c),_(t.$$.fragment,c),_(r.$$.fragment,c),o=!1},d(c){c&&(C(n),C(s)),b(e,c),b(t,c),b(r,c)}}}function Hn(i){let e,n,t=i[7].id+"",s,r,o,l=i[7].name+"",a,u,c,h=i[7].description+"",d,f,p,g=se(i[7].modified)+"",y,T,E,j,P,I;return j=new x({props:{$$slots:{default:[rl]},$$scope:{ctx:i}}}),{c(){e=A("tr"),n=A("td"),s=L(t),r=O(),o=A("td"),a=L(l),u=O(),c=A("td"),d=L(h),f=O(),p=A("td"),y=L(g),T=O(),E=A("td"),w(j.$$.fragment),P=O()},m(R,M){S(R,e,M),k(e,n),k(n,s),k(e,r),k(e,o),k(o,a),k(e,u),k(e,c),k(c,d),k(e,f),k(e,p),k(p,y),k(e,T),k(e,E),$(j,E,null),k(e,P),I=!0},p(R,M){(!I||M&1)&&t!==(t=R[7].id+"")&&B(s,t),(!I||M&1)&&l!==(l=R[7].name+"")&&B(a,l),(!I||M&1)&&h!==(h=R[7].description+"")&&B(d,h),(!I||M&1)&&g!==(g=se(R[7].modified)+"")&&B(y,g);const W={};M&1027&&(W.$$scope={dirty:M,ctx:R}),j.$set(W)},i(R){I||(m(j.$$.fragment,R),I=!0)},o(R){_(j.$$.fragment,R),I=!1},d(R){R&&C(e),b(j)}}}function sl(i){let e,n,t,s;return e=new H({props:{onClick:i[5],label:"Cancel"}}),t=new H({props:{onClick:i[6],label:"Create"}}),{c(){w(e.$$.fragment),n=O(),w(t.$$.fragment)},m(r,o){$(e,r,o),S(r,n,o),$(t,r,o),s=!0},p:D,i(r){s||(m(e.$$.fragment,r),m(t.$$.fragment,r),s=!0)},o(r){_(e.$$.fragment,r),_(t.$$.fragment,r),s=!1},d(r){r&&C(n),b(e,r),b(t,r)}}}function il(i){let e,n,t,s,r,o,l,a,u;e=new ie({props:{header:"List Books"}});let c=ae(i[0]),h=[];for(let f=0;f<c.length;f+=1)h[f]=Hn(zn(i,c,f));const d=f=>_(h[f],1,1,()=>{h[f]=null});return a=new x({props:{$$slots:{default:[sl]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment),n=O(),t=A("table"),s=A("thead"),s.innerHTML='<tr class="tb-head"><th>ID</th> <th>Name</th> <th>Description</th> <th>Modified</th> <th></th></tr>',r=O(),o=A("tbody");for(let f=0;f<h.length;f+=1)h[f].c();l=O(),w(a.$$.fragment),v(t,"class","bg-white shadow w-full")},m(f,p){$(e,f,p),S(f,n,p),S(f,t,p),k(t,s),k(t,r),k(t,o);for(let g=0;g<h.length;g+=1)h[g]&&h[g].m(o,null);S(f,l,p),$(a,f,p),u=!0},p(f,p){if(p&3){c=ae(f[0]);let y;for(y=0;y<c.length;y+=1){const T=zn(f,c,y);h[y]?(h[y].p(T,p),m(h[y],1)):(h[y]=Hn(T),h[y].c(),m(h[y],1),h[y].m(o,null))}for(G(),y=c.length;y<h.length;y+=1)d(y);V()}const g={};p&1024&&(g.$$scope={dirty:p,ctx:f}),a.$set(g)},i(f){if(!u){m(e.$$.fragment,f);for(let p=0;p<c.length;p+=1)m(h[p]);m(a.$$.fragment,f),u=!0}},o(f){_(e.$$.fragment,f),h=h.filter(Boolean);for(let p=0;p<h.length;p+=1)_(h[p]);_(a.$$.fragment,f),u=!1},d(f){f&&(C(n),C(t),C(l)),b(e,f),Ie(h,f),b(a,f)}}}function ol(i){let e,n,t,s;return e=new oe({props:{$$slots:{default:[il]},$$scope:{ctx:i}}}),t=new rn({props:{title:"Delete Book",deleteEntry:i[1]}}),{c(){w(e.$$.fragment),n=O(),w(t.$$.fragment)},m(r,o){$(e,r,o),S(r,n,o),$(t,r,o),s=!0},p(r,[o]){const l={};o&1027&&(l.$$scope={dirty:o,ctx:r}),e.$set(l);const a={};o&2&&(a.deleteEntry=r[1]),t.$set(a)},i(r){s||(m(e.$$.fragment,r),m(t.$$.fragment,r),s=!0)},o(r){_(e.$$.fragment,r),_(t.$$.fragment,r),s=!1},d(r){r&&C(n),b(e,r),b(t,r)}}}function al(i,e,n){let t=[],s={entry:null,onDelete:c=>{za(c.id).then(h=>{n(0,t=h)})},getMessage:c=>`Do you wnat to delete the book: '${c.id}'?`};return pe(async()=>{n(0,t=await en())}),[t,s,async c=>{n(1,s.entry=c,s)},c=>{J("/books/update/"+c.id)},c=>{J("/chapters/list/"+c.id)},()=>J("/books/list"),()=>J("/books/create")]}class ll extends N{constructor(e){super(),q(this,e,al,ol,U,{})}}function ul(i){let e,n,t;return{c(){e=A("textarea"),v(e,"class","input"),v(e,"id",i[2])},m(s,r){S(s,e,r),Je(e,i[0]),n||(t=Qe(e,"input",i[4]),n=!0)},p(s,r){r&4&&v(e,"id",s[2]),r&1&&Je(e,s[0])},d(s){s&&C(e),n=!1,t()}}}function cl(i){let e,n;return e=new xt({props:{id:i[2],label:i[1],error:i[3],$$slots:{default:[ul]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,s){$(e,t,s),n=!0},p(t,[s]){const r={};s&4&&(r.id=t[2]),s&2&&(r.label=t[1]),s&8&&(r.error=t[3]),s&37&&(r.$$scope={dirty:s,ctx:t}),e.$set(r)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function fl(i,e,n){let{label:t}=e,{id:s}=e,{value:r}=e,{error:o}=e;function l(){r=this.value,n(0,r)}return i.$$set=a=>{"label"in a&&n(1,t=a.label),"id"in a&&n(2,s=a.id),"value"in a&&n(0,r=a.value),"error"in a&&n(3,o=a.error)},[r,t,s,o,l]}class ve extends N{constructor(e){super(),q(this,e,fl,cl,U,{label:1,id:2,value:0,error:3})}}function hl(i){let e,n,t,s;return e=new H({props:{onClick:i[7],label:"Cancel"}}),t=new H({props:{label:"Create"}}),{c(){w(e.$$.fragment),n=O(),w(t.$$.fragment)},m(r,o){$(e,r,o),S(r,n,o),$(t,r,o),s=!0},p:D,i(r){s||(m(e.$$.fragment,r),m(t.$$.fragment,r),s=!0)},o(r){_(e.$$.fragment,r),_(t.$$.fragment,r),s=!1},d(r){r&&C(n),b(e,r),b(t,r)}}}function dl(i){let e,n,t,s,r,o,l,a;function u(f){i[5](f)}let c={id:"name",label:"Book name",error:i[1]};i[0]!==void 0&&(c.value=i[0]),e=new ke({props:c}),Z.push(()=>ne(e,"value",u));function h(f){i[6](f)}let d={id:"description",label:"Book description",error:i[3]};return i[2]!==void 0&&(d.value=i[2]),s=new ve({props:d}),Z.push(()=>ne(s,"value",h)),l=new x({props:{$$slots:{default:[hl]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment),t=O(),w(s.$$.fragment),o=O(),w(l.$$.fragment)},m(f,p){$(e,f,p),S(f,t,p),$(s,f,p),S(f,o,p),$(l,f,p),a=!0},p(f,p){const g={};p&2&&(g.error=f[1]),!n&&p&1&&(n=!0,g.value=f[0],te(()=>n=!1)),e.$set(g);const y={};p&8&&(y.error=f[3]),!r&&p&4&&(r=!0,y.value=f[2],te(()=>r=!1)),s.$set(y);const T={};p&256&&(T.$$scope={dirty:p,ctx:f}),l.$set(T)},i(f){a||(m(e.$$.fragment,f),m(s.$$.fragment,f),m(l.$$.fragment,f),a=!0)},o(f){_(e.$$.fragment,f),_(s.$$.fragment,f),_(l.$$.fragment,f),a=!1},d(f){f&&(C(t),C(o)),b(e,f),b(s,f),b(l,f)}}}function pl(i){let e,n,t,s;return e=new ie({props:{header:"Create Book"}}),t=new _e({props:{onSubmit:i[4],$$slots:{default:[dl]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment),n=O(),w(t.$$.fragment)},m(r,o){$(e,r,o),S(r,n,o),$(t,r,o),s=!0},p(r,o){const l={};o&271&&(l.$$scope={dirty:o,ctx:r}),t.$set(l)},i(r){s||(m(e.$$.fragment,r),m(t.$$.fragment,r),s=!0)},o(r){_(e.$$.fragment,r),_(t.$$.fragment,r),s=!1},d(r){r&&C(n),b(e,r),b(t,r)}}}function ml(i){let e,n;return e=new oe({props:{$$slots:{default:[pl]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,s){$(e,t,s),n=!0},p(t,[s]){const r={};s&271&&(r.$$scope={dirty:s,ctx:t}),e.$set(r)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function _l(i,e,n){let t="",s="",r="",o="";const l=async()=>{n(1,s=ce(t)),n(3,o=ce(r)),!(s||o)&&(await Ha(t,r),J("/books/list"))};function a(h){t=h,n(0,t)}function u(h){r=h,n(2,r)}return[t,s,r,o,l,a,u,()=>J("/books/list")]}class gl extends N{constructor(e){super(),q(this,e,_l,ml,U,{})}}function Jn(i){let e,n,t=i[0].id+"",s,r,o,l=se(i[0].modified)+"",a,u,c,h;return c=new _e({props:{onSubmit:i[5],$$slots:{default:[bl]},$$scope:{ctx:i}}}),{c(){e=A("div"),n=A("span"),s=L(t),r=O(),o=A("span"),a=L(l),u=O(),w(c.$$.fragment),v(e,"class","mb-4 text-small")},m(d,f){S(d,e,f),k(e,n),k(n,s),k(e,r),k(e,o),k(o,a),S(d,u,f),$(c,d,f),h=!0},p(d,f){(!h||f&1)&&t!==(t=d[0].id+"")&&B(s,t),(!h||f&1)&&l!==(l=se(d[0].modified)+"")&&B(a,l);const p={};f&1054&&(p.$$scope={dirty:f,ctx:d}),c.$set(p)},i(d){h||(m(c.$$.fragment,d),h=!0)},o(d){_(c.$$.fragment,d),h=!1},d(d){d&&(C(e),C(u)),b(c,d)}}}function $l(i){let e,n,t,s;return e=new H({props:{onClick:i[9],label:"Cancel"}}),t=new H({props:{label:"Update"}}),{c(){w(e.$$.fragment),n=O(),w(t.$$.fragment)},m(r,o){$(e,r,o),S(r,n,o),$(t,r,o),s=!0},p:D,i(r){s||(m(e.$$.fragment,r),m(t.$$.fragment,r),s=!0)},o(r){_(e.$$.fragment,r),_(t.$$.fragment,r),s=!1},d(r){r&&C(n),b(e,r),b(t,r)}}}function bl(i){let e,n,t,s,r,o,l,a;function u(f){i[7](f)}let c={id:"name",label:"Book name",error:i[2]};i[1]!==void 0&&(c.value=i[1]),e=new ke({props:c}),Z.push(()=>ne(e,"value",u));function h(f){i[8](f)}let d={id:"description",label:"Book description",error:i[4]};return i[3]!==void 0&&(d.value=i[3]),s=new ve({props:d}),Z.push(()=>ne(s,"value",h)),l=new x({props:{$$slots:{default:[$l]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment),t=O(),w(s.$$.fragment),o=O(),w(l.$$.fragment)},m(f,p){$(e,f,p),S(f,t,p),$(s,f,p),S(f,o,p),$(l,f,p),a=!0},p(f,p){const g={};p&4&&(g.error=f[2]),!n&&p&2&&(n=!0,g.value=f[1],te(()=>n=!1)),e.$set(g);const y={};p&16&&(y.error=f[4]),!r&&p&8&&(r=!0,y.value=f[3],te(()=>r=!1)),s.$set(y);const T={};p&1024&&(T.$$scope={dirty:p,ctx:f}),l.$set(T)},i(f){a||(m(e.$$.fragment,f),m(s.$$.fragment,f),m(l.$$.fragment,f),a=!0)},o(f){_(e.$$.fragment,f),_(s.$$.fragment,f),_(l.$$.fragment,f),a=!1},d(f){f&&(C(t),C(o)),b(e,f),b(s,f),b(l,f)}}}function wl(i){let e,n,t,s;e=new ie({props:{header:"Update Book"}});let r=i[0]&&Jn(i);return{c(){w(e.$$.fragment),n=O(),r&&r.c(),t=X()},m(o,l){$(e,o,l),S(o,n,l),r&&r.m(o,l),S(o,t,l),s=!0},p(o,l){o[0]?r?(r.p(o,l),l&1&&m(r,1)):(r=Jn(o),r.c(),m(r,1),r.m(t.parentNode,t)):r&&(G(),_(r,1,1,()=>{r=null}),V())},i(o){s||(m(e.$$.fragment,o),m(r),s=!0)},o(o){_(e.$$.fragment,o),_(r),s=!1},d(o){o&&(C(n),C(t)),b(e,o),r&&r.d(o)}}}function vl(i){let e,n;return e=new oe({props:{$$slots:{default:[wl]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,s){$(e,t,s),n=!0},p(t,[s]){const r={};s&1055&&(r.$$scope={dirty:s,ctx:t}),e.$set(r)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function kl(i,e,n){let{params:t={id:""}}=e,s=null,r="",o="",l="",a="";const u=async()=>{if(n(2,o=ce(r)),n(4,a=ce(l)),!(o||a)){if(!s){Q.setString("No book!!");return}await Ja(s.id,r,l),J("/books/list")}};pe(async()=>{n(0,s=await kt(parseInt(t.id))),s&&(n(1,r=s.name),n(3,l=s.description))});function c(f){r=f,n(1,r)}function h(f){l=f,n(3,l)}const d=()=>J("/books/list");return i.$$set=f=>{"params"in f&&n(6,t=f.params)},[s,r,o,l,a,u,t,c,h,d]}class yl extends N{constructor(e){super(),q(this,e,kl,vl,U,{params:6})}}const Cl=lt+"chapters",yt=i=>`${Cl}#${i}`,sn=async i=>{let{data:e,error:n}=await Y.from("chapters").select("*").eq("id",i).single();return n&&Q.setDBError(n),e||null},on=async i=>{const e=yt(i),n=localStorage.getItem(e);if(n)return JSON.parse(n);let{data:t,error:s}=await Y.from("chapters").select("*").eq("book_id",i).order("id");return s&&Q.setDBError(s),t?(localStorage.setItem(e,JSON.stringify(t)),t):[]},Sl=async(i,e)=>{const{error:n}=await Y.from("chapters").delete().eq("id",i);return n?(Q.setDBError(n),[]):(localStorage.removeItem(yt(e)),on(e))},El=async(i,e,n)=>{const{error:t}=await Y.from("chapters").update({name:n}).eq("id",i);return t?(Q.setDBError(t),[]):(localStorage.removeItem(yt(e)),on(e))},Ol=async(i,e)=>{const{error:n}=await Y.from("chapters").insert([{book_id:i,name:e}]);if(n)return Q.setDBError(n),[];localStorage.removeItem(yt(i))};function Al(i){let e,n;const t=i[1].default,s=ye(t,i,i[0],null);return{c(){e=A("div"),s&&s.c(),v(e,"class","border rounded shadow px-4 py-4")},m(r,o){S(r,e,o),s&&s.m(e,null),n=!0},p(r,[o]){s&&s.p&&(!n||o&1)&&Se(s,t,r,r[0],n?Ce(t,r[0],o,null):Ee(r[0]),null)},i(r){n||(m(s,r),n=!0)},o(r){_(s,r),n=!1},d(r){r&&C(e),s&&s.d(r)}}}function Tl(i,e,n){let{$$slots:t={},$$scope:s}=e;return i.$$set=r=>{"$$scope"in r&&n(0,s=r.$$scope)},[s,t]}class jl extends N{constructor(e){super(),q(this,e,Tl,Al,U,{})}}function Kn(i){let e,n,t,s=i[0].name+"",r,o,l,a,u=i[0].id+"",c,h,d=se(i[0].modified)+"",f,p,g=i[0].description&&Gn(i);return{c(){e=A("div"),n=A("div"),t=A("div"),r=L(s),o=O(),l=A("div"),a=L("Book-Id: "),c=L(u),h=L(" - Modified: "),f=L(d),p=O(),g&&g.c(),v(t,"class","text-lg font-semibold"),v(l,"class","text-sm"),v(n,"class","flex justify-between mb-2")},m(y,T){S(y,e,T),k(e,n),k(n,t),k(t,r),k(n,o),k(n,l),k(l,a),k(l,c),k(l,h),k(l,f),k(e,p),g&&g.m(e,null)},p(y,T){T&1&&s!==(s=y[0].name+"")&&B(r,s),T&1&&u!==(u=y[0].id+"")&&B(c,u),T&1&&d!==(d=se(y[0].modified)+"")&&B(f,d),y[0].description?g?g.p(y,T):(g=Gn(y),g.c(),g.m(e,null)):g&&(g.d(1),g=null)},d(y){y&&C(e),g&&g.d()}}}function Gn(i){let e,n=i[0].description+"",t;return{c(){e=A("p"),t=L(n),v(e,"class","mt-2 pt-2 border-t text-sm")},m(s,r){S(s,e,r),k(e,t)},p(s,r){r&1&&n!==(n=s[0].description+"")&&B(t,n)},d(s){s&&C(e)}}}function Vn(i){let e,n,t=i[1].name+"",s,r,o,l,a=i[1].id+"",u,c,h=se(i[1].modified)+"",d;return{c(){e=A("div"),n=A("div"),s=L(t),r=O(),o=A("div"),l=L("Chapter-Id: "),u=L(a),c=L(" - Modified: "),d=L(h),v(n,"class","text font-medium"),v(o,"class","text-sm"),v(e,"class","flex justify-between mb-2")},m(f,p){S(f,e,p),k(e,n),k(n,s),k(e,r),k(e,o),k(o,l),k(o,u),k(o,c),k(o,d)},p(f,p){p&2&&t!==(t=f[1].name+"")&&B(s,t),p&2&&a!==(a=f[1].id+"")&&B(u,a),p&2&&h!==(h=se(f[1].modified)+"")&&B(d,h)},d(f){f&&C(e)}}}function Pl(i){let e,n,t=i[0]&&Kn(i),s=i[1]&&Vn(i);return{c(){e=A("div"),t&&t.c(),n=O(),s&&s.c(),v(e,"class","flex flex-col gap-5")},m(r,o){S(r,e,o),t&&t.m(e,null),k(e,n),s&&s.m(e,null)},p(r,o){r[0]?t?t.p(r,o):(t=Kn(r),t.c(),t.m(e,n)):t&&(t.d(1),t=null),r[1]?s?s.p(r,o):(s=Vn(r),s.c(),s.m(e,null)):s&&(s.d(1),s=null)},d(r){r&&C(e),t&&t.d(),s&&s.d()}}}function Il(i){let e,n;return e=new jl({props:{$$slots:{default:[Pl]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,s){$(e,t,s),n=!0},p(t,[s]){const r={};s&7&&(r.$$scope={dirty:s,ctx:t}),e.$set(r)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function Rl(i,e,n){let{book:t=null}=e,{chapter:s=null}=e;return i.$$set=r=>{"book"in r&&n(0,t=r.book),"chapter"in r&&n(1,s=r.chapter)},[t,s]}class an extends N{constructor(e){super(),q(this,e,Rl,Il,U,{book:0,chapter:1})}}function Ll(i){let e,n;return{c(){e=ee("svg"),n=ee("path"),v(n,"stroke-linecap","round"),v(n,"stroke-linejoin","round"),v(n,"d","m12.75 15 3-3m0 0-3-3m3 3h-7.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"),v(e,"xmlns","http://www.w3.org/2000/svg"),v(e,"fill","none"),v(e,"viewBox","0 0 24 24"),v(e,"stroke-width","1.5"),v(e,"stroke","currentColor"),v(e,"class","size-6 hover:stroke-2")},m(t,s){S(t,e,s),k(e,n)},p:D,d(t){t&&C(e)}}}function Dl(i){let e,n;return e=new me({props:{onClick:i[0],$$slots:{default:[Ll]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,s){$(e,t,s),n=!0},p(t,[s]){const r={};s&1&&(r.onClick=t[0]),s&2&&(r.$$scope={dirty:s,ctx:t}),e.$set(r)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function Ul(i,e,n){let{onClick:t}=e;return i.$$set=s=>{"onClick"in s&&n(0,t=s.onClick)},[t]}class ql extends N{constructor(e){super(),q(this,e,Ul,Dl,U,{onClick:0})}}function Wn(i,e,n){const t=i.slice();return t[10]=e[n],t}function Nl(i){let e,n,t,s,r,o,l,a;function u(){return i[4](i[10])}e=new tn({props:{onClick:u}});function c(){return i[5](i[10])}t=new nn({props:{onClick:c}});function h(){return i[6](i[10])}r=new Br({props:{onClick:h}});function d(){return i[7](i[10])}return l=new ql({props:{onClick:d}}),{c(){w(e.$$.fragment),n=O(),w(t.$$.fragment),s=O(),w(r.$$.fragment),o=O(),w(l.$$.fragment)},m(f,p){$(e,f,p),S(f,n,p),$(t,f,p),S(f,s,p),$(r,f,p),S(f,o,p),$(l,f,p),a=!0},p(f,p){i=f;const g={};p&12&&(g.onClick=u),e.$set(g);const y={};p&4&&(y.onClick=c),t.$set(y);const T={};p&4&&(T.onClick=h),r.$set(T);const E={};p&4&&(E.onClick=d),l.$set(E)},i(f){a||(m(e.$$.fragment,f),m(t.$$.fragment,f),m(r.$$.fragment,f),m(l.$$.fragment,f),a=!0)},o(f){_(e.$$.fragment,f),_(t.$$.fragment,f),_(r.$$.fragment,f),_(l.$$.fragment,f),a=!1},d(f){f&&(C(n),C(s),C(o)),b(e,f),b(t,f),b(r,f),b(l,f)}}}function Qn(i){let e,n,t=i[10].id+"",s,r,o,l=i[10].name+"",a,u,c,h=se(i[10].modified)+"",d,f,p,g,y,T;return g=new x({props:{$$slots:{default:[Nl]},$$scope:{ctx:i}}}),{c(){e=A("tr"),n=A("td"),s=L(t),r=O(),o=A("td"),a=L(l),u=O(),c=A("td"),d=L(h),f=O(),p=A("td"),w(g.$$.fragment),y=O()},m(E,j){S(E,e,j),k(e,n),k(n,s),k(e,r),k(e,o),k(o,a),k(e,u),k(e,c),k(c,d),k(e,f),k(e,p),$(g,p,null),k(e,y),T=!0},p(E,j){(!T||j&4)&&t!==(t=E[10].id+"")&&B(s,t),(!T||j&4)&&l!==(l=E[10].name+"")&&B(a,l),(!T||j&4)&&h!==(h=se(E[10].modified)+"")&&B(d,h);const P={};j&8204&&(P.$$scope={dirty:j,ctx:E}),g.$set(P)},i(E){T||(m(g.$$.fragment,E),T=!0)},o(E){_(g.$$.fragment,E),T=!1},d(E){E&&C(e),b(g)}}}function Bl(i){let e,n,t,s;return e=new H({props:{onClick:i[8],label:"Cancel"}}),t=new H({props:{onClick:i[9],label:"Create"}}),{c(){w(e.$$.fragment),n=O(),w(t.$$.fragment)},m(r,o){$(e,r,o),S(r,n,o),$(t,r,o),s=!0},p(r,o){const l={};o&1&&(l.onClick=r[9]),t.$set(l)},i(r){s||(m(e.$$.fragment,r),m(t.$$.fragment,r),s=!0)},o(r){_(e.$$.fragment,r),_(t.$$.fragment,r),s=!1},d(r){r&&C(n),b(e,r),b(t,r)}}}function Ml(i){let e,n,t,s,r,o,l,a,u,c,h;e=new ie({props:{header:"List Chapters"}}),t=new an({props:{book:i[1]}});let d=ae(i[2]),f=[];for(let g=0;g<d.length;g+=1)f[g]=Qn(Wn(i,d,g));const p=g=>_(f[g],1,1,()=>{f[g]=null});return c=new x({props:{$$slots:{default:[Bl]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment),n=O(),w(t.$$.fragment),s=O(),r=A("table"),o=A("thead"),o.innerHTML='<tr class="tb-head"><th>ID</th> <th>Name</th> <th>Modified</th> <th></th></tr>',l=O(),a=A("tbody");for(let g=0;g<f.length;g+=1)f[g].c();u=O(),w(c.$$.fragment),v(r,"class","bg-white shadow w-full")},m(g,y){$(e,g,y),S(g,n,y),$(t,g,y),S(g,s,y),S(g,r,y),k(r,o),k(r,l),k(r,a);for(let T=0;T<f.length;T+=1)f[T]&&f[T].m(a,null);S(g,u,y),$(c,g,y),h=!0},p(g,y){const T={};if(y&2&&(T.book=g[1]),t.$set(T),y&12){d=ae(g[2]);let j;for(j=0;j<d.length;j+=1){const P=Wn(g,d,j);f[j]?(f[j].p(P,y),m(f[j],1)):(f[j]=Qn(P),f[j].c(),m(f[j],1),f[j].m(a,null))}for(G(),j=d.length;j<f.length;j+=1)p(j);V()}const E={};y&8193&&(E.$$scope={dirty:y,ctx:g}),c.$set(E)},i(g){if(!h){m(e.$$.fragment,g),m(t.$$.fragment,g);for(let y=0;y<d.length;y+=1)m(f[y]);m(c.$$.fragment,g),h=!0}},o(g){_(e.$$.fragment,g),_(t.$$.fragment,g),f=f.filter(Boolean);for(let y=0;y<f.length;y+=1)_(f[y]);_(c.$$.fragment,g),h=!1},d(g){g&&(C(n),C(s),C(r),C(u)),b(e,g),b(t,g),Ie(f,g),b(c,g)}}}function Fl(i){let e,n,t,s;return e=new oe({props:{$$slots:{default:[Ml]},$$scope:{ctx:i}}}),t=new rn({props:{title:"Delete Chapter",deleteEntry:i[3]}}),{c(){w(e.$$.fragment),n=O(),w(t.$$.fragment)},m(r,o){$(e,r,o),S(r,n,o),$(t,r,o),s=!0},p(r,[o]){const l={};o&8207&&(l.$$scope={dirty:o,ctx:r}),e.$set(l);const a={};o&8&&(a.deleteEntry=r[3]),t.$set(a)},i(r){s||(m(e.$$.fragment,r),m(t.$$.fragment,r),s=!0)},o(r){_(e.$$.fragment,r),_(t.$$.fragment,r),s=!1},d(r){r&&C(n),b(e,r),b(t,r)}}}function zl(i,e,n){let{params:t={id:0}}=e,s,r=[],o={entry:null,onDelete:f=>{Sl(f.id,f.book_id).then(p=>n(2,r=p))},getMessage:f=>`Do you wnat to delete the chapter: '${f.id}'?`};pe(async()=>{n(1,s=await kt(t.id)),s&&n(2,r=await on(s.id))});const l=async f=>{n(3,o.entry=f,o)},a=f=>{J("/chapters/update/"+f.id)},u=f=>{J("/questions/list/"+f.id)},c=f=>{J("/lession/prepare/"+f.id)},h=()=>J("/books/list"),d=()=>J("/chapters/create/"+t.id);return i.$$set=f=>{"params"in f&&n(0,t=f.params)},[t,s,r,o,l,a,u,c,h,d]}class Hl extends N{constructor(e){super(),q(this,e,zl,Fl,U,{params:0})}}function Jl(i){let e,n,t,s;return e=new H({props:{onClick:i[5],label:"Cancel"}}),t=new H({props:{label:"Create"}}),{c(){w(e.$$.fragment),n=O(),w(t.$$.fragment)},m(r,o){$(e,r,o),S(r,n,o),$(t,r,o),s=!0},p(r,o){const l={};o&1&&(l.onClick=r[5]),e.$set(l)},i(r){s||(m(e.$$.fragment,r),m(t.$$.fragment,r),s=!0)},o(r){_(e.$$.fragment,r),_(t.$$.fragment,r),s=!1},d(r){r&&C(n),b(e,r),b(t,r)}}}function Kl(i){let e,n,t,s,r;function o(a){i[4](a)}let l={id:"name",label:"Chapter name",error:i[2]};return i[1]!==void 0&&(l.value=i[1]),e=new ke({props:l}),Z.push(()=>ne(e,"value",o)),s=new x({props:{$$slots:{default:[Jl]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment),t=O(),w(s.$$.fragment)},m(a,u){$(e,a,u),S(a,t,u),$(s,a,u),r=!0},p(a,u){const c={};u&4&&(c.error=a[2]),!n&&u&2&&(n=!0,c.value=a[1],te(()=>n=!1)),e.$set(c);const h={};u&65&&(h.$$scope={dirty:u,ctx:a}),s.$set(h)},i(a){r||(m(e.$$.fragment,a),m(s.$$.fragment,a),r=!0)},o(a){_(e.$$.fragment,a),_(s.$$.fragment,a),r=!1},d(a){a&&C(t),b(e,a),b(s,a)}}}function Gl(i){let e,n,t,s;return e=new ie({props:{header:"Create Book"}}),t=new _e({props:{onSubmit:i[3],$$slots:{default:[Kl]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment),n=O(),w(t.$$.fragment)},m(r,o){$(e,r,o),S(r,n,o),$(t,r,o),s=!0},p(r,o){const l={};o&71&&(l.$$scope={dirty:o,ctx:r}),t.$set(l)},i(r){s||(m(e.$$.fragment,r),m(t.$$.fragment,r),s=!0)},o(r){_(e.$$.fragment,r),_(t.$$.fragment,r),s=!1},d(r){r&&C(n),b(e,r),b(t,r)}}}function Vl(i){let e,n;return e=new oe({props:{$$slots:{default:[Gl]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,s){$(e,t,s),n=!0},p(t,[s]){const r={};s&71&&(r.$$scope={dirty:s,ctx:t}),e.$set(r)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function Wl(i,e,n){let{params:t={book_id:0}}=e,s="",r="";const o=async()=>{n(2,r=ce(s)),!r&&(await Ol(t.book_id,s),J("/chapters/list/"+t.book_id))};function l(u){s=u,n(1,s)}const a=()=>J("/chapters/list/"+t.book_id);return i.$$set=u=>{"params"in u&&n(0,t=u.params)},[t,s,r,o,l,a]}class Ql extends N{constructor(e){super(),q(this,e,Wl,Vl,U,{params:0})}}function Yn(i){let e,n,t=i[0].id+"",s,r,o,l=se(i[0].modified)+"",a,u,c,h;return c=new _e({props:{onSubmit:i[3],$$slots:{default:[Xl]},$$scope:{ctx:i}}}),{c(){e=A("div"),n=A("span"),s=L(t),r=O(),o=A("span"),a=L(l),u=O(),w(c.$$.fragment),v(e,"class","mb-4 text-small")},m(d,f){S(d,e,f),k(e,n),k(n,s),k(e,r),k(e,o),k(o,a),S(d,u,f),$(c,d,f),h=!0},p(d,f){(!h||f&1)&&t!==(t=d[0].id+"")&&B(s,t),(!h||f&1)&&l!==(l=se(d[0].modified)+"")&&B(a,l);const p={};f&135&&(p.$$scope={dirty:f,ctx:d}),c.$set(p)},i(d){h||(m(c.$$.fragment,d),h=!0)},o(d){_(c.$$.fragment,d),h=!1},d(d){d&&(C(e),C(u)),b(c,d)}}}function Yl(i){let e,n,t,s;return e=new H({props:{onClick:i[6],label:"Cancel"}}),t=new H({props:{label:"Create"}}),{c(){w(e.$$.fragment),n=O(),w(t.$$.fragment)},m(r,o){$(e,r,o),S(r,n,o),$(t,r,o),s=!0},p(r,o){const l={};o&1&&(l.onClick=r[6]),e.$set(l)},i(r){s||(m(e.$$.fragment,r),m(t.$$.fragment,r),s=!0)},o(r){_(e.$$.fragment,r),_(t.$$.fragment,r),s=!1},d(r){r&&C(n),b(e,r),b(t,r)}}}function Xl(i){let e,n,t,s,r;function o(a){i[5](a)}let l={id:"name",label:"Chapter name",error:i[2]};return i[1]!==void 0&&(l.value=i[1]),e=new ke({props:l}),Z.push(()=>ne(e,"value",o)),s=new x({props:{$$slots:{default:[Yl]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment),t=O(),w(s.$$.fragment)},m(a,u){$(e,a,u),S(a,t,u),$(s,a,u),r=!0},p(a,u){const c={};u&4&&(c.error=a[2]),!n&&u&2&&(n=!0,c.value=a[1],te(()=>n=!1)),e.$set(c);const h={};u&129&&(h.$$scope={dirty:u,ctx:a}),s.$set(h)},i(a){r||(m(e.$$.fragment,a),m(s.$$.fragment,a),r=!0)},o(a){_(e.$$.fragment,a),_(s.$$.fragment,a),r=!1},d(a){a&&C(t),b(e,a),b(s,a)}}}function Zl(i){let e,n,t,s;e=new ie({props:{header:"Update Book"}});let r=i[0]&&Yn(i);return{c(){w(e.$$.fragment),n=O(),r&&r.c(),t=X()},m(o,l){$(e,o,l),S(o,n,l),r&&r.m(o,l),S(o,t,l),s=!0},p(o,l){o[0]?r?(r.p(o,l),l&1&&m(r,1)):(r=Yn(o),r.c(),m(r,1),r.m(t.parentNode,t)):r&&(G(),_(r,1,1,()=>{r=null}),V())},i(o){s||(m(e.$$.fragment,o),m(r),s=!0)},o(o){_(e.$$.fragment,o),_(r),s=!1},d(o){o&&(C(n),C(t)),b(e,o),r&&r.d(o)}}}function xl(i){let e,n;return e=new oe({props:{$$slots:{default:[Zl]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,s){$(e,t,s),n=!0},p(t,[s]){const r={};s&135&&(r.$$scope={dirty:s,ctx:t}),e.$set(r)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function eu(i,e,n){let{params:t={id:""}}=e,s=null,r="",o="";const l=async()=>{if(n(2,o=ce(r)),!o){if(!s){Q.setString("No chapter!!");return}await El(s.id,s.book_id,r),J("/chapters/list/"+s.book_id)}};pe(async()=>{n(0,s=await sn(parseInt(t.id))),s&&n(1,r=s.name)});function a(c){r=c,n(1,r)}const u=()=>J("/chapters/list/"+(s==null?void 0:s.book_id));return i.$$set=c=>{"params"in c&&n(4,t=c.params)},[s,r,o,l,t,a,u]}class tu extends N{constructor(e){super(),q(this,e,eu,xl,U,{params:4})}}const nu=lt+"questions",Ct=i=>`${nu}#${i}`,ru=async i=>{let{data:e,error:n}=await Y.from("questions").select("*").eq("id",i).single();return n&&Q.setDBError(n),e||null},St=async i=>{const e=Ct(i),n=localStorage.getItem(e);if(n)return JSON.parse(n);let{data:t,error:s}=await Y.from("questions").select("*").eq("chapter_id",i).order("id");return s&&Q.setDBError(s),t?(localStorage.setItem(e,JSON.stringify(t)),t):[]},su=async(i,e)=>{const{error:n}=await Y.from("questions").delete().eq("id",i);return n?(Q.setDBError(n),[]):(localStorage.removeItem(Ct(e)),St(e))},iu=async(i,e,n,t)=>{const{error:s}=await Y.from("questions").insert([{chapter_id:i,quest:e,answer:n,details:t}]);if(s)return Q.setDBError(s),[];localStorage.removeItem(Ct(i))},ou=async(i,e,n,t,s)=>{const{error:r}=await Y.from("questions").update({quest:n,answer:t,details:s}).eq("id",i);return r?(Q.setDBError(r),[]):(localStorage.removeItem(Ct(e)),St(e))},Dt=10,au=async(i,e)=>{const{data:n,error:t}=await Y.from("questions").select().ilike(e,`%${i}%`).limit(Dt+1);return t?(Q.setDBError(t),{questions:[],hasMore:!1}):(console.log("search-like:",i,"where:",e,"data:",n),{questions:n.slice(0,Dt),hasMore:n.length==Dt+1})};function lu(i){let e,n;return{c(){e=A("div"),n=L(i[0]),v(e,"class","text-xs font-medium rounded-full shadow-sm bg-teal-500 text-white py-1.5 px-3")},m(t,s){S(t,e,s),k(e,n)},p(t,[s]){s&1&&B(n,t[0])},i:D,o:D,d(t){t&&C(e)}}}function uu(i,e,n){let{text:t}=e;return i.$$set=s=>{"text"in s&&n(0,t=s.text)},[t]}class cu extends N{constructor(e){super(),q(this,e,uu,lu,U,{text:0})}}function Xn(i){let e,n;return e=new cu({props:{text:`Progress: ${i[1]} / 3`}}),{c(){w(e.$$.fragment)},m(t,s){$(e,t,s),n=!0},p(t,s){const r={};s&2&&(r.text=`Progress: ${t[1]} / 3`),e.$set(r)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function Zn(i){let e,n,t,s,r=(i[3]?i[0].quest:i[0].answer)+"",o,l,a,u=i[0].details&&xn(i);return{c(){e=A("div"),n=A("div"),n.textContent="Answer",t=O(),s=A("div"),o=L(r),l=O(),u&&u.c(),a=X(),v(n,"class","text-sm font-bold"),v(s,"class","px-3 py-3 mt-2 border border-gray-400 rounded shadow-sm whitespace-pre-line bg-yellow-50")},m(c,h){S(c,e,h),k(e,n),k(e,t),k(e,s),k(s,o),S(c,l,h),u&&u.m(c,h),S(c,a,h)},p(c,h){h&9&&r!==(r=(c[3]?c[0].quest:c[0].answer)+"")&&B(o,r),c[0].details?u?u.p(c,h):(u=xn(c),u.c(),u.m(a.parentNode,a)):u&&(u.d(1),u=null)},d(c){c&&(C(e),C(l),C(a)),u&&u.d(c)}}}function xn(i){let e,n,t,s,r=i[0].details+"",o;return{c(){e=A("div"),n=A("div"),n.textContent="Details",t=O(),s=A("div"),o=L(r),v(n,"class","text-sm font-bold"),v(s,"class","px-3 py-3 mt-2 border border-gray-400 rounded shadow-sm whitespace-pre-line bg-yellow-50")},m(l,a){S(l,e,a),k(e,n),k(e,t),k(e,s),k(s,o)},p(l,a){a&1&&r!==(r=l[0].details+"")&&B(o,r)},d(l){l&&C(e)}}}function fu(i){let e,n,t,s,r,o=i[0].id+"",l,a,u,c,h,d=se(i[0].modified)+"",f,p,g,y=(i[3]?i[0].answer:i[0].quest)+"",T,E,j,P=i[1]>=0&&Xn(i),I=i[2]&&Zn(i);return{c(){e=A("div"),n=A("div"),t=A("div"),s=A("div"),r=L("Question Id: "),l=L(o),a=O(),P&&P.c(),u=O(),c=A("div"),h=L("Modified: "),f=L(d),p=O(),g=A("div"),T=L(y),E=O(),I&&I.c(),v(s,"class","text-sm font-bold"),v(c,"class","text-sm"),v(t,"class","flex justify-between items-end"),v(g,"class","px-3 py-3 mt-2 border border-gray-400 rounded shadow-sm whitespace-pre-line bg-yellow-100"),v(e,"class","flex flex-col gap-3")},m(R,M){S(R,e,M),k(e,n),k(n,t),k(t,s),k(s,r),k(s,l),k(t,a),P&&P.m(t,null),k(t,u),k(t,c),k(c,h),k(c,f),k(n,p),k(n,g),k(g,T),k(e,E),I&&I.m(e,null),j=!0},p(R,[M]){(!j||M&1)&&o!==(o=R[0].id+"")&&B(l,o),R[1]>=0?P?(P.p(R,M),M&2&&m(P,1)):(P=Xn(R),P.c(),m(P,1),P.m(t,u)):P&&(G(),_(P,1,1,()=>{P=null}),V()),(!j||M&1)&&d!==(d=se(R[0].modified)+"")&&B(f,d),(!j||M&9)&&y!==(y=(R[3]?R[0].answer:R[0].quest)+"")&&B(T,y),R[2]?I?I.p(R,M):(I=Zn(R),I.c(),I.m(e,null)):I&&(I.d(1),I=null)},i(R){j||(m(P),j=!0)},o(R){_(P),j=!1},d(R){R&&C(e),P&&P.d(),I&&I.d()}}}function hu(i,e,n){let{question:t}=e,{progress:s=-1}=e,{showAnswer:r=!0}=e,{reverse:o=!1}=e;return i.$$set=l=>{"question"in l&&n(0,t=l.question),"progress"in l&&n(1,s=l.progress),"showAnswer"in l&&n(2,r=l.showAnswer),"reverse"in l&&n(3,o=l.reverse)},[t,s,r,o]}class ln extends N{constructor(e){super(),q(this,e,hu,fu,U,{question:0,progress:1,showAnswer:2,reverse:3})}}function er(i,e,n){const t=i.slice();return t[9]=e[n],t}function du(i){let e,n,t,s;function r(){return i[5](i[9])}e=new tn({props:{onClick:r}});function o(){return i[6](i[9])}return t=new nn({props:{onClick:o}}),{c(){w(e.$$.fragment),n=O(),w(t.$$.fragment)},m(l,a){$(e,l,a),S(l,n,a),$(t,l,a),s=!0},p(l,a){i=l;const u={};a&24&&(u.onClick=r),e.$set(u);const c={};a&8&&(c.onClick=o),t.$set(c)},i(l){s||(m(e.$$.fragment,l),m(t.$$.fragment,l),s=!0)},o(l){_(e.$$.fragment,l),_(t.$$.fragment,l),s=!1},d(l){l&&C(n),b(e,l),b(t,l)}}}function tr(i){let e,n,t,s,r,o,l;return n=new ln({props:{question:i[9]}}),r=new x({props:{$$slots:{default:[du]},$$scope:{ctx:i}}}),{c(){e=A("div"),w(n.$$.fragment),t=O(),s=A("div"),w(r.$$.fragment),o=O(),v(s,"class","mt-2 flex justify-end")},m(a,u){S(a,e,u),$(n,e,null),k(e,t),k(e,s),$(r,s,null),k(e,o),l=!0},p(a,u){const c={};u&8&&(c.question=a[9]),n.$set(c);const h={};u&4120&&(h.$$scope={dirty:u,ctx:a}),r.$set(h)},i(a){l||(m(n.$$.fragment,a),m(r.$$.fragment,a),l=!0)},o(a){_(n.$$.fragment,a),_(r.$$.fragment,a),l=!1},d(a){a&&C(e),b(n),b(r)}}}function pu(i){let e,n,t,s;return e=new H({props:{onClick:i[7],label:"Cancel"}}),t=new H({props:{onClick:i[8],label:"Create"}}),{c(){w(e.$$.fragment),n=O(),w(t.$$.fragment)},m(r,o){$(e,r,o),S(r,n,o),$(t,r,o),s=!0},p(r,o){const l={};o&4&&(l.onClick=r[7]),e.$set(l);const a={};o&1&&(a.onClick=r[8]),t.$set(a)},i(r){s||(m(e.$$.fragment,r),m(t.$$.fragment,r),s=!0)},o(r){_(e.$$.fragment,r),_(t.$$.fragment,r),s=!1},d(r){r&&C(n),b(e,r),b(t,r)}}}function mu(i){let e,n,t,s,r,o,l,a;e=new ie({props:{header:"List Chapters"}}),t=new an({props:{book:i[1],chapter:i[2]}});let u=ae(i[3]),c=[];for(let d=0;d<u.length;d+=1)c[d]=tr(er(i,u,d));const h=d=>_(c[d],1,1,()=>{c[d]=null});return l=new x({props:{$$slots:{default:[pu]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment),n=O(),w(t.$$.fragment),s=O(),r=A("div");for(let d=0;d<c.length;d+=1)c[d].c();o=O(),w(l.$$.fragment),v(r,"class","flex flex-col gap-5")},m(d,f){$(e,d,f),S(d,n,f),$(t,d,f),S(d,s,f),S(d,r,f);for(let p=0;p<c.length;p+=1)c[p]&&c[p].m(r,null);S(d,o,f),$(l,d,f),a=!0},p(d,f){const p={};if(f&2&&(p.book=d[1]),f&4&&(p.chapter=d[2]),t.$set(p),f&24){u=ae(d[3]);let y;for(y=0;y<u.length;y+=1){const T=er(d,u,y);c[y]?(c[y].p(T,f),m(c[y],1)):(c[y]=tr(T),c[y].c(),m(c[y],1),c[y].m(r,null))}for(G(),y=u.length;y<c.length;y+=1)h(y);V()}const g={};f&4101&&(g.$$scope={dirty:f,ctx:d}),l.$set(g)},i(d){if(!a){m(e.$$.fragment,d),m(t.$$.fragment,d);for(let f=0;f<u.length;f+=1)m(c[f]);m(l.$$.fragment,d),a=!0}},o(d){_(e.$$.fragment,d),_(t.$$.fragment,d),c=c.filter(Boolean);for(let f=0;f<c.length;f+=1)_(c[f]);_(l.$$.fragment,d),a=!1},d(d){d&&(C(n),C(s),C(r),C(o)),b(e,d),b(t,d),Ie(c,d),b(l,d)}}}function _u(i){let e,n,t,s;return e=new oe({props:{$$slots:{default:[mu]},$$scope:{ctx:i}}}),t=new rn({props:{title:"Delete Question",deleteEntry:i[4]}}),{c(){w(e.$$.fragment),n=O(),w(t.$$.fragment)},m(r,o){$(e,r,o),S(r,n,o),$(t,r,o),s=!0},p(r,[o]){const l={};o&4127&&(l.$$scope={dirty:o,ctx:r}),e.$set(l);const a={};o&16&&(a.deleteEntry=r[4]),t.$set(a)},i(r){s||(m(e.$$.fragment,r),m(t.$$.fragment,r),s=!0)},o(r){_(e.$$.fragment,r),_(t.$$.fragment,r),s=!1},d(r){r&&C(n),b(e,r),b(t,r)}}}function gu(i,e,n){let{params:t={id:0}}=e,s,r,o=[];pe(async()=>{n(2,r=await sn(t.id)),r&&(n(3,o=await St(r.id)),n(1,s=await kt(r.book_id)))});let l={entry:null,onDelete:d=>{su(d.id,d.chapter_id).then(f=>{n(3,o=f)})},getMessage:d=>`Do you wnat to delete the question: '${d.id}'?`};const a=d=>{n(4,l.entry=d,l)},u=d=>J("/questions/update/"+d.id),c=()=>J("/chapters/list/"+(r==null?void 0:r.book_id)),h=()=>J("/questions/create/"+t.id);return i.$$set=d=>{"params"in d&&n(0,t=d.params)},[t,s,r,o,l,a,u,c,h]}class $u extends N{constructor(e){super(),q(this,e,gu,_u,U,{params:0})}}function nr(i){let e,n,t=i[0].id+"",s,r,o,l=se(i[0].modified)+"",a,u,c,h;return c=new _e({props:{onSubmit:i[6],$$slots:{default:[wu]},$$scope:{ctx:i}}}),{c(){e=A("div"),n=A("span"),s=L(t),r=O(),o=A("span"),a=L(l),u=O(),w(c.$$.fragment),v(e,"class","mb-4 text-small")},m(d,f){S(d,e,f),k(e,n),k(n,s),k(e,r),k(e,o),k(o,a),S(d,u,f),$(c,d,f),h=!0},p(d,f){(!h||f&1)&&t!==(t=d[0].id+"")&&B(s,t),(!h||f&1)&&l!==(l=se(d[0].modified)+"")&&B(a,l);const p={};f&4159&&(p.$$scope={dirty:f,ctx:d}),c.$set(p)},i(d){h||(m(c.$$.fragment,d),h=!0)},o(d){_(c.$$.fragment,d),h=!1},d(d){d&&(C(e),C(u)),b(c,d)}}}function bu(i){let e,n,t,s;return e=new H({props:{onClick:i[11],label:"Cancel"}}),t=new H({props:{label:"Update"}}),{c(){w(e.$$.fragment),n=O(),w(t.$$.fragment)},m(r,o){$(e,r,o),S(r,n,o),$(t,r,o),s=!0},p(r,o){const l={};o&1&&(l.onClick=r[11]),e.$set(l)},i(r){s||(m(e.$$.fragment,r),m(t.$$.fragment,r),s=!0)},o(r){_(e.$$.fragment,r),_(t.$$.fragment,r),s=!1},d(r){r&&C(n),b(e,r),b(t,r)}}}function wu(i){let e,n,t,s,r,o,l,a,u,c,h;function d(E){i[8](E)}let f={id:"question",label:"Questione",error:i[2]};i[1]!==void 0&&(f.value=i[1]),e=new ve({props:f}),Z.push(()=>ne(e,"value",d));function p(E){i[9](E)}let g={id:"answer",label:"Answer",error:i[4]};i[3]!==void 0&&(g.value=i[3]),s=new ve({props:g}),Z.push(()=>ne(s,"value",p));function y(E){i[10](E)}let T={id:"details",label:"Details",error:yu};return i[5]!==void 0&&(T.value=i[5]),l=new ve({props:T}),Z.push(()=>ne(l,"value",y)),c=new x({props:{$$slots:{default:[bu]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment),t=O(),w(s.$$.fragment),o=O(),w(l.$$.fragment),u=O(),w(c.$$.fragment)},m(E,j){$(e,E,j),S(E,t,j),$(s,E,j),S(E,o,j),$(l,E,j),S(E,u,j),$(c,E,j),h=!0},p(E,j){const P={};j&4&&(P.error=E[2]),!n&&j&2&&(n=!0,P.value=E[1],te(()=>n=!1)),e.$set(P);const I={};j&16&&(I.error=E[4]),!r&&j&8&&(r=!0,I.value=E[3],te(()=>r=!1)),s.$set(I);const R={};!a&&j&32&&(a=!0,R.value=E[5],te(()=>a=!1)),l.$set(R);const M={};j&4097&&(M.$$scope={dirty:j,ctx:E}),c.$set(M)},i(E){h||(m(e.$$.fragment,E),m(s.$$.fragment,E),m(l.$$.fragment,E),m(c.$$.fragment,E),h=!0)},o(E){_(e.$$.fragment,E),_(s.$$.fragment,E),_(l.$$.fragment,E),_(c.$$.fragment,E),h=!1},d(E){E&&(C(t),C(o),C(u)),b(e,E),b(s,E),b(l,E),b(c,E)}}}function vu(i){let e,n,t,s;e=new ie({props:{header:"Update Book"}});let r=i[0]&&nr(i);return{c(){w(e.$$.fragment),n=O(),r&&r.c(),t=X()},m(o,l){$(e,o,l),S(o,n,l),r&&r.m(o,l),S(o,t,l),s=!0},p(o,l){o[0]?r?(r.p(o,l),l&1&&m(r,1)):(r=nr(o),r.c(),m(r,1),r.m(t.parentNode,t)):r&&(G(),_(r,1,1,()=>{r=null}),V())},i(o){s||(m(e.$$.fragment,o),m(r),s=!0)},o(o){_(e.$$.fragment,o),_(r),s=!1},d(o){o&&(C(n),C(t)),b(e,o),r&&r.d(o)}}}function ku(i){let e,n;return e=new oe({props:{$$slots:{default:[vu]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,s){$(e,t,s),n=!0},p(t,[s]){const r={};s&4159&&(r.$$scope={dirty:s,ctx:t}),e.$set(r)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}let yu="";function Cu(i,e,n){let{params:t={id:""}}=e,s=null,r="",o="",l="",a="",u="";const c=async()=>{const g={quest:r.trim(),answer:l.trim()};if(n(2,o=ce(g.quest)),n(4,a=ce(g.answer)),!(o||a)){if(!s){Q.setString("No question!!");return}await ou(s.id,s.chapter_id,g.quest,g.answer,Ur(u)),J("/questions/list/"+s.chapter_id)}};pe(async()=>{n(0,s=await ru(parseInt(t.id))),s&&(n(1,r=s.quest),n(3,l=s.answer),n(5,u=s.details?s.details:""))});function h(g){r=g,n(1,r)}function d(g){l=g,n(3,l)}function f(g){u=g,n(5,u)}const p=()=>J("/questions/list/"+(s==null?void 0:s.chapter_id));return i.$$set=g=>{"params"in g&&n(7,t=g.params)},[s,r,o,l,a,u,c,t,h,d,f,p]}class Su extends N{constructor(e){super(),q(this,e,Cu,ku,U,{params:7})}}function Eu(i){let e,n,t,s;return e=new H({props:{onClick:i[10],label:"Cancel"}}),t=new H({props:{label:"Create"}}),{c(){w(e.$$.fragment),n=O(),w(t.$$.fragment)},m(r,o){$(e,r,o),S(r,n,o),$(t,r,o),s=!0},p(r,o){const l={};o&1&&(l.onClick=r[10]),e.$set(l)},i(r){s||(m(e.$$.fragment,r),m(t.$$.fragment,r),s=!0)},o(r){_(e.$$.fragment,r),_(t.$$.fragment,r),s=!1},d(r){r&&C(n),b(e,r),b(t,r)}}}function Ou(i){let e,n,t,s,r,o,l,a,u,c,h;function d(E){i[7](E)}let f={id:"question",label:"Question",error:i[2]};i[1]!==void 0&&(f.value=i[1]),e=new ve({props:f}),Z.push(()=>ne(e,"value",d));function p(E){i[8](E)}let g={id:"answer",label:"Answer",error:i[4]};i[3]!==void 0&&(g.value=i[3]),s=new ve({props:g}),Z.push(()=>ne(s,"value",p));function y(E){i[9](E)}let T={id:"details",label:"Details",error:ju};return i[5]!==void 0&&(T.value=i[5]),l=new ve({props:T}),Z.push(()=>ne(l,"value",y)),c=new x({props:{$$slots:{default:[Eu]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment),t=O(),w(s.$$.fragment),o=O(),w(l.$$.fragment),u=O(),w(c.$$.fragment)},m(E,j){$(e,E,j),S(E,t,j),$(s,E,j),S(E,o,j),$(l,E,j),S(E,u,j),$(c,E,j),h=!0},p(E,j){const P={};j&4&&(P.error=E[2]),!n&&j&2&&(n=!0,P.value=E[1],te(()=>n=!1)),e.$set(P);const I={};j&16&&(I.error=E[4]),!r&&j&8&&(r=!0,I.value=E[3],te(()=>r=!1)),s.$set(I);const R={};!a&&j&32&&(a=!0,R.value=E[5],te(()=>a=!1)),l.$set(R);const M={};j&2049&&(M.$$scope={dirty:j,ctx:E}),c.$set(M)},i(E){h||(m(e.$$.fragment,E),m(s.$$.fragment,E),m(l.$$.fragment,E),m(c.$$.fragment,E),h=!0)},o(E){_(e.$$.fragment,E),_(s.$$.fragment,E),_(l.$$.fragment,E),_(c.$$.fragment,E),h=!1},d(E){E&&(C(t),C(o),C(u)),b(e,E),b(s,E),b(l,E),b(c,E)}}}function Au(i){let e,n,t,s;return e=new ie({props:{header:"Create Question"}}),t=new _e({props:{onSubmit:i[6],$$slots:{default:[Ou]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment),n=O(),w(t.$$.fragment)},m(r,o){$(e,r,o),S(r,n,o),$(t,r,o),s=!0},p(r,o){const l={};o&2111&&(l.$$scope={dirty:o,ctx:r}),t.$set(l)},i(r){s||(m(e.$$.fragment,r),m(t.$$.fragment,r),s=!0)},o(r){_(e.$$.fragment,r),_(t.$$.fragment,r),s=!1},d(r){r&&C(n),b(e,r),b(t,r)}}}function Tu(i){let e,n;return e=new oe({props:{$$slots:{default:[Au]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,s){$(e,t,s),n=!0},p(t,[s]){const r={};s&2111&&(r.$$scope={dirty:s,ctx:t}),e.$set(r)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}let ju="";function Pu(i,e,n){let{params:t={chapter_id:0}}=e,s="",r="",o="",l="",a="";const u=async()=>{const p={question:s.trim(),answer:o.trim()};n(2,r=ce(p.question)),n(4,l=ce(p.answer)),!(r||l)&&(await iu(t.chapter_id,p.question,p.answer,Ur(a)),J("/questions/list/"+t.chapter_id))};function c(p){s=p,n(1,s)}function h(p){o=p,n(3,o)}function d(p){a=p,n(5,a)}const f=()=>J("/questions/list/"+t.chapter_id);return i.$$set=p=>{"params"in p&&n(0,t=p.params)},[t,s,r,o,l,a,u,c,h,d,f]}class Iu extends N{constructor(e){super(),q(this,e,Pu,Tu,U,{params:0})}}function rr(i,e,n){const t=i.slice();return t[6]=e[n],t}function sr(i){let e,n=i[6].label+"",t,s,r;return{c(){e=A("option"),t=L(n),e.__value=s=i[6].value,Je(e,e.__value),e.selected=r=i[6].value===i[0]},m(o,l){S(o,e,l),k(e,t)},p(o,l){l&8&&n!==(n=o[6].label+"")&&B(t,n),l&8&&s!==(s=o[6].value)&&(e.__value=s,Je(e,e.__value)),l&9&&r!==(r=o[6].value===o[0])&&(e.selected=r)},d(o){o&&C(e)}}}function Ru(i){let e,n,t,s=ae(i[3]),r=[];for(let o=0;o<s.length;o+=1)r[o]=sr(rr(i,s,o));return{c(){e=A("select");for(let o=0;o<r.length;o+=1)r[o].c();v(e,"id",i[2]),v(e,"name",i[2]),v(e,"class","input"),i[0]===void 0&&_t(()=>i[5].call(e))},m(o,l){S(o,e,l);for(let a=0;a<r.length;a+=1)r[a]&&r[a].m(e,null);fn(e,i[0],!0),n||(t=Qe(e,"change",i[5]),n=!0)},p(o,l){if(l&9){s=ae(o[3]);let a;for(a=0;a<s.length;a+=1){const u=rr(o,s,a);r[a]?r[a].p(u,l):(r[a]=sr(u),r[a].c(),r[a].m(e,null))}for(;a<r.length;a+=1)r[a].d(1);r.length=s.length}l&4&&v(e,"id",o[2]),l&4&&v(e,"name",o[2]),l&9&&fn(e,o[0])},d(o){o&&C(e),Ie(r,o),n=!1,t()}}}function Lu(i){let e,n;return e=new xt({props:{id:i[2],label:i[1],error:i[4],$$slots:{default:[Ru]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,s){$(e,t,s),n=!0},p(t,[s]){const r={};s&4&&(r.id=t[2]),s&2&&(r.label=t[1]),s&16&&(r.error=t[4]),s&525&&(r.$$scope={dirty:s,ctx:t}),e.$set(r)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function Du(i,e,n){let{label:t}=e,{id:s}=e,{value:r}=e,{options:o}=e,{error:l=""}=e;function a(){r=Gr(this),n(0,r),n(3,o)}return i.$$set=u=>{"label"in u&&n(1,t=u.label),"id"in u&&n(2,s=u.id),"value"in u&&n(0,r=u.value),"options"in u&&n(3,o=u.options),"error"in u&&n(4,l=u.error)},[r,t,s,o,l,a]}class Jt extends N{constructor(e){super(),q(this,e,Du,Lu,U,{label:1,id:2,value:0,options:3,error:4})}}function ir(i){let e,n,t=i[2].length+"",s;return{c(){e=A("div"),n=L("Length: "),s=L(t)},m(r,o){S(r,e,o),k(e,n),k(e,s)},p(r,o){o&4&&t!==(t=r[2].length+"")&&B(s,t)},d(r){r&&C(e)}}}function or(i){let e,n;return e=new _e({props:{onSubmit:i[9],$$slots:{default:[qu]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,s){$(e,t,s),n=!0},p(t,s){const r={};s&16410&&(r.$$scope={dirty:s,ctx:t}),e.$set(r)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function Uu(i){let e,n,t,s;return e=new H({props:{onClick:i[13],label:"Cancel"}}),t=new H({props:{label:"Start"}}),{c(){w(e.$$.fragment),n=O(),w(t.$$.fragment)},m(r,o){$(e,r,o),S(r,n,o),$(t,r,o),s=!0},p(r,o){const l={};o&2&&(l.onClick=r[13]),e.$set(l)},i(r){s||(m(e.$$.fragment,r),m(t.$$.fragment,r),s=!0)},o(r){_(e.$$.fragment,r),_(t.$$.fragment,r),s=!1},d(r){r&&C(n),b(e,r),b(t,r)}}}function qu(i){let e,n,t,s,r,o,l,a,u;function c(p){i[11](p)}let h={id:"correct",label:"Correct Answers",options:i[6],error:i[5]};i[3]!==void 0&&(h.value=i[3]),n=new Jt({props:h}),Z.push(()=>ne(n,"value",c));function d(p){i[12](p)}let f={id:"reverse",label:"Reverse Answers",options:i[8],error:i[7]};return i[4]!==void 0&&(f.value=i[4]),r=new Jt({props:f}),Z.push(()=>ne(r,"value",d)),a=new x({props:{$$slots:{default:[Uu]},$$scope:{ctx:i}}}),{c(){e=A("div"),w(n.$$.fragment),s=O(),w(r.$$.fragment),l=O(),w(a.$$.fragment),v(e,"class","flex flex-row gap-4")},m(p,g){S(p,e,g),$(n,e,null),k(e,s),$(r,e,null),S(p,l,g),$(a,p,g),u=!0},p(p,g){const y={};!t&&g&8&&(t=!0,y.value=p[3],te(()=>t=!1)),n.$set(y);const T={};!o&&g&16&&(o=!0,T.value=p[4],te(()=>o=!1)),r.$set(T);const E={};g&16386&&(E.$$scope={dirty:g,ctx:p}),a.$set(E)},i(p){u||(m(n.$$.fragment,p),m(r.$$.fragment,p),m(a.$$.fragment,p),u=!0)},o(p){_(n.$$.fragment,p),_(r.$$.fragment,p),_(a.$$.fragment,p),u=!1},d(p){p&&(C(e),C(l)),b(n),b(r),b(a,p)}}}function Nu(i){let e,n,t,s,r,o,l;e=new ie({props:{header:"List Chapters"}}),t=new an({props:{book:i[0],chapter:i[1]}});let a=i[1]&&ir(i),u=i[2].length!==0&&or(i);return{c(){w(e.$$.fragment),n=O(),w(t.$$.fragment),s=O(),a&&a.c(),r=O(),u&&u.c(),o=X()},m(c,h){$(e,c,h),S(c,n,h),$(t,c,h),S(c,s,h),a&&a.m(c,h),S(c,r,h),u&&u.m(c,h),S(c,o,h),l=!0},p(c,h){const d={};h&1&&(d.book=c[0]),h&2&&(d.chapter=c[1]),t.$set(d),c[1]?a?a.p(c,h):(a=ir(c),a.c(),a.m(r.parentNode,r)):a&&(a.d(1),a=null),c[2].length!==0?u?(u.p(c,h),h&4&&m(u,1)):(u=or(c),u.c(),m(u,1),u.m(o.parentNode,o)):u&&(G(),_(u,1,1,()=>{u=null}),V())},i(c){l||(m(e.$$.fragment,c),m(t.$$.fragment,c),m(u),l=!0)},o(c){_(e.$$.fragment,c),_(t.$$.fragment,c),_(u),l=!1},d(c){c&&(C(n),C(s),C(r),C(o)),b(e,c),b(t,c),a&&a.d(c),u&&u.d(c)}}}function Bu(i){let e,n;return e=new oe({props:{$$slots:{default:[Nu]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,s){$(e,t,s),n=!0},p(t,[s]){const r={};s&16415&&(r.$$scope={dirty:s,ctx:t}),e.$set(r)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function Mu(i,e,n){let{params:t={id:0}}=e,s,r,o=[],l="1",a,u=[{label:"0",value:"0"},{label:"1",value:"1"},{label:"2",value:"2"},{label:"3",value:"3"}],c="false",h,d=[{label:"True",value:"true"},{label:"False",value:"false"}];pe(async()=>{n(1,r=await sn(t.id)),r&&(n(2,o=await St(r.id)),n(0,s=await kt(r.book_id)),o.length===0&&Q.setString("No questions found for this chapter!"))});const f=async()=>{ba(o,parseInt(l),c==="true"),J("/lession/process")};function p(T){l=T,n(3,l)}function g(T){c=T,n(4,c)}const y=()=>J("/chapters/list/"+(r==null?void 0:r.book_id));return i.$$set=T=>{"params"in T&&n(10,t=T.params)},[s,r,o,l,c,a,u,h,d,f,t,p,g,y]}class Fu extends N{constructor(e){super(),q(this,e,Mu,Bu,U,{params:10})}}function zu(i){let e,n,t,s,r,o,l=i[0][0]+"",a,u,c,h,d,f,p=i[0][1]+"",g,y,T,E,j,P,I=i[0][2]+"",R,M,W,le,un,ut,ct=i[0][3]+"",Et;return{c(){e=A("div"),n=A("table"),t=A("tr"),s=A("td"),s.textContent="No correct answers",r=O(),o=A("td"),a=L(l),u=O(),c=A("tr"),h=A("td"),h.textContent="One correct answer",d=O(),f=A("td"),g=L(p),y=O(),T=A("tr"),E=A("td"),E.textContent="Two correct answers",j=O(),P=A("td"),R=L(I),M=O(),W=A("tr"),le=A("td"),le.textContent="Learned",un=O(),ut=A("td"),Et=L(ct),v(s,"class","px-4 py-1 m-1 border-r border-gray-300"),v(o,"class","px-4 py-1 m-1"),v(t,"class",""),v(h,"class","px-4 py-1 m-1 border-r border-gray-300"),v(f,"class","px-4 py-1 m-1"),v(c,"class",""),v(E,"class","px-4 py-1 m-1 border-r border-gray-300"),v(P,"class","px-4 py-1 m-1"),v(T,"class",""),v(le,"class","px-4 py-1 m-1 border-r border-gray-300"),v(ut,"class","px-4 py-1 m-1"),v(W,"class",""),v(e,"class","border border-gray-300 rounded shadow-sm max-w-60 py-3")},m(ge,Le){S(ge,e,Le),k(e,n),k(n,t),k(t,s),k(t,r),k(t,o),k(o,a),k(n,u),k(n,c),k(c,h),k(c,d),k(c,f),k(f,g),k(n,y),k(n,T),k(T,E),k(T,j),k(T,P),k(P,R),k(n,M),k(n,W),k(W,le),k(W,un),k(W,ut),k(ut,Et)},p(ge,[Le]){Le&1&&l!==(l=ge[0][0]+"")&&B(a,l),Le&1&&p!==(p=ge[0][1]+"")&&B(g,p),Le&1&&I!==(I=ge[0][2]+"")&&B(R,I),Le&1&&ct!==(ct=ge[0][3]+"")&&B(Et,ct)},i:D,o:D,d(ge){ge&&C(e)}}}function Hu(i,e,n){let{progress:t}=e;return i.$$set=s=>{"progress"in s&&n(0,t=s.progress)},[t]}class Ju extends N{constructor(e){super(),q(this,e,Hu,zu,U,{progress:0})}}function Ku(i){let e,n;return e=new ln({props:{question:i[2].question,showAnswer:i[4],progress:i[2].progress,reverse:i[0].reverse}}),{c(){w(e.$$.fragment)},m(t,s){$(e,t,s),n=!0},p(t,s){const r={};s&4&&(r.question=t[2].question),s&16&&(r.showAnswer=t[4]),s&4&&(r.progress=t[2].progress),s&1&&(r.reverse=t[0].reverse),e.$set(r)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function Gu(i){let e;return{c(){e=A("p"),e.textContent="End"},m(n,t){S(n,e,t)},p:D,i:D,o:D,d(n){n&&C(e)}}}function ar(i){let e,n,t=i[2]&&lr(i);return{c(){t&&t.c(),e=X()},m(s,r){t&&t.m(s,r),S(s,e,r),n=!0},p(s,r){s[2]?t?(t.p(s,r),r&4&&m(t,1)):(t=lr(s),t.c(),m(t,1),t.m(e.parentNode,e)):t&&(G(),_(t,1,1,()=>{t=null}),V())},i(s){n||(m(t),n=!0)},o(s){_(t),n=!1},d(s){s&&C(e),t&&t.d(s)}}}function lr(i){let e,n,t,s;const r=[Wu,Vu],o=[];function l(a,u){return a[4]?1:0}return e=l(i),n=o[e]=r[e](i),{c(){n.c(),t=X()},m(a,u){o[e].m(a,u),S(a,t,u),s=!0},p(a,u){let c=e;e=l(a),e===c?o[e].p(a,u):(G(),_(o[c],1,1,()=>{o[c]=null}),V(),n=o[e],n?n.p(a,u):(n=o[e]=r[e](a),n.c()),m(n,1),n.m(t.parentNode,t))},i(a){s||(m(n),s=!0)},o(a){_(n),s=!1},d(a){a&&C(t),o[e].d(a)}}}function Vu(i){let e,n,t,s,r,o,l,a;return e=new H({props:{label:"Correct",onClick:i[6]}}),t=new H({props:{label:"Wrong",onClick:i[7]}}),r=new H({props:{label:"Learned",onClick:i[8]}}),l=new H({props:{label:"Skip",onClick:i[9]}}),{c(){w(e.$$.fragment),n=O(),w(t.$$.fragment),s=O(),w(r.$$.fragment),o=O(),w(l.$$.fragment)},m(u,c){$(e,u,c),S(u,n,c),$(t,u,c),S(u,s,c),$(r,u,c),S(u,o,c),$(l,u,c),a=!0},p:D,i(u){a||(m(e.$$.fragment,u),m(t.$$.fragment,u),m(r.$$.fragment,u),m(l.$$.fragment,u),a=!0)},o(u){_(e.$$.fragment,u),_(t.$$.fragment,u),_(r.$$.fragment,u),_(l.$$.fragment,u),a=!1},d(u){u&&(C(n),C(s),C(o)),b(e,u),b(t,u),b(r,u),b(l,u)}}}function Wu(i){let e,n;return e=new H({props:{label:"Show",onClick:i[5]}}),{c(){w(e.$$.fragment)},m(t,s){$(e,t,s),n=!0},p:D,i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function Qu(i){let e,n,t,s;e=new H({props:{label:"Stop",onClick:i[10]}});let r=!i[3]&&ar(i);return{c(){w(e.$$.fragment),n=O(),r&&r.c(),t=X()},m(o,l){$(e,o,l),S(o,n,l),r&&r.m(o,l),S(o,t,l),s=!0},p(o,l){o[3]?r&&(G(),_(r,1,1,()=>{r=null}),V()):r?(r.p(o,l),l&8&&m(r,1)):(r=ar(o),r.c(),m(r,1),r.m(t.parentNode,t))},i(o){s||(m(e.$$.fragment,o),m(r),s=!0)},o(o){_(e.$$.fragment,o),_(r),s=!1},d(o){o&&(C(n),C(t)),b(e,o),r&&r.d(o)}}}function Yu(i){let e,n,t,s,r,o,l,a,u;e=new ie({props:{header:"Lession"}}),t=new Ju({props:{progress:i[1]}});const c=[Gu,Ku],h=[];function d(f,p){return f[3]?0:f[2]?1:-1}return~(r=d(i))&&(o=h[r]=c[r](i)),a=new x({props:{$$slots:{default:[Qu]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment),n=O(),w(t.$$.fragment),s=O(),o&&o.c(),l=O(),w(a.$$.fragment)},m(f,p){$(e,f,p),S(f,n,p),$(t,f,p),S(f,s,p),~r&&h[r].m(f,p),S(f,l,p),$(a,f,p),u=!0},p(f,p){const g={};p&2&&(g.progress=f[1]),t.$set(g);let y=r;r=d(f),r===y?~r&&h[r].p(f,p):(o&&(G(),_(h[y],1,1,()=>{h[y]=null}),V()),~r?(o=h[r],o?o.p(f,p):(o=h[r]=c[r](f),o.c()),m(o,1),o.m(l.parentNode,l)):o=null);const T={};p&8220&&(T.$$scope={dirty:p,ctx:f}),a.$set(T)},i(f){u||(m(e.$$.fragment,f),m(t.$$.fragment,f),m(o),m(a.$$.fragment,f),u=!0)},o(f){_(e.$$.fragment,f),_(t.$$.fragment,f),_(o),_(a.$$.fragment,f),u=!1},d(f){f&&(C(n),C(s),C(l)),b(e,f),b(t,f),~r&&h[r].d(f),b(a,f)}}}function Xu(i){let e,n;return e=new oe({props:{$$slots:{default:[Yu]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,s){$(e,t,s),n=!0},p(t,[s]){const r={};s&8223&&(r.$$scope={dirty:s,ctx:t}),e.$set(r)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function Zu(i,e,n){let t,s=[0,0,0,0],r,o=!1,l=!1;const a=()=>{n(4,l=!0)},u=y=>{if(n(2,r.progress=y,r),r.progress<3?t.learning.push(r):t.learned.push(r),n(1,s=qn(t)),!wa(t)){n(3,o=!0);return}g()},c=()=>{u(r.progress+1)},h=()=>{u(0)},d=()=>{u(3)},f=()=>{u(r.progress)},p=()=>{J("/")},g=()=>{const y=t.learning.shift();y?(n(2,r=y),n(4,l=!1)):n(3,o=!0)};return pe(()=>{const y=qr();if(!y){Q.setString("No lession found!");return}n(0,t=y),n(1,s=qn(t)),g()}),[t,s,r,o,l,a,c,h,d,f,p]}class xu extends N{constructor(e){super(),q(this,e,Zu,Xu,U,{})}}function ur(i,e,n){const t=i.slice();return t[8]=e[n],t}function ec(i){let e,n;return e=new H({props:{disabled:i[4],label:"Search"}}),{c(){w(e.$$.fragment)},m(t,s){$(e,t,s),n=!0},p(t,s){const r={};s&16&&(r.disabled=t[4]),e.$set(r)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function tc(i){let e,n,t,s,r,o,l,a;function u(f){i[6](f)}let c={id:"search",label:"Search Text"};i[0]!==void 0&&(c.value=i[0]),e=new ke({props:c}),Z.push(()=>ne(e,"value",u));function h(f){i[7](f)}let d={id:"where",label:"Where",options:[{label:"Question",value:"quest"},{label:"Answer",value:"answer"},{label:"Details",value:"details"}]};return i[2]!==void 0&&(d.value=i[2]),s=new Jt({props:d}),Z.push(()=>ne(s,"value",h)),l=new x({props:{$$slots:{default:[ec]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment),t=O(),w(s.$$.fragment),o=O(),w(l.$$.fragment)},m(f,p){$(e,f,p),S(f,t,p),$(s,f,p),S(f,o,p),$(l,f,p),a=!0},p(f,p){const g={};!n&&p&1&&(n=!0,g.value=f[0],te(()=>n=!1)),e.$set(g);const y={};!r&&p&4&&(r=!0,y.value=f[2],te(()=>r=!1)),s.$set(y);const T={};p&2064&&(T.$$scope={dirty:p,ctx:f}),l.$set(T)},i(f){a||(m(e.$$.fragment,f),m(s.$$.fragment,f),m(l.$$.fragment,f),a=!0)},o(f){_(e.$$.fragment,f),_(s.$$.fragment,f),_(l.$$.fragment,f),a=!1},d(f){f&&(C(t),C(o)),b(e,f),b(s,f),b(l,f)}}}function nc(i){let e;return{c(){e=A("p"),e.textContent="Nothing found ..."},m(n,t){S(n,e,t)},p:D,i:D,o:D,d(n){n&&C(e)}}}function rc(i){let e,n,t,s=i[3].hasMore&&cr(),r=ae(i[3].questions),o=[];for(let a=0;a<r.length;a+=1)o[a]=fr(ur(i,r,a));const l=a=>_(o[a],1,1,()=>{o[a]=null});return{c(){s&&s.c(),e=O();for(let a=0;a<o.length;a+=1)o[a].c();n=X()},m(a,u){s&&s.m(a,u),S(a,e,u);for(let c=0;c<o.length;c+=1)o[c]&&o[c].m(a,u);S(a,n,u),t=!0},p(a,u){if(a[3].hasMore?s||(s=cr(),s.c(),s.m(e.parentNode,e)):s&&(s.d(1),s=null),u&8){r=ae(a[3].questions);let c;for(c=0;c<r.length;c+=1){const h=ur(a,r,c);o[c]?(o[c].p(h,u),m(o[c],1)):(o[c]=fr(h),o[c].c(),m(o[c],1),o[c].m(n.parentNode,n))}for(G(),c=r.length;c<o.length;c+=1)l(c);V()}},i(a){if(!t){for(let u=0;u<r.length;u+=1)m(o[u]);t=!0}},o(a){o=o.filter(Boolean);for(let u=0;u<o.length;u+=1)_(o[u]);t=!1},d(a){a&&(C(e),C(n)),s&&s.d(a),Ie(o,a)}}}function cr(i){let e;return{c(){e=A("div"),e.textContent="has more ...",v(e,"class","text-red-700")},m(n,t){S(n,e,t)},d(n){n&&C(e)}}}function fr(i){let e,n;return e=new ln({props:{question:i[8]}}),{c(){w(e.$$.fragment)},m(t,s){$(e,t,s),n=!0},p(t,s){const r={};s&8&&(r.question=t[8]),e.$set(r)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function sc(i){let e,n,t,s,r,o,l,a;e=new ie({props:{header:"Search Questions"}}),t=new _e({props:{onSubmit:i[5],$$slots:{default:[tc]},$$scope:{ctx:i}}});const u=[rc,nc],c=[];function h(d,f){return d[3]&&d[3].questions.length>0?0:d[1]!==""?1:-1}return~(o=h(i))&&(l=c[o]=u[o](i)),{c(){w(e.$$.fragment),n=O(),w(t.$$.fragment),s=O(),r=A("div"),l&&l.c(),v(r,"class","flex flex-col gap-16")},m(d,f){$(e,d,f),S(d,n,f),$(t,d,f),S(d,s,f),S(d,r,f),~o&&c[o].m(r,null),a=!0},p(d,f){const p={};f&2069&&(p.$$scope={dirty:f,ctx:d}),t.$set(p);let g=o;o=h(d),o===g?~o&&c[o].p(d,f):(l&&(G(),_(c[g],1,1,()=>{c[g]=null}),V()),~o?(l=c[o],l?l.p(d,f):(l=c[o]=u[o](d),l.c()),m(l,1),l.m(r,null)):l=null)},i(d){a||(m(e.$$.fragment,d),m(t.$$.fragment,d),m(l),a=!0)},o(d){_(e.$$.fragment,d),_(t.$$.fragment,d),_(l),a=!1},d(d){d&&(C(n),C(s),C(r)),b(e,d),b(t,d),~o&&c[o].d()}}}function ic(i){let e,n;return e=new oe({props:{$$slots:{default:[sc]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,s){$(e,t,s),n=!0},p(t,[s]){const r={};s&2079&&(r.$$scope={dirty:s,ctx:t}),e.$set(r)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function oc(i,e,n){let t,s="",r="",o="quest",l;const a=async()=>{n(3,l=await au(s,o)),n(1,r=s)};function u(h){s=h,n(0,s)}function c(h){o=h,n(2,o)}return i.$$.update=()=>{i.$$.dirty&3&&n(4,t=s.length<3||s===r)},[s,r,o,l,t,a,u,c]}class ac extends N{constructor(e){super(),q(this,e,oc,ic,U,{})}}function lc(i){let e,n;return e=new as({props:{routes:i[0]}}),{c(){w(e.$$.fragment)},m(t,s){$(e,t,s),n=!0},p:D,i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function uc(i){let e,n,t,s,r,o,l;return n=new vs({}),s=new _a({props:{$$slots:{default:[lc]},$$scope:{ctx:i}}}),{c(){e=A("main"),w(n.$$.fragment),t=O(),w(s.$$.fragment),r=O(),o=A("footer"),o.textContent="by Volker Senkel 2024",v(o,"class","text-sm text-end my-4 pt-2 border-t"),v(e,"class","text-gray-600 max-w-screen-lg m-auto mt-4")},m(a,u){S(a,e,u),$(n,e,null),k(e,t),$(s,e,null),k(e,r),k(e,o),l=!0},p(a,[u]){const c={};u&2&&(c.$$scope={dirty:u,ctx:a}),s.$set(c)},i(a){l||(m(n.$$.fragment,a),m(s.$$.fragment,a),l=!0)},o(a){_(n.$$.fragment,a),_(s.$$.fragment,a),l=!1},d(a){a&&C(e),b(n),b(s)}}}function cc(i){return[{"/":Aa,"/books/list":ll,"/books/create":gl,"/books/update/:id":yl,"/chapters/list/:id":Hl,"/chapters/create/:book_id":Ql,"/chapters/update/:id":tu,"/questions/list/:id":$u,"/questions/create/:chapter_id":Iu,"/questions/update/:id":Su,"/lession/prepare/:id":Fu,"/lession/process":xu,"/cache":Na,"/search":ac,"*":Fa}]}class fc extends N{constructor(e){super(),q(this,e,cc,uc,U,{})}}new fc({target:document.getElementById("app")});
