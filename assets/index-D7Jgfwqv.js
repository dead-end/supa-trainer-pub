var Fr=Object.defineProperty;var zr=(i,e,n)=>e in i?Fr(i,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):i[e]=n;var At=(i,e,n)=>(zr(i,typeof e!="symbol"?e+"":e,n),n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))t(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&t(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function t(s){if(s.ep)return;s.ep=!0;const r=n(s);fetch(s.href,r)}})();function D(){}function nt(i,e){for(const n in e)i[n]=e[n];return i}function pr(i){return i()}function cn(){return Object.create(null)}function Ve(i){i.forEach(pr)}function We(i){return typeof i=="function"}function U(i,e){return i!=i?e==e:i!==e||i&&typeof i=="object"||typeof i=="function"}function Hr(i){return Object.keys(i).length===0}function mr(i,...e){if(i==null){for(const t of e)t(void 0);return D}const n=i.subscribe(...e);return n.unsubscribe?()=>n.unsubscribe():n}function Jr(i,e,n){i.$$.on_destroy.push(mr(e,n))}function ye(i,e,n,t){if(i){const s=_r(i,e,n,t);return i[0](s)}}function _r(i,e,n,t){return i[1]&&t?nt(n.ctx.slice(),i[1](t(e))):n.ctx}function Ce(i,e,n,t){if(i[2]&&t){const s=i[2](t(n));if(e.dirty===void 0)return s;if(typeof s=="object"){const r=[],o=Math.max(e.dirty.length,s.length);for(let a=0;a<o;a+=1)r[a]=e.dirty[a]|s[a];return r}return e.dirty|s}return e.dirty}function Se(i,e,n,t,s,r){if(s){const o=_r(e,n,t,r);i.p(o,s)}}function Ee(i){if(i.ctx.length>32){const e=[],n=i.ctx.length/32;for(let t=0;t<n;t++)e[t]=-1;return e}return-1}function C(i,e){i.appendChild(e)}function b(i,e,n){i.insertBefore(e,n||null)}function $(i){i.parentNode&&i.parentNode.removeChild(i)}function Ie(i,e){for(let n=0;n<i.length;n+=1)i[n]&&i[n].d(e)}function A(i){return document.createElement(i)}function ee(i){return document.createElementNS("http://www.w3.org/2000/svg",i)}function L(i){return document.createTextNode(i)}function O(){return L(" ")}function Y(){return L("")}function Qe(i,e,n,t){return i.addEventListener(e,n,t),()=>i.removeEventListener(e,n,t)}function Kr(i){return function(e){return e.preventDefault(),i.call(this,e)}}function k(i,e,n){n==null?i.removeAttribute(e):i.getAttribute(e)!==n&&i.setAttribute(e,n)}function Gr(i){return Array.from(i.childNodes)}function B(i,e){e=""+e,i.data!==e&&(i.data=e)}function Je(i,e){i.value=e??""}function fn(i,e,n){for(let t=0;t<i.options.length;t+=1){const s=i.options[t];if(s.__value===e){s.selected=!0;return}}(!n||e!==void 0)&&(i.selectedIndex=-1)}function Vr(i){const e=i.querySelector(":checked");return e&&e.__value}function Wr(i,e,{bubbles:n=!1,cancelable:t=!1}={}){return new CustomEvent(i,{detail:e,bubbles:n,cancelable:t})}function mt(i,e){return new i(e)}let rt;function xe(i){rt=i}function bt(){if(!rt)throw new Error("Function called outside component initialization");return rt}function pe(i){bt().$$.on_mount.push(i)}function Qr(i){bt().$$.after_update.push(i)}function Yr(i){bt().$$.on_destroy.push(i)}function Xr(){const i=bt();return(e,n,{cancelable:t=!1}={})=>{const s=i.$$.callbacks[e];if(s){const r=Wr(e,n,{cancelable:t});return s.slice().forEach(o=>{o.call(i,r)}),!r.defaultPrevented}return!0}}function hn(i,e){const n=i.$$.callbacks[e.type];n&&n.slice().forEach(t=>t.call(this,e))}const Me=[],Z=[];let ze=[];const qt=[],gr=Promise.resolve();let Nt=!1;function $r(){Nt||(Nt=!0,gr.then(wr))}function br(){return $r(),gr}function _t(i){ze.push(i)}function te(i){qt.push(i)}const Tt=new Set;let De=0;function wr(){if(De!==0)return;const i=rt;do{try{for(;De<Me.length;){const e=Me[De];De++,xe(e),Zr(e.$$)}}catch(e){throw Me.length=0,De=0,e}for(xe(null),Me.length=0,De=0;Z.length;)Z.pop()();for(let e=0;e<ze.length;e+=1){const n=ze[e];Tt.has(n)||(Tt.add(n),n())}ze.length=0}while(Me.length);for(;qt.length;)qt.pop()();Nt=!1,Tt.clear(),xe(i)}function Zr(i){if(i.fragment!==null){i.update(),Ve(i.before_update);const e=i.dirty;i.dirty=[-1],i.fragment&&i.fragment.p(i.ctx,e),i.after_update.forEach(_t)}}function xr(i){const e=[],n=[];ze.forEach(t=>i.indexOf(t)===-1?e.push(t):n.push(t)),n.forEach(t=>t()),ze=e}const pt=new Set;let Pe;function K(){Pe={r:0,c:[],p:Pe}}function G(){Pe.r||Ve(Pe.c),Pe=Pe.p}function m(i,e){i&&i.i&&(pt.delete(i),i.i(e))}function _(i,e,n,t){if(i&&i.o){if(pt.has(i))return;pt.add(i),Pe.c.push(()=>{pt.delete(i),t&&(n&&i.d(1),t())}),i.o(e)}else t&&t()}function ae(i){return(i==null?void 0:i.length)!==void 0?i:Array.from(i)}function gt(i,e){const n={},t={},s={$$scope:1};let r=i.length;for(;r--;){const o=i[r],a=e[r];if(a){for(const l in o)l in a||(t[l]=1);for(const l in a)s[l]||(n[l]=a[l],s[l]=1);i[r]=a}else for(const l in o)s[l]=1}for(const o in t)o in n||(n[o]=void 0);return n}function $t(i){return typeof i=="object"&&i!==null?i:{}}function ne(i,e,n){const t=i.$$.props[e];t!==void 0&&(i.$$.bound[t]=n,n(i.$$.ctx[t]))}function y(i){i&&i.c()}function w(i,e,n){const{fragment:t,after_update:s}=i.$$;t&&t.m(e,n),_t(()=>{const r=i.$$.on_mount.map(pr).filter(We);i.$$.on_destroy?i.$$.on_destroy.push(...r):Ve(r),i.$$.on_mount=[]}),s.forEach(_t)}function v(i,e){const n=i.$$;n.fragment!==null&&(xr(n.after_update),Ve(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function es(i,e){i.$$.dirty[0]===-1&&(Me.push(i),$r(),i.$$.dirty.fill(0)),i.$$.dirty[e/31|0]|=1<<e%31}function q(i,e,n,t,s,r,o=null,a=[-1]){const l=rt;xe(i);const u=i.$$={fragment:null,ctx:[],props:r,update:D,not_equal:s,bound:cn(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(l?l.$$.context:[])),callbacks:cn(),dirty:a,skip_bound:!1,root:e.target||l.$$.root};o&&o(u.root);let c=!1;if(u.ctx=n?n(i,e.props||{},(h,d,...f)=>{const p=f.length?f[0]:d;return u.ctx&&s(u.ctx[h],u.ctx[h]=p)&&(!u.skip_bound&&u.bound[h]&&u.bound[h](p),c&&es(i,h)),d}):[],u.update(),c=!0,Ve(u.before_update),u.fragment=t?t(u.ctx):!1,e.target){if(e.hydrate){const h=Gr(e.target);u.fragment&&u.fragment.l(h),h.forEach($)}else u.fragment&&u.fragment.c();e.intro&&m(i.$$.fragment),w(i,e.target,e.anchor),wr()}xe(l)}class N{constructor(){At(this,"$$");At(this,"$$set")}$destroy(){v(this,1),this.$destroy=D}$on(e,n){if(!We(n))return D;const t=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return t.push(n),()=>{const s=t.indexOf(n);s!==-1&&t.splice(s,1)}}$set(e){this.$$set&&!Hr(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const ts="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(ts);const Ue=[];function vr(i,e){return{subscribe:Gt(i,e).subscribe}}function Gt(i,e=D){let n;const t=new Set;function s(a){if(U(i,a)&&(i=a,n)){const l=!Ue.length;for(const u of t)u[1](),Ue.push(u,i);if(l){for(let u=0;u<Ue.length;u+=2)Ue[u][0](Ue[u+1]);Ue.length=0}}}function r(a){s(a(i))}function o(a,l=D){const u=[a,l];return t.add(u),t.size===1&&(n=e(s,r)||D),a(i),()=>{t.delete(u),t.size===0&&n&&(n(),n=null)}}return{set:s,update:r,subscribe:o}}function kr(i,e,n){const t=!Array.isArray(i),s=t?[i]:i;if(!s.every(Boolean))throw new Error("derived() expects stores as input, got a falsy value");const r=e.length<2;return vr(n,(o,a)=>{let l=!1;const u=[];let c=0,h=D;const d=()=>{if(c)return;h();const p=e(t?u[0]:u,o,a);r?o(p):h=We(p)?p:D},f=s.map((p,g)=>mr(p,S=>{u[g]=S,c&=~(1<<g),l&&d()},()=>{c|=1<<g}));return l=!0,d(),function(){Ve(f),h(),l=!1}})}function ns(i,e){if(i instanceof RegExp)return{keys:!1,pattern:i};var n,t,s,r,o=[],a="",l=i.split("/");for(l[0]||l.shift();s=l.shift();)n=s[0],n==="*"?(o.push("wild"),a+="/(.*)"):n===":"?(t=s.indexOf("?",1),r=s.indexOf(".",1),o.push(s.substring(1,~t?t:~r?r:s.length)),a+=~t&&!~r?"(?:/([^/]+?))?":"/([^/]+?)",~r&&(a+=(~t?"?":"")+"\\"+s.substring(r))):a+="/"+s;return{keys:o,pattern:new RegExp("^"+a+"/?$","i")}}function rs(i){let e,n,t;const s=[i[2]];var r=i[0];function o(a,l){let u={};for(let c=0;c<s.length;c+=1)u=nt(u,s[c]);return l!==void 0&&l&4&&(u=nt(u,gt(s,[$t(a[2])]))),{props:u}}return r&&(e=mt(r,o(i)),e.$on("routeEvent",i[7])),{c(){e&&y(e.$$.fragment),n=Y()},m(a,l){e&&w(e,a,l),b(a,n,l),t=!0},p(a,l){if(l&1&&r!==(r=a[0])){if(e){K();const u=e;_(u.$$.fragment,1,0,()=>{v(u,1)}),G()}r?(e=mt(r,o(a,l)),e.$on("routeEvent",a[7]),y(e.$$.fragment),m(e.$$.fragment,1),w(e,n.parentNode,n)):e=null}else if(r){const u=l&4?gt(s,[$t(a[2])]):{};e.$set(u)}},i(a){t||(e&&m(e.$$.fragment,a),t=!0)},o(a){e&&_(e.$$.fragment,a),t=!1},d(a){a&&$(n),e&&v(e,a)}}}function ss(i){let e,n,t;const s=[{params:i[1]},i[2]];var r=i[0];function o(a,l){let u={};for(let c=0;c<s.length;c+=1)u=nt(u,s[c]);return l!==void 0&&l&6&&(u=nt(u,gt(s,[l&2&&{params:a[1]},l&4&&$t(a[2])]))),{props:u}}return r&&(e=mt(r,o(i)),e.$on("routeEvent",i[6])),{c(){e&&y(e.$$.fragment),n=Y()},m(a,l){e&&w(e,a,l),b(a,n,l),t=!0},p(a,l){if(l&1&&r!==(r=a[0])){if(e){K();const u=e;_(u.$$.fragment,1,0,()=>{v(u,1)}),G()}r?(e=mt(r,o(a,l)),e.$on("routeEvent",a[6]),y(e.$$.fragment),m(e.$$.fragment,1),w(e,n.parentNode,n)):e=null}else if(r){const u=l&6?gt(s,[l&2&&{params:a[1]},l&4&&$t(a[2])]):{};e.$set(u)}},i(a){t||(e&&m(e.$$.fragment,a),t=!0)},o(a){e&&_(e.$$.fragment,a),t=!1},d(a){a&&$(n),e&&v(e,a)}}}function is(i){let e,n,t,s;const r=[ss,rs],o=[];function a(l,u){return l[1]?0:1}return e=a(i),n=o[e]=r[e](i),{c(){n.c(),t=Y()},m(l,u){o[e].m(l,u),b(l,t,u),s=!0},p(l,[u]){let c=e;e=a(l),e===c?o[e].p(l,u):(K(),_(o[c],1,1,()=>{o[c]=null}),G(),n=o[e],n?n.p(l,u):(n=o[e]=r[e](l),n.c()),m(n,1),n.m(t.parentNode,t))},i(l){s||(m(n),s=!0)},o(l){_(n),s=!1},d(l){l&&$(t),o[e].d(l)}}}function dn(){const i=window.location.href.indexOf("#/");let e=i>-1?window.location.href.substr(i+1):"/";const n=e.indexOf("?");let t="";return n>-1&&(t=e.substr(n+1),e=e.substr(0,n)),{location:e,querystring:t}}const Vt=vr(null,function(e){e(dn());const n=()=>{e(dn())};return window.addEventListener("hashchange",n,!1),function(){window.removeEventListener("hashchange",n,!1)}});kr(Vt,i=>i.location);kr(Vt,i=>i.querystring);const pn=Gt(void 0);async function J(i){if(!i||i.length<1||i.charAt(0)!="/"&&i.indexOf("#/")!==0)throw Error("Invalid parameter location");await br(),history.replaceState({...history.state,__svelte_spa_router_scrollX:window.scrollX,__svelte_spa_router_scrollY:window.scrollY},void 0),window.location.hash=(i.charAt(0)=="#"?"":"#")+i}function os(i){i?window.scrollTo(i.__svelte_spa_router_scrollX,i.__svelte_spa_router_scrollY):window.scrollTo(0,0)}function as(i,e,n){let{routes:t={}}=e,{prefix:s=""}=e,{restoreScrollState:r=!1}=e;class o{constructor(I,R){if(!R||typeof R!="function"&&(typeof R!="object"||R._sveltesparouter!==!0))throw Error("Invalid component object");if(!I||typeof I=="string"&&(I.length<1||I.charAt(0)!="/"&&I.charAt(0)!="*")||typeof I=="object"&&!(I instanceof RegExp))throw Error('Invalid value for "path" argument - strings must start with / or *');const{pattern:M,keys:W}=ns(I);this.path=I,typeof R=="object"&&R._sveltesparouter===!0?(this.component=R.component,this.conditions=R.conditions||[],this.userData=R.userData,this.props=R.props||{}):(this.component=()=>Promise.resolve(R),this.conditions=[],this.props={}),this._pattern=M,this._keys=W}match(I){if(s){if(typeof s=="string")if(I.startsWith(s))I=I.substr(s.length)||"/";else return null;else if(s instanceof RegExp){const le=I.match(s);if(le&&le[0])I=I.substr(le[0].length)||"/";else return null}}const R=this._pattern.exec(I);if(R===null)return null;if(this._keys===!1)return R;const M={};let W=0;for(;W<this._keys.length;){try{M[this._keys[W]]=decodeURIComponent(R[W+1]||"")||null}catch{M[this._keys[W]]=null}W++}return M}async checkConditions(I){for(let R=0;R<this.conditions.length;R++)if(!await this.conditions[R](I))return!1;return!0}}const a=[];t instanceof Map?t.forEach((P,I)=>{a.push(new o(I,P))}):Object.keys(t).forEach(P=>{a.push(new o(P,t[P]))});let l=null,u=null,c={};const h=Xr();async function d(P,I){await br(),h(P,I)}let f=null,p=null;r&&(p=P=>{P.state&&(P.state.__svelte_spa_router_scrollY||P.state.__svelte_spa_router_scrollX)?f=P.state:f=null},window.addEventListener("popstate",p),Qr(()=>{os(f)}));let g=null,S=null;const T=Vt.subscribe(async P=>{g=P;let I=0;for(;I<a.length;){const R=a[I].match(P.location);if(!R){I++;continue}const M={route:a[I].path,location:P.location,querystring:P.querystring,userData:a[I].userData,params:R&&typeof R=="object"&&Object.keys(R).length?R:null};if(!await a[I].checkConditions(M)){n(0,l=null),S=null,d("conditionsFailed",M);return}d("routeLoading",Object.assign({},M));const W=a[I].component;if(S!=W){W.loading?(n(0,l=W.loading),S=W,n(1,u=W.loadingParams),n(2,c={}),d("routeLoaded",Object.assign({},M,{component:l,name:l.name,params:u}))):(n(0,l=null),S=null);const le=await W();if(P!=g)return;n(0,l=le&&le.default||le),S=W}R&&typeof R=="object"&&Object.keys(R).length?n(1,u=R):n(1,u=null),n(2,c=a[I].props),d("routeLoaded",Object.assign({},M,{component:l,name:l.name,params:u})).then(()=>{pn.set(u)});return}n(0,l=null),S=null,pn.set(void 0)});Yr(()=>{T(),p&&window.removeEventListener("popstate",p)});function E(P){hn.call(this,i,P)}function j(P){hn.call(this,i,P)}return i.$$set=P=>{"routes"in P&&n(3,t=P.routes),"prefix"in P&&n(4,s=P.prefix),"restoreScrollState"in P&&n(5,r=P.restoreScrollState)},i.$$.update=()=>{i.$$.dirty&32&&(history.scrollRestoration=r?"manual":"auto")},[l,u,c,t,s,r,E,j]}class ls extends N{constructor(e){super(),q(this,e,as,is,U,{routes:3,prefix:4,restoreScrollState:5})}}function us(){const{subscribe:i,set:e,update:n}=Gt(null);return{subscribe:i,setDBError:t=>e({msg:t.message,details:t.details}),setAuthError:t=>{e({msg:t.message})},setString:(t,s)=>e({msg:t,details:s}),reset:()=>e(null)}}const Q=us();function cs(i){let e,n,t,s;return{c(){e=A("button"),n=L(i[0]),k(e,"class","btn"),e.disabled=i[2],k(e,"type","button")},m(r,o){b(r,e,o),C(e,n),t||(s=Qe(e,"click",function(){We(i[1])&&i[1].apply(this,arguments)}),t=!0)},p(r,o){i=r,o&1&&B(n,i[0]),o&4&&(e.disabled=i[2])},d(r){r&&$(e),t=!1,s()}}}function fs(i){let e,n;return{c(){e=A("button"),n=L(i[0]),k(e,"class","btn"),e.disabled=i[2],k(e,"type","submit")},m(t,s){b(t,e,s),C(e,n)},p(t,s){s&1&&B(n,t[0]),s&4&&(e.disabled=t[2])},d(t){t&&$(e)}}}function hs(i){let e;function n(r,o){return r[1]==null?fs:cs}let t=n(i),s=t(i);return{c(){s.c(),e=Y()},m(r,o){s.m(r,o),b(r,e,o)},p(r,[o]){t===(t=n(r))&&s?s.p(r,o):(s.d(1),s=t(r),s&&(s.c(),s.m(e.parentNode,e)))},i:D,o:D,d(r){r&&$(e),s.d(r)}}}function ds(i,e,n){let{label:t}=e,{onClick:s=null}=e,{disabled:r=!1}=e;return i.$$set=o=>{"label"in o&&n(0,t=o.label),"onClick"in o&&n(1,s=o.onClick),"disabled"in o&&n(2,r=o.disabled)},[t,s,r]}class H extends N{constructor(e){super(),q(this,e,ds,hs,U,{label:0,onClick:1,disabled:2})}}function ps(i){let e,n;const t=i[1].default,s=ye(t,i,i[0],null);return{c(){e=A("div"),s&&s.c(),k(e,"class","flex gap-4")},m(r,o){b(r,e,o),s&&s.m(e,null),n=!0},p(r,[o]){s&&s.p&&(!n||o&1)&&Se(s,t,r,r[0],n?Ce(t,r[0],o,null):Ee(r[0]),null)},i(r){n||(m(s,r),n=!0)},o(r){_(s,r),n=!1},d(r){r&&$(e),s&&s.d(r)}}}function ms(i,e,n){let{$$slots:t={},$$scope:s}=e;return i.$$set=r=>{"$$scope"in r&&n(0,s=r.$$scope)},[s,t]}class x extends N{constructor(e){super(),q(this,e,ms,ps,U,{})}}function mn(i,e,n){const t=i.slice();return t[5]=e[n],t}function _n(i){let e,n;return e=new H({props:{label:i[5].label,onClick:i[5].onclick}}),{c(){y(e.$$.fragment)},m(t,s){w(e,t,s),n=!0},p(t,s){const r={};s&2&&(r.label=t[5].label),s&2&&(r.onClick=t[5].onclick),e.$set(r)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function _s(i){let e,n,t=ae(i[1]),s=[];for(let o=0;o<t.length;o+=1)s[o]=_n(mn(i,t,o));const r=o=>_(s[o],1,1,()=>{s[o]=null});return{c(){for(let o=0;o<s.length;o+=1)s[o].c();e=Y()},m(o,a){for(let l=0;l<s.length;l+=1)s[l]&&s[l].m(o,a);b(o,e,a),n=!0},p(o,a){if(a&2){t=ae(o[1]);let l;for(l=0;l<t.length;l+=1){const u=mn(o,t,l);s[l]?(s[l].p(u,a),m(s[l],1)):(s[l]=_n(u),s[l].c(),m(s[l],1),s[l].m(e.parentNode,e))}for(K(),l=t.length;l<s.length;l+=1)r(l);G()}},i(o){if(!n){for(let a=0;a<t.length;a+=1)m(s[a]);n=!0}},o(o){s=s.filter(Boolean);for(let a=0;a<s.length;a+=1)_(s[a]);n=!1},d(o){o&&$(e),Ie(s,o)}}}function gs(i){let e,n,t,s,r,o,a,l,u,c,h;const d=i[3].default,f=ye(d,i,i[4],null);return c=new x({props:{$$slots:{default:[_s]},$$scope:{ctx:i}}}),{c(){e=A("div"),n=A("div"),t=A("div"),s=L(i[0]),o=O(),a=A("div"),f&&f.c(),l=O(),u=A("div"),y(c.$$.fragment),k(t,"class",r="text-lg pb-2 border-b "+(i[2]==="error"?"text-red-900":"")),k(a,"class","my-6"),k(n,"class","relative top-1/3 mx-auto max-w-md bg-white rounded shadow p-6"),k(e,"class","fixed z-50 inset-0 bg-black bg-opacity-50 overflow-y-auto h-full w-full")},m(p,g){b(p,e,g),C(e,n),C(n,t),C(t,s),C(n,o),C(n,a),f&&f.m(a,null),C(n,l),C(n,u),w(c,u,null),h=!0},p(p,[g]){(!h||g&1)&&B(s,p[0]),(!h||g&4&&r!==(r="text-lg pb-2 border-b "+(p[2]==="error"?"text-red-900":"")))&&k(t,"class",r),f&&f.p&&(!h||g&16)&&Se(f,d,p,p[4],h?Ce(d,p[4],g,null):Ee(p[4]),null);const S={};g&18&&(S.$$scope={dirty:g,ctx:p}),c.$set(S)},i(p){h||(m(f,p),m(c.$$.fragment,p),h=!0)},o(p){_(f,p),_(c.$$.fragment,p),h=!1},d(p){p&&$(e),f&&f.d(p),v(c)}}}function $s(i,e,n){let{$$slots:t={},$$scope:s}=e,{title:r}=e,{buttons:o}=e,{type:a="ok"}=e;return i.$$set=l=>{"title"in l&&n(0,r=l.title),"buttons"in l&&n(1,o=l.buttons),"type"in l&&n(2,a=l.type),"$$scope"in l&&n(4,s=l.$$scope)},[r,o,a,t,s]}class wt extends N{constructor(e){super(),q(this,e,$s,gs,U,{title:0,buttons:1,type:2})}}function gn(i){let e,n;return e=new wt({props:{title:"Errors",buttons:i[1],type:"error",$$slots:{default:[bs]},$$scope:{ctx:i}}}),{c(){y(e.$$.fragment)},m(t,s){w(e,t,s),n=!0},p(t,s){const r={};s&5&&(r.$$scope={dirty:s,ctx:t}),e.$set(r)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function $n(i){let e,n=i[0].msg+"",t;return{c(){e=A("p"),t=L(n),k(e,"class","text-sm pt-3")},m(s,r){b(s,e,r),C(e,t)},p(s,r){r&1&&n!==(n=s[0].msg+"")&&B(t,n)},d(s){s&&$(e)}}}function bs(i){let e=i[0].msg+"",n,t,s,r=i[0].details&&$n(i);return{c(){n=L(e),t=O(),r&&r.c(),s=Y()},m(o,a){b(o,n,a),b(o,t,a),r&&r.m(o,a),b(o,s,a)},p(o,a){a&1&&e!==(e=o[0].msg+"")&&B(n,e),o[0].details?r?r.p(o,a):(r=$n(o),r.c(),r.m(s.parentNode,s)):r&&(r.d(1),r=null)},d(o){o&&($(n),$(t),$(s)),r&&r.d(o)}}}function ws(i){let e,n,t=i[0]!==null&&gn(i);return{c(){t&&t.c(),e=Y()},m(s,r){t&&t.m(s,r),b(s,e,r),n=!0},p(s,[r]){s[0]!==null?t?(t.p(s,r),r&1&&m(t,1)):(t=gn(s),t.c(),m(t,1),t.m(e.parentNode,e)):t&&(K(),_(t,1,1,()=>{t=null}),G())},i(s){n||(m(t),n=!0)},o(s){_(t),n=!1},d(s){s&&$(e),t&&t.d(s)}}}function vs(i,e,n){let t;return Jr(i,Q,r=>n(0,t=r)),[t,[{label:"OK",onclick:()=>{Q.reset()}}]]}class ks extends N{constructor(e){super(),q(this,e,vs,ws,U,{})}}const ys="modulepreload",Cs=function(i,e){return new URL(i,e).href},bn={},Ke=function(e,n,t){let s=Promise.resolve();if(n&&n.length>0){const r=document.getElementsByTagName("link"),o=document.querySelector("meta[property=csp-nonce]"),a=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));s=Promise.all(n.map(l=>{if(l=Cs(l,t),l in bn)return;bn[l]=!0;const u=l.endsWith(".css"),c=u?'[rel="stylesheet"]':"";if(!!t)for(let f=r.length-1;f>=0;f--){const p=r[f];if(p.href===l&&(!u||p.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${l}"]${c}`))return;const d=document.createElement("link");if(d.rel=u?"stylesheet":ys,u||(d.as="script",d.crossOrigin=""),d.href=l,a&&d.setAttribute("nonce",a),document.head.appendChild(d),u)return new Promise((f,p)=>{d.addEventListener("load",f),d.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${l}`)))})}))}return s.then(()=>e()).catch(r=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=r,window.dispatchEvent(o),!o.defaultPrevented)throw r})},Ss=i=>{let e;return i?e=i:typeof fetch>"u"?e=(...n)=>Ke(()=>Promise.resolve().then(()=>at),void 0,import.meta.url).then(({default:t})=>t(...n)):e=fetch,(...n)=>e(...n)};class Wt extends Error{constructor(e,n="FunctionsError",t){super(e),this.name=n,this.context=t}}class Es extends Wt{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Os extends Wt{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class As extends Wt{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Bt;(function(i){i.Any="any",i.ApNortheast1="ap-northeast-1",i.ApNortheast2="ap-northeast-2",i.ApSouth1="ap-south-1",i.ApSoutheast1="ap-southeast-1",i.ApSoutheast2="ap-southeast-2",i.CaCentral1="ca-central-1",i.EuCentral1="eu-central-1",i.EuWest1="eu-west-1",i.EuWest2="eu-west-2",i.EuWest3="eu-west-3",i.SaEast1="sa-east-1",i.UsEast1="us-east-1",i.UsWest1="us-west-1",i.UsWest2="us-west-2"})(Bt||(Bt={}));var Ts=function(i,e,n,t){function s(r){return r instanceof n?r:new n(function(o){o(r)})}return new(n||(n=Promise))(function(r,o){function a(c){try{u(t.next(c))}catch(h){o(h)}}function l(c){try{u(t.throw(c))}catch(h){o(h)}}function u(c){c.done?r(c.value):s(c.value).then(a,l)}u((t=t.apply(i,e||[])).next())})};class js{constructor(e,{headers:n={},customFetch:t,region:s=Bt.Any}={}){this.url=e,this.headers=n,this.region=s,this.fetch=Ss(t)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,n={}){var t;return Ts(this,void 0,void 0,function*(){try{const{headers:s,method:r,body:o}=n;let a={},{region:l}=n;l||(l=this.region),l&&l!=="any"&&(a["x-region"]=l);let u;o&&(s&&!Object.prototype.hasOwnProperty.call(s,"Content-Type")||!s)&&(typeof Blob<"u"&&o instanceof Blob||o instanceof ArrayBuffer?(a["Content-Type"]="application/octet-stream",u=o):typeof o=="string"?(a["Content-Type"]="text/plain",u=o):typeof FormData<"u"&&o instanceof FormData?u=o:(a["Content-Type"]="application/json",u=JSON.stringify(o)));const c=yield this.fetch(`${this.url}/${e}`,{method:r||"POST",headers:Object.assign(Object.assign(Object.assign({},a),this.headers),s),body:u}).catch(p=>{throw new Es(p)}),h=c.headers.get("x-relay-error");if(h&&h==="true")throw new Os(c);if(!c.ok)throw new As(c);let d=((t=c.headers.get("Content-Type"))!==null&&t!==void 0?t:"text/plain").split(";")[0].trim(),f;return d==="application/json"?f=yield c.json():d==="application/octet-stream"?f=yield c.blob():d==="text/event-stream"?f=c:d==="multipart/form-data"?f=yield c.formData():f=yield c.text(),{data:f,error:null}}catch(s){return{data:null,error:s}}})}}var Ps=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Ge=Ps();const Is=Ge.fetch,Qt=Ge.fetch.bind(Ge),yr=Ge.Headers,Rs=Ge.Request,Ls=Ge.Response,at=Object.freeze(Object.defineProperty({__proto__:null,Headers:yr,Request:Rs,Response:Ls,default:Qt,fetch:Is},Symbol.toStringTag,{value:"Module"}));class Ds extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}}class Us{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=Qt:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}then(e,n){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const t=this.fetch;let s=t(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async r=>{var o,a,l;let u=null,c=null,h=null,d=r.status,f=r.statusText;if(r.ok){if(this.method!=="HEAD"){const T=await r.text();T===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?c=T:c=JSON.parse(T))}const g=(o=this.headers.Prefer)===null||o===void 0?void 0:o.match(/count=(exact|planned|estimated)/),S=(a=r.headers.get("content-range"))===null||a===void 0?void 0:a.split("/");g&&S&&S.length>1&&(h=parseInt(S[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(c)&&(c.length>1?(u={code:"PGRST116",details:`Results contain ${c.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},c=null,h=null,d=406,f="Not Acceptable"):c.length===1?c=c[0]:c=null)}else{const g=await r.text();try{u=JSON.parse(g),Array.isArray(u)&&r.status===404&&(c=[],u=null,d=200,f="OK")}catch{r.status===404&&g===""?(d=204,f="No Content"):u={message:g}}if(u&&this.isMaybeSingle&&(!((l=u==null?void 0:u.details)===null||l===void 0)&&l.includes("0 rows"))&&(u=null,d=200,f="OK"),u&&this.shouldThrowOnError)throw new Ds(u)}return{error:u,data:c,count:h,status:d,statusText:f}});return this.shouldThrowOnError||(s=s.catch(r=>{var o,a,l;return{error:{message:`${(o=r==null?void 0:r.name)!==null&&o!==void 0?o:"FetchError"}: ${r==null?void 0:r.message}`,details:`${(a=r==null?void 0:r.stack)!==null&&a!==void 0?a:""}`,hint:"",code:`${(l=r==null?void 0:r.code)!==null&&l!==void 0?l:""}`},data:null,count:null,status:0,statusText:""}})),s.then(e,n)}}class qs extends Us{select(e){let n=!1;const t=(e??"*").split("").map(s=>/\s/.test(s)&&!n?"":(s==='"'&&(n=!n),s)).join("");return this.url.searchParams.set("select",t),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e,{ascending:n=!0,nullsFirst:t,foreignTable:s,referencedTable:r=s}={}){const o=r?`${r}.order`:"order",a=this.url.searchParams.get(o);return this.url.searchParams.set(o,`${a?`${a},`:""}${e}.${n?"asc":"desc"}${t===void 0?"":t?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:n,referencedTable:t=n}={}){const s=typeof t>"u"?"limit":`${t}.limit`;return this.url.searchParams.set(s,`${e}`),this}range(e,n,{foreignTable:t,referencedTable:s=t}={}){const r=typeof s>"u"?"offset":`${s}.offset`,o=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(r,`${e}`),this.url.searchParams.set(o,`${n-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:e=!1,verbose:n=!1,settings:t=!1,buffers:s=!1,wal:r=!1,format:o="text"}={}){var a;const l=[e?"analyze":null,n?"verbose":null,t?"settings":null,s?"buffers":null,r?"wal":null].filter(Boolean).join("|"),u=(a=this.headers.Accept)!==null&&a!==void 0?a:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${o}; for="${u}"; options=${l};`,o==="json"?this:this}rollback(){var e;return((e=this.headers.Prefer)!==null&&e!==void 0?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}class Fe extends qs{eq(e,n){return this.url.searchParams.append(e,`eq.${n}`),this}neq(e,n){return this.url.searchParams.append(e,`neq.${n}`),this}gt(e,n){return this.url.searchParams.append(e,`gt.${n}`),this}gte(e,n){return this.url.searchParams.append(e,`gte.${n}`),this}lt(e,n){return this.url.searchParams.append(e,`lt.${n}`),this}lte(e,n){return this.url.searchParams.append(e,`lte.${n}`),this}like(e,n){return this.url.searchParams.append(e,`like.${n}`),this}likeAllOf(e,n){return this.url.searchParams.append(e,`like(all).{${n.join(",")}}`),this}likeAnyOf(e,n){return this.url.searchParams.append(e,`like(any).{${n.join(",")}}`),this}ilike(e,n){return this.url.searchParams.append(e,`ilike.${n}`),this}ilikeAllOf(e,n){return this.url.searchParams.append(e,`ilike(all).{${n.join(",")}}`),this}ilikeAnyOf(e,n){return this.url.searchParams.append(e,`ilike(any).{${n.join(",")}}`),this}is(e,n){return this.url.searchParams.append(e,`is.${n}`),this}in(e,n){const t=Array.from(new Set(n)).map(s=>typeof s=="string"&&new RegExp("[,()]").test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(e,`in.(${t})`),this}contains(e,n){return typeof n=="string"?this.url.searchParams.append(e,`cs.${n}`):Array.isArray(n)?this.url.searchParams.append(e,`cs.{${n.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(n)}`),this}containedBy(e,n){return typeof n=="string"?this.url.searchParams.append(e,`cd.${n}`):Array.isArray(n)?this.url.searchParams.append(e,`cd.{${n.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(n)}`),this}rangeGt(e,n){return this.url.searchParams.append(e,`sr.${n}`),this}rangeGte(e,n){return this.url.searchParams.append(e,`nxl.${n}`),this}rangeLt(e,n){return this.url.searchParams.append(e,`sl.${n}`),this}rangeLte(e,n){return this.url.searchParams.append(e,`nxr.${n}`),this}rangeAdjacent(e,n){return this.url.searchParams.append(e,`adj.${n}`),this}overlaps(e,n){return typeof n=="string"?this.url.searchParams.append(e,`ov.${n}`):this.url.searchParams.append(e,`ov.{${n.join(",")}}`),this}textSearch(e,n,{config:t,type:s}={}){let r="";s==="plain"?r="pl":s==="phrase"?r="ph":s==="websearch"&&(r="w");const o=t===void 0?"":`(${t})`;return this.url.searchParams.append(e,`${r}fts${o}.${n}`),this}match(e){return Object.entries(e).forEach(([n,t])=>{this.url.searchParams.append(n,`eq.${t}`)}),this}not(e,n,t){return this.url.searchParams.append(e,`not.${n}.${t}`),this}or(e,{foreignTable:n,referencedTable:t=n}={}){const s=t?`${t}.or`:"or";return this.url.searchParams.append(s,`(${e})`),this}filter(e,n,t){return this.url.searchParams.append(e,`${n}.${t}`),this}}class Ns{constructor(e,{headers:n={},schema:t,fetch:s}){this.url=e,this.headers=n,this.schema=t,this.fetch=s}select(e,{head:n=!1,count:t}={}){const s=n?"HEAD":"GET";let r=!1;const o=(e??"*").split("").map(a=>/\s/.test(a)&&!r?"":(a==='"'&&(r=!r),a)).join("");return this.url.searchParams.set("select",o),t&&(this.headers.Prefer=`count=${t}`),new Fe({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e,{count:n,defaultToNull:t=!0}={}){const s="POST",r=[];if(this.headers.Prefer&&r.push(this.headers.Prefer),n&&r.push(`count=${n}`),t||r.push("missing=default"),this.headers.Prefer=r.join(","),Array.isArray(e)){const o=e.reduce((a,l)=>a.concat(Object.keys(l)),[]);if(o.length>0){const a=[...new Set(o)].map(l=>`"${l}"`);this.url.searchParams.set("columns",a.join(","))}}return new Fe({method:s,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e,{onConflict:n,ignoreDuplicates:t=!1,count:s,defaultToNull:r=!0}={}){const o="POST",a=[`resolution=${t?"ignore":"merge"}-duplicates`];if(n!==void 0&&this.url.searchParams.set("on_conflict",n),this.headers.Prefer&&a.push(this.headers.Prefer),s&&a.push(`count=${s}`),r||a.push("missing=default"),this.headers.Prefer=a.join(","),Array.isArray(e)){const l=e.reduce((u,c)=>u.concat(Object.keys(c)),[]);if(l.length>0){const u=[...new Set(l)].map(c=>`"${c}"`);this.url.searchParams.set("columns",u.join(","))}}return new Fe({method:o,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e,{count:n}={}){const t="PATCH",s=[];return this.headers.Prefer&&s.push(this.headers.Prefer),n&&s.push(`count=${n}`),this.headers.Prefer=s.join(","),new Fe({method:t,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete({count:e}={}){const n="DELETE",t=[];return e&&t.push(`count=${e}`),this.headers.Prefer&&t.unshift(this.headers.Prefer),this.headers.Prefer=t.join(","),new Fe({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}const Bs="1.15.2",Ms={"X-Client-Info":`postgrest-js/${Bs}`};class Yt{constructor(e,{headers:n={},schema:t,fetch:s}={}){this.url=e,this.headers=Object.assign(Object.assign({},Ms),n),this.schemaName=t,this.fetch=s}from(e){const n=new URL(`${this.url}/${e}`);return new Ns(n,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new Yt(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,n={},{head:t=!1,get:s=!1,count:r}={}){let o;const a=new URL(`${this.url}/rpc/${e}`);let l;t||s?(o=t?"HEAD":"GET",Object.entries(n).filter(([c,h])=>h!==void 0).map(([c,h])=>[c,Array.isArray(h)?`{${h.join(",")}}`:`${h}`]).forEach(([c,h])=>{a.searchParams.append(c,h)})):(o="POST",l=n);const u=Object.assign({},this.headers);return r&&(u.Prefer=`count=${r}`),new Fe({method:o,url:a,headers:u,schema:this.schemaName,body:l,fetch:this.fetch,allowEmpty:!1})}}const Fs="2.9.5",zs={"X-Client-Info":`realtime-js/${Fs}`},Hs="1.0.0",Cr=1e4,Js=1e3;var He;(function(i){i[i.connecting=0]="connecting",i[i.open=1]="open",i[i.closing=2]="closing",i[i.closed=3]="closed"})(He||(He={}));var ue;(function(i){i.closed="closed",i.errored="errored",i.joined="joined",i.joining="joining",i.leaving="leaving"})(ue||(ue={}));var de;(function(i){i.close="phx_close",i.error="phx_error",i.join="phx_join",i.reply="phx_reply",i.leave="phx_leave",i.access_token="access_token"})(de||(de={}));var Mt;(function(i){i.websocket="websocket"})(Mt||(Mt={}));var je;(function(i){i.Connecting="connecting",i.Open="open",i.Closing="closing",i.Closed="closed"})(je||(je={}));class Sr{constructor(e,n){this.callback=e,this.timerCalc=n,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=n}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}class Ks{constructor(){this.HEADER_LENGTH=1}decode(e,n){return e.constructor===ArrayBuffer?n(this._binaryDecode(e)):n(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const n=new DataView(e),t=new TextDecoder;return this._decodeBroadcast(e,n,t)}_decodeBroadcast(e,n,t){const s=n.getUint8(1),r=n.getUint8(2);let o=this.HEADER_LENGTH+2;const a=t.decode(e.slice(o,o+s));o=o+s;const l=t.decode(e.slice(o,o+r));o=o+r;const u=JSON.parse(t.decode(e.slice(o,e.byteLength)));return{ref:null,topic:a,event:l,payload:u}}}class jt{constructor(e,n,t={},s=Cr){this.channel=e,this.event=n,this.payload=t,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,n){var t;return this._hasReceived(e)&&n((t=this.receivedResp)===null||t===void 0?void 0:t.response),this.recHooks.push({status:e,callback:n}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=n=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=n,this._matchReceive(n)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,n){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:n})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:n}){this.recHooks.filter(t=>t.status===e).forEach(t=>t.callback(n))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var wn;(function(i){i.SYNC="sync",i.JOIN="join",i.LEAVE="leave"})(wn||(wn={}));class et{constructor(e,n){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const t=(n==null?void 0:n.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(t.state,{},s=>{const{onJoin:r,onLeave:o,onSync:a}=this.caller;this.joinRef=this.channel._joinRef(),this.state=et.syncState(this.state,s,r,o),this.pendingDiffs.forEach(l=>{this.state=et.syncDiff(this.state,l,r,o)}),this.pendingDiffs=[],a()}),this.channel._on(t.diff,{},s=>{const{onJoin:r,onLeave:o,onSync:a}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=et.syncDiff(this.state,s,r,o),a())}),this.onJoin((s,r,o)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:r,newPresences:o})}),this.onLeave((s,r,o)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:r,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,n,t,s){const r=this.cloneDeep(e),o=this.transformState(n),a={},l={};return this.map(r,(u,c)=>{o[u]||(l[u]=c)}),this.map(o,(u,c)=>{const h=r[u];if(h){const d=c.map(S=>S.presence_ref),f=h.map(S=>S.presence_ref),p=c.filter(S=>f.indexOf(S.presence_ref)<0),g=h.filter(S=>d.indexOf(S.presence_ref)<0);p.length>0&&(a[u]=p),g.length>0&&(l[u]=g)}else a[u]=c}),this.syncDiff(r,{joins:a,leaves:l},t,s)}static syncDiff(e,n,t,s){const{joins:r,leaves:o}={joins:this.transformState(n.joins),leaves:this.transformState(n.leaves)};return t||(t=()=>{}),s||(s=()=>{}),this.map(r,(a,l)=>{var u;const c=(u=e[a])!==null&&u!==void 0?u:[];if(e[a]=this.cloneDeep(l),c.length>0){const h=e[a].map(f=>f.presence_ref),d=c.filter(f=>h.indexOf(f.presence_ref)<0);e[a].unshift(...d)}t(a,c,l)}),this.map(o,(a,l)=>{let u=e[a];if(!u)return;const c=l.map(h=>h.presence_ref);u=u.filter(h=>c.indexOf(h.presence_ref)<0),e[a]=u,s(a,u,l),u.length===0&&delete e[a]}),e}static map(e,n){return Object.getOwnPropertyNames(e).map(t=>n(t,e[t]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((n,t)=>{const s=e[t];return"metas"in s?n[t]=s.metas.map(r=>(r.presence_ref=r.phx_ref,delete r.phx_ref,delete r.phx_ref_prev,r)):n[t]=s,n},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var V;(function(i){i.abstime="abstime",i.bool="bool",i.date="date",i.daterange="daterange",i.float4="float4",i.float8="float8",i.int2="int2",i.int4="int4",i.int4range="int4range",i.int8="int8",i.int8range="int8range",i.json="json",i.jsonb="jsonb",i.money="money",i.numeric="numeric",i.oid="oid",i.reltime="reltime",i.text="text",i.time="time",i.timestamp="timestamp",i.timestamptz="timestamptz",i.timetz="timetz",i.tsrange="tsrange",i.tstzrange="tstzrange"})(V||(V={}));const vn=(i,e,n={})=>{var t;const s=(t=n.skipTypes)!==null&&t!==void 0?t:[];return Object.keys(e).reduce((r,o)=>(r[o]=Gs(o,i,e,s),r),{})},Gs=(i,e,n,t)=>{const s=e.find(a=>a.name===i),r=s==null?void 0:s.type,o=n[i];return r&&!t.includes(r)?Er(r,o):Ft(o)},Er=(i,e)=>{if(i.charAt(0)==="_"){const n=i.slice(1,i.length);return Ys(e,n)}switch(i){case V.bool:return Vs(e);case V.float4:case V.float8:case V.int2:case V.int4:case V.int8:case V.numeric:case V.oid:return Ws(e);case V.json:case V.jsonb:return Qs(e);case V.timestamp:return Xs(e);case V.abstime:case V.date:case V.daterange:case V.int4range:case V.int8range:case V.money:case V.reltime:case V.text:case V.time:case V.timestamptz:case V.timetz:case V.tsrange:case V.tstzrange:return Ft(e);default:return Ft(e)}},Ft=i=>i,Vs=i=>{switch(i){case"t":return!0;case"f":return!1;default:return i}},Ws=i=>{if(typeof i=="string"){const e=parseFloat(i);if(!Number.isNaN(e))return e}return i},Qs=i=>{if(typeof i=="string")try{return JSON.parse(i)}catch(e){return console.log(`JSON parse error: ${e}`),i}return i},Ys=(i,e)=>{if(typeof i!="string")return i;const n=i.length-1,t=i[n];if(i[0]==="{"&&t==="}"){let r;const o=i.slice(1,n);try{r=JSON.parse("["+o+"]")}catch{r=o?o.split(","):[]}return r.map(a=>Er(e,a))}return i},Xs=i=>typeof i=="string"?i.replace(" ","T"):i;var kn;(function(i){i.ALL="*",i.INSERT="INSERT",i.UPDATE="UPDATE",i.DELETE="DELETE"})(kn||(kn={}));var yn;(function(i){i.BROADCAST="broadcast",i.PRESENCE="presence",i.POSTGRES_CHANGES="postgres_changes"})(yn||(yn={}));var Cn;(function(i){i.SUBSCRIBED="SUBSCRIBED",i.TIMED_OUT="TIMED_OUT",i.CLOSED="CLOSED",i.CHANNEL_ERROR="CHANNEL_ERROR"})(Cn||(Cn={}));class Xt{constructor(e,n={config:{}},t){this.topic=e,this.params=n,this.socket=t,this.bindings={},this.state=ue.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""}},n.config),this.timeout=this.socket.timeout,this.joinPush=new jt(this,de.join,this.params,this.timeout),this.rejoinTimer=new Sr(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=ue.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(s=>s.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=ue.closed,this.socket._remove(this)}),this._onError(s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=ue.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=ue.errored,this.rejoinTimer.scheduleTimeout())}),this._on(de.reply,{},(s,r)=>{this._trigger(this._replyEventName(r),s)}),this.presence=new et(this),this.broadcastEndpointURL=this._broadcastEndpointURL()}subscribe(e,n=this.timeout){var t,s;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:r,presence:o}}=this.params;this._onError(u=>e&&e("CHANNEL_ERROR",u)),this._onClose(()=>e&&e("CLOSED"));const a={},l={broadcast:r,presence:o,postgres_changes:(s=(t=this.bindings.postgres_changes)===null||t===void 0?void 0:t.map(u=>u.filter))!==null&&s!==void 0?s:[]};this.socket.accessToken&&(a.access_token=this.socket.accessToken),this.updateJoinPayload(Object.assign({config:l},a)),this.joinedOnce=!0,this._rejoin(n),this.joinPush.receive("ok",({postgres_changes:u})=>{var c;if(this.socket.accessToken&&this.socket.setAuth(this.socket.accessToken),u===void 0){e&&e("SUBSCRIBED");return}else{const h=this.bindings.postgres_changes,d=(c=h==null?void 0:h.length)!==null&&c!==void 0?c:0,f=[];for(let p=0;p<d;p++){const g=h[p],{filter:{event:S,schema:T,table:E,filter:j}}=g,P=u&&u[p];if(P&&P.event===S&&P.schema===T&&P.table===E&&P.filter===j)f.push(Object.assign(Object.assign({},g),{id:P.id}));else{this.unsubscribe(),e&&e("CHANNEL_ERROR",new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=f,e&&e("SUBSCRIBED");return}}).receive("error",u=>{e&&e("CHANNEL_ERROR",new Error(JSON.stringify(Object.values(u).join(", ")||"error")))}).receive("timeout",()=>{e&&e("TIMED_OUT")})}return this}presenceState(){return this.presence.state}async track(e,n={}){return await this.send({type:"presence",event:"track",payload:e},n.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,n,t){return this._on(e,n,t)}async send(e,n={}){var t,s;if(!this._canPush()&&e.type==="broadcast"){const{event:r,payload:o}=e,a={method:"POST",headers:{apikey:(t=this.socket.apiKey)!==null&&t!==void 0?t:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:r,payload:o}]})};try{return(await this._fetchWithTimeout(this.broadcastEndpointURL,a,(s=n.timeout)!==null&&s!==void 0?s:this.timeout)).ok?"ok":"error"}catch(l){return l.name==="AbortError"?"timed out":"error"}}else return new Promise(r=>{var o,a,l;const u=this._push(e.type,e,n.timeout||this.timeout);e.type==="broadcast"&&!(!((l=(a=(o=this.params)===null||o===void 0?void 0:o.config)===null||a===void 0?void 0:a.broadcast)===null||l===void 0)&&l.ack)&&r("ok"),u.receive("ok",()=>r("ok")),u.receive("error",()=>r("error")),u.receive("timeout",()=>r("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=ue.leaving;const n=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(de.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(t=>{const s=new jt(this,de.leave,{},e);s.receive("ok",()=>{n(),t("ok")}).receive("timeout",()=>{n(),t("timed out")}).receive("error",()=>{t("error")}),s.send(),this._canPush()||s.trigger("ok",{})})}_broadcastEndpointURL(){let e=this.socket.endPoint;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")+"/api/broadcast"}async _fetchWithTimeout(e,n,t){const s=new AbortController,r=setTimeout(()=>s.abort(),t),o=await this.socket.fetch(e,Object.assign(Object.assign({},n),{signal:s.signal}));return clearTimeout(r),o}_push(e,n,t=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new jt(this,e,n,t);return this._canPush()?s.send():(s.startTimeout(),this.pushBuffer.push(s)),s}_onMessage(e,n,t){return n}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,n,t){var s,r;const o=e.toLocaleLowerCase(),{close:a,error:l,leave:u,join:c}=de;if(t&&[a,l,u,c].indexOf(o)>=0&&t!==this._joinRef())return;let d=this._onMessage(o,n,t);if(n&&!d)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(f=>{var p,g,S;return((p=f.filter)===null||p===void 0?void 0:p.event)==="*"||((S=(g=f.filter)===null||g===void 0?void 0:g.event)===null||S===void 0?void 0:S.toLocaleLowerCase())===o}).map(f=>f.callback(d,t)):(r=this.bindings[o])===null||r===void 0||r.filter(f=>{var p,g,S,T,E,j;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in f){const P=f.id,I=(p=f.filter)===null||p===void 0?void 0:p.event;return P&&((g=n.ids)===null||g===void 0?void 0:g.includes(P))&&(I==="*"||(I==null?void 0:I.toLocaleLowerCase())===((S=n.data)===null||S===void 0?void 0:S.type.toLocaleLowerCase()))}else{const P=(E=(T=f==null?void 0:f.filter)===null||T===void 0?void 0:T.event)===null||E===void 0?void 0:E.toLocaleLowerCase();return P==="*"||P===((j=n==null?void 0:n.event)===null||j===void 0?void 0:j.toLocaleLowerCase())}else return f.type.toLocaleLowerCase()===o}).map(f=>{if(typeof d=="object"&&"ids"in d){const p=d.data,{schema:g,table:S,commit_timestamp:T,type:E,errors:j}=p;d=Object.assign(Object.assign({},{schema:g,table:S,commit_timestamp:T,eventType:E,new:{},old:{},errors:j}),this._getPayloadRecords(p))}f.callback(d,t)})}_isClosed(){return this.state===ue.closed}_isJoined(){return this.state===ue.joined}_isJoining(){return this.state===ue.joining}_isLeaving(){return this.state===ue.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,n,t){const s=e.toLocaleLowerCase(),r={type:s,filter:n,callback:t};return this.bindings[s]?this.bindings[s].push(r):this.bindings[s]=[r],this}_off(e,n){const t=e.toLocaleLowerCase();return this.bindings[t]=this.bindings[t].filter(s=>{var r;return!(((r=s.type)===null||r===void 0?void 0:r.toLocaleLowerCase())===t&&Xt.isEqual(s.filter,n))}),this}static isEqual(e,n){if(Object.keys(e).length!==Object.keys(n).length)return!1;for(const t in e)if(e[t]!==n[t])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(de.close,{},e)}_onError(e){this._on(de.error,{},n=>e(n))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=ue.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const n={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(n.new=vn(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(n.old=vn(e.columns,e.old_record)),n}}const Zs=()=>{},xs=typeof WebSocket<"u";class ei{constructor(e,n){var t;this.accessToken=null,this.apiKey=null,this.channels=[],this.endPoint="",this.headers=zs,this.params={},this.timeout=Cr,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=Zs,this.conn=null,this.sendBuffer=[],this.serializer=new Ks,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this._resolveFetch=r=>{let o;return r?o=r:typeof fetch>"u"?o=(...a)=>Ke(()=>Promise.resolve().then(()=>at),void 0,import.meta.url).then(({default:l})=>l(...a)):o=fetch,(...a)=>o(...a)},this.endPoint=`${e}/${Mt.websocket}`,n!=null&&n.transport?this.transport=n.transport:this.transport=null,n!=null&&n.params&&(this.params=n.params),n!=null&&n.headers&&(this.headers=Object.assign(Object.assign({},this.headers),n.headers)),n!=null&&n.timeout&&(this.timeout=n.timeout),n!=null&&n.logger&&(this.logger=n.logger),n!=null&&n.heartbeatIntervalMs&&(this.heartbeatIntervalMs=n.heartbeatIntervalMs);const s=(t=n==null?void 0:n.params)===null||t===void 0?void 0:t.apikey;s&&(this.accessToken=s,this.apiKey=s),this.reconnectAfterMs=n!=null&&n.reconnectAfterMs?n.reconnectAfterMs:r=>[1e3,2e3,5e3,1e4][r-1]||1e4,this.encode=n!=null&&n.encode?n.encode:(r,o)=>o(JSON.stringify(r)),this.decode=n!=null&&n.decode?n.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new Sr(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(n==null?void 0:n.fetch)}connect(){if(!this.conn){if(this.transport){this.conn=new this.transport(this._endPointURL(),void 0,{headers:this.headers});return}if(xs){this.conn=new WebSocket(this._endPointURL()),this.setupConnection();return}this.conn=new ti(this._endPointURL(),void 0,{close:()=>{this.conn=null}}),Ke(()=>import("./browser-BImCA5dO.js").then(e=>e.b),[],import.meta.url).then(({default:e})=>{this.conn=new e(this._endPointURL(),void 0,{headers:this.headers}),this.setupConnection()})}}disconnect(e,n){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,n??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(e){const n=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),n}async removeAllChannels(){const e=await Promise.all(this.channels.map(n=>n.unsubscribe()));return this.disconnect(),e}log(e,n,t){this.logger(e,n,t)}connectionState(){switch(this.conn&&this.conn.readyState){case He.connecting:return je.Connecting;case He.open:return je.Open;case He.closing:return je.Closing;default:return je.Closed}}isConnected(){return this.connectionState()===je.Open}channel(e,n={config:{}}){const t=new Xt(`realtime:${e}`,n,this);return this.channels.push(t),t}push(e){const{topic:n,event:t,payload:s,ref:r}=e,o=()=>{this.encode(e,a=>{var l;(l=this.conn)===null||l===void 0||l.send(a)})};this.log("push",`${n} ${t} (${r})`,s),this.isConnected()?o():this.sendBuffer.push(o)}setAuth(e){this.accessToken=e,this.channels.forEach(n=>{e&&n.updateJoinPayload({access_token:e}),n.joinedOnce&&n._isJoined()&&n._push(de.access_token,{access_token:e})})}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let n=this.channels.find(t=>t.topic===e&&(t._isJoined()||t._isJoining()));n&&(this.log("transport",`leaving duplicate topic "${e}"`),n.unsubscribe())}_remove(e){this.channels=this.channels.filter(n=>n._joinRef()!==e._joinRef())}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_endPointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:Hs}))}_onConnMessage(e){this.decode(e.data,n=>{let{topic:t,event:s,payload:r,ref:o}=n;(o&&o===this.pendingHeartbeatRef||s===(r==null?void 0:r.type))&&(this.pendingHeartbeatRef=null),this.log("receive",`${r.status||""} ${t} ${s} ${o&&"("+o+")"||""}`,r),this.channels.filter(a=>a._isMember(t)).forEach(a=>a._trigger(s,r,o)),this.stateChangeCallbacks.message.forEach(a=>a(n))})}_onConnOpen(){this.log("transport",`connected to ${this._endPointURL()}`),this._flushSendBuffer(),this.reconnectTimer.reset(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this._sendHeartbeat(),this.heartbeatIntervalMs),this.stateChangeCallbacks.open.forEach(e=>e())}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(n=>n(e))}_onConnError(e){this.log("transport",e.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(n=>n(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(de.error))}_appendParams(e,n){if(Object.keys(n).length===0)return e;const t=e.match(/\?/)?"&":"?",s=new URLSearchParams(n);return`${e}${t}${s}`}_flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(e=this.conn)===null||e===void 0||e.close(Js,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth(this.accessToken)}}}class ti{constructor(e,n,t){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=He.connecting,this.send=()=>{},this.url=null,this.url=e,this.close=t.close}}class Zt extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function re(i){return typeof i=="object"&&i!==null&&"__isStorageError"in i}class ni extends Zt{constructor(e,n){super(e),this.name="StorageApiError",this.status=n}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class Sn extends Zt{constructor(e,n){super(e),this.name="StorageUnknownError",this.originalError=n}}var ri=function(i,e,n,t){function s(r){return r instanceof n?r:new n(function(o){o(r)})}return new(n||(n=Promise))(function(r,o){function a(c){try{u(t.next(c))}catch(h){o(h)}}function l(c){try{u(t.throw(c))}catch(h){o(h)}}function u(c){c.done?r(c.value):s(c.value).then(a,l)}u((t=t.apply(i,e||[])).next())})};const Or=i=>{let e;return i?e=i:typeof fetch>"u"?e=(...n)=>Ke(()=>Promise.resolve().then(()=>at),void 0,import.meta.url).then(({default:t})=>t(...n)):e=fetch,(...n)=>e(...n)},si=()=>ri(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Ke(()=>Promise.resolve().then(()=>at),void 0,import.meta.url)).Response:Response});var Ye=function(i,e,n,t){function s(r){return r instanceof n?r:new n(function(o){o(r)})}return new(n||(n=Promise))(function(r,o){function a(c){try{u(t.next(c))}catch(h){o(h)}}function l(c){try{u(t.throw(c))}catch(h){o(h)}}function u(c){c.done?r(c.value):s(c.value).then(a,l)}u((t=t.apply(i,e||[])).next())})};const Pt=i=>i.msg||i.message||i.error_description||i.error||JSON.stringify(i),ii=(i,e)=>Ye(void 0,void 0,void 0,function*(){const n=yield si();i instanceof n?i.json().then(t=>{e(new ni(Pt(t),i.status||500))}).catch(t=>{e(new Sn(Pt(t),t))}):e(new Sn(Pt(i),i))}),oi=(i,e,n,t)=>{const s={method:i,headers:(e==null?void 0:e.headers)||{}};return i==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),s.body=JSON.stringify(t),Object.assign(Object.assign({},s),n))};function vt(i,e,n,t,s,r){return Ye(this,void 0,void 0,function*(){return new Promise((o,a)=>{i(n,oi(e,t,s,r)).then(l=>{if(!l.ok)throw l;return t!=null&&t.noResolveJson?l:l.json()}).then(l=>o(l)).catch(l=>ii(l,a))})})}function zt(i,e,n,t){return Ye(this,void 0,void 0,function*(){return vt(i,"GET",e,n,t)})}function be(i,e,n,t,s){return Ye(this,void 0,void 0,function*(){return vt(i,"POST",e,t,s,n)})}function ai(i,e,n,t,s){return Ye(this,void 0,void 0,function*(){return vt(i,"PUT",e,t,s,n)})}function Ar(i,e,n,t,s){return Ye(this,void 0,void 0,function*(){return vt(i,"DELETE",e,t,s,n)})}var fe=function(i,e,n,t){function s(r){return r instanceof n?r:new n(function(o){o(r)})}return new(n||(n=Promise))(function(r,o){function a(c){try{u(t.next(c))}catch(h){o(h)}}function l(c){try{u(t.throw(c))}catch(h){o(h)}}function u(c){c.done?r(c.value):s(c.value).then(a,l)}u((t=t.apply(i,e||[])).next())})};const li={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},En={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class ui{constructor(e,n={},t,s){this.url=e,this.headers=n,this.bucketId=t,this.fetch=Or(s)}uploadOrUpdate(e,n,t,s){return fe(this,void 0,void 0,function*(){try{let r;const o=Object.assign(Object.assign({},En),s),a=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(o.upsert)});typeof Blob<"u"&&t instanceof Blob?(r=new FormData,r.append("cacheControl",o.cacheControl),r.append("",t)):typeof FormData<"u"&&t instanceof FormData?(r=t,r.append("cacheControl",o.cacheControl)):(r=t,a["cache-control"]=`max-age=${o.cacheControl}`,a["content-type"]=o.contentType);const l=this._removeEmptyFolders(n),u=this._getFinalPath(l),c=yield this.fetch(`${this.url}/object/${u}`,Object.assign({method:e,body:r,headers:a},o!=null&&o.duplex?{duplex:o.duplex}:{})),h=yield c.json();return c.ok?{data:{path:l,id:h.Id,fullPath:h.Key},error:null}:{data:null,error:h}}catch(r){if(re(r))return{data:null,error:r};throw r}})}upload(e,n,t){return fe(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,n,t)})}uploadToSignedUrl(e,n,t,s){return fe(this,void 0,void 0,function*(){const r=this._removeEmptyFolders(e),o=this._getFinalPath(r),a=new URL(this.url+`/object/upload/sign/${o}`);a.searchParams.set("token",n);try{let l;const u=Object.assign({upsert:En.upsert},s),c=Object.assign(Object.assign({},this.headers),{"x-upsert":String(u.upsert)});typeof Blob<"u"&&t instanceof Blob?(l=new FormData,l.append("cacheControl",u.cacheControl),l.append("",t)):typeof FormData<"u"&&t instanceof FormData?(l=t,l.append("cacheControl",u.cacheControl)):(l=t,c["cache-control"]=`max-age=${u.cacheControl}`,c["content-type"]=u.contentType);const h=yield this.fetch(a.toString(),{method:"PUT",body:l,headers:c}),d=yield h.json();return h.ok?{data:{path:r,fullPath:d.Key},error:null}:{data:null,error:d}}catch(l){if(re(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(e){return fe(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e);const t=yield be(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:this.headers}),s=new URL(this.url+t.url),r=s.searchParams.get("token");if(!r)throw new Zt("No token returned by API");return{data:{signedUrl:s.toString(),path:e,token:r},error:null}}catch(n){if(re(n))return{data:null,error:n};throw n}})}update(e,n,t){return fe(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,n,t)})}move(e,n){return fe(this,void 0,void 0,function*(){try{return{data:yield be(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n},{headers:this.headers}),error:null}}catch(t){if(re(t))return{data:null,error:t};throw t}})}copy(e,n){return fe(this,void 0,void 0,function*(){try{return{data:{path:(yield be(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n},{headers:this.headers})).Key},error:null}}catch(t){if(re(t))return{data:null,error:t};throw t}})}createSignedUrl(e,n,t){return fe(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e),r=yield be(this.fetch,`${this.url}/object/sign/${s}`,Object.assign({expiresIn:n},t!=null&&t.transform?{transform:t.transform}:{}),{headers:this.headers});const o=t!=null&&t.download?`&download=${t.download===!0?"":t.download}`:"";return r={signedUrl:encodeURI(`${this.url}${r.signedURL}${o}`)},{data:r,error:null}}catch(s){if(re(s))return{data:null,error:s};throw s}})}createSignedUrls(e,n,t){return fe(this,void 0,void 0,function*(){try{const s=yield be(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:n,paths:e},{headers:this.headers}),r=t!=null&&t.download?`&download=${t.download===!0?"":t.download}`:"";return{data:s.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${r}`):null})),error:null}}catch(s){if(re(s))return{data:null,error:s};throw s}})}download(e,n){return fe(this,void 0,void 0,function*(){const s=typeof(n==null?void 0:n.transform)<"u"?"render/image/authenticated":"object",r=this.transformOptsToQueryString((n==null?void 0:n.transform)||{}),o=r?`?${r}`:"";try{const a=this._getFinalPath(e);return{data:yield(yield zt(this.fetch,`${this.url}/${s}/${a}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(a){if(re(a))return{data:null,error:a};throw a}})}getPublicUrl(e,n){const t=this._getFinalPath(e),s=[],r=n!=null&&n.download?`download=${n.download===!0?"":n.download}`:"";r!==""&&s.push(r);const a=typeof(n==null?void 0:n.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((n==null?void 0:n.transform)||{});l!==""&&s.push(l);let u=s.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${a}/public/${t}${u}`)}}}remove(e){return fe(this,void 0,void 0,function*(){try{return{data:yield Ar(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(n){if(re(n))return{data:null,error:n};throw n}})}list(e,n,t){return fe(this,void 0,void 0,function*(){try{const s=Object.assign(Object.assign(Object.assign({},li),n),{prefix:e||""});return{data:yield be(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},t),error:null}}catch(s){if(re(s))return{data:null,error:s};throw s}})}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const n=[];return e.width&&n.push(`width=${e.width}`),e.height&&n.push(`height=${e.height}`),e.resize&&n.push(`resize=${e.resize}`),e.format&&n.push(`format=${e.format}`),e.quality&&n.push(`quality=${e.quality}`),n.join("&")}}const ci="2.5.5",fi={"X-Client-Info":`storage-js/${ci}`};var qe=function(i,e,n,t){function s(r){return r instanceof n?r:new n(function(o){o(r)})}return new(n||(n=Promise))(function(r,o){function a(c){try{u(t.next(c))}catch(h){o(h)}}function l(c){try{u(t.throw(c))}catch(h){o(h)}}function u(c){c.done?r(c.value):s(c.value).then(a,l)}u((t=t.apply(i,e||[])).next())})};class hi{constructor(e,n={},t){this.url=e,this.headers=Object.assign(Object.assign({},fi),n),this.fetch=Or(t)}listBuckets(){return qe(this,void 0,void 0,function*(){try{return{data:yield zt(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(re(e))return{data:null,error:e};throw e}})}getBucket(e){return qe(this,void 0,void 0,function*(){try{return{data:yield zt(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(n){if(re(n))return{data:null,error:n};throw n}})}createBucket(e,n={public:!1}){return qe(this,void 0,void 0,function*(){try{return{data:yield be(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(t){if(re(t))return{data:null,error:t};throw t}})}updateBucket(e,n){return qe(this,void 0,void 0,function*(){try{return{data:yield ai(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(t){if(re(t))return{data:null,error:t};throw t}})}emptyBucket(e){return qe(this,void 0,void 0,function*(){try{return{data:yield be(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(n){if(re(n))return{data:null,error:n};throw n}})}deleteBucket(e){return qe(this,void 0,void 0,function*(){try{return{data:yield Ar(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(n){if(re(n))return{data:null,error:n};throw n}})}}class di extends hi{constructor(e,n={},t){super(e,n,t)}from(e){return new ui(this.url,this.headers,e,this.fetch)}}const pi="2.43.4";let Ze="";typeof Deno<"u"?Ze="deno":typeof document<"u"?Ze="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Ze="react-native":Ze="node";const mi={"X-Client-Info":`supabase-js-${Ze}/${pi}`},_i={headers:mi},gi={schema:"public"},$i={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},bi={};var wi=function(i,e,n,t){function s(r){return r instanceof n?r:new n(function(o){o(r)})}return new(n||(n=Promise))(function(r,o){function a(c){try{u(t.next(c))}catch(h){o(h)}}function l(c){try{u(t.throw(c))}catch(h){o(h)}}function u(c){c.done?r(c.value):s(c.value).then(a,l)}u((t=t.apply(i,e||[])).next())})};const vi=i=>{let e;return i?e=i:typeof fetch>"u"?e=Qt:e=fetch,(...n)=>e(...n)},ki=()=>typeof Headers>"u"?yr:Headers,yi=(i,e,n)=>{const t=vi(n),s=ki();return(r,o)=>wi(void 0,void 0,void 0,function*(){var a;const l=(a=yield e())!==null&&a!==void 0?a:i;let u=new s(o==null?void 0:o.headers);return u.has("apikey")||u.set("apikey",i),u.has("Authorization")||u.set("Authorization",`Bearer ${l}`),t(r,Object.assign(Object.assign({},o),{headers:u}))})};function Ci(i){return i.replace(/\/$/,"")}function Si(i,e){const{db:n,auth:t,realtime:s,global:r}=i,{db:o,auth:a,realtime:l,global:u}=e;return{db:Object.assign(Object.assign({},o),n),auth:Object.assign(Object.assign({},a),t),realtime:Object.assign(Object.assign({},l),s),global:Object.assign(Object.assign({},u),r)}}const Tr="2.64.2",Ei="http://localhost:9999",Oi="supabase.auth.token",Ai={"X-Client-Info":`gotrue-js/${Tr}`},On=10,Ht="X-Supabase-Api-Version",jr={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}};function Ti(i){return Math.round(Date.now()/1e3)+i}function ji(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(i){const e=Math.random()*16|0;return(i=="x"?e:e&3|8).toString(16)})}const he=()=>typeof document<"u",Oe={tested:!1,writable:!1},tt=()=>{if(!he())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Oe.tested)return Oe.writable;const i=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(i,i),globalThis.localStorage.removeItem(i),Oe.tested=!0,Oe.writable=!0}catch{Oe.tested=!0,Oe.writable=!1}return Oe.writable};function It(i){const e={},n=new URL(i);if(n.hash&&n.hash[0]==="#")try{new URLSearchParams(n.hash.substring(1)).forEach((s,r)=>{e[r]=s})}catch{}return n.searchParams.forEach((t,s)=>{e[s]=t}),e}const Pr=i=>{let e;return i?e=i:typeof fetch>"u"?e=(...n)=>Ke(()=>Promise.resolve().then(()=>at),void 0,import.meta.url).then(({default:t})=>t(...n)):e=fetch,(...n)=>e(...n)},Pi=i=>typeof i=="object"&&i!==null&&"status"in i&&"ok"in i&&"json"in i&&typeof i.json=="function",Ir=async(i,e,n)=>{await i.setItem(e,JSON.stringify(n))},ft=async(i,e)=>{const n=await i.getItem(e);if(!n)return null;try{return JSON.parse(n)}catch{return n}},Rt=async(i,e)=>{await i.removeItem(e)};function Ii(i){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let n="",t,s,r,o,a,l,u,c=0;for(i=i.replace("-","+").replace("_","/");c<i.length;)o=e.indexOf(i.charAt(c++)),a=e.indexOf(i.charAt(c++)),l=e.indexOf(i.charAt(c++)),u=e.indexOf(i.charAt(c++)),t=o<<2|a>>4,s=(a&15)<<4|l>>2,r=(l&3)<<6|u,n=n+String.fromCharCode(t),l!=64&&s!=0&&(n=n+String.fromCharCode(s)),u!=64&&r!=0&&(n=n+String.fromCharCode(r));return n}class kt{constructor(){this.promise=new kt.promiseConstructor((e,n)=>{this.resolve=e,this.reject=n})}}kt.promiseConstructor=Promise;function An(i){const e=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}=?$|[a-z0-9_-]{2}(==)?$)$/i,n=i.split(".");if(n.length!==3)throw new Error("JWT is not valid: not a JWT structure");if(!e.test(n[1]))throw new Error("JWT is not valid: payload is not in base64url format");const t=n[1];return JSON.parse(Ii(t))}async function Ri(i){return await new Promise(e=>{setTimeout(()=>e(null),i)})}function Li(i,e){return new Promise((t,s)=>{(async()=>{for(let r=0;r<1/0;r++)try{const o=await i(r);if(!e(r,null,o)){t(o);return}}catch(o){if(!e(r,o)){s(o);return}}})()})}function Di(i){return("0"+i.toString(16)).substr(-2)}function Ui(){const e=new Uint32Array(56);if(typeof crypto>"u"){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",t=n.length;let s="";for(let r=0;r<56;r++)s+=n.charAt(Math.floor(Math.random()*t));return s}return crypto.getRandomValues(e),Array.from(e,Di).join("")}async function qi(i){const n=new TextEncoder().encode(i),t=await crypto.subtle.digest("SHA-256",n),s=new Uint8Array(t);return Array.from(s).map(r=>String.fromCharCode(r)).join("")}function Ni(i){return btoa(i).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Bi(i){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),i;const n=await qi(i);return Ni(n)}async function Ne(i,e,n=!1){const t=Ui();let s=t;n&&(s+="/PASSWORD_RECOVERY"),await Ir(i,`${e}-code-verifier`,s);const r=await Bi(t);return[r,t===r?"plain":"s256"]}const Mi=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Fi(i){const e=i.headers.get(Ht);if(!e||!e.match(Mi))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}class xt extends Error{constructor(e,n,t){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=n,this.code=t}}function F(i){return typeof i=="object"&&i!==null&&"__isAuthError"in i}class zi extends xt{constructor(e,n,t){super(e,n,t),this.name="AuthApiError",this.status=n,this.code=t}}function Hi(i){return F(i)&&i.name==="AuthApiError"}class Rr extends xt{constructor(e,n){super(e),this.name="AuthUnknownError",this.originalError=n}}class Re extends xt{constructor(e,n,t,s){super(e,t,s),this.name=n,this.status=t}}class Ae extends Re{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}class Lt extends Re{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class ht extends Re{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class dt extends Re{constructor(e,n=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Tn extends Re{constructor(e,n=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Jt extends Re{constructor(e,n){super(e,"AuthRetryableFetchError",n,void 0)}}function Dt(i){return F(i)&&i.name==="AuthRetryableFetchError"}class jn extends Re{constructor(e,n,t){super(e,"AuthWeakPasswordError",n,"weak_password"),this.reasons=t}}var Ji=function(i,e){var n={};for(var t in i)Object.prototype.hasOwnProperty.call(i,t)&&e.indexOf(t)<0&&(n[t]=i[t]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,t=Object.getOwnPropertySymbols(i);s<t.length;s++)e.indexOf(t[s])<0&&Object.prototype.propertyIsEnumerable.call(i,t[s])&&(n[t[s]]=i[t[s]]);return n};const Te=i=>i.msg||i.message||i.error_description||i.error||JSON.stringify(i),Ki=[502,503,504];async function Pn(i){var e;if(!Pi(i))throw new Jt(Te(i),0);if(Ki.includes(i.status))throw new Jt(Te(i),i.status);let n;try{n=await i.json()}catch(r){throw new Rr(Te(r),r)}let t;const s=Fi(i);if(s&&s.getTime()>=jr["2024-01-01"].timestamp&&typeof n=="object"&&n&&typeof n.code=="string"?t=n.code:typeof n=="object"&&n&&typeof n.error_code=="string"&&(t=n.error_code),t){if(t==="weak_password")throw new jn(Te(n),i.status,((e=n.weak_password)===null||e===void 0?void 0:e.reasons)||[])}else if(typeof n=="object"&&n&&typeof n.weak_password=="object"&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((r,o)=>r&&typeof o=="string",!0))throw new jn(Te(n),i.status,n.weak_password.reasons);throw new zi(Te(n),i.status||500,t)}const Gi=(i,e,n,t)=>{const s={method:i,headers:(e==null?void 0:e.headers)||{}};return i==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),s.body=JSON.stringify(t),Object.assign(Object.assign({},s),n))};async function z(i,e,n,t){var s;const r=Object.assign({},t==null?void 0:t.headers);r[Ht]||(r[Ht]=jr["2024-01-01"].name),t!=null&&t.jwt&&(r.Authorization=`Bearer ${t.jwt}`);const o=(s=t==null?void 0:t.query)!==null&&s!==void 0?s:{};t!=null&&t.redirectTo&&(o.redirect_to=t.redirectTo);const a=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",l=await Vi(i,e,n+a,{headers:r,noResolveJson:t==null?void 0:t.noResolveJson},{},t==null?void 0:t.body);return t!=null&&t.xform?t==null?void 0:t.xform(l):{data:Object.assign({},l),error:null}}async function Vi(i,e,n,t,s,r){const o=Gi(e,t,s,r);let a;try{a=await i(n,Object.assign({},o))}catch(l){throw console.error(l),new Jt(Te(l),0)}if(a.ok||await Pn(a),t!=null&&t.noResolveJson)return a;try{return await a.json()}catch(l){await Pn(l)}}function $e(i){var e;let n=null;Xi(i)&&(n=Object.assign({},i),i.expires_at||(n.expires_at=Ti(i.expires_in)));const t=(e=i.user)!==null&&e!==void 0?e:i;return{data:{session:n,user:t},error:null}}function In(i){const e=$e(i);return!e.error&&i.weak_password&&typeof i.weak_password=="object"&&Array.isArray(i.weak_password.reasons)&&i.weak_password.reasons.length&&i.weak_password.message&&typeof i.weak_password.message=="string"&&i.weak_password.reasons.reduce((n,t)=>n&&typeof t=="string",!0)&&(e.data.weak_password=i.weak_password),e}function we(i){var e;return{data:{user:(e=i.user)!==null&&e!==void 0?e:i},error:null}}function Wi(i){return{data:i,error:null}}function Qi(i){const{action_link:e,email_otp:n,hashed_token:t,redirect_to:s,verification_type:r}=i,o=Ji(i,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),a={action_link:e,email_otp:n,hashed_token:t,redirect_to:s,verification_type:r},l=Object.assign({},o);return{data:{properties:a,user:l},error:null}}function Yi(i){return i}function Xi(i){return i.access_token&&i.refresh_token&&i.expires_in}var Zi=function(i,e){var n={};for(var t in i)Object.prototype.hasOwnProperty.call(i,t)&&e.indexOf(t)<0&&(n[t]=i[t]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,t=Object.getOwnPropertySymbols(i);s<t.length;s++)e.indexOf(t[s])<0&&Object.prototype.propertyIsEnumerable.call(i,t[s])&&(n[t[s]]=i[t[s]]);return n};class xi{constructor({url:e="",headers:n={},fetch:t}){this.url=e,this.headers=n,this.fetch=Pr(t),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,n="global"){try{return await z(this.fetch,"POST",`${this.url}/logout?scope=${n}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(t){if(F(t))return{data:null,error:t};throw t}}async inviteUserByEmail(e,n={}){try{return await z(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:n.data},headers:this.headers,redirectTo:n.redirectTo,xform:we})}catch(t){if(F(t))return{data:{user:null},error:t};throw t}}async generateLink(e){try{const{options:n}=e,t=Zi(e,["options"]),s=Object.assign(Object.assign({},t),n);return"newEmail"in t&&(s.new_email=t==null?void 0:t.newEmail,delete s.newEmail),await z(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:Qi,redirectTo:n==null?void 0:n.redirectTo})}catch(n){if(F(n))return{data:{properties:null,user:null},error:n};throw n}}async createUser(e){try{return await z(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:we})}catch(n){if(F(n))return{data:{user:null},error:n};throw n}}async listUsers(e){var n,t,s,r,o,a,l;try{const u={nextPage:null,lastPage:0,total:0},c=await z(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(t=(n=e==null?void 0:e.page)===null||n===void 0?void 0:n.toString())!==null&&t!==void 0?t:"",per_page:(r=(s=e==null?void 0:e.perPage)===null||s===void 0?void 0:s.toString())!==null&&r!==void 0?r:""},xform:Yi});if(c.error)throw c.error;const h=await c.json(),d=(o=c.headers.get("x-total-count"))!==null&&o!==void 0?o:0,f=(l=(a=c.headers.get("link"))===null||a===void 0?void 0:a.split(","))!==null&&l!==void 0?l:[];return f.length>0&&(f.forEach(p=>{const g=parseInt(p.split(";")[0].split("=")[1].substring(0,1)),S=JSON.parse(p.split(";")[1].split("=")[1]);u[`${S}Page`]=g}),u.total=parseInt(d)),{data:Object.assign(Object.assign({},h),u),error:null}}catch(u){if(F(u))return{data:{users:[]},error:u};throw u}}async getUserById(e){try{return await z(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:we})}catch(n){if(F(n))return{data:{user:null},error:n};throw n}}async updateUserById(e,n){try{return await z(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:n,headers:this.headers,xform:we})}catch(t){if(F(t))return{data:{user:null},error:t};throw t}}async deleteUser(e,n=!1){try{return await z(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:n},xform:we})}catch(t){if(F(t))return{data:{user:null},error:t};throw t}}async _listFactors(e){try{const{data:n,error:t}=await z(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:n,error:t}}catch(n){if(F(n))return{data:null,error:n};throw n}}async _deleteFactor(e){try{return{data:await z(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(n){if(F(n))return{data:null,error:n};throw n}}}const eo={getItem:i=>tt()?globalThis.localStorage.getItem(i):null,setItem:(i,e)=>{tt()&&globalThis.localStorage.setItem(i,e)},removeItem:i=>{tt()&&globalThis.localStorage.removeItem(i)}};function Rn(i={}){return{getItem:e=>i[e]||null,setItem:(e,n)=>{i[e]=n},removeItem:e=>{delete i[e]}}}function to(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Be={debug:!!(globalThis&&tt()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Lr extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class no extends Lr{}async function ro(i,e,n){Be.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",i,e);const t=new globalThis.AbortController;return e>0&&setTimeout(()=>{t.abort(),Be.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",i)},e),await globalThis.navigator.locks.request(i,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:t.signal},async s=>{if(s){Be.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",i,s.name);try{return await n()}finally{Be.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",i,s.name)}}else{if(e===0)throw Be.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",i),new no(`Acquiring an exclusive Navigator LockManager lock "${i}" immediately failed`);if(Be.debug)try{const r=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(r,null,"  "))}catch(r){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",r)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}})}to();const so={url:Ei,storageKey:Oi,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Ai,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1},Xe=30*1e3,Ln=3;async function Dn(i,e,n){return await n()}class st{constructor(e){var n,t;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=st.nextInstanceID,st.nextInstanceID+=1,this.instanceID>0&&he()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const s=Object.assign(Object.assign({},so),e);if(this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.persistSession=s.persistSession,this.storageKey=s.storageKey,this.autoRefreshToken=s.autoRefreshToken,this.admin=new xi({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=Pr(s.fetch),this.lock=s.lock||Dn,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,s.lock?this.lock=s.lock:he()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=ro:this.lock=Dn,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?s.storage?this.storage=s.storage:tt()?this.storage=eo:(this.memoryStorage={},this.storage=Rn(this.memoryStorage)):(this.memoryStorage={},this.storage=Rn(this.memoryStorage)),he()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(r){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",r)}(t=this.broadcastChannel)===null||t===void 0||t.addEventListener("message",async r=>{this._debug("received broadcast notification from other tab or client",r),await this._notifyAllSubscribers(r.data.event,r.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Tr}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){try{const e=he()?await this._isPKCEFlow():!1;if(this._debug("#_initialize()","begin","is PKCE flow",e),e||this.detectSessionInUrl&&this._isImplicitGrantFlow()){const{data:n,error:t}=await this._getSessionFromURL(e);if(t)return this._debug("#_initialize()","error detecting session from URL",t),(t==null?void 0:t.message)==="Identity is already linked"||(t==null?void 0:t.message)==="Identity is already linked to another user"?{error:t}:(await this._removeSession(),{error:t});const{session:s,redirectType:r}=n;return this._debug("#_initialize()","detected session in URL",s,"redirect type",r),await this._saveSession(s),setTimeout(async()=>{r==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",s):await this._notifyAllSubscribers("SIGNED_IN",s)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(e){return F(e)?{error:e}:{error:new Rr("Unexpected error during initialization",e)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var n,t,s;try{await this._removeSession();const r=await z(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(t=(n=e==null?void 0:e.options)===null||n===void 0?void 0:n.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:(s=e==null?void 0:e.options)===null||s===void 0?void 0:s.captchaToken}},xform:$e}),{data:o,error:a}=r;if(a||!o)return{data:{user:null,session:null},error:a};const l=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:u,session:l},error:null}}catch(r){if(F(r))return{data:{user:null,session:null},error:r};throw r}}async signUp(e){var n,t,s;try{await this._removeSession();let r;if("email"in e){const{email:c,password:h,options:d}=e;let f=null,p=null;this.flowType==="pkce"&&([f,p]=await Ne(this.storage,this.storageKey)),r=await z(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:d==null?void 0:d.emailRedirectTo,body:{email:c,password:h,data:(n=d==null?void 0:d.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken},code_challenge:f,code_challenge_method:p},xform:$e})}else if("phone"in e){const{phone:c,password:h,options:d}=e;r=await z(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:c,password:h,data:(t=d==null?void 0:d.data)!==null&&t!==void 0?t:{},channel:(s=d==null?void 0:d.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken}},xform:$e})}else throw new ht("You must provide either an email or phone number and a password");const{data:o,error:a}=r;if(a||!o)return{data:{user:null,session:null},error:a};const l=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:u,session:l},error:null}}catch(r){if(F(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithPassword(e){try{await this._removeSession();let n;if("email"in e){const{email:r,password:o,options:a}=e;n=await z(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:r,password:o,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:In})}else if("phone"in e){const{phone:r,password:o,options:a}=e;n=await z(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:r,password:o,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:In})}else throw new ht("You must provide either an email or phone number and a password");const{data:t,error:s}=n;return s?{data:{user:null,session:null},error:s}:!t||!t.session||!t.user?{data:{user:null,session:null},error:new Lt}:(t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),{data:Object.assign({user:t.user,session:t.session},t.weak_password?{weakPassword:t.weak_password}:null),error:s})}catch(n){if(F(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOAuth(e){var n,t,s,r;return await this._removeSession(),await this._handleProviderSignIn(e.provider,{redirectTo:(n=e.options)===null||n===void 0?void 0:n.redirectTo,scopes:(t=e.options)===null||t===void 0?void 0:t.scopes,queryParams:(s=e.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(r=e.options)===null||r===void 0?void 0:r.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async _exchangeCodeForSession(e){const n=await ft(this.storage,`${this.storageKey}-code-verifier`),[t,s]=(n??"").split("/"),{data:r,error:o}=await z(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:t},xform:$e});return await Rt(this.storage,`${this.storageKey}-code-verifier`),o?{data:{user:null,session:null,redirectType:null},error:o}:!r||!r.session||!r.user?{data:{user:null,session:null,redirectType:null},error:new Lt}:(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign(Object.assign({},r),{redirectType:s??null}),error:o})}async signInWithIdToken(e){await this._removeSession();try{const{options:n,provider:t,token:s,access_token:r,nonce:o}=e,a=await z(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:t,id_token:s,access_token:r,nonce:o,gotrue_meta_security:{captcha_token:n==null?void 0:n.captchaToken}},xform:$e}),{data:l,error:u}=a;return u?{data:{user:null,session:null},error:u}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new Lt}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:u})}catch(n){if(F(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOtp(e){var n,t,s,r,o;try{if(await this._removeSession(),"email"in e){const{email:a,options:l}=e;let u=null,c=null;this.flowType==="pkce"&&([u,c]=await Ne(this.storage,this.storageKey));const{error:h}=await z(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:a,data:(n=l==null?void 0:l.data)!==null&&n!==void 0?n:{},create_user:(t=l==null?void 0:l.shouldCreateUser)!==null&&t!==void 0?t:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:u,code_challenge_method:c},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:h}}if("phone"in e){const{phone:a,options:l}=e,{data:u,error:c}=await z(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:a,data:(s=l==null?void 0:l.data)!==null&&s!==void 0?s:{},create_user:(r=l==null?void 0:l.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(o=l==null?void 0:l.channel)!==null&&o!==void 0?o:"sms"}});return{data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:c}}throw new ht("You must provide either an email or phone number.")}catch(a){if(F(a))return{data:{user:null,session:null},error:a};throw a}}async verifyOtp(e){var n,t;try{e.type!=="email_change"&&e.type!=="phone_change"&&await this._removeSession();let s,r;"options"in e&&(s=(n=e.options)===null||n===void 0?void 0:n.redirectTo,r=(t=e.options)===null||t===void 0?void 0:t.captchaToken);const{data:o,error:a}=await z(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:r}}),redirectTo:s,xform:$e});if(a)throw a;if(!o)throw new Error("An error occurred on token verification.");const l=o.session,u=o.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:u,session:l},error:null}}catch(s){if(F(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithSSO(e){var n,t,s;try{await this._removeSession();let r=null,o=null;return this.flowType==="pkce"&&([r,o]=await Ne(this.storage,this.storageKey)),await z(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(t=(n=e.options)===null||n===void 0?void 0:n.redirectTo)!==null&&t!==void 0?t:void 0}),!((s=e==null?void 0:e.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:r,code_challenge_method:o}),headers:this.headers,xform:Wi})}catch(r){if(F(r))return{data:null,error:r};throw r}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:n},error:t}=e;if(t)throw t;if(!n)throw new Ae;const{error:s}=await z(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:n.access_token});return{data:{user:null,session:null},error:s}})}catch(e){if(F(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{e.type!="email_change"&&e.type!="phone_change"&&await this._removeSession();const n=`${this.url}/resend`;if("email"in e){const{email:t,type:s,options:r}=e,{error:o}=await z(this.fetch,"POST",n,{headers:this.headers,body:{email:t,type:s,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},redirectTo:r==null?void 0:r.emailRedirectTo});return{data:{user:null,session:null},error:o}}else if("phone"in e){const{phone:t,type:s,options:r}=e,{data:o,error:a}=await z(this.fetch,"POST",n,{headers:this.headers,body:{phone:t,type:s,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}}});return{data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:a}}throw new ht("You must provide either an email or phone number and a type")}catch(n){if(F(n))return{data:{user:null,session:null},error:n};throw n}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async n=>n))}async _acquireLock(e,n){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const t=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await t,await n()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const t=n();for(this.pendingInLock.push((async()=>{try{await t}catch{}})()),await t;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await t}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const n=await this.__loadSession();return await e(n)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const n=await ft(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",n),n!==null&&(this._isValidSession(n)?e=n:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const t=e.expires_at?e.expires_at<=Date.now()/1e3:!1;if(this._debug("#__loadSession()",`session has${t?"":" not"} expired`,"expires_at",e.expires_at),!t){if(this.storage.isServer){const o=this.suppressGetSessionWarning;e=new Proxy(e,{get(l,u,c){return!o&&u==="user"&&console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and many not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),Reflect.get(l,u,c)}})}return{data:{session:e},error:null}}const{session:s,error:r}=await this._callRefreshToken(e.refresh_token);return r?{data:{session:null},error:r}:{data:{session:s},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await z(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:we}):await this._useSession(async n=>{var t,s,r;const{data:o,error:a}=n;if(a)throw a;return!(!((t=o.session)===null||t===void 0)&&t.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Ae}:await z(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(r=(s=o.session)===null||s===void 0?void 0:s.access_token)!==null&&r!==void 0?r:void 0,xform:we})})}catch(n){if(F(n))return{data:{user:null},error:n};throw n}}async updateUser(e,n={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,n))}async _updateUser(e,n={}){try{return await this._useSession(async t=>{const{data:s,error:r}=t;if(r)throw r;if(!s.session)throw new Ae;const o=s.session;let a=null,l=null;this.flowType==="pkce"&&e.email!=null&&([a,l]=await Ne(this.storage,this.storageKey));const{data:u,error:c}=await z(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:n==null?void 0:n.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:a,code_challenge_method:l}),jwt:o.access_token,xform:we});if(c)throw c;return o.user=u.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}})}catch(t){if(F(t))return{data:{user:null},error:t};throw t}}_decodeJWT(e){return An(e)}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Ae;const n=Date.now()/1e3;let t=n,s=!0,r=null;const o=An(e.access_token);if(o.exp&&(t=o.exp,s=t<=n),s){const{session:a,error:l}=await this._callRefreshToken(e.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!a)return{data:{user:null,session:null},error:null};r=a}else{const{data:a,error:l}=await this._getUser(e.access_token);if(l)throw l;r={access_token:e.access_token,refresh_token:e.refresh_token,user:a.user,token_type:"bearer",expires_in:t-n,expires_at:t},await this._saveSession(r),await this._notifyAllSubscribers("SIGNED_IN",r)}return{data:{user:r.user,session:r},error:null}}catch(n){if(F(n))return{data:{session:null,user:null},error:n};throw n}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async n=>{var t;if(!e){const{data:o,error:a}=n;if(a)throw a;e=(t=o.session)!==null&&t!==void 0?t:void 0}if(!(e!=null&&e.refresh_token))throw new Ae;const{session:s,error:r}=await this._callRefreshToken(e.refresh_token);return r?{data:{user:null,session:null},error:r}:s?{data:{user:s.user,session:s},error:null}:{data:{user:null,session:null},error:null}})}catch(n){if(F(n))return{data:{user:null,session:null},error:n};throw n}}async _getSessionFromURL(e){try{if(!he())throw new dt("No browser detected.");if(this.flowType==="implicit"&&!this._isImplicitGrantFlow())throw new dt("Not a valid implicit grant flow url.");if(this.flowType=="pkce"&&!e)throw new Tn("Not a valid PKCE flow url.");const n=It(window.location.href);if(e){if(!n.code)throw new Tn("No code detected.");const{data:E,error:j}=await this._exchangeCodeForSession(n.code);if(j)throw j;const P=new URL(window.location.href);return P.searchParams.delete("code"),window.history.replaceState(window.history.state,"",P.toString()),{data:{session:E.session,redirectType:null},error:null}}if(n.error||n.error_description||n.error_code)throw new dt(n.error_description||"Error in URL with unspecified error_description",{error:n.error||"unspecified_error",code:n.error_code||"unspecified_code"});const{provider_token:t,provider_refresh_token:s,access_token:r,refresh_token:o,expires_in:a,expires_at:l,token_type:u}=n;if(!r||!a||!o||!u)throw new dt("No session defined in URL");const c=Math.round(Date.now()/1e3),h=parseInt(a);let d=c+h;l&&(d=parseInt(l));const f=d-c;f*1e3<=Xe&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${f}s, should have been closer to ${h}s`);const p=d-h;c-p>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",p,d,c):c-p<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clok for skew",p,d,c);const{data:g,error:S}=await this._getUser(r);if(S)throw S;const T={provider_token:t,provider_refresh_token:s,access_token:r,expires_in:h,expires_at:d,refresh_token:o,token_type:u,user:g.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:T,redirectType:n.type},error:null}}catch(n){if(F(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantFlow(){const e=It(window.location.href);return!!(he()&&(e.access_token||e.error_description))}async _isPKCEFlow(){const e=It(window.location.href),n=await ft(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&n)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async n=>{var t;const{data:s,error:r}=n;if(r)return{error:r};const o=(t=s.session)===null||t===void 0?void 0:t.access_token;if(o){const{error:a}=await this.admin.signOut(o,e);if(a&&!(Hi(a)&&(a.status===404||a.status===401||a.status===403)))return{error:a}}return e!=="others"&&(await this._removeSession(),await Rt(this.storage,`${this.storageKey}-code-verifier`),await this._notifyAllSubscribers("SIGNED_OUT",null)),{error:null}})}onAuthStateChange(e){const n=ji(),t={id:n,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",n),this.stateChangeEmitters.delete(n)}};return this._debug("#onAuthStateChange()","registered callback with id",n),this.stateChangeEmitters.set(n,t),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(n)})))(),{data:{subscription:t}}}async _emitInitialSession(e){return await this._useSession(async n=>{var t,s;try{const{data:{session:r},error:o}=n;if(o)throw o;await((t=this.stateChangeEmitters.get(e))===null||t===void 0?void 0:t.callback("INITIAL_SESSION",r)),this._debug("INITIAL_SESSION","callback id",e,"session",r)}catch(r){await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",r),console.error(r)}})}async resetPasswordForEmail(e,n={}){let t=null,s=null;this.flowType==="pkce"&&([t,s]=await Ne(this.storage,this.storageKey,!0));try{return await z(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:t,code_challenge_method:s,gotrue_meta_security:{captcha_token:n.captchaToken}},headers:this.headers,redirectTo:n.redirectTo})}catch(r){if(F(r))return{data:null,error:r};throw r}}async getUserIdentities(){var e;try{const{data:n,error:t}=await this.getUser();if(t)throw t;return{data:{identities:(e=n.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(n){if(F(n))return{data:null,error:n};throw n}}async linkIdentity(e){var n;try{const{data:t,error:s}=await this._useSession(async r=>{var o,a,l,u,c;const{data:h,error:d}=r;if(d)throw d;const f=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(a=e.options)===null||a===void 0?void 0:a.scopes,queryParams:(l=e.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await z(this.fetch,"GET",f,{headers:this.headers,jwt:(c=(u=h.session)===null||u===void 0?void 0:u.access_token)!==null&&c!==void 0?c:void 0})});if(s)throw s;return he()&&!(!((n=e.options)===null||n===void 0)&&n.skipBrowserRedirect)&&window.location.assign(t==null?void 0:t.url),{data:{provider:e.provider,url:t==null?void 0:t.url},error:null}}catch(t){if(F(t))return{data:{provider:e.provider,url:null},error:t};throw t}}async unlinkIdentity(e){try{return await this._useSession(async n=>{var t,s;const{data:r,error:o}=n;if(o)throw o;return await z(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(s=(t=r.session)===null||t===void 0?void 0:t.access_token)!==null&&s!==void 0?s:void 0})})}catch(n){if(F(n))return{data:null,error:n};throw n}}async _refreshAccessToken(e){const n=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{const t=Date.now();return await Li(async s=>(s>0&&await Ri(200*Math.pow(2,s-1)),this._debug(n,"refreshing attempt",s),await z(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:$e})),(s,r)=>{const o=200*Math.pow(2,s);return r&&Dt(r)&&Date.now()+o-t<Xe})}catch(t){if(this._debug(n,"error",t),F(t))return{data:{session:null,user:null},error:t};throw t}finally{this._debug(n,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,n){const t=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:n.redirectTo,scopes:n.scopes,queryParams:n.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",n,"url",t),he()&&!n.skipBrowserRedirect&&window.location.assign(t),{data:{provider:e,url:t},error:null}}async _recoverAndRefresh(){var e;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const t=await ft(this.storage,this.storageKey);if(this._debug(n,"session from storage",t),!this._isValidSession(t)){this._debug(n,"session is not valid"),t!==null&&await this._removeSession();return}const s=Math.round(Date.now()/1e3),r=((e=t.expires_at)!==null&&e!==void 0?e:1/0)<s+On;if(this._debug(n,`session has${r?"":" not"} expired with margin of ${On}s`),r){if(this.autoRefreshToken&&t.refresh_token){const{error:o}=await this._callRefreshToken(t.refresh_token);o&&(console.error(o),Dt(o)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",t)}catch(t){this._debug(n,"error",t),console.error(t);return}finally{this._debug(n,"end")}}async _callRefreshToken(e){var n,t;if(!e)throw new Ae;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new kt;const{data:r,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!r.session)throw new Ae;await this._saveSession(r.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",r.session);const a={session:r.session,error:null};return this.refreshingDeferred.resolve(a),a}catch(r){if(this._debug(s,"error",r),F(r)){const o={session:null,error:r};return Dt(r)||(await this._removeSession(),await this._notifyAllSubscribers("SIGNED_OUT",null)),(n=this.refreshingDeferred)===null||n===void 0||n.resolve(o),o}throw(t=this.refreshingDeferred)===null||t===void 0||t.reject(r),r}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(e,n,t=!0){const s=`#_notifyAllSubscribers(${e})`;this._debug(s,"begin",n,`broadcast = ${t}`);try{this.broadcastChannel&&t&&this.broadcastChannel.postMessage({event:e,session:n});const r=[],o=Array.from(this.stateChangeEmitters.values()).map(async a=>{try{await a.callback(e,n)}catch(l){r.push(l)}});if(await Promise.all(o),r.length>0){for(let a=0;a<r.length;a+=1)console.error(r[a]);throw r[0]}}finally{this._debug(s,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await Ir(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await Rt(this.storage,this.storageKey)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&he()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(n){console.error("removing visibilitychange callback failed",n)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Xe);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async n=>{const{data:{session:t}}=n;if(!t||!t.refresh_token||!t.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((t.expires_at*1e3-e)/Xe);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${Xe}ms, refresh threshold is ${Ln} ticks`),s<=Ln&&await this._callRefreshToken(t.refresh_token)})}catch(n){console.error("Auto refresh tick failed with error. This is likely a transient error.",n)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof Lr)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!he()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const n=`#_onVisibilityChanged(${e})`;this._debug(n,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(n,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,n,t){const s=[`provider=${encodeURIComponent(n)}`];if(t!=null&&t.redirectTo&&s.push(`redirect_to=${encodeURIComponent(t.redirectTo)}`),t!=null&&t.scopes&&s.push(`scopes=${encodeURIComponent(t.scopes)}`),this.flowType==="pkce"){const[r,o]=await Ne(this.storage,this.storageKey),a=new URLSearchParams({code_challenge:`${encodeURIComponent(r)}`,code_challenge_method:`${encodeURIComponent(o)}`});s.push(a.toString())}if(t!=null&&t.queryParams){const r=new URLSearchParams(t.queryParams);s.push(r.toString())}return t!=null&&t.skipBrowserRedirect&&s.push(`skip_http_redirect=${t.skipBrowserRedirect}`),`${e}?${s.join("&")}`}async _unenroll(e){try{return await this._useSession(async n=>{var t;const{data:s,error:r}=n;return r?{data:null,error:r}:await z(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(t=s==null?void 0:s.session)===null||t===void 0?void 0:t.access_token})})}catch(n){if(F(n))return{data:null,error:n};throw n}}async _enroll(e){try{return await this._useSession(async n=>{var t,s;const{data:r,error:o}=n;if(o)return{data:null,error:o};const{data:a,error:l}=await z(this.fetch,"POST",`${this.url}/factors`,{body:{friendly_name:e.friendlyName,factor_type:e.factorType,issuer:e.issuer},headers:this.headers,jwt:(t=r==null?void 0:r.session)===null||t===void 0?void 0:t.access_token});return l?{data:null,error:l}:(!((s=a==null?void 0:a.totp)===null||s===void 0)&&s.qr_code&&(a.totp.qr_code=`data:image/svg+xml;utf-8,${a.totp.qr_code}`),{data:a,error:null})})}catch(n){if(F(n))return{data:null,error:n};throw n}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var t;const{data:s,error:r}=n;if(r)return{data:null,error:r};const{data:o,error:a}=await z(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(t=s==null?void 0:s.session)===null||t===void 0?void 0:t.access_token});return a?{data:null,error:a}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:a})})}catch(n){if(F(n))return{data:null,error:n};throw n}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var t;const{data:s,error:r}=n;return r?{data:null,error:r}:await z(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{headers:this.headers,jwt:(t=s==null?void 0:s.session)===null||t===void 0?void 0:t.access_token})})}catch(n){if(F(n))return{data:null,error:n};throw n}})}async _challengeAndVerify(e){const{data:n,error:t}=await this._challenge({factorId:e.factorId});return t?{data:null,error:t}:await this._verify({factorId:e.factorId,challengeId:n.id,code:e.code})}async _listFactors(){const{data:{user:e},error:n}=await this.getUser();if(n)return{data:null,error:n};const t=(e==null?void 0:e.factors)||[],s=t.filter(r=>r.factor_type==="totp"&&r.status==="verified");return{data:{all:t,totp:s},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var n,t;const{data:{session:s},error:r}=e;if(r)return{data:null,error:r};if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const o=this._decodeJWT(s.access_token);let a=null;o.aal&&(a=o.aal);let l=a;((t=(n=s.user.factors)===null||n===void 0?void 0:n.filter(h=>h.status==="verified"))!==null&&t!==void 0?t:[]).length>0&&(l="aal2");const c=o.amr||[];return{data:{currentLevel:a,nextLevel:l,currentAuthenticationMethods:c},error:null}}))}}st.nextInstanceID=0;const io=st;class oo extends io{constructor(e){super(e)}}var ao=function(i,e,n,t){function s(r){return r instanceof n?r:new n(function(o){o(r)})}return new(n||(n=Promise))(function(r,o){function a(c){try{u(t.next(c))}catch(h){o(h)}}function l(c){try{u(t.throw(c))}catch(h){o(h)}}function u(c){c.done?r(c.value):s(c.value).then(a,l)}u((t=t.apply(i,e||[])).next())})};class lo{constructor(e,n,t){var s,r,o;if(this.supabaseUrl=e,this.supabaseKey=n,!e)throw new Error("supabaseUrl is required.");if(!n)throw new Error("supabaseKey is required.");const a=Ci(e);this.realtimeUrl=`${a}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${a}/auth/v1`,this.storageUrl=`${a}/storage/v1`,this.functionsUrl=`${a}/functions/v1`;const l=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,u={db:gi,realtime:bi,auth:Object.assign(Object.assign({},$i),{storageKey:l}),global:_i},c=Si(t??{},u);this.storageKey=(s=c.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(r=c.global.headers)!==null&&r!==void 0?r:{},this.auth=this._initSupabaseAuthClient((o=c.auth)!==null&&o!==void 0?o:{},this.headers,c.global.fetch),this.fetch=yi(n,this._getAccessToken.bind(this),c.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers},c.realtime)),this.rest=new Yt(`${a}/rest/v1`,{headers:this.headers,schema:c.db.schema,fetch:this.fetch}),this._listenForAuthEvents()}get functions(){return new js(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new di(this.storageUrl,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,n={},t={}){return this.rest.rpc(e,n,t)}channel(e,n={config:{}}){return this.realtime.channel(e,n)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,n;return ao(this,void 0,void 0,function*(){const{data:t}=yield this.auth.getSession();return(n=(e=t.session)===null||e===void 0?void 0:e.access_token)!==null&&n!==void 0?n:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:n,detectSessionInUrl:t,storage:s,storageKey:r,flowType:o,debug:a},l,u){var c;const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new oo({url:this.authUrl,headers:Object.assign(Object.assign({},h),l),storageKey:r,autoRefreshToken:e,persistSession:n,detectSessionInUrl:t,storage:s,flowType:o,debug:a,fetch:u,hasCustomAuthorizationHeader:(c="Authorization"in this.headers)!==null&&c!==void 0?c:!1})}_initRealtimeClient(e){return new ei(this.realtimeUrl,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((n,t)=>{this._handleTokenChanged(n,"CLIENT",t==null?void 0:t.access_token)})}_handleTokenChanged(e,n,t){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==t?(this.realtime.setAuth(t??null),this.changedAccessToken=t):e==="SIGNED_OUT"&&(this.realtime.setAuth(this.supabaseKey),n=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const Dr=(i,e,n)=>new lo(i,e,n),Ur="supabase-config",uo=()=>{const i=localStorage.getItem(Ur);if(!i)return null;const e=JSON.parse(i);return Dr(e.supabaseUrl,e.supabaseKey)};let X=uo();const co=i=>{X=Dr(i.supabaseUrl,i.supabaseKey),localStorage.setItem(Ur,JSON.stringify(i))};function fo(i){let e,n,t,s;const r=i[2].default,o=ye(r,i,i[1],null);return{c(){e=A("button"),o&&o.c(),k(e,"class","text-blue-600 hover:text-blue-700")},m(a,l){b(a,e,l),o&&o.m(e,null),n=!0,t||(s=Qe(e,"click",function(){We(i[0])&&i[0].apply(this,arguments)}),t=!0)},p(a,[l]){i=a,o&&o.p&&(!n||l&2)&&Se(o,r,i,i[1],n?Ce(r,i[1],l,null):Ee(i[1]),null)},i(a){n||(m(o,a),n=!0)},o(a){_(o,a),n=!1},d(a){a&&$(e),o&&o.d(a),t=!1,s()}}}function ho(i,e,n){let{$$slots:t={},$$scope:s}=e,{onClick:r}=e;return i.$$set=o=>{"onClick"in o&&n(0,r=o.onClick),"$$scope"in o&&n(1,s=o.$$scope)},[r,s,t]}class me extends N{constructor(e){super(),q(this,e,ho,fo,U,{onClick:0})}}function po(i){let e,n;return{c(){e=ee("svg"),n=ee("path"),k(n,"stroke-linecap","round"),k(n,"stroke-linejoin","round"),k(n,"d","m2.25 12 8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25"),k(e,"xmlns","http://www.w3.org/2000/svg"),k(e,"fill","none"),k(e,"viewBox","0 0 24 24"),k(e,"stroke-width","1.5"),k(e,"stroke","currentColor"),k(e,"class","size-6 hover:stroke-2")},m(t,s){b(t,e,s),C(e,n)},p:D,d(t){t&&$(e)}}}function mo(i){let e,n;return e=new me({props:{onClick:i[0],$$slots:{default:[po]},$$scope:{ctx:i}}}),{c(){y(e.$$.fragment)},m(t,s){w(e,t,s),n=!0},p(t,[s]){const r={};s&1&&(r.onClick=t[0]),s&2&&(r.$$scope={dirty:s,ctx:t}),e.$set(r)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function _o(i,e,n){let{onClick:t}=e;return i.$$set=s=>{"onClick"in s&&n(0,t=s.onClick)},[t]}class go extends N{constructor(e){super(),q(this,e,_o,mo,U,{onClick:0})}}function $o(i){let e,n;return{c(){e=ee("svg"),n=ee("path"),k(n,"stroke-linecap","round"),k(n,"stroke-linejoin","round"),k(n,"d","m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"),k(e,"xmlns","http://www.w3.org/2000/svg"),k(e,"fill","none"),k(e,"viewBox","0 0 24 24"),k(e,"stroke-width","1.5"),k(e,"stroke","currentColor"),k(e,"class","size-6 hover:stroke-2")},m(t,s){b(t,e,s),C(e,n)},p:D,d(t){t&&$(e)}}}function bo(i){let e,n;return e=new me({props:{onClick:i[0],$$slots:{default:[$o]},$$scope:{ctx:i}}}),{c(){y(e.$$.fragment)},m(t,s){w(e,t,s),n=!0},p(t,[s]){const r={};s&1&&(r.onClick=t[0]),s&2&&(r.$$scope={dirty:s,ctx:t}),e.$set(r)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function wo(i,e,n){let{onClick:t}=e;return i.$$set=s=>{"onClick"in s&&n(0,t=s.onClick)},[t]}class vo extends N{constructor(e){super(),q(this,e,wo,bo,U,{onClick:0})}}function ko(i){let e,n;return{c(){e=ee("svg"),n=ee("path"),k(n,"stroke-linecap","round"),k(n,"stroke-linejoin","round"),k(n,"d","M12 6.042A8.967 8.967 0 0 0 6 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 0 1 6 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 0 1 6-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0 0 18 18a8.967 8.967 0 0 0-6 2.292m0-14.25v14.25"),k(e,"xmlns","http://www.w3.org/2000/svg"),k(e,"fill","none"),k(e,"viewBox","0 0 24 24"),k(e,"stroke-width","1.5"),k(e,"stroke","currentColor"),k(e,"class","size-6 hover:stroke-2")},m(t,s){b(t,e,s),C(e,n)},p:D,d(t){t&&$(e)}}}function yo(i){let e,n;return e=new me({props:{onClick:i[0],$$slots:{default:[ko]},$$scope:{ctx:i}}}),{c(){y(e.$$.fragment)},m(t,s){w(e,t,s),n=!0},p(t,[s]){const r={};s&1&&(r.onClick=t[0]),s&2&&(r.$$scope={dirty:s,ctx:t}),e.$set(r)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function Co(i,e,n){let{onClick:t}=e;return i.$$set=s=>{"onClick"in s&&n(0,t=s.onClick)},[t]}class So extends N{constructor(e){super(),q(this,e,Co,yo,U,{onClick:0})}}function Eo(i){let e,n;return{c(){e=ee("svg"),n=ee("path"),k(n,"stroke-linecap","round"),k(n,"stroke-linejoin","round"),k(n,"d","M6 6.878V6a2.25 2.25 0 0 1 2.25-2.25h7.5A2.25 2.25 0 0 1 18 6v.878m-12 0c.235-.083.487-.128.75-.128h10.5c.263 0 .515.045.75.128m-12 0A2.25 2.25 0 0 0 4.5 9v.878m13.5-3A2.25 2.25 0 0 1 19.5 9v.878m0 0a2.246 2.246 0 0 0-.75-.128H5.25c-.263 0-.515.045-.75.128m15 0A2.25 2.25 0 0 1 21 12v6a2.25 2.25 0 0 1-2.25 2.25H5.25A2.25 2.25 0 0 1 3 18v-6c0-.98.626-1.813 1.5-2.122"),k(e,"xmlns","http://www.w3.org/2000/svg"),k(e,"fill","none"),k(e,"viewBox","0 0 24 24"),k(e,"stroke-width","1.5"),k(e,"stroke","currentColor"),k(e,"class","size-6 hover:stroke-2")},m(t,s){b(t,e,s),C(e,n)},p:D,d(t){t&&$(e)}}}function Oo(i){let e,n;return e=new me({props:{onClick:i[0],$$slots:{default:[Eo]},$$scope:{ctx:i}}}),{c(){y(e.$$.fragment)},m(t,s){w(e,t,s),n=!0},p(t,[s]){const r={};s&1&&(r.onClick=t[0]),s&2&&(r.$$scope={dirty:s,ctx:t}),e.$set(r)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function Ao(i,e,n){let{onClick:t}=e;return i.$$set=s=>{"onClick"in s&&n(0,t=s.onClick)},[t]}class To extends N{constructor(e){super(),q(this,e,Ao,Oo,U,{onClick:0})}}function jo(i){let e,n;return{c(){e=ee("svg"),n=ee("path"),k(n,"stroke-linecap","round"),k(n,"stroke-linejoin","round"),k(n,"d","M15.75 9V5.25A2.25 2.25 0 0 0 13.5 3h-6a2.25 2.25 0 0 0-2.25 2.25v13.5A2.25 2.25 0 0 0 7.5 21h6a2.25 2.25 0 0 0 2.25-2.25V15m3 0 3-3m0 0-3-3m3 3H9"),k(e,"xmlns","http://www.w3.org/2000/svg"),k(e,"fill","none"),k(e,"viewBox","0 0 24 24"),k(e,"stroke-width","1.5"),k(e,"stroke","currentColor"),k(e,"class","size-6 hover:stroke-2")},m(t,s){b(t,e,s),C(e,n)},p:D,d(t){t&&$(e)}}}function Po(i){let e,n;return e=new me({props:{onClick:i[0],$$slots:{default:[jo]},$$scope:{ctx:i}}}),{c(){y(e.$$.fragment)},m(t,s){w(e,t,s),n=!0},p(t,[s]){const r={};s&1&&(r.onClick=t[0]),s&2&&(r.$$scope={dirty:s,ctx:t}),e.$set(r)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function Io(i,e,n){let{onClick:t}=e;return i.$$set=s=>{"onClick"in s&&n(0,t=s.onClick)},[t]}class Ro extends N{constructor(e){super(),q(this,e,Io,Po,U,{onClick:0})}}function Lo(i){let e,n;return{c(){e=ee("svg"),n=ee("path"),k(n,"stroke-linecap","round"),k(n,"stroke-linejoin","round"),k(n,"d","M15.75 6a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0ZM4.501 20.118a7.5 7.5 0 0 1 14.998 0A17.933 17.933 0 0 1 12 21.75c-2.676 0-5.216-.584-7.499-1.632Z"),k(e,"xmlns","http://www.w3.org/2000/svg"),k(e,"fill","none"),k(e,"viewBox","0 0 24 24"),k(e,"stroke-width","1.5"),k(e,"stroke","currentColor"),k(e,"class","size-6 hover:stroke-2")},m(t,s){b(t,e,s),C(e,n)},p:D,d(t){t&&$(e)}}}function Do(i){let e,n;return e=new me({props:{onClick:i[0],$$slots:{default:[Lo]},$$scope:{ctx:i}}}),{c(){y(e.$$.fragment)},m(t,s){w(e,t,s),n=!0},p(t,[s]){const r={};s&1&&(r.onClick=t[0]),s&2&&(r.$$scope={dirty:s,ctx:t}),e.$set(r)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function Uo(i,e,n){let{onClick:t}=e;return i.$$set=s=>{"onClick"in s&&n(0,t=s.onClick)},[t]}class qo extends N{constructor(e){super(),q(this,e,Uo,Do,U,{onClick:0})}}function No(i){let e,n,t,s,r,o,a,l,u,c,h,d,f,p,g=i[0].email+"",S,T;return n=new go({props:{onClick:i[2]}}),s=new So({props:{onClick:i[3]}}),o=new To({props:{onClick:i[4]}}),l=new vo({props:{onClick:i[5]}}),c=new qo({props:{onClick:i[6]}}),d=new Ro({props:{onClick:i[1]}}),{c(){e=A("nav"),y(n.$$.fragment),t=O(),y(s.$$.fragment),r=O(),y(o.$$.fragment),a=O(),y(l.$$.fragment),u=O(),y(c.$$.fragment),h=O(),y(d.$$.fragment),f=O(),p=A("div"),S=L(g),k(e,"class","flex justify-end items-center gap-2 mb-4")},m(E,j){b(E,e,j),w(n,e,null),C(e,t),w(s,e,null),C(e,r),w(o,e,null),C(e,a),w(l,e,null),C(e,u),w(c,e,null),C(e,h),w(d,e,null),C(e,f),C(e,p),C(p,S),T=!0},p(E,[j]){const P={};j&2&&(P.onClick=E[1]),d.$set(P),(!T||j&1)&&g!==(g=E[0].email+"")&&B(S,g)},i(E){T||(m(n.$$.fragment,E),m(s.$$.fragment,E),m(o.$$.fragment,E),m(l.$$.fragment,E),m(c.$$.fragment,E),m(d.$$.fragment,E),T=!0)},o(E){_(n.$$.fragment,E),_(s.$$.fragment,E),_(o.$$.fragment,E),_(l.$$.fragment,E),_(c.$$.fragment,E),_(d.$$.fragment,E),T=!1},d(E){E&&$(e),v(n),v(s),v(o),v(l),v(c),v(d)}}}function Bo(i,e,n){let{user:t}=e,{onLogout:s}=e;const r=()=>J("/"),o=()=>J("/books/list"),a=()=>J("/cache"),l=()=>J("/search"),u=()=>J("/");return i.$$set=c=>{"user"in c&&n(0,t=c.user),"onLogout"in c&&n(1,s=c.onLogout)},[t,s,r,o,a,l,u]}class Mo extends N{constructor(e){super(),q(this,e,Bo,No,U,{user:0,onLogout:1})}}const se=i=>new Date(i).toLocaleString(),ce=i=>i?"":"Please enter a value!",Fo=(i,e)=>Math.floor(Math.random()*(e-i+1)+i),zo=i=>{for(let e=0;e<i.length;e++){const n=Fo(0,i.length-1);if(e===n)continue;const t=i[e];i[e]=i[n],i[n]=t}},qr=i=>(i=i.trim(),i||null);function Ho(i){let e,n,t,s;const r=i[2].default,o=ye(r,i,i[1],null);return{c(){e=A("form"),o&&o.c(),k(e,"class","flex flex-col gap-5 max-w-md")},m(a,l){b(a,e,l),o&&o.m(e,null),n=!0,t||(s=Qe(e,"submit",Kr(function(){We(i[0])&&i[0].apply(this,arguments)})),t=!0)},p(a,[l]){i=a,o&&o.p&&(!n||l&2)&&Se(o,r,i,i[1],n?Ce(r,i[1],l,null):Ee(i[1]),null)},i(a){n||(m(o,a),n=!0)},o(a){_(o,a),n=!1},d(a){a&&$(e),o&&o.d(a),t=!1,s()}}}function Jo(i,e,n){let{$$slots:t={},$$scope:s}=e,{onSubmit:r}=e;return i.$$set=o=>{"onSubmit"in o&&n(0,r=o.onSubmit),"$$scope"in o&&n(1,s=o.$$scope)},[r,s,t]}class _e extends N{constructor(e){super(),q(this,e,Jo,Ho,U,{onSubmit:0})}}function Un(i){let e,n;return{c(){e=A("p"),n=L(i[2]),k(e,"class","text-red-600 text-sm mt-1")},m(t,s){b(t,e,s),C(e,n)},p(t,s){s&4&&B(n,t[2])},d(t){t&&$(e)}}}function Ko(i){let e,n,t,s,r,o;const a=i[4].default,l=ye(a,i,i[3],null);let u=i[2]&&Un(i);return{c(){e=A("div"),n=A("label"),t=L(i[1]),s=O(),l&&l.c(),r=O(),u&&u.c(),k(n,"class","block text-gray-700 text-sm font-bold mb-2"),k(n,"for",i[0])},m(c,h){b(c,e,h),C(e,n),C(n,t),C(e,s),l&&l.m(e,null),C(e,r),u&&u.m(e,null),o=!0},p(c,[h]){(!o||h&2)&&B(t,c[1]),(!o||h&1)&&k(n,"for",c[0]),l&&l.p&&(!o||h&8)&&Se(l,a,c,c[3],o?Ce(a,c[3],h,null):Ee(c[3]),null),c[2]?u?u.p(c,h):(u=Un(c),u.c(),u.m(e,null)):u&&(u.d(1),u=null)},i(c){o||(m(l,c),o=!0)},o(c){_(l,c),o=!1},d(c){c&&$(e),l&&l.d(c),u&&u.d()}}}function Go(i,e,n){let{$$slots:t={},$$scope:s}=e,{id:r}=e,{label:o}=e,{error:a}=e;return i.$$set=l=>{"id"in l&&n(0,r=l.id),"label"in l&&n(1,o=l.label),"error"in l&&n(2,a=l.error),"$$scope"in l&&n(3,s=l.$$scope)},[r,o,a,s,t]}class en extends N{constructor(e){super(),q(this,e,Go,Ko,U,{id:0,label:1,error:2})}}function Vo(i){let e,n,t;return{c(){e=A("input"),k(e,"class","input"),k(e,"id",i[2])},m(s,r){b(s,e,r),Je(e,i[0]),n||(t=Qe(e,"input",i[4]),n=!0)},p(s,r){r&4&&k(e,"id",s[2]),r&1&&e.value!==s[0]&&Je(e,s[0])},d(s){s&&$(e),n=!1,t()}}}function Wo(i){let e,n;return e=new en({props:{id:i[2],label:i[1],error:i[3],$$slots:{default:[Vo]},$$scope:{ctx:i}}}),{c(){y(e.$$.fragment)},m(t,s){w(e,t,s),n=!0},p(t,[s]){const r={};s&4&&(r.id=t[2]),s&2&&(r.label=t[1]),s&8&&(r.error=t[3]),s&37&&(r.$$scope={dirty:s,ctx:t}),e.$set(r)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function Qo(i,e,n){let{label:t}=e,{id:s}=e,{value:r}=e,{error:o=""}=e;function a(){r=this.value,n(0,r)}return i.$$set=l=>{"label"in l&&n(1,t=l.label),"id"in l&&n(2,s=l.id),"value"in l&&n(0,r=l.value),"error"in l&&n(3,o=l.error)},[r,t,s,o,a]}class ke extends N{constructor(e){super(),q(this,e,Qo,Wo,U,{label:1,id:2,value:0,error:3})}}function Yo(i){let e,n;return e=new H({props:{label:"Save"}}),{c(){y(e.$$.fragment)},m(t,s){w(e,t,s),n=!0},p:D,i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function Xo(i){let e,n,t,s,r,o,a,l;function u(f){i[6](f)}let c={id:"url",label:"Supabase URL",error:i[1]};i[0]!==void 0&&(c.value=i[0]),e=new ke({props:c}),Z.push(()=>ne(e,"value",u));function h(f){i[7](f)}let d={id:"key",label:"Supabase key",error:i[3]};return i[2]!==void 0&&(d.value=i[2]),s=new ke({props:d}),Z.push(()=>ne(s,"value",h)),a=new x({props:{$$slots:{default:[Yo]},$$scope:{ctx:i}}}),{c(){y(e.$$.fragment),t=O(),y(s.$$.fragment),o=O(),y(a.$$.fragment)},m(f,p){w(e,f,p),b(f,t,p),w(s,f,p),b(f,o,p),w(a,f,p),l=!0},p(f,p){const g={};p&2&&(g.error=f[1]),!n&&p&1&&(n=!0,g.value=f[0],te(()=>n=!1)),e.$set(g);const S={};p&8&&(S.error=f[3]),!r&&p&4&&(r=!0,S.value=f[2],te(()=>r=!1)),s.$set(S);const T={};p&256&&(T.$$scope={dirty:p,ctx:f}),a.$set(T)},i(f){l||(m(e.$$.fragment,f),m(s.$$.fragment,f),m(a.$$.fragment,f),l=!0)},o(f){_(e.$$.fragment,f),_(s.$$.fragment,f),_(a.$$.fragment,f),l=!1},d(f){f&&($(t),$(o)),v(e,f),v(s,f),v(a,f)}}}function Zo(i){let e,n;return e=new _e({props:{onSubmit:i[4],$$slots:{default:[Xo]},$$scope:{ctx:i}}}),{c(){y(e.$$.fragment)},m(t,s){w(e,t,s),n=!0},p(t,[s]){const r={};s&271&&(r.$$scope={dirty:s,ctx:t}),e.$set(r)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function xo(i,e,n){let{onConfig:t}=e,s="",r="",o="",a="";const l=()=>{n(1,r=ce(s)),n(3,a=ce(o)),!(r||a)&&t({supabaseUrl:s,supabaseKey:o})};function u(h){s=h,n(0,s)}function c(h){o=h,n(2,o)}return i.$$set=h=>{"onConfig"in h&&n(5,t=h.onConfig)},[s,r,o,a,l,t,u,c]}class ea extends N{constructor(e){super(),q(this,e,xo,Zo,U,{onConfig:5})}}function ta(i){let e,n;return e=new _e({props:{onSubmit:i[4],$$slots:{default:[sa]},$$scope:{ctx:i}}}),{c(){y(e.$$.fragment)},m(t,s){w(e,t,s),n=!0},p(t,s){const r={};s&71&&(r.$$scope={dirty:s,ctx:t}),e.$set(r)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function na(i){let e,n,t;return{c(){e=A("div"),e.textContent="Magic link was successfully send!",n=O(),t=A("div"),t.textContent="Please check your E-Mail"},m(s,r){b(s,e,r),b(s,n,r),b(s,t,r)},p:D,i:D,o:D,d(s){s&&($(e),$(n),$(t))}}}function ra(i){let e,n;return e=new H({props:{disabled:i[2],label:"Magic Link"}}),{c(){y(e.$$.fragment)},m(t,s){w(e,t,s),n=!0},p(t,s){const r={};s&4&&(r.disabled=t[2]),e.$set(r)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function sa(i){let e,n,t,s,r;function o(l){i[5](l)}let a={id:"email",label:"E-Mail",error:i[1]};return i[0]!==void 0&&(a.value=i[0]),e=new ke({props:a}),Z.push(()=>ne(e,"value",o)),s=new x({props:{$$slots:{default:[ra]},$$scope:{ctx:i}}}),{c(){y(e.$$.fragment),t=O(),y(s.$$.fragment)},m(l,u){w(e,l,u),b(l,t,u),w(s,l,u),r=!0},p(l,u){const c={};u&2&&(c.error=l[1]),!n&&u&1&&(n=!0,c.value=l[0],te(()=>n=!1)),e.$set(c);const h={};u&68&&(h.$$scope={dirty:u,ctx:l}),s.$set(h)},i(l){r||(m(e.$$.fragment,l),m(s.$$.fragment,l),r=!0)},o(l){_(e.$$.fragment,l),_(s.$$.fragment,l),r=!1},d(l){l&&$(t),v(e,l),v(s,l)}}}function ia(i){let e,n,t,s;const r=[na,ta],o=[];function a(l,u){return l[3]?0:1}return e=a(i),n=o[e]=r[e](i),{c(){n.c(),t=Y()},m(l,u){o[e].m(l,u),b(l,t,u),s=!0},p(l,[u]){let c=e;e=a(l),e===c?o[e].p(l,u):(K(),_(o[c],1,1,()=>{o[c]=null}),G(),n=o[e],n?n.p(l,u):(n=o[e]=r[e](l),n.c()),m(n,1),n.m(t.parentNode,t))},i(l){s||(m(n),s=!0)},o(l){_(n),s=!1},d(l){l&&$(t),o[e].d(l)}}}function oa(i,e,n){let t="",s="",r=!1,o=!1;const a=async()=>{if(n(1,s=ce(t)),s)return;n(2,r=!0);const{data:u,error:c}=await X.auth.signInWithOtp({email:t});if(n(2,r=!1),c){Q.setAuthError(c);return}u&&(console.log("data",u),n(3,o=!0))};function l(u){t=u,n(0,t)}return[t,s,r,o,a,l]}class aa extends N{constructor(e){super(),q(this,e,oa,ia,U,{})}}function la(i){let e;return{c(){e=A("div"),e.innerHTML='<svg class="h-8 w-8 animate-spin text-blue-600" viewBox="0 0 100 100"><circle fill="none" stroke-width="10" class="stroke-current opacity-40" cx="50" cy="50" r="40"></circle><circle fill="none" stroke-width="10" class="stroke-current" stroke-dasharray="250" stroke-dashoffset="210" cx="50" cy="50" r="40"></circle></svg>',k(e,"class","flex justify-center")},m(n,t){b(n,e,t)},p:D,i:D,o:D,d(n){n&&$(e)}}}class ua extends N{constructor(e){super(),q(this,e,null,la,U,{})}}function ca(i){let e,n,t;e=new Mo({props:{user:i[0],onLogout:i[4]}});const s=i[6].default,r=ye(s,i,i[5],null);return{c(){y(e.$$.fragment),n=O(),r&&r.c()},m(o,a){w(e,o,a),b(o,n,a),r&&r.m(o,a),t=!0},p(o,a){const l={};a&1&&(l.user=o[0]),e.$set(l),r&&r.p&&(!t||a&32)&&Se(r,s,o,o[5],t?Ce(s,o[5],a,null):Ee(o[5]),null)},i(o){t||(m(e.$$.fragment,o),m(r,o),t=!0)},o(o){_(e.$$.fragment,o),_(r,o),t=!1},d(o){o&&$(n),v(e,o),r&&r.d(o)}}}function fa(i){let e,n,t,s;const r=[pa,da],o=[];function a(l,u){return l[2]?0:1}return e=a(i),n=o[e]=r[e](i),{c(){n.c(),t=Y()},m(l,u){o[e].m(l,u),b(l,t,u),s=!0},p(l,u){let c=e;e=a(l),e!==c&&(K(),_(o[c],1,1,()=>{o[c]=null}),G(),n=o[e],n||(n=o[e]=r[e](l),n.c()),m(n,1),n.m(t.parentNode,t))},i(l){s||(m(n),s=!0)},o(l){_(n),s=!1},d(l){l&&$(t),o[e].d(l)}}}function ha(i){let e,n;return e=new ea({props:{onConfig:i[3]}}),{c(){y(e.$$.fragment)},m(t,s){w(e,t,s),n=!0},p:D,i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function da(i){let e,n,t,s;return e=new ua({}),{c(){y(e.$$.fragment),n=O(),t=A("p"),t.textContent="Waiting for server ..."},m(r,o){w(e,r,o),b(r,n,o),b(r,t,o),s=!0},i(r){s||(m(e.$$.fragment,r),s=!0)},o(r){_(e.$$.fragment,r),s=!1},d(r){r&&($(n),$(t)),v(e,r)}}}function pa(i){let e,n;return e=new aa({}),{c(){y(e.$$.fragment)},m(t,s){w(e,t,s),n=!0},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function ma(i){let e,n,t,s;const r=[ha,fa,ca],o=[];function a(l,u){return l[1]?l[0]?2:1:0}return e=a(i),n=o[e]=r[e](i),{c(){n.c(),t=Y()},m(l,u){o[e].m(l,u),b(l,t,u),s=!0},p(l,[u]){let c=e;e=a(l),e===c?o[e].p(l,u):(K(),_(o[c],1,1,()=>{o[c]=null}),G(),n=o[e],n?n.p(l,u):(n=o[e]=r[e](l),n.c()),m(n,1),n.m(t.parentNode,t))},i(l){s||(m(n),s=!0)},o(l){_(n),s=!1},d(l){l&&$(t),o[e].d(l)}}}function _a(i,e,n){let{$$slots:t={},$$scope:s}=e,r,o=!1,a=!1;const l=()=>X?(X.auth.onAuthStateChange((h,d)=>{console.log("auth changed:",d==null?void 0:d.user),d!=null&&d.user?n(0,r=d.user):n(0,r=null),n(2,a=!0)}),!0):(console.log("supabase is not initialized!"),!1),u=h=>{co(h),n(1,o=l())},c=()=>{X&&r&&X.auth.signOut()};return pe(()=>{n(1,o=l())}),i.$$set=h=>{"$$scope"in h&&n(5,s=h.$$scope)},[r,o,a,u,c,s,t]}class ga extends N{constructor(e){super(),q(this,e,_a,ma,U,{})}}function $a(i){let e,n;return{c(){e=A("h2"),n=L(i[0]),k(e,"class","text-2xl font-extrabold")},m(t,s){b(t,e,s),C(e,n)},p(t,[s]){s&1&&B(n,t[0])},i:D,o:D,d(t){t&&$(e)}}}function ba(i,e,n){let{header:t}=e;return i.$$set=s=>{"header"in s&&n(0,t=s.header)},[t]}class ie extends N{constructor(e){super(),q(this,e,ba,$a,U,{header:0})}}const it="session",wa=(i,e,n)=>{if(i.length==0)return;const t=i.map(r=>({question:r,progress:e}));zo(t);const s={learning:t,learned:[],reverse:n};localStorage.setItem(it,JSON.stringify(s))},Nr=()=>{const i=localStorage.getItem(it);return i?JSON.parse(i):null},va=i=>i.learning.length>0?(localStorage.setItem(it,JSON.stringify(i)),!0):(localStorage.removeItem(it),!1),ka=()=>{localStorage.removeItem(it)},qn=i=>{const e=[0,0,0,i.learned.length];return i.learning.forEach(n=>{if(n.progress>2)throw Error(`Invalid progress ${n.progress}`);e[n.progress]++}),e};function ya(i){let e,n;const t=i[1].default,s=ye(t,i,i[0],null);return{c(){e=A("div"),s&&s.c(),k(e,"class","flex flex-col gap-5")},m(r,o){b(r,e,o),s&&s.m(e,null),n=!0},p(r,[o]){s&&s.p&&(!n||o&1)&&Se(s,t,r,r[0],n?Ce(t,r[0],o,null):Ee(r[0]),null)},i(r){n||(m(s,r),n=!0)},o(r){_(s,r),n=!1},d(r){r&&$(e),s&&s.d(r)}}}function Ca(i,e,n){let{$$slots:t={},$$scope:s}=e;return i.$$set=r=>{"$$scope"in r&&n(0,s=r.$$scope)},[s,t]}class oe extends N{constructor(e){super(),q(this,e,Ca,ya,U,{})}}function Nn(i){let e,n;return e=new x({props:{$$slots:{default:[Sa]},$$scope:{ctx:i}}}),{c(){y(e.$$.fragment)},m(t,s){w(e,t,s),n=!0},p(t,s){const r={};s&8&&(r.$$scope={dirty:s,ctx:t}),e.$set(r)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function Sa(i){let e,n,t,s;return e=new H({props:{label:"Continue",onClick:i[1]}}),t=new H({props:{label:"End",onClick:i[2]}}),{c(){y(e.$$.fragment),n=O(),y(t.$$.fragment)},m(r,o){w(e,r,o),b(r,n,o),w(t,r,o),s=!0},p:D,i(r){s||(m(e.$$.fragment,r),m(t.$$.fragment,r),s=!0)},o(r){_(e.$$.fragment,r),_(t.$$.fragment,r),s=!1},d(r){r&&$(n),v(e,r),v(t,r)}}}function Ea(i){let e,n,t,s;e=new ie({props:{header:"Home"}});let r=i[0]&&Nn(i);return{c(){y(e.$$.fragment),n=O(),r&&r.c(),t=Y()},m(o,a){w(e,o,a),b(o,n,a),r&&r.m(o,a),b(o,t,a),s=!0},p(o,a){o[0]?r?(r.p(o,a),a&1&&m(r,1)):(r=Nn(o),r.c(),m(r,1),r.m(t.parentNode,t)):r&&(K(),_(r,1,1,()=>{r=null}),G())},i(o){s||(m(e.$$.fragment,o),m(r),s=!0)},o(o){_(e.$$.fragment,o),_(r),s=!1},d(o){o&&($(n),$(t)),v(e,o),r&&r.d(o)}}}function Oa(i){let e,n;return e=new oe({props:{$$slots:{default:[Ea]},$$scope:{ctx:i}}}),{c(){y(e.$$.fragment)},m(t,s){w(e,t,s),n=!0},p(t,[s]){const r={};s&9&&(r.$$scope={dirty:s,ctx:t}),e.$set(r)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function Aa(i,e,n){let t=!1;const s=()=>{J("/lession/process")},r=()=>{ka(),n(0,t=!1)};return pe(()=>{Nr()&&n(0,t=!0)}),[t,s,r]}class Ta extends N{constructor(e){super(),q(this,e,Aa,Oa,U,{})}}const lt="cache-",Br=()=>{const i=[];for(let e in localStorage)e.startsWith(lt)&&i.push(e);return i.sort()},ja=()=>{const i=[];for(let e in localStorage)e.startsWith(lt)&&localStorage.removeItem(e);return i},Pa=i=>(localStorage.removeItem(i),Br());function Bn(i,e,n){const t=i.slice();return t[4]=e[n],t}function Ia(i){let e;return{c(){e=L("Cache is empty!")},m(n,t){b(n,e,t)},p:D,i:D,o:D,d(n){n&&$(e)}}}function Ra(i){let e,n,t,s,r,o,a,l=ae(i[0]),u=[];for(let h=0;h<l.length;h+=1)u[h]=Mn(Bn(i,l,h));const c=h=>_(u[h],1,1,()=>{u[h]=null});return o=new x({props:{$$slots:{default:[Da]},$$scope:{ctx:i}}}),{c(){e=A("table"),n=A("thead"),n.innerHTML='<tr class="tb-head"><th>Cache Key</th> <th></th></tr>',t=O(),s=A("tbody");for(let h=0;h<u.length;h+=1)u[h].c();r=O(),y(o.$$.fragment),k(e,"class","bg-white shadow w-full")},m(h,d){b(h,e,d),C(e,n),C(e,t),C(e,s);for(let f=0;f<u.length;f+=1)u[f]&&u[f].m(s,null);b(h,r,d),w(o,h,d),a=!0},p(h,d){if(d&1){l=ae(h[0]);let p;for(p=0;p<l.length;p+=1){const g=Bn(h,l,p);u[p]?(u[p].p(g,d),m(u[p],1)):(u[p]=Mn(g),u[p].c(),m(u[p],1),u[p].m(s,null))}for(K(),p=l.length;p<u.length;p+=1)c(p);G()}const f={};d&129&&(f.$$scope={dirty:d,ctx:h}),o.$set(f)},i(h){if(!a){for(let d=0;d<l.length;d+=1)m(u[d]);m(o.$$.fragment,h),a=!0}},o(h){u=u.filter(Boolean);for(let d=0;d<u.length;d+=1)_(u[d]);_(o.$$.fragment,h),a=!1},d(h){h&&($(e),$(r)),Ie(u,h),v(o,h)}}}function La(i){let e,n;function t(){return i[1](i[4])}return e=new H({props:{label:"Delete",onClick:t}}),{c(){y(e.$$.fragment)},m(s,r){w(e,s,r),n=!0},p(s,r){i=s;const o={};r&1&&(o.onClick=t),e.$set(o)},i(s){n||(m(e.$$.fragment,s),n=!0)},o(s){_(e.$$.fragment,s),n=!1},d(s){v(e,s)}}}function Mn(i){let e,n,t=i[4]+"",s,r,o,a,l,u;return a=new x({props:{$$slots:{default:[La]},$$scope:{ctx:i}}}),{c(){e=A("tr"),n=A("td"),s=L(t),r=O(),o=A("td"),y(a.$$.fragment),l=O()},m(c,h){b(c,e,h),C(e,n),C(n,s),C(e,r),C(e,o),w(a,o,null),C(e,l),u=!0},p(c,h){(!u||h&1)&&t!==(t=c[4]+"")&&B(s,t);const d={};h&129&&(d.$$scope={dirty:h,ctx:c}),a.$set(d)},i(c){u||(m(a.$$.fragment,c),u=!0)},o(c){_(a.$$.fragment,c),u=!1},d(c){c&&$(e),v(a)}}}function Da(i){let e,n,t,s;return e=new H({props:{onClick:i[2],label:"Cancel"}}),t=new H({props:{onClick:i[3],label:"Delete all"}}),{c(){y(e.$$.fragment),n=O(),y(t.$$.fragment)},m(r,o){w(e,r,o),b(r,n,o),w(t,r,o),s=!0},p(r,o){const a={};o&1&&(a.onClick=r[3]),t.$set(a)},i(r){s||(m(e.$$.fragment,r),m(t.$$.fragment,r),s=!0)},o(r){_(e.$$.fragment,r),_(t.$$.fragment,r),s=!1},d(r){r&&$(n),v(e,r),v(t,r)}}}function Ua(i){let e,n,t,s,r,o;e=new ie({props:{header:"Cache"}});const a=[Ra,Ia],l=[];function u(c,h){return c[0].length>0?0:1}return t=u(i),s=l[t]=a[t](i),{c(){y(e.$$.fragment),n=O(),s.c(),r=Y()},m(c,h){w(e,c,h),b(c,n,h),l[t].m(c,h),b(c,r,h),o=!0},p(c,h){let d=t;t=u(c),t===d?l[t].p(c,h):(K(),_(l[d],1,1,()=>{l[d]=null}),G(),s=l[t],s?s.p(c,h):(s=l[t]=a[t](c),s.c()),m(s,1),s.m(r.parentNode,r))},i(c){o||(m(e.$$.fragment,c),m(s),o=!0)},o(c){_(e.$$.fragment,c),_(s),o=!1},d(c){c&&($(n),$(r)),v(e,c),l[t].d(c)}}}function qa(i){let e,n;return e=new oe({props:{$$slots:{default:[Ua]},$$scope:{ctx:i}}}),{c(){y(e.$$.fragment)},m(t,s){w(e,t,s),n=!0},p(t,[s]){const r={};s&129&&(r.$$scope={dirty:s,ctx:t}),e.$set(r)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function Na(i,e,n){let t=[];return pe(()=>{n(0,t=Br())}),[t,a=>{n(0,t=Pa(a))},()=>J("/"),()=>n(0,t=ja())]}class Ba extends N{constructor(e){super(),q(this,e,Na,qa,U,{})}}function Ma(i){let e,n,t,s;return e=new ie({props:{header:"Not Found"}}),{c(){y(e.$$.fragment),n=O(),t=A("div"),t.textContent="Not Found"},m(r,o){w(e,r,o),b(r,n,o),b(r,t,o),s=!0},p:D,i(r){s||(m(e.$$.fragment,r),s=!0)},o(r){_(e.$$.fragment,r),s=!1},d(r){r&&($(n),$(t)),v(e,r)}}}function Fa(i){let e,n;return e=new oe({props:{$$slots:{default:[Ma]},$$scope:{ctx:i}}}),{c(){y(e.$$.fragment)},m(t,s){w(e,t,s),n=!0},p(t,[s]){const r={};s&1&&(r.$$scope={dirty:s,ctx:t}),e.$set(r)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}class za extends N{constructor(e){super(),q(this,e,null,Fa,U,{})}}const ot=lt+"books",yt=async i=>{let{data:e,error:n}=await X.from("books").select("*").eq("id",i).single();return n&&Q.setDBError(n),e||null},tn=async()=>{const i=localStorage.getItem(ot);if(i)return JSON.parse(i);let{data:e,error:n}=await X.from("books").select("*");return n&&Q.setDBError(n),e?(localStorage.setItem(ot,JSON.stringify(e)),e):[]},Ha=async i=>{const{error:e}=await X.from("books").delete().eq("id",i);return e?(Q.setDBError(e),[]):(localStorage.removeItem(ot),tn())},Ja=async(i,e)=>{const{error:n}=await X.from("books").insert([{name:i,description:e}]);if(n)return Q.setDBError(n),[];localStorage.removeItem(ot)},Ka=async(i,e,n)=>{const{error:t}=await X.from("books").update({name:e,description:n}).eq("id",i);return t?(Q.setDBError(t),[]):(localStorage.removeItem(ot),tn())};function Ga(i){let e,n;return{c(){e=ee("svg"),n=ee("path"),k(n,"stroke-linecap","round"),k(n,"stroke-linejoin","round"),k(n,"d","m9.75 9.75 4.5 4.5m0-4.5-4.5 4.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"),k(e,"xmlns","http://www.w3.org/2000/svg"),k(e,"fill","none"),k(e,"viewBox","0 0 24 24"),k(e,"stroke-width","1.5"),k(e,"stroke","currentColor"),k(e,"class","size-6 hover:stroke-2")},m(t,s){b(t,e,s),C(e,n)},p:D,d(t){t&&$(e)}}}function Va(i){let e,n;return e=new me({props:{onClick:i[0],$$slots:{default:[Ga]},$$scope:{ctx:i}}}),{c(){y(e.$$.fragment)},m(t,s){w(e,t,s),n=!0},p(t,[s]){const r={};s&1&&(r.onClick=t[0]),s&2&&(r.$$scope={dirty:s,ctx:t}),e.$set(r)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function Wa(i,e,n){let{onClick:t}=e;return i.$$set=s=>{"onClick"in s&&n(0,t=s.onClick)},[t]}class nn extends N{constructor(e){super(),q(this,e,Wa,Va,U,{onClick:0})}}function Qa(i){let e,n;return{c(){e=ee("svg"),n=ee("path"),k(n,"stroke-linecap","round"),k(n,"stroke-linejoin","round"),k(n,"d","M3.75 12h16.5m-16.5 3.75h16.5M3.75 19.5h16.5M5.625 4.5h12.75a1.875 1.875 0 0 1 0 3.75H5.625a1.875 1.875 0 0 1 0-3.75Z"),k(e,"xmlns","http://www.w3.org/2000/svg"),k(e,"fill","none"),k(e,"viewBox","0 0 24 24"),k(e,"stroke-width","1.5"),k(e,"stroke","currentColor"),k(e,"class","size-6 hover:stroke-2")},m(t,s){b(t,e,s),C(e,n)},p:D,d(t){t&&$(e)}}}function Ya(i){let e,n;return e=new me({props:{onClick:i[0],$$slots:{default:[Qa]},$$scope:{ctx:i}}}),{c(){y(e.$$.fragment)},m(t,s){w(e,t,s),n=!0},p(t,[s]){const r={};s&1&&(r.onClick=t[0]),s&2&&(r.$$scope={dirty:s,ctx:t}),e.$set(r)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function Xa(i,e,n){let{onClick:t}=e;return i.$$set=s=>{"onClick"in s&&n(0,t=s.onClick)},[t]}class Mr extends N{constructor(e){super(),q(this,e,Xa,Ya,U,{onClick:0})}}function Za(i){let e,n;return{c(){e=ee("svg"),n=ee("path"),k(n,"stroke-linecap","round"),k(n,"stroke-linejoin","round"),k(n,"d","m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"),k(e,"xmlns","http://www.w3.org/2000/svg"),k(e,"fill","none"),k(e,"viewBox","0 0 24 24"),k(e,"stroke-width","1.5"),k(e,"stroke","currentColor"),k(e,"class","size-6 hover:stroke-2")},m(t,s){b(t,e,s),C(e,n)},p:D,d(t){t&&$(e)}}}function xa(i){let e,n;return e=new me({props:{onClick:i[0],$$slots:{default:[Za]},$$scope:{ctx:i}}}),{c(){y(e.$$.fragment)},m(t,s){w(e,t,s),n=!0},p(t,[s]){const r={};s&1&&(r.onClick=t[0]),s&2&&(r.$$scope={dirty:s,ctx:t}),e.$set(r)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function el(i,e,n){let{onClick:t}=e;return i.$$set=s=>{"onClick"in s&&n(0,t=s.onClick)},[t]}class rn extends N{constructor(e){super(),q(this,e,el,xa,U,{onClick:0})}}function Fn(i,e,n){const t=i.slice();return t[8]=e[n],t}function tl(i){let e,n,t,s,r,o;function a(){return i[3](i[8])}e=new nn({props:{onClick:a}});function l(){return i[4](i[8])}t=new rn({props:{onClick:l}});function u(){return i[5](i[8])}return r=new Mr({props:{onClick:u}}),{c(){y(e.$$.fragment),n=O(),y(t.$$.fragment),s=O(),y(r.$$.fragment)},m(c,h){w(e,c,h),b(c,n,h),w(t,c,h),b(c,s,h),w(r,c,h),o=!0},p(c,h){i=c;const d={};h&3&&(d.onClick=a),e.$set(d);const f={};h&1&&(f.onClick=l),t.$set(f);const p={};h&1&&(p.onClick=u),r.$set(p)},i(c){o||(m(e.$$.fragment,c),m(t.$$.fragment,c),m(r.$$.fragment,c),o=!0)},o(c){_(e.$$.fragment,c),_(t.$$.fragment,c),_(r.$$.fragment,c),o=!1},d(c){c&&($(n),$(s)),v(e,c),v(t,c),v(r,c)}}}function zn(i){let e,n,t=i[8].id+"",s,r,o,a=i[8].name+"",l,u,c,h=i[8].description+"",d,f,p,g=se(i[8].modified)+"",S,T,E,j,P,I;return j=new x({props:{$$slots:{default:[tl]},$$scope:{ctx:i}}}),{c(){e=A("tr"),n=A("td"),s=L(t),r=O(),o=A("td"),l=L(a),u=O(),c=A("td"),d=L(h),f=O(),p=A("td"),S=L(g),T=O(),E=A("td"),y(j.$$.fragment),P=O()},m(R,M){b(R,e,M),C(e,n),C(n,s),C(e,r),C(e,o),C(o,l),C(e,u),C(e,c),C(c,d),C(e,f),C(e,p),C(p,S),C(e,T),C(e,E),w(j,E,null),C(e,P),I=!0},p(R,M){(!I||M&1)&&t!==(t=R[8].id+"")&&B(s,t),(!I||M&1)&&a!==(a=R[8].name+"")&&B(l,a),(!I||M&1)&&h!==(h=R[8].description+"")&&B(d,h),(!I||M&1)&&g!==(g=se(R[8].modified)+"")&&B(S,g);const W={};M&2051&&(W.$$scope={dirty:M,ctx:R}),j.$set(W)},i(R){I||(m(j.$$.fragment,R),I=!0)},o(R){_(j.$$.fragment,R),I=!1},d(R){R&&$(e),v(j)}}}function nl(i){let e,n,t,s;return e=new H({props:{onClick:i[6],label:"Cancel"}}),t=new H({props:{onClick:i[7],label:"Create"}}),{c(){y(e.$$.fragment),n=O(),y(t.$$.fragment)},m(r,o){w(e,r,o),b(r,n,o),w(t,r,o),s=!0},p:D,i(r){s||(m(e.$$.fragment,r),m(t.$$.fragment,r),s=!0)},o(r){_(e.$$.fragment,r),_(t.$$.fragment,r),s=!1},d(r){r&&$(n),v(e,r),v(t,r)}}}function rl(i){let e,n,t,s,r,o,a,l,u;e=new ie({props:{header:"List Books"}});let c=ae(i[0]),h=[];for(let f=0;f<c.length;f+=1)h[f]=zn(Fn(i,c,f));const d=f=>_(h[f],1,1,()=>{h[f]=null});return l=new x({props:{$$slots:{default:[nl]},$$scope:{ctx:i}}}),{c(){y(e.$$.fragment),n=O(),t=A("table"),s=A("thead"),s.innerHTML='<tr class="tb-head"><th>ID</th> <th>Name</th> <th>Description</th> <th>Modified</th> <th></th></tr>',r=O(),o=A("tbody");for(let f=0;f<h.length;f+=1)h[f].c();a=O(),y(l.$$.fragment),k(t,"class","bg-white shadow w-full")},m(f,p){w(e,f,p),b(f,n,p),b(f,t,p),C(t,s),C(t,r),C(t,o);for(let g=0;g<h.length;g+=1)h[g]&&h[g].m(o,null);b(f,a,p),w(l,f,p),u=!0},p(f,p){if(p&3){c=ae(f[0]);let S;for(S=0;S<c.length;S+=1){const T=Fn(f,c,S);h[S]?(h[S].p(T,p),m(h[S],1)):(h[S]=zn(T),h[S].c(),m(h[S],1),h[S].m(o,null))}for(K(),S=c.length;S<h.length;S+=1)d(S);G()}const g={};p&2048&&(g.$$scope={dirty:p,ctx:f}),l.$set(g)},i(f){if(!u){m(e.$$.fragment,f);for(let p=0;p<c.length;p+=1)m(h[p]);m(l.$$.fragment,f),u=!0}},o(f){_(e.$$.fragment,f),h=h.filter(Boolean);for(let p=0;p<h.length;p+=1)_(h[p]);_(l.$$.fragment,f),u=!1},d(f){f&&($(n),$(t),$(a)),v(e,f),Ie(h,f),v(l,f)}}}function Hn(i){let e,n;return e=new wt({props:{title:"Delete Book",buttons:i[2],$$slots:{default:[sl]},$$scope:{ctx:i}}}),{c(){y(e.$$.fragment)},m(t,s){w(e,t,s),n=!0},p(t,s){const r={};s&2050&&(r.$$scope={dirty:s,ctx:t}),e.$set(r)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function sl(i){let e,n=i[1].id+"",t,s;return{c(){e=L("Do you want to delete book: '"),t=L(n),s=L("'?")},m(r,o){b(r,e,o),b(r,t,o),b(r,s,o)},p(r,o){o&2&&n!==(n=r[1].id+"")&&B(t,n)},d(r){r&&($(e),$(t),$(s))}}}function il(i){let e,n,t,s;e=new oe({props:{$$slots:{default:[rl]},$$scope:{ctx:i}}});let r=i[1]&&Hn(i);return{c(){y(e.$$.fragment),n=O(),r&&r.c(),t=Y()},m(o,a){w(e,o,a),b(o,n,a),r&&r.m(o,a),b(o,t,a),s=!0},p(o,[a]){const l={};a&2051&&(l.$$scope={dirty:a,ctx:o}),e.$set(l),o[1]?r?(r.p(o,a),a&2&&m(r,1)):(r=Hn(o),r.c(),m(r,1),r.m(t.parentNode,t)):r&&(K(),_(r,1,1,()=>{r=null}),G())},i(o){s||(m(e.$$.fragment,o),m(r),s=!0)},o(o){_(e.$$.fragment,o),_(r),s=!1},d(o){o&&($(n),$(t)),v(e,o),r&&r.d(o)}}}function ol(i,e,n){let t=[],s=null;const r=[{label:"Close",onclick:()=>{n(1,s=null)}},{label:"Delete",onclick:async()=>{s&&(n(0,t=await Ha(s.id)),n(1,s=null))}}];return pe(async()=>{n(0,t=await tn())}),[t,s,r,async h=>{n(1,s=h)},h=>{J("/books/update/"+h.id)},h=>{J("/chapters/list/"+h.id)},()=>J("/books/list"),()=>J("/books/create")]}class al extends N{constructor(e){super(),q(this,e,ol,il,U,{})}}function ll(i){let e,n,t;return{c(){e=A("textarea"),k(e,"class","input"),k(e,"id",i[2])},m(s,r){b(s,e,r),Je(e,i[0]),n||(t=Qe(e,"input",i[4]),n=!0)},p(s,r){r&4&&k(e,"id",s[2]),r&1&&Je(e,s[0])},d(s){s&&$(e),n=!1,t()}}}function ul(i){let e,n;return e=new en({props:{id:i[2],label:i[1],error:i[3],$$slots:{default:[ll]},$$scope:{ctx:i}}}),{c(){y(e.$$.fragment)},m(t,s){w(e,t,s),n=!0},p(t,[s]){const r={};s&4&&(r.id=t[2]),s&2&&(r.label=t[1]),s&8&&(r.error=t[3]),s&37&&(r.$$scope={dirty:s,ctx:t}),e.$set(r)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function cl(i,e,n){let{label:t}=e,{id:s}=e,{value:r}=e,{error:o}=e;function a(){r=this.value,n(0,r)}return i.$$set=l=>{"label"in l&&n(1,t=l.label),"id"in l&&n(2,s=l.id),"value"in l&&n(0,r=l.value),"error"in l&&n(3,o=l.error)},[r,t,s,o,a]}class ve extends N{constructor(e){super(),q(this,e,cl,ul,U,{label:1,id:2,value:0,error:3})}}function fl(i){let e,n,t,s;return e=new H({props:{onClick:i[7],label:"Cancel"}}),t=new H({props:{label:"Create"}}),{c(){y(e.$$.fragment),n=O(),y(t.$$.fragment)},m(r,o){w(e,r,o),b(r,n,o),w(t,r,o),s=!0},p:D,i(r){s||(m(e.$$.fragment,r),m(t.$$.fragment,r),s=!0)},o(r){_(e.$$.fragment,r),_(t.$$.fragment,r),s=!1},d(r){r&&$(n),v(e,r),v(t,r)}}}function hl(i){let e,n,t,s,r,o,a,l;function u(f){i[5](f)}let c={id:"name",label:"Book name",error:i[1]};i[0]!==void 0&&(c.value=i[0]),e=new ke({props:c}),Z.push(()=>ne(e,"value",u));function h(f){i[6](f)}let d={id:"description",label:"Book description",error:i[3]};return i[2]!==void 0&&(d.value=i[2]),s=new ve({props:d}),Z.push(()=>ne(s,"value",h)),a=new x({props:{$$slots:{default:[fl]},$$scope:{ctx:i}}}),{c(){y(e.$$.fragment),t=O(),y(s.$$.fragment),o=O(),y(a.$$.fragment)},m(f,p){w(e,f,p),b(f,t,p),w(s,f,p),b(f,o,p),w(a,f,p),l=!0},p(f,p){const g={};p&2&&(g.error=f[1]),!n&&p&1&&(n=!0,g.value=f[0],te(()=>n=!1)),e.$set(g);const S={};p&8&&(S.error=f[3]),!r&&p&4&&(r=!0,S.value=f[2],te(()=>r=!1)),s.$set(S);const T={};p&256&&(T.$$scope={dirty:p,ctx:f}),a.$set(T)},i(f){l||(m(e.$$.fragment,f),m(s.$$.fragment,f),m(a.$$.fragment,f),l=!0)},o(f){_(e.$$.fragment,f),_(s.$$.fragment,f),_(a.$$.fragment,f),l=!1},d(f){f&&($(t),$(o)),v(e,f),v(s,f),v(a,f)}}}function dl(i){let e,n,t,s;return e=new ie({props:{header:"Create Book"}}),t=new _e({props:{onSubmit:i[4],$$slots:{default:[hl]},$$scope:{ctx:i}}}),{c(){y(e.$$.fragment),n=O(),y(t.$$.fragment)},m(r,o){w(e,r,o),b(r,n,o),w(t,r,o),s=!0},p(r,o){const a={};o&271&&(a.$$scope={dirty:o,ctx:r}),t.$set(a)},i(r){s||(m(e.$$.fragment,r),m(t.$$.fragment,r),s=!0)},o(r){_(e.$$.fragment,r),_(t.$$.fragment,r),s=!1},d(r){r&&$(n),v(e,r),v(t,r)}}}function pl(i){let e,n;return e=new oe({props:{$$slots:{default:[dl]},$$scope:{ctx:i}}}),{c(){y(e.$$.fragment)},m(t,s){w(e,t,s),n=!0},p(t,[s]){const r={};s&271&&(r.$$scope={dirty:s,ctx:t}),e.$set(r)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function ml(i,e,n){let t="",s="",r="",o="";const a=async()=>{n(1,s=ce(t)),n(3,o=ce(r)),!(s||o)&&(await Ja(t,r),J("/books/list"))};function l(h){t=h,n(0,t)}function u(h){r=h,n(2,r)}return[t,s,r,o,a,l,u,()=>J("/books/list")]}class _l extends N{constructor(e){super(),q(this,e,ml,pl,U,{})}}function Jn(i){let e,n,t=i[0].id+"",s,r,o,a=se(i[0].modified)+"",l,u,c,h;return c=new _e({props:{onSubmit:i[5],$$slots:{default:[$l]},$$scope:{ctx:i}}}),{c(){e=A("div"),n=A("span"),s=L(t),r=O(),o=A("span"),l=L(a),u=O(),y(c.$$.fragment),k(e,"class","mb-4 text-small")},m(d,f){b(d,e,f),C(e,n),C(n,s),C(e,r),C(e,o),C(o,l),b(d,u,f),w(c,d,f),h=!0},p(d,f){(!h||f&1)&&t!==(t=d[0].id+"")&&B(s,t),(!h||f&1)&&a!==(a=se(d[0].modified)+"")&&B(l,a);const p={};f&1054&&(p.$$scope={dirty:f,ctx:d}),c.$set(p)},i(d){h||(m(c.$$.fragment,d),h=!0)},o(d){_(c.$$.fragment,d),h=!1},d(d){d&&($(e),$(u)),v(c,d)}}}function gl(i){let e,n,t,s;return e=new H({props:{onClick:i[9],label:"Cancel"}}),t=new H({props:{label:"Update"}}),{c(){y(e.$$.fragment),n=O(),y(t.$$.fragment)},m(r,o){w(e,r,o),b(r,n,o),w(t,r,o),s=!0},p:D,i(r){s||(m(e.$$.fragment,r),m(t.$$.fragment,r),s=!0)},o(r){_(e.$$.fragment,r),_(t.$$.fragment,r),s=!1},d(r){r&&$(n),v(e,r),v(t,r)}}}function $l(i){let e,n,t,s,r,o,a,l;function u(f){i[7](f)}let c={id:"name",label:"Book name",error:i[2]};i[1]!==void 0&&(c.value=i[1]),e=new ke({props:c}),Z.push(()=>ne(e,"value",u));function h(f){i[8](f)}let d={id:"description",label:"Book description",error:i[4]};return i[3]!==void 0&&(d.value=i[3]),s=new ve({props:d}),Z.push(()=>ne(s,"value",h)),a=new x({props:{$$slots:{default:[gl]},$$scope:{ctx:i}}}),{c(){y(e.$$.fragment),t=O(),y(s.$$.fragment),o=O(),y(a.$$.fragment)},m(f,p){w(e,f,p),b(f,t,p),w(s,f,p),b(f,o,p),w(a,f,p),l=!0},p(f,p){const g={};p&4&&(g.error=f[2]),!n&&p&2&&(n=!0,g.value=f[1],te(()=>n=!1)),e.$set(g);const S={};p&16&&(S.error=f[4]),!r&&p&8&&(r=!0,S.value=f[3],te(()=>r=!1)),s.$set(S);const T={};p&1024&&(T.$$scope={dirty:p,ctx:f}),a.$set(T)},i(f){l||(m(e.$$.fragment,f),m(s.$$.fragment,f),m(a.$$.fragment,f),l=!0)},o(f){_(e.$$.fragment,f),_(s.$$.fragment,f),_(a.$$.fragment,f),l=!1},d(f){f&&($(t),$(o)),v(e,f),v(s,f),v(a,f)}}}function bl(i){let e,n,t,s;e=new ie({props:{header:"Update Book"}});let r=i[0]&&Jn(i);return{c(){y(e.$$.fragment),n=O(),r&&r.c(),t=Y()},m(o,a){w(e,o,a),b(o,n,a),r&&r.m(o,a),b(o,t,a),s=!0},p(o,a){o[0]?r?(r.p(o,a),a&1&&m(r,1)):(r=Jn(o),r.c(),m(r,1),r.m(t.parentNode,t)):r&&(K(),_(r,1,1,()=>{r=null}),G())},i(o){s||(m(e.$$.fragment,o),m(r),s=!0)},o(o){_(e.$$.fragment,o),_(r),s=!1},d(o){o&&($(n),$(t)),v(e,o),r&&r.d(o)}}}function wl(i){let e,n;return e=new oe({props:{$$slots:{default:[bl]},$$scope:{ctx:i}}}),{c(){y(e.$$.fragment)},m(t,s){w(e,t,s),n=!0},p(t,[s]){const r={};s&1055&&(r.$$scope={dirty:s,ctx:t}),e.$set(r)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function vl(i,e,n){let{params:t={id:""}}=e,s=null,r="",o="",a="",l="";const u=async()=>{if(n(2,o=ce(r)),n(4,l=ce(a)),!(o||l)){if(!s){Q.setString("No book!!");return}await Ka(s.id,r,a),J("/books/list")}};pe(async()=>{n(0,s=await yt(parseInt(t.id))),s&&(n(1,r=s.name),n(3,a=s.description))});function c(f){r=f,n(1,r)}function h(f){a=f,n(3,a)}const d=()=>J("/books/list");return i.$$set=f=>{"params"in f&&n(6,t=f.params)},[s,r,o,a,l,u,t,c,h,d]}class kl extends N{constructor(e){super(),q(this,e,vl,wl,U,{params:6})}}const yl=lt+"chapters",Ct=i=>`${yl}#${i}`,sn=async i=>{let{data:e,error:n}=await X.from("chapters").select("*").eq("id",i).single();return n&&Q.setDBError(n),e||null},on=async i=>{const e=Ct(i),n=localStorage.getItem(e);if(n)return JSON.parse(n);let{data:t,error:s}=await X.from("chapters").select("*").eq("book_id",i).order("id");return s&&Q.setDBError(s),t?(localStorage.setItem(e,JSON.stringify(t)),t):[]},Cl=async(i,e)=>{const{error:n}=await X.from("chapters").delete().eq("id",i);return n?(Q.setDBError(n),[]):(localStorage.removeItem(Ct(e)),on(e))},Sl=async(i,e,n)=>{const{error:t}=await X.from("chapters").update({name:n}).eq("id",i);return t?(Q.setDBError(t),[]):(localStorage.removeItem(Ct(e)),on(e))},El=async(i,e)=>{const{error:n}=await X.from("chapters").insert([{book_id:i,name:e}]);if(n)return Q.setDBError(n),[];localStorage.removeItem(Ct(i))};function Ol(i){let e,n;const t=i[1].default,s=ye(t,i,i[0],null);return{c(){e=A("div"),s&&s.c(),k(e,"class","border rounded shadow px-4 py-4")},m(r,o){b(r,e,o),s&&s.m(e,null),n=!0},p(r,[o]){s&&s.p&&(!n||o&1)&&Se(s,t,r,r[0],n?Ce(t,r[0],o,null):Ee(r[0]),null)},i(r){n||(m(s,r),n=!0)},o(r){_(s,r),n=!1},d(r){r&&$(e),s&&s.d(r)}}}function Al(i,e,n){let{$$slots:t={},$$scope:s}=e;return i.$$set=r=>{"$$scope"in r&&n(0,s=r.$$scope)},[s,t]}class Tl extends N{constructor(e){super(),q(this,e,Al,Ol,U,{})}}function Kn(i){let e,n,t,s=i[0].name+"",r,o,a,l,u=i[0].id+"",c,h,d=se(i[0].modified)+"",f,p,g=i[0].description&&Gn(i);return{c(){e=A("div"),n=A("div"),t=A("div"),r=L(s),o=O(),a=A("div"),l=L("Book-Id: "),c=L(u),h=L(" - Modified: "),f=L(d),p=O(),g&&g.c(),k(t,"class","text-lg font-semibold"),k(a,"class","text-sm"),k(n,"class","flex justify-between mb-2")},m(S,T){b(S,e,T),C(e,n),C(n,t),C(t,r),C(n,o),C(n,a),C(a,l),C(a,c),C(a,h),C(a,f),C(e,p),g&&g.m(e,null)},p(S,T){T&1&&s!==(s=S[0].name+"")&&B(r,s),T&1&&u!==(u=S[0].id+"")&&B(c,u),T&1&&d!==(d=se(S[0].modified)+"")&&B(f,d),S[0].description?g?g.p(S,T):(g=Gn(S),g.c(),g.m(e,null)):g&&(g.d(1),g=null)},d(S){S&&$(e),g&&g.d()}}}function Gn(i){let e,n=i[0].description+"",t;return{c(){e=A("p"),t=L(n),k(e,"class","mt-2 pt-2 border-t text-sm")},m(s,r){b(s,e,r),C(e,t)},p(s,r){r&1&&n!==(n=s[0].description+"")&&B(t,n)},d(s){s&&$(e)}}}function Vn(i){let e,n,t=i[1].name+"",s,r,o,a,l=i[1].id+"",u,c,h=se(i[1].modified)+"",d;return{c(){e=A("div"),n=A("div"),s=L(t),r=O(),o=A("div"),a=L("Chapter-Id: "),u=L(l),c=L(" - Modified: "),d=L(h),k(n,"class","text font-medium"),k(o,"class","text-sm"),k(e,"class","flex justify-between mb-2")},m(f,p){b(f,e,p),C(e,n),C(n,s),C(e,r),C(e,o),C(o,a),C(o,u),C(o,c),C(o,d)},p(f,p){p&2&&t!==(t=f[1].name+"")&&B(s,t),p&2&&l!==(l=f[1].id+"")&&B(u,l),p&2&&h!==(h=se(f[1].modified)+"")&&B(d,h)},d(f){f&&$(e)}}}function jl(i){let e,n,t=i[0]&&Kn(i),s=i[1]&&Vn(i);return{c(){e=A("div"),t&&t.c(),n=O(),s&&s.c(),k(e,"class","flex flex-col gap-5")},m(r,o){b(r,e,o),t&&t.m(e,null),C(e,n),s&&s.m(e,null)},p(r,o){r[0]?t?t.p(r,o):(t=Kn(r),t.c(),t.m(e,n)):t&&(t.d(1),t=null),r[1]?s?s.p(r,o):(s=Vn(r),s.c(),s.m(e,null)):s&&(s.d(1),s=null)},d(r){r&&$(e),t&&t.d(),s&&s.d()}}}function Pl(i){let e,n;return e=new Tl({props:{$$slots:{default:[jl]},$$scope:{ctx:i}}}),{c(){y(e.$$.fragment)},m(t,s){w(e,t,s),n=!0},p(t,[s]){const r={};s&7&&(r.$$scope={dirty:s,ctx:t}),e.$set(r)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function Il(i,e,n){let{book:t=null}=e,{chapter:s=null}=e;return i.$$set=r=>{"book"in r&&n(0,t=r.book),"chapter"in r&&n(1,s=r.chapter)},[t,s]}class an extends N{constructor(e){super(),q(this,e,Il,Pl,U,{book:0,chapter:1})}}function Rl(i){let e,n;return{c(){e=ee("svg"),n=ee("path"),k(n,"stroke-linecap","round"),k(n,"stroke-linejoin","round"),k(n,"d","m12.75 15 3-3m0 0-3-3m3 3h-7.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"),k(e,"xmlns","http://www.w3.org/2000/svg"),k(e,"fill","none"),k(e,"viewBox","0 0 24 24"),k(e,"stroke-width","1.5"),k(e,"stroke","currentColor"),k(e,"class","size-6 hover:stroke-2")},m(t,s){b(t,e,s),C(e,n)},p:D,d(t){t&&$(e)}}}function Ll(i){let e,n;return e=new me({props:{onClick:i[0],$$slots:{default:[Rl]},$$scope:{ctx:i}}}),{c(){y(e.$$.fragment)},m(t,s){w(e,t,s),n=!0},p(t,[s]){const r={};s&1&&(r.onClick=t[0]),s&2&&(r.$$scope={dirty:s,ctx:t}),e.$set(r)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function Dl(i,e,n){let{onClick:t}=e;return i.$$set=s=>{"onClick"in s&&n(0,t=s.onClick)},[t]}class Ul extends N{constructor(e){super(),q(this,e,Dl,Ll,U,{onClick:0})}}function Wn(i,e,n){const t=i.slice();return t[11]=e[n],t}function ql(i){let e,n,t,s,r,o,a,l;function u(){return i[5](i[11])}e=new nn({props:{onClick:u}});function c(){return i[6](i[11])}t=new rn({props:{onClick:c}});function h(){return i[7](i[11])}r=new Mr({props:{onClick:h}});function d(){return i[8](i[11])}return a=new Ul({props:{onClick:d}}),{c(){y(e.$$.fragment),n=O(),y(t.$$.fragment),s=O(),y(r.$$.fragment),o=O(),y(a.$$.fragment)},m(f,p){w(e,f,p),b(f,n,p),w(t,f,p),b(f,s,p),w(r,f,p),b(f,o,p),w(a,f,p),l=!0},p(f,p){i=f;const g={};p&12&&(g.onClick=u),e.$set(g);const S={};p&4&&(S.onClick=c),t.$set(S);const T={};p&4&&(T.onClick=h),r.$set(T);const E={};p&4&&(E.onClick=d),a.$set(E)},i(f){l||(m(e.$$.fragment,f),m(t.$$.fragment,f),m(r.$$.fragment,f),m(a.$$.fragment,f),l=!0)},o(f){_(e.$$.fragment,f),_(t.$$.fragment,f),_(r.$$.fragment,f),_(a.$$.fragment,f),l=!1},d(f){f&&($(n),$(s),$(o)),v(e,f),v(t,f),v(r,f),v(a,f)}}}function Qn(i){let e,n,t=i[11].id+"",s,r,o,a=i[11].name+"",l,u,c,h=se(i[11].modified)+"",d,f,p,g,S,T;return g=new x({props:{$$slots:{default:[ql]},$$scope:{ctx:i}}}),{c(){e=A("tr"),n=A("td"),s=L(t),r=O(),o=A("td"),l=L(a),u=O(),c=A("td"),d=L(h),f=O(),p=A("td"),y(g.$$.fragment),S=O()},m(E,j){b(E,e,j),C(e,n),C(n,s),C(e,r),C(e,o),C(o,l),C(e,u),C(e,c),C(c,d),C(e,f),C(e,p),w(g,p,null),C(e,S),T=!0},p(E,j){(!T||j&4)&&t!==(t=E[11].id+"")&&B(s,t),(!T||j&4)&&a!==(a=E[11].name+"")&&B(l,a),(!T||j&4)&&h!==(h=se(E[11].modified)+"")&&B(d,h);const P={};j&16396&&(P.$$scope={dirty:j,ctx:E}),g.$set(P)},i(E){T||(m(g.$$.fragment,E),T=!0)},o(E){_(g.$$.fragment,E),T=!1},d(E){E&&$(e),v(g)}}}function Nl(i){let e,n,t,s;return e=new H({props:{onClick:i[9],label:"Cancel"}}),t=new H({props:{onClick:i[10],label:"Create"}}),{c(){y(e.$$.fragment),n=O(),y(t.$$.fragment)},m(r,o){w(e,r,o),b(r,n,o),w(t,r,o),s=!0},p(r,o){const a={};o&1&&(a.onClick=r[10]),t.$set(a)},i(r){s||(m(e.$$.fragment,r),m(t.$$.fragment,r),s=!0)},o(r){_(e.$$.fragment,r),_(t.$$.fragment,r),s=!1},d(r){r&&$(n),v(e,r),v(t,r)}}}function Bl(i){let e,n,t,s,r,o,a,l,u,c,h;e=new ie({props:{header:"List Chapters"}}),t=new an({props:{book:i[1]}});let d=ae(i[2]),f=[];for(let g=0;g<d.length;g+=1)f[g]=Qn(Wn(i,d,g));const p=g=>_(f[g],1,1,()=>{f[g]=null});return c=new x({props:{$$slots:{default:[Nl]},$$scope:{ctx:i}}}),{c(){y(e.$$.fragment),n=O(),y(t.$$.fragment),s=O(),r=A("table"),o=A("thead"),o.innerHTML='<tr class="tb-head"><th>ID</th> <th>Name</th> <th>Modified</th> <th></th></tr>',a=O(),l=A("tbody");for(let g=0;g<f.length;g+=1)f[g].c();u=O(),y(c.$$.fragment),k(r,"class","bg-white shadow w-full")},m(g,S){w(e,g,S),b(g,n,S),w(t,g,S),b(g,s,S),b(g,r,S),C(r,o),C(r,a),C(r,l);for(let T=0;T<f.length;T+=1)f[T]&&f[T].m(l,null);b(g,u,S),w(c,g,S),h=!0},p(g,S){const T={};if(S&2&&(T.book=g[1]),t.$set(T),S&12){d=ae(g[2]);let j;for(j=0;j<d.length;j+=1){const P=Wn(g,d,j);f[j]?(f[j].p(P,S),m(f[j],1)):(f[j]=Qn(P),f[j].c(),m(f[j],1),f[j].m(l,null))}for(K(),j=d.length;j<f.length;j+=1)p(j);G()}const E={};S&16385&&(E.$$scope={dirty:S,ctx:g}),c.$set(E)},i(g){if(!h){m(e.$$.fragment,g),m(t.$$.fragment,g);for(let S=0;S<d.length;S+=1)m(f[S]);m(c.$$.fragment,g),h=!0}},o(g){_(e.$$.fragment,g),_(t.$$.fragment,g),f=f.filter(Boolean);for(let S=0;S<f.length;S+=1)_(f[S]);_(c.$$.fragment,g),h=!1},d(g){g&&($(n),$(s),$(r),$(u)),v(e,g),v(t,g),Ie(f,g),v(c,g)}}}function Yn(i){let e,n;return e=new wt({props:{title:"Delete Chapter",buttons:i[4],$$slots:{default:[Ml]},$$scope:{ctx:i}}}),{c(){y(e.$$.fragment)},m(t,s){w(e,t,s),n=!0},p(t,s){const r={};s&16392&&(r.$$scope={dirty:s,ctx:t}),e.$set(r)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function Ml(i){let e,n=i[3].id+"",t,s;return{c(){e=L("Do you want to delete chapter: '"),t=L(n),s=L("'?")},m(r,o){b(r,e,o),b(r,t,o),b(r,s,o)},p(r,o){o&8&&n!==(n=r[3].id+"")&&B(t,n)},d(r){r&&($(e),$(t),$(s))}}}function Fl(i){let e,n,t,s;e=new oe({props:{$$slots:{default:[Bl]},$$scope:{ctx:i}}});let r=i[3]&&Yn(i);return{c(){y(e.$$.fragment),n=O(),r&&r.c(),t=Y()},m(o,a){w(e,o,a),b(o,n,a),r&&r.m(o,a),b(o,t,a),s=!0},p(o,[a]){const l={};a&16399&&(l.$$scope={dirty:a,ctx:o}),e.$set(l),o[3]?r?(r.p(o,a),a&8&&m(r,1)):(r=Yn(o),r.c(),m(r,1),r.m(t.parentNode,t)):r&&(K(),_(r,1,1,()=>{r=null}),G())},i(o){s||(m(e.$$.fragment,o),m(r),s=!0)},o(o){_(e.$$.fragment,o),_(r),s=!1},d(o){o&&($(n),$(t)),v(e,o),r&&r.d(o)}}}function zl(i,e,n){let{params:t={id:0}}=e,s,r=[],o=null;const a=[{label:"Close",onclick:()=>{n(3,o=null)}},{label:"Delete",onclick:async()=>{o&&(n(2,r=await Cl(o.id,o.book_id)),n(3,o=null))}}];pe(async()=>{n(1,s=await yt(t.id)),s&&n(2,r=await on(s.id))});const l=async p=>{n(3,o=p)},u=p=>{J("/chapters/update/"+p.id)},c=p=>{J("/questions/list/"+p.id)},h=p=>{J("/lession/prepare/"+p.id)},d=()=>J("/books/list"),f=()=>J("/chapters/create/"+t.id);return i.$$set=p=>{"params"in p&&n(0,t=p.params)},[t,s,r,o,a,l,u,c,h,d,f]}class Hl extends N{constructor(e){super(),q(this,e,zl,Fl,U,{params:0})}}function Jl(i){let e,n,t,s;return e=new H({props:{onClick:i[5],label:"Cancel"}}),t=new H({props:{label:"Create"}}),{c(){y(e.$$.fragment),n=O(),y(t.$$.fragment)},m(r,o){w(e,r,o),b(r,n,o),w(t,r,o),s=!0},p(r,o){const a={};o&1&&(a.onClick=r[5]),e.$set(a)},i(r){s||(m(e.$$.fragment,r),m(t.$$.fragment,r),s=!0)},o(r){_(e.$$.fragment,r),_(t.$$.fragment,r),s=!1},d(r){r&&$(n),v(e,r),v(t,r)}}}function Kl(i){let e,n,t,s,r;function o(l){i[4](l)}let a={id:"name",label:"Chapter name",error:i[2]};return i[1]!==void 0&&(a.value=i[1]),e=new ke({props:a}),Z.push(()=>ne(e,"value",o)),s=new x({props:{$$slots:{default:[Jl]},$$scope:{ctx:i}}}),{c(){y(e.$$.fragment),t=O(),y(s.$$.fragment)},m(l,u){w(e,l,u),b(l,t,u),w(s,l,u),r=!0},p(l,u){const c={};u&4&&(c.error=l[2]),!n&&u&2&&(n=!0,c.value=l[1],te(()=>n=!1)),e.$set(c);const h={};u&65&&(h.$$scope={dirty:u,ctx:l}),s.$set(h)},i(l){r||(m(e.$$.fragment,l),m(s.$$.fragment,l),r=!0)},o(l){_(e.$$.fragment,l),_(s.$$.fragment,l),r=!1},d(l){l&&$(t),v(e,l),v(s,l)}}}function Gl(i){let e,n,t,s;return e=new ie({props:{header:"Create Book"}}),t=new _e({props:{onSubmit:i[3],$$slots:{default:[Kl]},$$scope:{ctx:i}}}),{c(){y(e.$$.fragment),n=O(),y(t.$$.fragment)},m(r,o){w(e,r,o),b(r,n,o),w(t,r,o),s=!0},p(r,o){const a={};o&71&&(a.$$scope={dirty:o,ctx:r}),t.$set(a)},i(r){s||(m(e.$$.fragment,r),m(t.$$.fragment,r),s=!0)},o(r){_(e.$$.fragment,r),_(t.$$.fragment,r),s=!1},d(r){r&&$(n),v(e,r),v(t,r)}}}function Vl(i){let e,n;return e=new oe({props:{$$slots:{default:[Gl]},$$scope:{ctx:i}}}),{c(){y(e.$$.fragment)},m(t,s){w(e,t,s),n=!0},p(t,[s]){const r={};s&71&&(r.$$scope={dirty:s,ctx:t}),e.$set(r)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function Wl(i,e,n){let{params:t={book_id:0}}=e,s="",r="";const o=async()=>{n(2,r=ce(s)),!r&&(await El(t.book_id,s),J("/chapters/list/"+t.book_id))};function a(u){s=u,n(1,s)}const l=()=>J("/chapters/list/"+t.book_id);return i.$$set=u=>{"params"in u&&n(0,t=u.params)},[t,s,r,o,a,l]}class Ql extends N{constructor(e){super(),q(this,e,Wl,Vl,U,{params:0})}}function Xn(i){let e,n,t=i[0].id+"",s,r,o,a=se(i[0].modified)+"",l,u,c,h;return c=new _e({props:{onSubmit:i[3],$$slots:{default:[Xl]},$$scope:{ctx:i}}}),{c(){e=A("div"),n=A("span"),s=L(t),r=O(),o=A("span"),l=L(a),u=O(),y(c.$$.fragment),k(e,"class","mb-4 text-small")},m(d,f){b(d,e,f),C(e,n),C(n,s),C(e,r),C(e,o),C(o,l),b(d,u,f),w(c,d,f),h=!0},p(d,f){(!h||f&1)&&t!==(t=d[0].id+"")&&B(s,t),(!h||f&1)&&a!==(a=se(d[0].modified)+"")&&B(l,a);const p={};f&135&&(p.$$scope={dirty:f,ctx:d}),c.$set(p)},i(d){h||(m(c.$$.fragment,d),h=!0)},o(d){_(c.$$.fragment,d),h=!1},d(d){d&&($(e),$(u)),v(c,d)}}}function Yl(i){let e,n,t,s;return e=new H({props:{onClick:i[6],label:"Cancel"}}),t=new H({props:{label:"Create"}}),{c(){y(e.$$.fragment),n=O(),y(t.$$.fragment)},m(r,o){w(e,r,o),b(r,n,o),w(t,r,o),s=!0},p(r,o){const a={};o&1&&(a.onClick=r[6]),e.$set(a)},i(r){s||(m(e.$$.fragment,r),m(t.$$.fragment,r),s=!0)},o(r){_(e.$$.fragment,r),_(t.$$.fragment,r),s=!1},d(r){r&&$(n),v(e,r),v(t,r)}}}function Xl(i){let e,n,t,s,r;function o(l){i[5](l)}let a={id:"name",label:"Chapter name",error:i[2]};return i[1]!==void 0&&(a.value=i[1]),e=new ke({props:a}),Z.push(()=>ne(e,"value",o)),s=new x({props:{$$slots:{default:[Yl]},$$scope:{ctx:i}}}),{c(){y(e.$$.fragment),t=O(),y(s.$$.fragment)},m(l,u){w(e,l,u),b(l,t,u),w(s,l,u),r=!0},p(l,u){const c={};u&4&&(c.error=l[2]),!n&&u&2&&(n=!0,c.value=l[1],te(()=>n=!1)),e.$set(c);const h={};u&129&&(h.$$scope={dirty:u,ctx:l}),s.$set(h)},i(l){r||(m(e.$$.fragment,l),m(s.$$.fragment,l),r=!0)},o(l){_(e.$$.fragment,l),_(s.$$.fragment,l),r=!1},d(l){l&&$(t),v(e,l),v(s,l)}}}function Zl(i){let e,n,t,s;e=new ie({props:{header:"Update Book"}});let r=i[0]&&Xn(i);return{c(){y(e.$$.fragment),n=O(),r&&r.c(),t=Y()},m(o,a){w(e,o,a),b(o,n,a),r&&r.m(o,a),b(o,t,a),s=!0},p(o,a){o[0]?r?(r.p(o,a),a&1&&m(r,1)):(r=Xn(o),r.c(),m(r,1),r.m(t.parentNode,t)):r&&(K(),_(r,1,1,()=>{r=null}),G())},i(o){s||(m(e.$$.fragment,o),m(r),s=!0)},o(o){_(e.$$.fragment,o),_(r),s=!1},d(o){o&&($(n),$(t)),v(e,o),r&&r.d(o)}}}function xl(i){let e,n;return e=new oe({props:{$$slots:{default:[Zl]},$$scope:{ctx:i}}}),{c(){y(e.$$.fragment)},m(t,s){w(e,t,s),n=!0},p(t,[s]){const r={};s&135&&(r.$$scope={dirty:s,ctx:t}),e.$set(r)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function eu(i,e,n){let{params:t={id:""}}=e,s=null,r="",o="";const a=async()=>{if(n(2,o=ce(r)),!o){if(!s){Q.setString("No chapter!!");return}await Sl(s.id,s.book_id,r),J("/chapters/list/"+s.book_id)}};pe(async()=>{n(0,s=await sn(parseInt(t.id))),s&&n(1,r=s.name)});function l(c){r=c,n(1,r)}const u=()=>J("/chapters/list/"+(s==null?void 0:s.book_id));return i.$$set=c=>{"params"in c&&n(4,t=c.params)},[s,r,o,a,t,l,u]}class tu extends N{constructor(e){super(),q(this,e,eu,xl,U,{params:4})}}const nu=lt+"questions",St=i=>`${nu}#${i}`,ru=async i=>{let{data:e,error:n}=await X.from("questions").select("*").eq("id",i).single();return n&&Q.setDBError(n),e||null},Et=async i=>{const e=St(i),n=localStorage.getItem(e);if(n)return JSON.parse(n);let{data:t,error:s}=await X.from("questions").select("*").eq("chapter_id",i).order("id");return s&&Q.setDBError(s),t?(localStorage.setItem(e,JSON.stringify(t)),t):[]},su=async(i,e)=>{const{error:n}=await X.from("questions").delete().eq("id",i);return n?(Q.setDBError(n),[]):(localStorage.removeItem(St(e)),Et(e))},iu=async(i,e,n,t)=>{const{error:s}=await X.from("questions").insert([{chapter_id:i,quest:e,answer:n,details:t}]);if(s)return Q.setDBError(s),[];localStorage.removeItem(St(i))},ou=async(i,e,n,t,s)=>{const{error:r}=await X.from("questions").update({quest:n,answer:t,details:s}).eq("id",i);return r?(Q.setDBError(r),[]):(localStorage.removeItem(St(e)),Et(e))},Ut=10,au=async(i,e)=>{const{data:n,error:t}=await X.from("questions").select().ilike(e,`%${i}%`).limit(Ut+1);return t?(Q.setDBError(t),{questions:[],hasMore:!1}):(console.log("search-like:",i,"where:",e,"data:",n),{questions:n.slice(0,Ut),hasMore:n.length==Ut+1})};function lu(i){let e,n;return{c(){e=A("div"),n=L(i[0]),k(e,"class","text-xs font-medium rounded-full shadow-sm bg-teal-500 text-white py-1.5 px-3")},m(t,s){b(t,e,s),C(e,n)},p(t,[s]){s&1&&B(n,t[0])},i:D,o:D,d(t){t&&$(e)}}}function uu(i,e,n){let{text:t}=e;return i.$$set=s=>{"text"in s&&n(0,t=s.text)},[t]}class cu extends N{constructor(e){super(),q(this,e,uu,lu,U,{text:0})}}function Zn(i){let e,n;return e=new cu({props:{text:`Progress: ${i[1]} / 3`}}),{c(){y(e.$$.fragment)},m(t,s){w(e,t,s),n=!0},p(t,s){const r={};s&2&&(r.text=`Progress: ${t[1]} / 3`),e.$set(r)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function xn(i){let e,n,t,s,r=(i[3]?i[0].quest:i[0].answer)+"",o,a,l,u=i[0].details&&er(i);return{c(){e=A("div"),n=A("div"),n.textContent="Answer",t=O(),s=A("div"),o=L(r),a=O(),u&&u.c(),l=Y(),k(n,"class","text-sm font-bold"),k(s,"class","px-3 py-3 mt-2 border border-gray-400 rounded shadow-sm whitespace-pre-line bg-yellow-50")},m(c,h){b(c,e,h),C(e,n),C(e,t),C(e,s),C(s,o),b(c,a,h),u&&u.m(c,h),b(c,l,h)},p(c,h){h&9&&r!==(r=(c[3]?c[0].quest:c[0].answer)+"")&&B(o,r),c[0].details?u?u.p(c,h):(u=er(c),u.c(),u.m(l.parentNode,l)):u&&(u.d(1),u=null)},d(c){c&&($(e),$(a),$(l)),u&&u.d(c)}}}function er(i){let e,n,t,s,r=i[0].details+"",o;return{c(){e=A("div"),n=A("div"),n.textContent="Details",t=O(),s=A("div"),o=L(r),k(n,"class","text-sm font-bold"),k(s,"class","px-3 py-3 mt-2 border border-gray-400 rounded shadow-sm whitespace-pre-line bg-yellow-50")},m(a,l){b(a,e,l),C(e,n),C(e,t),C(e,s),C(s,o)},p(a,l){l&1&&r!==(r=a[0].details+"")&&B(o,r)},d(a){a&&$(e)}}}function fu(i){let e,n,t,s,r,o=i[0].id+"",a,l,u,c,h,d=se(i[0].modified)+"",f,p,g,S=(i[3]?i[0].answer:i[0].quest)+"",T,E,j,P=i[1]>=0&&Zn(i),I=i[2]&&xn(i);return{c(){e=A("div"),n=A("div"),t=A("div"),s=A("div"),r=L("Question Id: "),a=L(o),l=O(),P&&P.c(),u=O(),c=A("div"),h=L("Modified: "),f=L(d),p=O(),g=A("div"),T=L(S),E=O(),I&&I.c(),k(s,"class","text-sm font-bold"),k(c,"class","text-sm"),k(t,"class","flex justify-between items-end"),k(g,"class","px-3 py-3 mt-2 border border-gray-400 rounded shadow-sm whitespace-pre-line bg-yellow-100"),k(e,"class","flex flex-col gap-3")},m(R,M){b(R,e,M),C(e,n),C(n,t),C(t,s),C(s,r),C(s,a),C(t,l),P&&P.m(t,null),C(t,u),C(t,c),C(c,h),C(c,f),C(n,p),C(n,g),C(g,T),C(e,E),I&&I.m(e,null),j=!0},p(R,[M]){(!j||M&1)&&o!==(o=R[0].id+"")&&B(a,o),R[1]>=0?P?(P.p(R,M),M&2&&m(P,1)):(P=Zn(R),P.c(),m(P,1),P.m(t,u)):P&&(K(),_(P,1,1,()=>{P=null}),G()),(!j||M&1)&&d!==(d=se(R[0].modified)+"")&&B(f,d),(!j||M&9)&&S!==(S=(R[3]?R[0].answer:R[0].quest)+"")&&B(T,S),R[2]?I?I.p(R,M):(I=xn(R),I.c(),I.m(e,null)):I&&(I.d(1),I=null)},i(R){j||(m(P),j=!0)},o(R){_(P),j=!1},d(R){R&&$(e),P&&P.d(),I&&I.d()}}}function hu(i,e,n){let{question:t}=e,{progress:s=-1}=e,{showAnswer:r=!0}=e,{reverse:o=!1}=e;return i.$$set=a=>{"question"in a&&n(0,t=a.question),"progress"in a&&n(1,s=a.progress),"showAnswer"in a&&n(2,r=a.showAnswer),"reverse"in a&&n(3,o=a.reverse)},[t,s,r,o]}class ln extends N{constructor(e){super(),q(this,e,hu,fu,U,{question:0,progress:1,showAnswer:2,reverse:3})}}function tr(i,e,n){const t=i.slice();return t[10]=e[n],t}function du(i){let e,n,t,s;function r(){return i[6](i[10])}e=new rn({props:{onClick:r}});function o(){return i[7](i[10])}return t=new nn({props:{onClick:o}}),{c(){y(e.$$.fragment),n=O(),y(t.$$.fragment)},m(a,l){w(e,a,l),b(a,n,l),w(t,a,l),s=!0},p(a,l){i=a;const u={};l&8&&(u.onClick=r),e.$set(u);const c={};l&24&&(c.onClick=o),t.$set(c)},i(a){s||(m(e.$$.fragment,a),m(t.$$.fragment,a),s=!0)},o(a){_(e.$$.fragment,a),_(t.$$.fragment,a),s=!1},d(a){a&&$(n),v(e,a),v(t,a)}}}function nr(i){let e,n,t,s,r,o,a;return n=new ln({props:{question:i[10]}}),r=new x({props:{$$slots:{default:[du]},$$scope:{ctx:i}}}),{c(){e=A("div"),y(n.$$.fragment),t=O(),s=A("div"),y(r.$$.fragment),o=O(),k(s,"class","mt-2 flex justify-end")},m(l,u){b(l,e,u),w(n,e,null),C(e,t),C(e,s),w(r,s,null),C(e,o),a=!0},p(l,u){const c={};u&8&&(c.question=l[10]),n.$set(c);const h={};u&8216&&(h.$$scope={dirty:u,ctx:l}),r.$set(h)},i(l){a||(m(n.$$.fragment,l),m(r.$$.fragment,l),a=!0)},o(l){_(n.$$.fragment,l),_(r.$$.fragment,l),a=!1},d(l){l&&$(e),v(n),v(r)}}}function pu(i){let e,n,t,s;return e=new H({props:{onClick:i[8],label:"Cancel"}}),t=new H({props:{onClick:i[9],label:"Create"}}),{c(){y(e.$$.fragment),n=O(),y(t.$$.fragment)},m(r,o){w(e,r,o),b(r,n,o),w(t,r,o),s=!0},p(r,o){const a={};o&4&&(a.onClick=r[8]),e.$set(a);const l={};o&1&&(l.onClick=r[9]),t.$set(l)},i(r){s||(m(e.$$.fragment,r),m(t.$$.fragment,r),s=!0)},o(r){_(e.$$.fragment,r),_(t.$$.fragment,r),s=!1},d(r){r&&$(n),v(e,r),v(t,r)}}}function mu(i){let e,n,t,s,r,o,a,l;e=new ie({props:{header:"List Chapters"}}),t=new an({props:{book:i[1],chapter:i[2]}});let u=ae(i[3]),c=[];for(let d=0;d<u.length;d+=1)c[d]=nr(tr(i,u,d));const h=d=>_(c[d],1,1,()=>{c[d]=null});return a=new x({props:{$$slots:{default:[pu]},$$scope:{ctx:i}}}),{c(){y(e.$$.fragment),n=O(),y(t.$$.fragment),s=O(),r=A("div");for(let d=0;d<c.length;d+=1)c[d].c();o=O(),y(a.$$.fragment),k(r,"class","flex flex-col gap-5")},m(d,f){w(e,d,f),b(d,n,f),w(t,d,f),b(d,s,f),b(d,r,f);for(let p=0;p<c.length;p+=1)c[p]&&c[p].m(r,null);b(d,o,f),w(a,d,f),l=!0},p(d,f){const p={};if(f&2&&(p.book=d[1]),f&4&&(p.chapter=d[2]),t.$set(p),f&24){u=ae(d[3]);let S;for(S=0;S<u.length;S+=1){const T=tr(d,u,S);c[S]?(c[S].p(T,f),m(c[S],1)):(c[S]=nr(T),c[S].c(),m(c[S],1),c[S].m(r,null))}for(K(),S=u.length;S<c.length;S+=1)h(S);G()}const g={};f&8197&&(g.$$scope={dirty:f,ctx:d}),a.$set(g)},i(d){if(!l){m(e.$$.fragment,d),m(t.$$.fragment,d);for(let f=0;f<u.length;f+=1)m(c[f]);m(a.$$.fragment,d),l=!0}},o(d){_(e.$$.fragment,d),_(t.$$.fragment,d),c=c.filter(Boolean);for(let f=0;f<c.length;f+=1)_(c[f]);_(a.$$.fragment,d),l=!1},d(d){d&&($(n),$(s),$(r),$(o)),v(e,d),v(t,d),Ie(c,d),v(a,d)}}}function rr(i){let e,n;return e=new wt({props:{title:"Delete Question",buttons:i[5],$$slots:{default:[_u]},$$scope:{ctx:i}}}),{c(){y(e.$$.fragment)},m(t,s){w(e,t,s),n=!0},p(t,s){const r={};s&8208&&(r.$$scope={dirty:s,ctx:t}),e.$set(r)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function _u(i){let e,n=i[4].id+"",t,s;return{c(){e=L("Do you want to delete question: '"),t=L(n),s=L("'?")},m(r,o){b(r,e,o),b(r,t,o),b(r,s,o)},p(r,o){o&16&&n!==(n=r[4].id+"")&&B(t,n)},d(r){r&&($(e),$(t),$(s))}}}function gu(i){let e,n,t,s;e=new oe({props:{$$slots:{default:[mu]},$$scope:{ctx:i}}});let r=i[4]&&rr(i);return{c(){y(e.$$.fragment),n=O(),r&&r.c(),t=Y()},m(o,a){w(e,o,a),b(o,n,a),r&&r.m(o,a),b(o,t,a),s=!0},p(o,[a]){const l={};a&8223&&(l.$$scope={dirty:a,ctx:o}),e.$set(l),o[4]?r?(r.p(o,a),a&16&&m(r,1)):(r=rr(o),r.c(),m(r,1),r.m(t.parentNode,t)):r&&(K(),_(r,1,1,()=>{r=null}),G())},i(o){s||(m(e.$$.fragment,o),m(r),s=!0)},o(o){_(e.$$.fragment,o),_(r),s=!1},d(o){o&&($(n),$(t)),v(e,o),r&&r.d(o)}}}function $u(i,e,n){let{params:t={id:0}}=e,s,r,o=[];pe(async()=>{n(2,r=await sn(t.id)),r&&(n(3,o=await Et(r.id)),n(1,s=await yt(r.book_id)))});let a=null;const l=[{label:"Close",onclick:()=>{n(4,a=null)}},{label:"Delete",onclick:async()=>{a&&(n(3,o=await su(a.id,a.chapter_id)),n(4,a=null))}}],u=f=>J("/questions/update/"+f.id),c=f=>{n(4,a=f)},h=()=>J("/chapters/list/"+(r==null?void 0:r.book_id)),d=()=>J("/questions/create/"+t.id);return i.$$set=f=>{"params"in f&&n(0,t=f.params)},[t,s,r,o,a,l,u,c,h,d]}class bu extends N{constructor(e){super(),q(this,e,$u,gu,U,{params:0})}}function sr(i){let e,n,t=i[0].id+"",s,r,o,a=se(i[0].modified)+"",l,u,c,h;return c=new _e({props:{onSubmit:i[6],$$slots:{default:[vu]},$$scope:{ctx:i}}}),{c(){e=A("div"),n=A("span"),s=L(t),r=O(),o=A("span"),l=L(a),u=O(),y(c.$$.fragment),k(e,"class","mb-4 text-small")},m(d,f){b(d,e,f),C(e,n),C(n,s),C(e,r),C(e,o),C(o,l),b(d,u,f),w(c,d,f),h=!0},p(d,f){(!h||f&1)&&t!==(t=d[0].id+"")&&B(s,t),(!h||f&1)&&a!==(a=se(d[0].modified)+"")&&B(l,a);const p={};f&4159&&(p.$$scope={dirty:f,ctx:d}),c.$set(p)},i(d){h||(m(c.$$.fragment,d),h=!0)},o(d){_(c.$$.fragment,d),h=!1},d(d){d&&($(e),$(u)),v(c,d)}}}function wu(i){let e,n,t,s;return e=new H({props:{onClick:i[11],label:"Cancel"}}),t=new H({props:{label:"Update"}}),{c(){y(e.$$.fragment),n=O(),y(t.$$.fragment)},m(r,o){w(e,r,o),b(r,n,o),w(t,r,o),s=!0},p(r,o){const a={};o&1&&(a.onClick=r[11]),e.$set(a)},i(r){s||(m(e.$$.fragment,r),m(t.$$.fragment,r),s=!0)},o(r){_(e.$$.fragment,r),_(t.$$.fragment,r),s=!1},d(r){r&&$(n),v(e,r),v(t,r)}}}function vu(i){let e,n,t,s,r,o,a,l,u,c,h;function d(E){i[8](E)}let f={id:"question",label:"Questione",error:i[2]};i[1]!==void 0&&(f.value=i[1]),e=new ve({props:f}),Z.push(()=>ne(e,"value",d));function p(E){i[9](E)}let g={id:"answer",label:"Answer",error:i[4]};i[3]!==void 0&&(g.value=i[3]),s=new ve({props:g}),Z.push(()=>ne(s,"value",p));function S(E){i[10](E)}let T={id:"details",label:"Details",error:Cu};return i[5]!==void 0&&(T.value=i[5]),a=new ve({props:T}),Z.push(()=>ne(a,"value",S)),c=new x({props:{$$slots:{default:[wu]},$$scope:{ctx:i}}}),{c(){y(e.$$.fragment),t=O(),y(s.$$.fragment),o=O(),y(a.$$.fragment),u=O(),y(c.$$.fragment)},m(E,j){w(e,E,j),b(E,t,j),w(s,E,j),b(E,o,j),w(a,E,j),b(E,u,j),w(c,E,j),h=!0},p(E,j){const P={};j&4&&(P.error=E[2]),!n&&j&2&&(n=!0,P.value=E[1],te(()=>n=!1)),e.$set(P);const I={};j&16&&(I.error=E[4]),!r&&j&8&&(r=!0,I.value=E[3],te(()=>r=!1)),s.$set(I);const R={};!l&&j&32&&(l=!0,R.value=E[5],te(()=>l=!1)),a.$set(R);const M={};j&4097&&(M.$$scope={dirty:j,ctx:E}),c.$set(M)},i(E){h||(m(e.$$.fragment,E),m(s.$$.fragment,E),m(a.$$.fragment,E),m(c.$$.fragment,E),h=!0)},o(E){_(e.$$.fragment,E),_(s.$$.fragment,E),_(a.$$.fragment,E),_(c.$$.fragment,E),h=!1},d(E){E&&($(t),$(o),$(u)),v(e,E),v(s,E),v(a,E),v(c,E)}}}function ku(i){let e,n,t,s;e=new ie({props:{header:"Update Book"}});let r=i[0]&&sr(i);return{c(){y(e.$$.fragment),n=O(),r&&r.c(),t=Y()},m(o,a){w(e,o,a),b(o,n,a),r&&r.m(o,a),b(o,t,a),s=!0},p(o,a){o[0]?r?(r.p(o,a),a&1&&m(r,1)):(r=sr(o),r.c(),m(r,1),r.m(t.parentNode,t)):r&&(K(),_(r,1,1,()=>{r=null}),G())},i(o){s||(m(e.$$.fragment,o),m(r),s=!0)},o(o){_(e.$$.fragment,o),_(r),s=!1},d(o){o&&($(n),$(t)),v(e,o),r&&r.d(o)}}}function yu(i){let e,n;return e=new oe({props:{$$slots:{default:[ku]},$$scope:{ctx:i}}}),{c(){y(e.$$.fragment)},m(t,s){w(e,t,s),n=!0},p(t,[s]){const r={};s&4159&&(r.$$scope={dirty:s,ctx:t}),e.$set(r)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}let Cu="";function Su(i,e,n){let{params:t={id:""}}=e,s=null,r="",o="",a="",l="",u="";const c=async()=>{const g={quest:r.trim(),answer:a.trim()};if(n(2,o=ce(g.quest)),n(4,l=ce(g.answer)),!(o||l)){if(!s){Q.setString("No question!!");return}await ou(s.id,s.chapter_id,g.quest,g.answer,qr(u)),J("/questions/list/"+s.chapter_id)}};pe(async()=>{n(0,s=await ru(parseInt(t.id))),s&&(n(1,r=s.quest),n(3,a=s.answer),n(5,u=s.details?s.details:""))});function h(g){r=g,n(1,r)}function d(g){a=g,n(3,a)}function f(g){u=g,n(5,u)}const p=()=>J("/questions/list/"+(s==null?void 0:s.chapter_id));return i.$$set=g=>{"params"in g&&n(7,t=g.params)},[s,r,o,a,l,u,c,t,h,d,f,p]}class Eu extends N{constructor(e){super(),q(this,e,Su,yu,U,{params:7})}}function Ou(i){let e,n,t,s;return e=new H({props:{onClick:i[10],label:"Cancel"}}),t=new H({props:{label:"Create"}}),{c(){y(e.$$.fragment),n=O(),y(t.$$.fragment)},m(r,o){w(e,r,o),b(r,n,o),w(t,r,o),s=!0},p(r,o){const a={};o&1&&(a.onClick=r[10]),e.$set(a)},i(r){s||(m(e.$$.fragment,r),m(t.$$.fragment,r),s=!0)},o(r){_(e.$$.fragment,r),_(t.$$.fragment,r),s=!1},d(r){r&&$(n),v(e,r),v(t,r)}}}function Au(i){let e,n,t,s,r,o,a,l,u,c,h;function d(E){i[7](E)}let f={id:"question",label:"Question",error:i[2]};i[1]!==void 0&&(f.value=i[1]),e=new ve({props:f}),Z.push(()=>ne(e,"value",d));function p(E){i[8](E)}let g={id:"answer",label:"Answer",error:i[4]};i[3]!==void 0&&(g.value=i[3]),s=new ve({props:g}),Z.push(()=>ne(s,"value",p));function S(E){i[9](E)}let T={id:"details",label:"Details",error:Pu};return i[5]!==void 0&&(T.value=i[5]),a=new ve({props:T}),Z.push(()=>ne(a,"value",S)),c=new x({props:{$$slots:{default:[Ou]},$$scope:{ctx:i}}}),{c(){y(e.$$.fragment),t=O(),y(s.$$.fragment),o=O(),y(a.$$.fragment),u=O(),y(c.$$.fragment)},m(E,j){w(e,E,j),b(E,t,j),w(s,E,j),b(E,o,j),w(a,E,j),b(E,u,j),w(c,E,j),h=!0},p(E,j){const P={};j&4&&(P.error=E[2]),!n&&j&2&&(n=!0,P.value=E[1],te(()=>n=!1)),e.$set(P);const I={};j&16&&(I.error=E[4]),!r&&j&8&&(r=!0,I.value=E[3],te(()=>r=!1)),s.$set(I);const R={};!l&&j&32&&(l=!0,R.value=E[5],te(()=>l=!1)),a.$set(R);const M={};j&2049&&(M.$$scope={dirty:j,ctx:E}),c.$set(M)},i(E){h||(m(e.$$.fragment,E),m(s.$$.fragment,E),m(a.$$.fragment,E),m(c.$$.fragment,E),h=!0)},o(E){_(e.$$.fragment,E),_(s.$$.fragment,E),_(a.$$.fragment,E),_(c.$$.fragment,E),h=!1},d(E){E&&($(t),$(o),$(u)),v(e,E),v(s,E),v(a,E),v(c,E)}}}function Tu(i){let e,n,t,s;return e=new ie({props:{header:"Create Question"}}),t=new _e({props:{onSubmit:i[6],$$slots:{default:[Au]},$$scope:{ctx:i}}}),{c(){y(e.$$.fragment),n=O(),y(t.$$.fragment)},m(r,o){w(e,r,o),b(r,n,o),w(t,r,o),s=!0},p(r,o){const a={};o&2111&&(a.$$scope={dirty:o,ctx:r}),t.$set(a)},i(r){s||(m(e.$$.fragment,r),m(t.$$.fragment,r),s=!0)},o(r){_(e.$$.fragment,r),_(t.$$.fragment,r),s=!1},d(r){r&&$(n),v(e,r),v(t,r)}}}function ju(i){let e,n;return e=new oe({props:{$$slots:{default:[Tu]},$$scope:{ctx:i}}}),{c(){y(e.$$.fragment)},m(t,s){w(e,t,s),n=!0},p(t,[s]){const r={};s&2111&&(r.$$scope={dirty:s,ctx:t}),e.$set(r)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}let Pu="";function Iu(i,e,n){let{params:t={chapter_id:0}}=e,s="",r="",o="",a="",l="";const u=async()=>{const p={question:s.trim(),answer:o.trim()};n(2,r=ce(p.question)),n(4,a=ce(p.answer)),!(r||a)&&(await iu(t.chapter_id,p.question,p.answer,qr(l)),J("/questions/list/"+t.chapter_id))};function c(p){s=p,n(1,s)}function h(p){o=p,n(3,o)}function d(p){l=p,n(5,l)}const f=()=>J("/questions/list/"+t.chapter_id);return i.$$set=p=>{"params"in p&&n(0,t=p.params)},[t,s,r,o,a,l,u,c,h,d,f]}class Ru extends N{constructor(e){super(),q(this,e,Iu,ju,U,{params:0})}}function ir(i,e,n){const t=i.slice();return t[6]=e[n],t}function or(i){let e,n=i[6].label+"",t,s,r;return{c(){e=A("option"),t=L(n),e.__value=s=i[6].value,Je(e,e.__value),e.selected=r=i[6].value===i[0]},m(o,a){b(o,e,a),C(e,t)},p(o,a){a&8&&n!==(n=o[6].label+"")&&B(t,n),a&8&&s!==(s=o[6].value)&&(e.__value=s,Je(e,e.__value)),a&9&&r!==(r=o[6].value===o[0])&&(e.selected=r)},d(o){o&&$(e)}}}function Lu(i){let e,n,t,s=ae(i[3]),r=[];for(let o=0;o<s.length;o+=1)r[o]=or(ir(i,s,o));return{c(){e=A("select");for(let o=0;o<r.length;o+=1)r[o].c();k(e,"id",i[2]),k(e,"name",i[2]),k(e,"class","input"),i[0]===void 0&&_t(()=>i[5].call(e))},m(o,a){b(o,e,a);for(let l=0;l<r.length;l+=1)r[l]&&r[l].m(e,null);fn(e,i[0],!0),n||(t=Qe(e,"change",i[5]),n=!0)},p(o,a){if(a&9){s=ae(o[3]);let l;for(l=0;l<s.length;l+=1){const u=ir(o,s,l);r[l]?r[l].p(u,a):(r[l]=or(u),r[l].c(),r[l].m(e,null))}for(;l<r.length;l+=1)r[l].d(1);r.length=s.length}a&4&&k(e,"id",o[2]),a&4&&k(e,"name",o[2]),a&9&&fn(e,o[0])},d(o){o&&$(e),Ie(r,o),n=!1,t()}}}function Du(i){let e,n;return e=new en({props:{id:i[2],label:i[1],error:i[4],$$slots:{default:[Lu]},$$scope:{ctx:i}}}),{c(){y(e.$$.fragment)},m(t,s){w(e,t,s),n=!0},p(t,[s]){const r={};s&4&&(r.id=t[2]),s&2&&(r.label=t[1]),s&16&&(r.error=t[4]),s&525&&(r.$$scope={dirty:s,ctx:t}),e.$set(r)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function Uu(i,e,n){let{label:t}=e,{id:s}=e,{value:r}=e,{options:o}=e,{error:a=""}=e;function l(){r=Vr(this),n(0,r),n(3,o)}return i.$$set=u=>{"label"in u&&n(1,t=u.label),"id"in u&&n(2,s=u.id),"value"in u&&n(0,r=u.value),"options"in u&&n(3,o=u.options),"error"in u&&n(4,a=u.error)},[r,t,s,o,a,l]}class Kt extends N{constructor(e){super(),q(this,e,Uu,Du,U,{label:1,id:2,value:0,options:3,error:4})}}function ar(i){let e,n,t=i[2].length+"",s;return{c(){e=A("div"),n=L("Length: "),s=L(t)},m(r,o){b(r,e,o),C(e,n),C(e,s)},p(r,o){o&4&&t!==(t=r[2].length+"")&&B(s,t)},d(r){r&&$(e)}}}function lr(i){let e,n;return e=new _e({props:{onSubmit:i[9],$$slots:{default:[Nu]},$$scope:{ctx:i}}}),{c(){y(e.$$.fragment)},m(t,s){w(e,t,s),n=!0},p(t,s){const r={};s&16410&&(r.$$scope={dirty:s,ctx:t}),e.$set(r)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function qu(i){let e,n,t,s;return e=new H({props:{onClick:i[13],label:"Cancel"}}),t=new H({props:{label:"Start"}}),{c(){y(e.$$.fragment),n=O(),y(t.$$.fragment)},m(r,o){w(e,r,o),b(r,n,o),w(t,r,o),s=!0},p(r,o){const a={};o&2&&(a.onClick=r[13]),e.$set(a)},i(r){s||(m(e.$$.fragment,r),m(t.$$.fragment,r),s=!0)},o(r){_(e.$$.fragment,r),_(t.$$.fragment,r),s=!1},d(r){r&&$(n),v(e,r),v(t,r)}}}function Nu(i){let e,n,t,s,r,o,a,l,u;function c(p){i[11](p)}let h={id:"correct",label:"Correct Answers",options:i[6],error:i[5]};i[3]!==void 0&&(h.value=i[3]),n=new Kt({props:h}),Z.push(()=>ne(n,"value",c));function d(p){i[12](p)}let f={id:"reverse",label:"Reverse Answers",options:i[8],error:i[7]};return i[4]!==void 0&&(f.value=i[4]),r=new Kt({props:f}),Z.push(()=>ne(r,"value",d)),l=new x({props:{$$slots:{default:[qu]},$$scope:{ctx:i}}}),{c(){e=A("div"),y(n.$$.fragment),s=O(),y(r.$$.fragment),a=O(),y(l.$$.fragment),k(e,"class","flex flex-row gap-4")},m(p,g){b(p,e,g),w(n,e,null),C(e,s),w(r,e,null),b(p,a,g),w(l,p,g),u=!0},p(p,g){const S={};!t&&g&8&&(t=!0,S.value=p[3],te(()=>t=!1)),n.$set(S);const T={};!o&&g&16&&(o=!0,T.value=p[4],te(()=>o=!1)),r.$set(T);const E={};g&16386&&(E.$$scope={dirty:g,ctx:p}),l.$set(E)},i(p){u||(m(n.$$.fragment,p),m(r.$$.fragment,p),m(l.$$.fragment,p),u=!0)},o(p){_(n.$$.fragment,p),_(r.$$.fragment,p),_(l.$$.fragment,p),u=!1},d(p){p&&($(e),$(a)),v(n),v(r),v(l,p)}}}function Bu(i){let e,n,t,s,r,o,a;e=new ie({props:{header:"List Chapters"}}),t=new an({props:{book:i[0],chapter:i[1]}});let l=i[1]&&ar(i),u=i[2].length!==0&&lr(i);return{c(){y(e.$$.fragment),n=O(),y(t.$$.fragment),s=O(),l&&l.c(),r=O(),u&&u.c(),o=Y()},m(c,h){w(e,c,h),b(c,n,h),w(t,c,h),b(c,s,h),l&&l.m(c,h),b(c,r,h),u&&u.m(c,h),b(c,o,h),a=!0},p(c,h){const d={};h&1&&(d.book=c[0]),h&2&&(d.chapter=c[1]),t.$set(d),c[1]?l?l.p(c,h):(l=ar(c),l.c(),l.m(r.parentNode,r)):l&&(l.d(1),l=null),c[2].length!==0?u?(u.p(c,h),h&4&&m(u,1)):(u=lr(c),u.c(),m(u,1),u.m(o.parentNode,o)):u&&(K(),_(u,1,1,()=>{u=null}),G())},i(c){a||(m(e.$$.fragment,c),m(t.$$.fragment,c),m(u),a=!0)},o(c){_(e.$$.fragment,c),_(t.$$.fragment,c),_(u),a=!1},d(c){c&&($(n),$(s),$(r),$(o)),v(e,c),v(t,c),l&&l.d(c),u&&u.d(c)}}}function Mu(i){let e,n;return e=new oe({props:{$$slots:{default:[Bu]},$$scope:{ctx:i}}}),{c(){y(e.$$.fragment)},m(t,s){w(e,t,s),n=!0},p(t,[s]){const r={};s&16415&&(r.$$scope={dirty:s,ctx:t}),e.$set(r)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function Fu(i,e,n){let{params:t={id:0}}=e,s,r,o=[],a="1",l,u=[{label:"0",value:"0"},{label:"1",value:"1"},{label:"2",value:"2"},{label:"3",value:"3"}],c="false",h,d=[{label:"True",value:"true"},{label:"False",value:"false"}];pe(async()=>{n(1,r=await sn(t.id)),r&&(n(2,o=await Et(r.id)),n(0,s=await yt(r.book_id)),o.length===0&&Q.setString("No questions found for this chapter!"))});const f=async()=>{wa(o,parseInt(a),c==="true"),J("/lession/process")};function p(T){a=T,n(3,a)}function g(T){c=T,n(4,c)}const S=()=>J("/chapters/list/"+(r==null?void 0:r.book_id));return i.$$set=T=>{"params"in T&&n(10,t=T.params)},[s,r,o,a,c,l,u,h,d,f,t,p,g,S]}class zu extends N{constructor(e){super(),q(this,e,Fu,Mu,U,{params:10})}}function Hu(i){let e,n,t,s,r,o,a=i[0][0]+"",l,u,c,h,d,f,p=i[0][1]+"",g,S,T,E,j,P,I=i[0][2]+"",R,M,W,le,un,ut,ct=i[0][3]+"",Ot;return{c(){e=A("div"),n=A("table"),t=A("tr"),s=A("td"),s.textContent="No correct answers",r=O(),o=A("td"),l=L(a),u=O(),c=A("tr"),h=A("td"),h.textContent="One correct answer",d=O(),f=A("td"),g=L(p),S=O(),T=A("tr"),E=A("td"),E.textContent="Two correct answers",j=O(),P=A("td"),R=L(I),M=O(),W=A("tr"),le=A("td"),le.textContent="Learned",un=O(),ut=A("td"),Ot=L(ct),k(s,"class","px-4 py-1 m-1 border-r border-gray-300"),k(o,"class","px-4 py-1 m-1"),k(t,"class",""),k(h,"class","px-4 py-1 m-1 border-r border-gray-300"),k(f,"class","px-4 py-1 m-1"),k(c,"class",""),k(E,"class","px-4 py-1 m-1 border-r border-gray-300"),k(P,"class","px-4 py-1 m-1"),k(T,"class",""),k(le,"class","px-4 py-1 m-1 border-r border-gray-300"),k(ut,"class","px-4 py-1 m-1"),k(W,"class",""),k(e,"class","border border-gray-300 rounded shadow-sm max-w-60 py-3")},m(ge,Le){b(ge,e,Le),C(e,n),C(n,t),C(t,s),C(t,r),C(t,o),C(o,l),C(n,u),C(n,c),C(c,h),C(c,d),C(c,f),C(f,g),C(n,S),C(n,T),C(T,E),C(T,j),C(T,P),C(P,R),C(n,M),C(n,W),C(W,le),C(W,un),C(W,ut),C(ut,Ot)},p(ge,[Le]){Le&1&&a!==(a=ge[0][0]+"")&&B(l,a),Le&1&&p!==(p=ge[0][1]+"")&&B(g,p),Le&1&&I!==(I=ge[0][2]+"")&&B(R,I),Le&1&&ct!==(ct=ge[0][3]+"")&&B(Ot,ct)},i:D,o:D,d(ge){ge&&$(e)}}}function Ju(i,e,n){let{progress:t}=e;return i.$$set=s=>{"progress"in s&&n(0,t=s.progress)},[t]}class Ku extends N{constructor(e){super(),q(this,e,Ju,Hu,U,{progress:0})}}function Gu(i){let e,n;return e=new ln({props:{question:i[2].question,showAnswer:i[4],progress:i[2].progress,reverse:i[0].reverse}}),{c(){y(e.$$.fragment)},m(t,s){w(e,t,s),n=!0},p(t,s){const r={};s&4&&(r.question=t[2].question),s&16&&(r.showAnswer=t[4]),s&4&&(r.progress=t[2].progress),s&1&&(r.reverse=t[0].reverse),e.$set(r)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function Vu(i){let e;return{c(){e=A("p"),e.textContent="End"},m(n,t){b(n,e,t)},p:D,i:D,o:D,d(n){n&&$(e)}}}function ur(i){let e,n,t=i[2]&&cr(i);return{c(){t&&t.c(),e=Y()},m(s,r){t&&t.m(s,r),b(s,e,r),n=!0},p(s,r){s[2]?t?(t.p(s,r),r&4&&m(t,1)):(t=cr(s),t.c(),m(t,1),t.m(e.parentNode,e)):t&&(K(),_(t,1,1,()=>{t=null}),G())},i(s){n||(m(t),n=!0)},o(s){_(t),n=!1},d(s){s&&$(e),t&&t.d(s)}}}function cr(i){let e,n,t,s;const r=[Qu,Wu],o=[];function a(l,u){return l[4]?1:0}return e=a(i),n=o[e]=r[e](i),{c(){n.c(),t=Y()},m(l,u){o[e].m(l,u),b(l,t,u),s=!0},p(l,u){let c=e;e=a(l),e===c?o[e].p(l,u):(K(),_(o[c],1,1,()=>{o[c]=null}),G(),n=o[e],n?n.p(l,u):(n=o[e]=r[e](l),n.c()),m(n,1),n.m(t.parentNode,t))},i(l){s||(m(n),s=!0)},o(l){_(n),s=!1},d(l){l&&$(t),o[e].d(l)}}}function Wu(i){let e,n,t,s,r,o,a,l;return e=new H({props:{label:"Correct",onClick:i[6]}}),t=new H({props:{label:"Wrong",onClick:i[7]}}),r=new H({props:{label:"Learned",onClick:i[8]}}),a=new H({props:{label:"Skip",onClick:i[9]}}),{c(){y(e.$$.fragment),n=O(),y(t.$$.fragment),s=O(),y(r.$$.fragment),o=O(),y(a.$$.fragment)},m(u,c){w(e,u,c),b(u,n,c),w(t,u,c),b(u,s,c),w(r,u,c),b(u,o,c),w(a,u,c),l=!0},p:D,i(u){l||(m(e.$$.fragment,u),m(t.$$.fragment,u),m(r.$$.fragment,u),m(a.$$.fragment,u),l=!0)},o(u){_(e.$$.fragment,u),_(t.$$.fragment,u),_(r.$$.fragment,u),_(a.$$.fragment,u),l=!1},d(u){u&&($(n),$(s),$(o)),v(e,u),v(t,u),v(r,u),v(a,u)}}}function Qu(i){let e,n;return e=new H({props:{label:"Show",onClick:i[5]}}),{c(){y(e.$$.fragment)},m(t,s){w(e,t,s),n=!0},p:D,i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function Yu(i){let e,n,t,s;e=new H({props:{label:"Stop",onClick:i[10]}});let r=!i[3]&&ur(i);return{c(){y(e.$$.fragment),n=O(),r&&r.c(),t=Y()},m(o,a){w(e,o,a),b(o,n,a),r&&r.m(o,a),b(o,t,a),s=!0},p(o,a){o[3]?r&&(K(),_(r,1,1,()=>{r=null}),G()):r?(r.p(o,a),a&8&&m(r,1)):(r=ur(o),r.c(),m(r,1),r.m(t.parentNode,t))},i(o){s||(m(e.$$.fragment,o),m(r),s=!0)},o(o){_(e.$$.fragment,o),_(r),s=!1},d(o){o&&($(n),$(t)),v(e,o),r&&r.d(o)}}}function Xu(i){let e,n,t,s,r,o,a,l,u;e=new ie({props:{header:"Lession"}}),t=new Ku({props:{progress:i[1]}});const c=[Vu,Gu],h=[];function d(f,p){return f[3]?0:f[2]?1:-1}return~(r=d(i))&&(o=h[r]=c[r](i)),l=new x({props:{$$slots:{default:[Yu]},$$scope:{ctx:i}}}),{c(){y(e.$$.fragment),n=O(),y(t.$$.fragment),s=O(),o&&o.c(),a=O(),y(l.$$.fragment)},m(f,p){w(e,f,p),b(f,n,p),w(t,f,p),b(f,s,p),~r&&h[r].m(f,p),b(f,a,p),w(l,f,p),u=!0},p(f,p){const g={};p&2&&(g.progress=f[1]),t.$set(g);let S=r;r=d(f),r===S?~r&&h[r].p(f,p):(o&&(K(),_(h[S],1,1,()=>{h[S]=null}),G()),~r?(o=h[r],o?o.p(f,p):(o=h[r]=c[r](f),o.c()),m(o,1),o.m(a.parentNode,a)):o=null);const T={};p&8220&&(T.$$scope={dirty:p,ctx:f}),l.$set(T)},i(f){u||(m(e.$$.fragment,f),m(t.$$.fragment,f),m(o),m(l.$$.fragment,f),u=!0)},o(f){_(e.$$.fragment,f),_(t.$$.fragment,f),_(o),_(l.$$.fragment,f),u=!1},d(f){f&&($(n),$(s),$(a)),v(e,f),v(t,f),~r&&h[r].d(f),v(l,f)}}}function Zu(i){let e,n;return e=new oe({props:{$$slots:{default:[Xu]},$$scope:{ctx:i}}}),{c(){y(e.$$.fragment)},m(t,s){w(e,t,s),n=!0},p(t,[s]){const r={};s&8223&&(r.$$scope={dirty:s,ctx:t}),e.$set(r)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function xu(i,e,n){let t,s=[0,0,0,0],r,o=!1,a=!1;const l=()=>{n(4,a=!0)},u=S=>{if(n(2,r.progress=S,r),r.progress<3?t.learning.push(r):t.learned.push(r),n(1,s=qn(t)),!va(t)){n(3,o=!0);return}g()},c=()=>{u(r.progress+1)},h=()=>{u(0)},d=()=>{u(3)},f=()=>{u(r.progress)},p=()=>{J("/")},g=()=>{const S=t.learning.shift();S?(n(2,r=S),n(4,a=!1)):n(3,o=!0)};return pe(()=>{const S=Nr();if(!S){Q.setString("No lession found!");return}n(0,t=S),n(1,s=qn(t)),g()}),[t,s,r,o,a,l,c,h,d,f,p]}class ec extends N{constructor(e){super(),q(this,e,xu,Zu,U,{})}}function fr(i,e,n){const t=i.slice();return t[8]=e[n],t}function tc(i){let e,n;return e=new H({props:{disabled:i[4],label:"Search"}}),{c(){y(e.$$.fragment)},m(t,s){w(e,t,s),n=!0},p(t,s){const r={};s&16&&(r.disabled=t[4]),e.$set(r)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function nc(i){let e,n,t,s,r,o,a,l;function u(f){i[6](f)}let c={id:"search",label:"Search Text"};i[0]!==void 0&&(c.value=i[0]),e=new ke({props:c}),Z.push(()=>ne(e,"value",u));function h(f){i[7](f)}let d={id:"where",label:"Where",options:[{label:"Question",value:"quest"},{label:"Answer",value:"answer"},{label:"Details",value:"details"}]};return i[2]!==void 0&&(d.value=i[2]),s=new Kt({props:d}),Z.push(()=>ne(s,"value",h)),a=new x({props:{$$slots:{default:[tc]},$$scope:{ctx:i}}}),{c(){y(e.$$.fragment),t=O(),y(s.$$.fragment),o=O(),y(a.$$.fragment)},m(f,p){w(e,f,p),b(f,t,p),w(s,f,p),b(f,o,p),w(a,f,p),l=!0},p(f,p){const g={};!n&&p&1&&(n=!0,g.value=f[0],te(()=>n=!1)),e.$set(g);const S={};!r&&p&4&&(r=!0,S.value=f[2],te(()=>r=!1)),s.$set(S);const T={};p&2064&&(T.$$scope={dirty:p,ctx:f}),a.$set(T)},i(f){l||(m(e.$$.fragment,f),m(s.$$.fragment,f),m(a.$$.fragment,f),l=!0)},o(f){_(e.$$.fragment,f),_(s.$$.fragment,f),_(a.$$.fragment,f),l=!1},d(f){f&&($(t),$(o)),v(e,f),v(s,f),v(a,f)}}}function rc(i){let e;return{c(){e=A("p"),e.textContent="Nothing found ..."},m(n,t){b(n,e,t)},p:D,i:D,o:D,d(n){n&&$(e)}}}function sc(i){let e,n,t,s=i[3].hasMore&&hr(),r=ae(i[3].questions),o=[];for(let l=0;l<r.length;l+=1)o[l]=dr(fr(i,r,l));const a=l=>_(o[l],1,1,()=>{o[l]=null});return{c(){s&&s.c(),e=O();for(let l=0;l<o.length;l+=1)o[l].c();n=Y()},m(l,u){s&&s.m(l,u),b(l,e,u);for(let c=0;c<o.length;c+=1)o[c]&&o[c].m(l,u);b(l,n,u),t=!0},p(l,u){if(l[3].hasMore?s||(s=hr(),s.c(),s.m(e.parentNode,e)):s&&(s.d(1),s=null),u&8){r=ae(l[3].questions);let c;for(c=0;c<r.length;c+=1){const h=fr(l,r,c);o[c]?(o[c].p(h,u),m(o[c],1)):(o[c]=dr(h),o[c].c(),m(o[c],1),o[c].m(n.parentNode,n))}for(K(),c=r.length;c<o.length;c+=1)a(c);G()}},i(l){if(!t){for(let u=0;u<r.length;u+=1)m(o[u]);t=!0}},o(l){o=o.filter(Boolean);for(let u=0;u<o.length;u+=1)_(o[u]);t=!1},d(l){l&&($(e),$(n)),s&&s.d(l),Ie(o,l)}}}function hr(i){let e;return{c(){e=A("div"),e.textContent="has more ...",k(e,"class","text-red-700")},m(n,t){b(n,e,t)},d(n){n&&$(e)}}}function dr(i){let e,n;return e=new ln({props:{question:i[8]}}),{c(){y(e.$$.fragment)},m(t,s){w(e,t,s),n=!0},p(t,s){const r={};s&8&&(r.question=t[8]),e.$set(r)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function ic(i){let e,n,t,s,r,o,a,l;e=new ie({props:{header:"Search Questions"}}),t=new _e({props:{onSubmit:i[5],$$slots:{default:[nc]},$$scope:{ctx:i}}});const u=[sc,rc],c=[];function h(d,f){return d[3]&&d[3].questions.length>0?0:d[1]!==""?1:-1}return~(o=h(i))&&(a=c[o]=u[o](i)),{c(){y(e.$$.fragment),n=O(),y(t.$$.fragment),s=O(),r=A("div"),a&&a.c(),k(r,"class","flex flex-col gap-16")},m(d,f){w(e,d,f),b(d,n,f),w(t,d,f),b(d,s,f),b(d,r,f),~o&&c[o].m(r,null),l=!0},p(d,f){const p={};f&2069&&(p.$$scope={dirty:f,ctx:d}),t.$set(p);let g=o;o=h(d),o===g?~o&&c[o].p(d,f):(a&&(K(),_(c[g],1,1,()=>{c[g]=null}),G()),~o?(a=c[o],a?a.p(d,f):(a=c[o]=u[o](d),a.c()),m(a,1),a.m(r,null)):a=null)},i(d){l||(m(e.$$.fragment,d),m(t.$$.fragment,d),m(a),l=!0)},o(d){_(e.$$.fragment,d),_(t.$$.fragment,d),_(a),l=!1},d(d){d&&($(n),$(s),$(r)),v(e,d),v(t,d),~o&&c[o].d()}}}function oc(i){let e,n;return e=new oe({props:{$$slots:{default:[ic]},$$scope:{ctx:i}}}),{c(){y(e.$$.fragment)},m(t,s){w(e,t,s),n=!0},p(t,[s]){const r={};s&2079&&(r.$$scope={dirty:s,ctx:t}),e.$set(r)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function ac(i,e,n){let t,s="",r="",o="quest",a;const l=async()=>{n(3,a=await au(s,o)),n(1,r=s)};function u(h){s=h,n(0,s)}function c(h){o=h,n(2,o)}return i.$$.update=()=>{i.$$.dirty&3&&n(4,t=s.length<3||s===r)},[s,r,o,a,t,l,u,c]}class lc extends N{constructor(e){super(),q(this,e,ac,oc,U,{})}}function uc(i){let e,n;return e=new ls({props:{routes:i[0]}}),{c(){y(e.$$.fragment)},m(t,s){w(e,t,s),n=!0},p:D,i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function cc(i){let e,n,t,s,r,o,a;return n=new ks({}),s=new ga({props:{$$slots:{default:[uc]},$$scope:{ctx:i}}}),{c(){e=A("main"),y(n.$$.fragment),t=O(),y(s.$$.fragment),r=O(),o=A("footer"),o.textContent="by Volker Senkel 2024",k(o,"class","text-sm text-end my-4 pt-2 border-t"),k(e,"class","text-gray-600 max-w-screen-lg m-auto mt-4")},m(l,u){b(l,e,u),w(n,e,null),C(e,t),w(s,e,null),C(e,r),C(e,o),a=!0},p(l,[u]){const c={};u&2&&(c.$$scope={dirty:u,ctx:l}),s.$set(c)},i(l){a||(m(n.$$.fragment,l),m(s.$$.fragment,l),a=!0)},o(l){_(n.$$.fragment,l),_(s.$$.fragment,l),a=!1},d(l){l&&$(e),v(n),v(s)}}}function fc(i){return[{"/":Ta,"/books/list":al,"/books/create":_l,"/books/update/:id":kl,"/chapters/list/:id":Hl,"/chapters/create/:book_id":Ql,"/chapters/update/:id":tu,"/questions/list/:id":bu,"/questions/create/:chapter_id":Ru,"/questions/update/:id":Eu,"/lession/prepare/:id":zu,"/lession/process":ec,"/cache":Ba,"/search":lc,"*":za}]}class hc extends N{constructor(e){super(),q(this,e,fc,cc,U,{})}}new hc({target:document.getElementById("app")});
