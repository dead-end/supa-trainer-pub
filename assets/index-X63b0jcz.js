var ss=Object.defineProperty;var is=(i,e,n)=>e in i?ss(i,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):i[e]=n;var Ht=(i,e,n)=>(is(i,typeof e!="symbol"?e+"":e,n),n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))t(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&t(o)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function t(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}})();function D(){}function ct(i,e){for(const n in e)i[n]=e[n];return i}function jr(i){return i()}function An(){return Object.create(null)}function xe(i){i.forEach(jr)}function et(i){return typeof i=="function"}function U(i,e){return i!=i?e==e:i!==e||i&&typeof i=="object"||typeof i=="function"}function os(i){return Object.keys(i).length===0}function Pr(i,...e){if(i==null){for(const t of e)t(void 0);return D}const n=i.subscribe(...e);return n.unsubscribe?()=>n.unsubscribe():n}function ln(i,e,n){i.$$.on_destroy.push(Pr(e,n))}function Ae(i,e,n,t){if(i){const r=Ir(i,e,n,t);return i[0](r)}}function Ir(i,e,n,t){return i[1]&&t?ct(n.ctx.slice(),i[1](t(e))):n.ctx}function Te(i,e,n,t){if(i[2]&&t){const r=i[2](t(n));if(e.dirty===void 0)return r;if(typeof r=="object"){const s=[],o=Math.max(e.dirty.length,r.length);for(let l=0;l<o;l+=1)s[l]=e.dirty[l]|r[l];return s}return e.dirty|r}return e.dirty}function je(i,e,n,t,r,s){if(r){const o=Ir(e,n,t,s);i.p(o,r)}}function Pe(i){if(i.ctx.length>32){const e=[],n=i.ctx.length/32;for(let t=0;t<n;t++)e[t]=-1;return e}return-1}function g(i,e){i.appendChild(e)}function S(i,e,n){i.insertBefore(e,n||null)}function C(i){i.parentNode&&i.parentNode.removeChild(i)}function Be(i,e){for(let n=0;n<i.length;n+=1)i[n]&&i[n].d(e)}function O(i){return document.createElement(i)}function ee(i){return document.createElementNS("http://www.w3.org/2000/svg",i)}function L(i){return document.createTextNode(i)}function E(){return L(" ")}function X(){return L("")}function tt(i,e,n,t){return i.addEventListener(e,n,t),()=>i.removeEventListener(e,n,t)}function as(i){return function(e){return e.preventDefault(),i.call(this,e)}}function y(i,e,n){n==null?i.removeAttribute(e):i.getAttribute(e)!==n&&i.setAttribute(e,n)}function ls(i){return Array.from(i.childNodes)}function B(i,e){e=""+e,i.data!==e&&(i.data=e)}function Ye(i,e){i.value=e??""}function Tn(i,e,n){for(let t=0;t<i.options.length;t+=1){const r=i.options[t];if(r.__value===e){r.selected=!0;return}}(!n||e!==void 0)&&(i.selectedIndex=-1)}function us(i){const e=i.querySelector(":checked");return e&&e.__value}function cs(i,e,{bubbles:n=!1,cancelable:t=!1}={}){return new CustomEvent(i,{detail:e,bubbles:n,cancelable:t})}function Ct(i,e){return new i(e)}let ft;function at(i){ft=i}function At(){if(!ft)throw new Error("Function called outside component initialization");return ft}function me(i){At().$$.on_mount.push(i)}function fs(i){At().$$.after_update.push(i)}function hs(i){At().$$.on_destroy.push(i)}function ds(){const i=At();return(e,n,{cancelable:t=!1}={})=>{const r=i.$$.callbacks[e];if(r){const s=cs(e,n,{cancelable:t});return r.slice().forEach(o=>{o.call(i,s)}),!s.defaultPrevented}return!0}}function jn(i,e){const n=i.$$.callbacks[e.type];n&&n.slice().forEach(t=>t.call(this,e))}const Ge=[],x=[];let We=[];const Zt=[],Rr=Promise.resolve();let xt=!1;function Lr(){xt||(xt=!0,Rr.then(Ur))}function Dr(){return Lr(),Rr}function St(i){We.push(i)}function te(i){Zt.push(i)}const Jt=new Set;let Fe=0;function Ur(){if(Fe!==0)return;const i=ft;do{try{for(;Fe<Ge.length;){const e=Ge[Fe];Fe++,at(e),ps(e.$$)}}catch(e){throw Ge.length=0,Fe=0,e}for(at(null),Ge.length=0,Fe=0;x.length;)x.pop()();for(let e=0;e<We.length;e+=1){const n=We[e];Jt.has(n)||(Jt.add(n),n())}We.length=0}while(Ge.length);for(;Zt.length;)Zt.pop()();xt=!1,Jt.clear(),at(i)}function ps(i){if(i.fragment!==null){i.update(),xe(i.before_update);const e=i.dirty;i.dirty=[-1],i.fragment&&i.fragment.p(i.ctx,e),i.after_update.forEach(St)}}function ms(i){const e=[],n=[];We.forEach(t=>i.indexOf(t)===-1?e.push(t):n.push(t)),n.forEach(t=>t()),We=e}const kt=new Set;let Ne;function V(){Ne={r:0,c:[],p:Ne}}function W(){Ne.r||xe(Ne.c),Ne=Ne.p}function m(i,e){i&&i.i&&(kt.delete(i),i.i(e))}function _(i,e,n,t){if(i&&i.o){if(kt.has(i))return;kt.add(i),Ne.c.push(()=>{kt.delete(i),t&&(n&&i.d(1),t())}),i.o(e)}else t&&t()}function le(i){return(i==null?void 0:i.length)!==void 0?i:Array.from(i)}function Et(i,e){const n={},t={},r={$$scope:1};let s=i.length;for(;s--;){const o=i[s],l=e[s];if(l){for(const a in o)a in l||(t[a]=1);for(const a in l)r[a]||(n[a]=l[a],r[a]=1);i[s]=l}else for(const a in o)r[a]=1}for(const o in t)o in n||(n[o]=void 0);return n}function Ot(i){return typeof i=="object"&&i!==null?i:{}}function ne(i,e,n){const t=i.$$.props[e];t!==void 0&&(i.$$.bound[t]=n,n(i.$$.ctx[t]))}function v(i){i&&i.c()}function b(i,e,n){const{fragment:t,after_update:r}=i.$$;t&&t.m(e,n),St(()=>{const s=i.$$.on_mount.map(jr).filter(et);i.$$.on_destroy?i.$$.on_destroy.push(...s):xe(s),i.$$.on_mount=[]}),r.forEach(St)}function w(i,e){const n=i.$$;n.fragment!==null&&(ms(n.after_update),xe(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function _s(i,e){i.$$.dirty[0]===-1&&(Ge.push(i),Lr(),i.$$.dirty.fill(0)),i.$$.dirty[e/31|0]|=1<<e%31}function q(i,e,n,t,r,s,o=null,l=[-1]){const a=ft;at(i);const u=i.$$={fragment:null,ctx:[],props:s,update:D,not_equal:r,bound:An(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(a?a.$$.context:[])),callbacks:An(),dirty:l,skip_bound:!1,root:e.target||a.$$.root};o&&o(u.root);let c=!1;if(u.ctx=n?n(i,e.props||{},(h,d,...f)=>{const p=f.length?f[0]:d;return u.ctx&&r(u.ctx[h],u.ctx[h]=p)&&(!u.skip_bound&&u.bound[h]&&u.bound[h](p),c&&_s(i,h)),d}):[],u.update(),c=!0,xe(u.before_update),u.fragment=t?t(u.ctx):!1,e.target){if(e.hydrate){const h=ls(e.target);u.fragment&&u.fragment.l(h),h.forEach(C)}else u.fragment&&u.fragment.c();e.intro&&m(i.$$.fragment),b(i,e.target,e.anchor),Ur()}at(a)}class N{constructor(){Ht(this,"$$");Ht(this,"$$set")}$destroy(){w(this,1),this.$destroy=D}$on(e,n){if(!et(n))return D;const t=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return t.push(n),()=>{const r=t.indexOf(n);r!==-1&&t.splice(r,1)}}$set(e){this.$$set&&!os(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const gs="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(gs);const ze=[];function qr(i,e){return{subscribe:Tt(i,e).subscribe}}function Tt(i,e=D){let n;const t=new Set;function r(l){if(U(i,l)&&(i=l,n)){const a=!ze.length;for(const u of t)u[1](),ze.push(u,i);if(a){for(let u=0;u<ze.length;u+=2)ze[u][0](ze[u+1]);ze.length=0}}}function s(l){r(l(i))}function o(l,a=D){const u=[l,a];return t.add(u),t.size===1&&(n=e(r,s)||D),l(i),()=>{t.delete(u),t.size===0&&n&&(n(),n=null)}}return{set:r,update:s,subscribe:o}}function Nr(i,e,n){const t=!Array.isArray(i),r=t?[i]:i;if(!r.every(Boolean))throw new Error("derived() expects stores as input, got a falsy value");const s=e.length<2;return qr(n,(o,l)=>{let a=!1;const u=[];let c=0,h=D;const d=()=>{if(c)return;h();const p=e(t?u[0]:u,o,l);s?o(p):h=et(p)?p:D},f=r.map((p,$)=>Pr(p,k=>{u[$]=k,c&=~(1<<$),a&&d()},()=>{c|=1<<$}));return a=!0,d(),function(){xe(f),h(),a=!1}})}function $s(i,e){if(i instanceof RegExp)return{keys:!1,pattern:i};var n,t,r,s,o=[],l="",a=i.split("/");for(a[0]||a.shift();r=a.shift();)n=r[0],n==="*"?(o.push("wild"),l+="/(.*)"):n===":"?(t=r.indexOf("?",1),s=r.indexOf(".",1),o.push(r.substring(1,~t?t:~s?s:r.length)),l+=~t&&!~s?"(?:/([^/]+?))?":"/([^/]+?)",~s&&(l+=(~t?"?":"")+"\\"+r.substring(s))):l+="/"+r;return{keys:o,pattern:new RegExp("^"+l+"/?$","i")}}function bs(i){let e,n,t;const r=[i[2]];var s=i[0];function o(l,a){let u={};for(let c=0;c<r.length;c+=1)u=ct(u,r[c]);return a!==void 0&&a&4&&(u=ct(u,Et(r,[Ot(l[2])]))),{props:u}}return s&&(e=Ct(s,o(i)),e.$on("routeEvent",i[7])),{c(){e&&v(e.$$.fragment),n=X()},m(l,a){e&&b(e,l,a),S(l,n,a),t=!0},p(l,a){if(a&1&&s!==(s=l[0])){if(e){V();const u=e;_(u.$$.fragment,1,0,()=>{w(u,1)}),W()}s?(e=Ct(s,o(l,a)),e.$on("routeEvent",l[7]),v(e.$$.fragment),m(e.$$.fragment,1),b(e,n.parentNode,n)):e=null}else if(s){const u=a&4?Et(r,[Ot(l[2])]):{};e.$set(u)}},i(l){t||(e&&m(e.$$.fragment,l),t=!0)},o(l){e&&_(e.$$.fragment,l),t=!1},d(l){l&&C(n),e&&w(e,l)}}}function ws(i){let e,n,t;const r=[{params:i[1]},i[2]];var s=i[0];function o(l,a){let u={};for(let c=0;c<r.length;c+=1)u=ct(u,r[c]);return a!==void 0&&a&6&&(u=ct(u,Et(r,[a&2&&{params:l[1]},a&4&&Ot(l[2])]))),{props:u}}return s&&(e=Ct(s,o(i)),e.$on("routeEvent",i[6])),{c(){e&&v(e.$$.fragment),n=X()},m(l,a){e&&b(e,l,a),S(l,n,a),t=!0},p(l,a){if(a&1&&s!==(s=l[0])){if(e){V();const u=e;_(u.$$.fragment,1,0,()=>{w(u,1)}),W()}s?(e=Ct(s,o(l,a)),e.$on("routeEvent",l[6]),v(e.$$.fragment),m(e.$$.fragment,1),b(e,n.parentNode,n)):e=null}else if(s){const u=a&6?Et(r,[a&2&&{params:l[1]},a&4&&Ot(l[2])]):{};e.$set(u)}},i(l){t||(e&&m(e.$$.fragment,l),t=!0)},o(l){e&&_(e.$$.fragment,l),t=!1},d(l){l&&C(n),e&&w(e,l)}}}function vs(i){let e,n,t,r;const s=[ws,bs],o=[];function l(a,u){return a[1]?0:1}return e=l(i),n=o[e]=s[e](i),{c(){n.c(),t=X()},m(a,u){o[e].m(a,u),S(a,t,u),r=!0},p(a,[u]){let c=e;e=l(a),e===c?o[e].p(a,u):(V(),_(o[c],1,1,()=>{o[c]=null}),W(),n=o[e],n?n.p(a,u):(n=o[e]=s[e](a),n.c()),m(n,1),n.m(t.parentNode,t))},i(a){r||(m(n),r=!0)},o(a){_(n),r=!1},d(a){a&&C(t),o[e].d(a)}}}function Pn(){const i=window.location.href.indexOf("#/");let e=i>-1?window.location.href.substr(i+1):"/";const n=e.indexOf("?");let t="";return n>-1&&(t=e.substr(n+1),e=e.substr(0,n)),{location:e,querystring:t}}const un=qr(null,function(e){e(Pn());const n=()=>{e(Pn())};return window.addEventListener("hashchange",n,!1),function(){window.removeEventListener("hashchange",n,!1)}});Nr(un,i=>i.location);Nr(un,i=>i.querystring);const In=Tt(void 0);async function H(i){if(!i||i.length<1||i.charAt(0)!="/"&&i.indexOf("#/")!==0)throw Error("Invalid parameter location");await Dr(),history.replaceState({...history.state,__svelte_spa_router_scrollX:window.scrollX,__svelte_spa_router_scrollY:window.scrollY},void 0),window.location.hash=(i.charAt(0)=="#"?"":"#")+i}function ks(i){i?window.scrollTo(i.__svelte_spa_router_scrollX,i.__svelte_spa_router_scrollY):window.scrollTo(0,0)}function ys(i,e,n){let{routes:t={}}=e,{prefix:r=""}=e,{restoreScrollState:s=!1}=e;class o{constructor(I,R){if(!R||typeof R!="function"&&(typeof R!="object"||R._sveltesparouter!==!0))throw Error("Invalid component object");if(!I||typeof I=="string"&&(I.length<1||I.charAt(0)!="/"&&I.charAt(0)!="*")||typeof I=="object"&&!(I instanceof RegExp))throw Error('Invalid value for "path" argument - strings must start with / or *');const{pattern:M,keys:K}=$s(I);this.path=I,typeof R=="object"&&R._sveltesparouter===!0?(this.component=R.component,this.conditions=R.conditions||[],this.userData=R.userData,this.props=R.props||{}):(this.component=()=>Promise.resolve(R),this.conditions=[],this.props={}),this._pattern=M,this._keys=K}match(I){if(r){if(typeof r=="string")if(I.startsWith(r))I=I.substr(r.length)||"/";else return null;else if(r instanceof RegExp){const re=I.match(r);if(re&&re[0])I=I.substr(re[0].length)||"/";else return null}}const R=this._pattern.exec(I);if(R===null)return null;if(this._keys===!1)return R;const M={};let K=0;for(;K<this._keys.length;){try{M[this._keys[K]]=decodeURIComponent(R[K+1]||"")||null}catch{M[this._keys[K]]=null}K++}return M}async checkConditions(I){for(let R=0;R<this.conditions.length;R++)if(!await this.conditions[R](I))return!1;return!0}}const l=[];t instanceof Map?t.forEach((P,I)=>{l.push(new o(I,P))}):Object.keys(t).forEach(P=>{l.push(new o(P,t[P]))});let a=null,u=null,c={};const h=ds();async function d(P,I){await Dr(),h(P,I)}let f=null,p=null;s&&(p=P=>{P.state&&(P.state.__svelte_spa_router_scrollY||P.state.__svelte_spa_router_scrollX)?f=P.state:f=null},window.addEventListener("popstate",p),fs(()=>{ks(f)}));let $=null,k=null;const T=un.subscribe(async P=>{$=P;let I=0;for(;I<l.length;){const R=l[I].match(P.location);if(!R){I++;continue}const M={route:l[I].path,location:P.location,querystring:P.querystring,userData:l[I].userData,params:R&&typeof R=="object"&&Object.keys(R).length?R:null};if(!await l[I].checkConditions(M)){n(0,a=null),k=null,d("conditionsFailed",M);return}d("routeLoading",Object.assign({},M));const K=l[I].component;if(k!=K){K.loading?(n(0,a=K.loading),k=K,n(1,u=K.loadingParams),n(2,c={}),d("routeLoaded",Object.assign({},M,{component:a,name:a.name,params:u}))):(n(0,a=null),k=null);const re=await K();if(P!=$)return;n(0,a=re&&re.default||re),k=K}R&&typeof R=="object"&&Object.keys(R).length?n(1,u=R):n(1,u=null),n(2,c=l[I].props),d("routeLoaded",Object.assign({},M,{component:a,name:a.name,params:u})).then(()=>{In.set(u)});return}n(0,a=null),k=null,In.set(void 0)});hs(()=>{T(),p&&window.removeEventListener("popstate",p)});function A(P){jn.call(this,i,P)}function j(P){jn.call(this,i,P)}return i.$$set=P=>{"routes"in P&&n(3,t=P.routes),"prefix"in P&&n(4,r=P.prefix),"restoreScrollState"in P&&n(5,s=P.restoreScrollState)},i.$$.update=()=>{i.$$.dirty&32&&(history.scrollRestoration=s?"manual":"auto")},[a,u,c,t,r,s,A,j]}class Cs extends N{constructor(e){super(),q(this,e,ys,vs,U,{routes:3,prefix:4,restoreScrollState:5})}}function Ss(){const{subscribe:i,set:e,update:n}=Tt(null);return{subscribe:i,setDBError:t=>e({msg:t.message,details:t.details}),setAuthError:t=>{e({msg:t.message})},setString:(t,r)=>e({msg:t,details:r}),reset:()=>e(null)}}const Q=Ss();function Es(i){let e,n,t,r;return{c(){e=O("button"),n=L(i[0]),y(e,"class","btn"),e.disabled=i[2],y(e,"type","button")},m(s,o){S(s,e,o),g(e,n),t||(r=tt(e,"click",function(){et(i[1])&&i[1].apply(this,arguments)}),t=!0)},p(s,o){i=s,o&1&&B(n,i[0]),o&4&&(e.disabled=i[2])},d(s){s&&C(e),t=!1,r()}}}function Os(i){let e,n;return{c(){e=O("button"),n=L(i[0]),y(e,"class","btn"),e.disabled=i[2],y(e,"type","submit")},m(t,r){S(t,e,r),g(e,n)},p(t,r){r&1&&B(n,t[0]),r&4&&(e.disabled=t[2])},d(t){t&&C(e)}}}function As(i){let e;function n(s,o){return s[1]==null?Os:Es}let t=n(i),r=t(i);return{c(){r.c(),e=X()},m(s,o){r.m(s,o),S(s,e,o)},p(s,[o]){t===(t=n(s))&&r?r.p(s,o):(r.d(1),r=t(s),r&&(r.c(),r.m(e.parentNode,e)))},i:D,o:D,d(s){s&&C(e),r.d(s)}}}function Ts(i,e,n){let{label:t}=e,{onClick:r=null}=e,{disabled:s=!1}=e;return i.$$set=o=>{"label"in o&&n(0,t=o.label),"onClick"in o&&n(1,r=o.onClick),"disabled"in o&&n(2,s=o.disabled)},[t,r,s]}class J extends N{constructor(e){super(),q(this,e,Ts,As,U,{label:0,onClick:1,disabled:2})}}function js(i){let e,n;const t=i[1].default,r=Ae(t,i,i[0],null);return{c(){e=O("div"),r&&r.c(),y(e,"class","flex gap-4")},m(s,o){S(s,e,o),r&&r.m(e,null),n=!0},p(s,[o]){r&&r.p&&(!n||o&1)&&je(r,t,s,s[0],n?Te(t,s[0],o,null):Pe(s[0]),null)},i(s){n||(m(r,s),n=!0)},o(s){_(r,s),n=!1},d(s){s&&C(e),r&&r.d(s)}}}function Ps(i,e,n){let{$$slots:t={},$$scope:r}=e;return i.$$set=s=>{"$$scope"in s&&n(0,r=s.$$scope)},[r,t]}class Z extends N{constructor(e){super(),q(this,e,Ps,js,U,{})}}function Rn(i,e,n){const t=i.slice();return t[5]=e[n],t}function Ln(i){let e,n;return e=new J({props:{label:i[5].label,onClick:i[5].onclick}}),{c(){v(e.$$.fragment)},m(t,r){b(e,t,r),n=!0},p(t,r){const s={};r&2&&(s.label=t[5].label),r&2&&(s.onClick=t[5].onclick),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}function Is(i){let e,n,t=le(i[1]),r=[];for(let o=0;o<t.length;o+=1)r[o]=Ln(Rn(i,t,o));const s=o=>_(r[o],1,1,()=>{r[o]=null});return{c(){for(let o=0;o<r.length;o+=1)r[o].c();e=X()},m(o,l){for(let a=0;a<r.length;a+=1)r[a]&&r[a].m(o,l);S(o,e,l),n=!0},p(o,l){if(l&2){t=le(o[1]);let a;for(a=0;a<t.length;a+=1){const u=Rn(o,t,a);r[a]?(r[a].p(u,l),m(r[a],1)):(r[a]=Ln(u),r[a].c(),m(r[a],1),r[a].m(e.parentNode,e))}for(V(),a=t.length;a<r.length;a+=1)s(a);W()}},i(o){if(!n){for(let l=0;l<t.length;l+=1)m(r[l]);n=!0}},o(o){r=r.filter(Boolean);for(let l=0;l<r.length;l+=1)_(r[l]);n=!1},d(o){o&&C(e),Be(r,o)}}}function Rs(i){let e,n,t,r,s,o,l,a,u,c,h;const d=i[3].default,f=Ae(d,i,i[4],null);return c=new Z({props:{$$slots:{default:[Is]},$$scope:{ctx:i}}}),{c(){e=O("div"),n=O("div"),t=O("div"),r=L(i[0]),o=E(),l=O("div"),f&&f.c(),a=E(),u=O("div"),v(c.$$.fragment),y(t,"class",s="text-lg pb-2 border-b "+(i[2]==="error"?"text-red-900":"")),y(l,"class","my-6"),y(n,"class","relative top-1/3 mx-auto max-w-md bg-white rounded shadow p-6"),y(e,"class","fixed z-50 inset-0 bg-black bg-opacity-50 overflow-y-auto h-full w-full")},m(p,$){S(p,e,$),g(e,n),g(n,t),g(t,r),g(n,o),g(n,l),f&&f.m(l,null),g(n,a),g(n,u),b(c,u,null),h=!0},p(p,[$]){(!h||$&1)&&B(r,p[0]),(!h||$&4&&s!==(s="text-lg pb-2 border-b "+(p[2]==="error"?"text-red-900":"")))&&y(t,"class",s),f&&f.p&&(!h||$&16)&&je(f,d,p,p[4],h?Te(d,p[4],$,null):Pe(p[4]),null);const k={};$&18&&(k.$$scope={dirty:$,ctx:p}),c.$set(k)},i(p){h||(m(f,p),m(c.$$.fragment,p),h=!0)},o(p){_(f,p),_(c.$$.fragment,p),h=!1},d(p){p&&C(e),f&&f.d(p),w(c)}}}function Ls(i,e,n){let{$$slots:t={},$$scope:r}=e,{title:s}=e,{buttons:o}=e,{type:l="ok"}=e;return i.$$set=a=>{"title"in a&&n(0,s=a.title),"buttons"in a&&n(1,o=a.buttons),"type"in a&&n(2,l=a.type),"$$scope"in a&&n(4,r=a.$$scope)},[s,o,l,t,r]}class Br extends N{constructor(e){super(),q(this,e,Ls,Rs,U,{title:0,buttons:1,type:2})}}function Dn(i){let e,n;return e=new Br({props:{title:"Errors",buttons:i[1],type:"error",$$slots:{default:[Ds]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment)},m(t,r){b(e,t,r),n=!0},p(t,r){const s={};r&5&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}function Un(i){let e,n=i[0].msg+"",t;return{c(){e=O("p"),t=L(n),y(e,"class","text-sm pt-3")},m(r,s){S(r,e,s),g(e,t)},p(r,s){s&1&&n!==(n=r[0].msg+"")&&B(t,n)},d(r){r&&C(e)}}}function Ds(i){let e=i[0].msg+"",n,t,r,s=i[0].details&&Un(i);return{c(){n=L(e),t=E(),s&&s.c(),r=X()},m(o,l){S(o,n,l),S(o,t,l),s&&s.m(o,l),S(o,r,l)},p(o,l){l&1&&e!==(e=o[0].msg+"")&&B(n,e),o[0].details?s?s.p(o,l):(s=Un(o),s.c(),s.m(r.parentNode,r)):s&&(s.d(1),s=null)},d(o){o&&(C(n),C(t),C(r)),s&&s.d(o)}}}function Us(i){let e,n,t=i[0]!==null&&Dn(i);return{c(){t&&t.c(),e=X()},m(r,s){t&&t.m(r,s),S(r,e,s),n=!0},p(r,[s]){r[0]!==null?t?(t.p(r,s),s&1&&m(t,1)):(t=Dn(r),t.c(),m(t,1),t.m(e.parentNode,e)):t&&(V(),_(t,1,1,()=>{t=null}),W())},i(r){n||(m(t),n=!0)},o(r){_(t),n=!1},d(r){r&&C(e),t&&t.d(r)}}}function qs(i,e,n){let t;return ln(i,Q,s=>n(0,t=s)),[t,[{label:"OK",onclick:()=>{Q.reset()}}]]}class Ns extends N{constructor(e){super(),q(this,e,qs,Us,U,{})}}const Bs="modulepreload",Ms=function(i,e){return new URL(i,e).href},qn={},Xe=function(e,n,t){let r=Promise.resolve();if(n&&n.length>0){const s=document.getElementsByTagName("link"),o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));r=Promise.all(n.map(a=>{if(a=Ms(a,t),a in qn)return;qn[a]=!0;const u=a.endsWith(".css"),c=u?'[rel="stylesheet"]':"";if(!!t)for(let f=s.length-1;f>=0;f--){const p=s[f];if(p.href===a&&(!u||p.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${a}"]${c}`))return;const d=document.createElement("link");if(d.rel=u?"stylesheet":Bs,u||(d.as="script",d.crossOrigin=""),d.href=a,l&&d.setAttribute("nonce",l),document.head.appendChild(d),u)return new Promise((f,p)=>{d.addEventListener("load",f),d.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${a}`)))})}))}return r.then(()=>e()).catch(s=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=s,window.dispatchEvent(o),!o.defaultPrevented)throw s})},Fs=i=>{let e;return i?e=i:typeof fetch>"u"?e=(...n)=>Xe(()=>Promise.resolve().then(()=>mt),void 0,import.meta.url).then(({default:t})=>t(...n)):e=fetch,(...n)=>e(...n)};class cn extends Error{constructor(e,n="FunctionsError",t){super(e),this.name=n,this.context=t}}class zs extends cn{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Hs extends cn{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Js extends cn{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var en;(function(i){i.Any="any",i.ApNortheast1="ap-northeast-1",i.ApNortheast2="ap-northeast-2",i.ApSouth1="ap-south-1",i.ApSoutheast1="ap-southeast-1",i.ApSoutheast2="ap-southeast-2",i.CaCentral1="ca-central-1",i.EuCentral1="eu-central-1",i.EuWest1="eu-west-1",i.EuWest2="eu-west-2",i.EuWest3="eu-west-3",i.SaEast1="sa-east-1",i.UsEast1="us-east-1",i.UsWest1="us-west-1",i.UsWest2="us-west-2"})(en||(en={}));var Ks=function(i,e,n,t){function r(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function l(c){try{u(t.next(c))}catch(h){o(h)}}function a(c){try{u(t.throw(c))}catch(h){o(h)}}function u(c){c.done?s(c.value):r(c.value).then(l,a)}u((t=t.apply(i,e||[])).next())})};class Gs{constructor(e,{headers:n={},customFetch:t,region:r=en.Any}={}){this.url=e,this.headers=n,this.region=r,this.fetch=Fs(t)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,n={}){var t;return Ks(this,void 0,void 0,function*(){try{const{headers:r,method:s,body:o}=n;let l={},{region:a}=n;a||(a=this.region),a&&a!=="any"&&(l["x-region"]=a);let u;o&&(r&&!Object.prototype.hasOwnProperty.call(r,"Content-Type")||!r)&&(typeof Blob<"u"&&o instanceof Blob||o instanceof ArrayBuffer?(l["Content-Type"]="application/octet-stream",u=o):typeof o=="string"?(l["Content-Type"]="text/plain",u=o):typeof FormData<"u"&&o instanceof FormData?u=o:(l["Content-Type"]="application/json",u=JSON.stringify(o)));const c=yield this.fetch(`${this.url}/${e}`,{method:s||"POST",headers:Object.assign(Object.assign(Object.assign({},l),this.headers),r),body:u}).catch(p=>{throw new zs(p)}),h=c.headers.get("x-relay-error");if(h&&h==="true")throw new Hs(c);if(!c.ok)throw new Js(c);let d=((t=c.headers.get("Content-Type"))!==null&&t!==void 0?t:"text/plain").split(";")[0].trim(),f;return d==="application/json"?f=yield c.json():d==="application/octet-stream"?f=yield c.blob():d==="text/event-stream"?f=c:d==="multipart/form-data"?f=yield c.formData():f=yield c.text(),{data:f,error:null}}catch(r){return{data:null,error:r}}})}}var Vs=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Ze=Vs();const Ws=Ze.fetch,fn=Ze.fetch.bind(Ze),Mr=Ze.Headers,Qs=Ze.Request,Ys=Ze.Response,mt=Object.freeze(Object.defineProperty({__proto__:null,Headers:Mr,Request:Qs,Response:Ys,default:fn,fetch:Ws},Symbol.toStringTag,{value:"Module"}));class Xs extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}}class Zs{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=fn:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}then(e,n){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const t=this.fetch;let r=t(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async s=>{var o,l,a;let u=null,c=null,h=null,d=s.status,f=s.statusText;if(s.ok){if(this.method!=="HEAD"){const T=await s.text();T===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?c=T:c=JSON.parse(T))}const $=(o=this.headers.Prefer)===null||o===void 0?void 0:o.match(/count=(exact|planned|estimated)/),k=(l=s.headers.get("content-range"))===null||l===void 0?void 0:l.split("/");$&&k&&k.length>1&&(h=parseInt(k[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(c)&&(c.length>1?(u={code:"PGRST116",details:`Results contain ${c.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},c=null,h=null,d=406,f="Not Acceptable"):c.length===1?c=c[0]:c=null)}else{const $=await s.text();try{u=JSON.parse($),Array.isArray(u)&&s.status===404&&(c=[],u=null,d=200,f="OK")}catch{s.status===404&&$===""?(d=204,f="No Content"):u={message:$}}if(u&&this.isMaybeSingle&&(!((a=u==null?void 0:u.details)===null||a===void 0)&&a.includes("0 rows"))&&(u=null,d=200,f="OK"),u&&this.shouldThrowOnError)throw new Xs(u)}return{error:u,data:c,count:h,status:d,statusText:f}});return this.shouldThrowOnError||(r=r.catch(s=>{var o,l,a;return{error:{message:`${(o=s==null?void 0:s.name)!==null&&o!==void 0?o:"FetchError"}: ${s==null?void 0:s.message}`,details:`${(l=s==null?void 0:s.stack)!==null&&l!==void 0?l:""}`,hint:"",code:`${(a=s==null?void 0:s.code)!==null&&a!==void 0?a:""}`},data:null,count:null,status:0,statusText:""}})),r.then(e,n)}}class xs extends Zs{select(e){let n=!1;const t=(e??"*").split("").map(r=>/\s/.test(r)&&!n?"":(r==='"'&&(n=!n),r)).join("");return this.url.searchParams.set("select",t),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e,{ascending:n=!0,nullsFirst:t,foreignTable:r,referencedTable:s=r}={}){const o=s?`${s}.order`:"order",l=this.url.searchParams.get(o);return this.url.searchParams.set(o,`${l?`${l},`:""}${e}.${n?"asc":"desc"}${t===void 0?"":t?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:n,referencedTable:t=n}={}){const r=typeof t>"u"?"limit":`${t}.limit`;return this.url.searchParams.set(r,`${e}`),this}range(e,n,{foreignTable:t,referencedTable:r=t}={}){const s=typeof r>"u"?"offset":`${r}.offset`,o=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(s,`${e}`),this.url.searchParams.set(o,`${n-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:e=!1,verbose:n=!1,settings:t=!1,buffers:r=!1,wal:s=!1,format:o="text"}={}){var l;const a=[e?"analyze":null,n?"verbose":null,t?"settings":null,r?"buffers":null,s?"wal":null].filter(Boolean).join("|"),u=(l=this.headers.Accept)!==null&&l!==void 0?l:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${o}; for="${u}"; options=${a};`,o==="json"?this:this}rollback(){var e;return((e=this.headers.Prefer)!==null&&e!==void 0?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}class Ve extends xs{eq(e,n){return this.url.searchParams.append(e,`eq.${n}`),this}neq(e,n){return this.url.searchParams.append(e,`neq.${n}`),this}gt(e,n){return this.url.searchParams.append(e,`gt.${n}`),this}gte(e,n){return this.url.searchParams.append(e,`gte.${n}`),this}lt(e,n){return this.url.searchParams.append(e,`lt.${n}`),this}lte(e,n){return this.url.searchParams.append(e,`lte.${n}`),this}like(e,n){return this.url.searchParams.append(e,`like.${n}`),this}likeAllOf(e,n){return this.url.searchParams.append(e,`like(all).{${n.join(",")}}`),this}likeAnyOf(e,n){return this.url.searchParams.append(e,`like(any).{${n.join(",")}}`),this}ilike(e,n){return this.url.searchParams.append(e,`ilike.${n}`),this}ilikeAllOf(e,n){return this.url.searchParams.append(e,`ilike(all).{${n.join(",")}}`),this}ilikeAnyOf(e,n){return this.url.searchParams.append(e,`ilike(any).{${n.join(",")}}`),this}is(e,n){return this.url.searchParams.append(e,`is.${n}`),this}in(e,n){const t=Array.from(new Set(n)).map(r=>typeof r=="string"&&new RegExp("[,()]").test(r)?`"${r}"`:`${r}`).join(",");return this.url.searchParams.append(e,`in.(${t})`),this}contains(e,n){return typeof n=="string"?this.url.searchParams.append(e,`cs.${n}`):Array.isArray(n)?this.url.searchParams.append(e,`cs.{${n.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(n)}`),this}containedBy(e,n){return typeof n=="string"?this.url.searchParams.append(e,`cd.${n}`):Array.isArray(n)?this.url.searchParams.append(e,`cd.{${n.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(n)}`),this}rangeGt(e,n){return this.url.searchParams.append(e,`sr.${n}`),this}rangeGte(e,n){return this.url.searchParams.append(e,`nxl.${n}`),this}rangeLt(e,n){return this.url.searchParams.append(e,`sl.${n}`),this}rangeLte(e,n){return this.url.searchParams.append(e,`nxr.${n}`),this}rangeAdjacent(e,n){return this.url.searchParams.append(e,`adj.${n}`),this}overlaps(e,n){return typeof n=="string"?this.url.searchParams.append(e,`ov.${n}`):this.url.searchParams.append(e,`ov.{${n.join(",")}}`),this}textSearch(e,n,{config:t,type:r}={}){let s="";r==="plain"?s="pl":r==="phrase"?s="ph":r==="websearch"&&(s="w");const o=t===void 0?"":`(${t})`;return this.url.searchParams.append(e,`${s}fts${o}.${n}`),this}match(e){return Object.entries(e).forEach(([n,t])=>{this.url.searchParams.append(n,`eq.${t}`)}),this}not(e,n,t){return this.url.searchParams.append(e,`not.${n}.${t}`),this}or(e,{foreignTable:n,referencedTable:t=n}={}){const r=t?`${t}.or`:"or";return this.url.searchParams.append(r,`(${e})`),this}filter(e,n,t){return this.url.searchParams.append(e,`${n}.${t}`),this}}class ei{constructor(e,{headers:n={},schema:t,fetch:r}){this.url=e,this.headers=n,this.schema=t,this.fetch=r}select(e,{head:n=!1,count:t}={}){const r=n?"HEAD":"GET";let s=!1;const o=(e??"*").split("").map(l=>/\s/.test(l)&&!s?"":(l==='"'&&(s=!s),l)).join("");return this.url.searchParams.set("select",o),t&&(this.headers.Prefer=`count=${t}`),new Ve({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e,{count:n,defaultToNull:t=!0}={}){const r="POST",s=[];if(this.headers.Prefer&&s.push(this.headers.Prefer),n&&s.push(`count=${n}`),t||s.push("missing=default"),this.headers.Prefer=s.join(","),Array.isArray(e)){const o=e.reduce((l,a)=>l.concat(Object.keys(a)),[]);if(o.length>0){const l=[...new Set(o)].map(a=>`"${a}"`);this.url.searchParams.set("columns",l.join(","))}}return new Ve({method:r,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e,{onConflict:n,ignoreDuplicates:t=!1,count:r,defaultToNull:s=!0}={}){const o="POST",l=[`resolution=${t?"ignore":"merge"}-duplicates`];if(n!==void 0&&this.url.searchParams.set("on_conflict",n),this.headers.Prefer&&l.push(this.headers.Prefer),r&&l.push(`count=${r}`),s||l.push("missing=default"),this.headers.Prefer=l.join(","),Array.isArray(e)){const a=e.reduce((u,c)=>u.concat(Object.keys(c)),[]);if(a.length>0){const u=[...new Set(a)].map(c=>`"${c}"`);this.url.searchParams.set("columns",u.join(","))}}return new Ve({method:o,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e,{count:n}={}){const t="PATCH",r=[];return this.headers.Prefer&&r.push(this.headers.Prefer),n&&r.push(`count=${n}`),this.headers.Prefer=r.join(","),new Ve({method:t,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete({count:e}={}){const n="DELETE",t=[];return e&&t.push(`count=${e}`),this.headers.Prefer&&t.unshift(this.headers.Prefer),this.headers.Prefer=t.join(","),new Ve({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}const ti="1.15.2",ni={"X-Client-Info":`postgrest-js/${ti}`};class hn{constructor(e,{headers:n={},schema:t,fetch:r}={}){this.url=e,this.headers=Object.assign(Object.assign({},ni),n),this.schemaName=t,this.fetch=r}from(e){const n=new URL(`${this.url}/${e}`);return new ei(n,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new hn(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,n={},{head:t=!1,get:r=!1,count:s}={}){let o;const l=new URL(`${this.url}/rpc/${e}`);let a;t||r?(o=t?"HEAD":"GET",Object.entries(n).filter(([c,h])=>h!==void 0).map(([c,h])=>[c,Array.isArray(h)?`{${h.join(",")}}`:`${h}`]).forEach(([c,h])=>{l.searchParams.append(c,h)})):(o="POST",a=n);const u=Object.assign({},this.headers);return s&&(u.Prefer=`count=${s}`),new Ve({method:o,url:l,headers:u,schema:this.schemaName,body:a,fetch:this.fetch,allowEmpty:!1})}}const ri="2.9.5",si={"X-Client-Info":`realtime-js/${ri}`},ii="1.0.0",Fr=1e4,oi=1e3;var Qe;(function(i){i[i.connecting=0]="connecting",i[i.open=1]="open",i[i.closing=2]="closing",i[i.closed=3]="closed"})(Qe||(Qe={}));var ce;(function(i){i.closed="closed",i.errored="errored",i.joined="joined",i.joining="joining",i.leaving="leaving"})(ce||(ce={}));var pe;(function(i){i.close="phx_close",i.error="phx_error",i.join="phx_join",i.reply="phx_reply",i.leave="phx_leave",i.access_token="access_token"})(pe||(pe={}));var tn;(function(i){i.websocket="websocket"})(tn||(tn={}));var qe;(function(i){i.Connecting="connecting",i.Open="open",i.Closing="closing",i.Closed="closed"})(qe||(qe={}));class zr{constructor(e,n){this.callback=e,this.timerCalc=n,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=n}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}class ai{constructor(){this.HEADER_LENGTH=1}decode(e,n){return e.constructor===ArrayBuffer?n(this._binaryDecode(e)):n(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const n=new DataView(e),t=new TextDecoder;return this._decodeBroadcast(e,n,t)}_decodeBroadcast(e,n,t){const r=n.getUint8(1),s=n.getUint8(2);let o=this.HEADER_LENGTH+2;const l=t.decode(e.slice(o,o+r));o=o+r;const a=t.decode(e.slice(o,o+s));o=o+s;const u=JSON.parse(t.decode(e.slice(o,e.byteLength)));return{ref:null,topic:l,event:a,payload:u}}}class Kt{constructor(e,n,t={},r=Fr){this.channel=e,this.event=n,this.payload=t,this.timeout=r,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,n){var t;return this._hasReceived(e)&&n((t=this.receivedResp)===null||t===void 0?void 0:t.response),this.recHooks.push({status:e,callback:n}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=n=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=n,this._matchReceive(n)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,n){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:n})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:n}){this.recHooks.filter(t=>t.status===e).forEach(t=>t.callback(n))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Nn;(function(i){i.SYNC="sync",i.JOIN="join",i.LEAVE="leave"})(Nn||(Nn={}));class lt{constructor(e,n){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const t=(n==null?void 0:n.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(t.state,{},r=>{const{onJoin:s,onLeave:o,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=lt.syncState(this.state,r,s,o),this.pendingDiffs.forEach(a=>{this.state=lt.syncDiff(this.state,a,s,o)}),this.pendingDiffs=[],l()}),this.channel._on(t.diff,{},r=>{const{onJoin:s,onLeave:o,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(r):(this.state=lt.syncDiff(this.state,r,s,o),l())}),this.onJoin((r,s,o)=>{this.channel._trigger("presence",{event:"join",key:r,currentPresences:s,newPresences:o})}),this.onLeave((r,s,o)=>{this.channel._trigger("presence",{event:"leave",key:r,currentPresences:s,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,n,t,r){const s=this.cloneDeep(e),o=this.transformState(n),l={},a={};return this.map(s,(u,c)=>{o[u]||(a[u]=c)}),this.map(o,(u,c)=>{const h=s[u];if(h){const d=c.map(k=>k.presence_ref),f=h.map(k=>k.presence_ref),p=c.filter(k=>f.indexOf(k.presence_ref)<0),$=h.filter(k=>d.indexOf(k.presence_ref)<0);p.length>0&&(l[u]=p),$.length>0&&(a[u]=$)}else l[u]=c}),this.syncDiff(s,{joins:l,leaves:a},t,r)}static syncDiff(e,n,t,r){const{joins:s,leaves:o}={joins:this.transformState(n.joins),leaves:this.transformState(n.leaves)};return t||(t=()=>{}),r||(r=()=>{}),this.map(s,(l,a)=>{var u;const c=(u=e[l])!==null&&u!==void 0?u:[];if(e[l]=this.cloneDeep(a),c.length>0){const h=e[l].map(f=>f.presence_ref),d=c.filter(f=>h.indexOf(f.presence_ref)<0);e[l].unshift(...d)}t(l,c,a)}),this.map(o,(l,a)=>{let u=e[l];if(!u)return;const c=a.map(h=>h.presence_ref);u=u.filter(h=>c.indexOf(h.presence_ref)<0),e[l]=u,r(l,u,a),u.length===0&&delete e[l]}),e}static map(e,n){return Object.getOwnPropertyNames(e).map(t=>n(t,e[t]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((n,t)=>{const r=e[t];return"metas"in r?n[t]=r.metas.map(s=>(s.presence_ref=s.phx_ref,delete s.phx_ref,delete s.phx_ref_prev,s)):n[t]=r,n},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var G;(function(i){i.abstime="abstime",i.bool="bool",i.date="date",i.daterange="daterange",i.float4="float4",i.float8="float8",i.int2="int2",i.int4="int4",i.int4range="int4range",i.int8="int8",i.int8range="int8range",i.json="json",i.jsonb="jsonb",i.money="money",i.numeric="numeric",i.oid="oid",i.reltime="reltime",i.text="text",i.time="time",i.timestamp="timestamp",i.timestamptz="timestamptz",i.timetz="timetz",i.tsrange="tsrange",i.tstzrange="tstzrange"})(G||(G={}));const Bn=(i,e,n={})=>{var t;const r=(t=n.skipTypes)!==null&&t!==void 0?t:[];return Object.keys(e).reduce((s,o)=>(s[o]=li(o,i,e,r),s),{})},li=(i,e,n,t)=>{const r=e.find(l=>l.name===i),s=r==null?void 0:r.type,o=n[i];return s&&!t.includes(s)?Hr(s,o):nn(o)},Hr=(i,e)=>{if(i.charAt(0)==="_"){const n=i.slice(1,i.length);return hi(e,n)}switch(i){case G.bool:return ui(e);case G.float4:case G.float8:case G.int2:case G.int4:case G.int8:case G.numeric:case G.oid:return ci(e);case G.json:case G.jsonb:return fi(e);case G.timestamp:return di(e);case G.abstime:case G.date:case G.daterange:case G.int4range:case G.int8range:case G.money:case G.reltime:case G.text:case G.time:case G.timestamptz:case G.timetz:case G.tsrange:case G.tstzrange:return nn(e);default:return nn(e)}},nn=i=>i,ui=i=>{switch(i){case"t":return!0;case"f":return!1;default:return i}},ci=i=>{if(typeof i=="string"){const e=parseFloat(i);if(!Number.isNaN(e))return e}return i},fi=i=>{if(typeof i=="string")try{return JSON.parse(i)}catch(e){return console.log(`JSON parse error: ${e}`),i}return i},hi=(i,e)=>{if(typeof i!="string")return i;const n=i.length-1,t=i[n];if(i[0]==="{"&&t==="}"){let s;const o=i.slice(1,n);try{s=JSON.parse("["+o+"]")}catch{s=o?o.split(","):[]}return s.map(l=>Hr(e,l))}return i},di=i=>typeof i=="string"?i.replace(" ","T"):i;var Mn;(function(i){i.ALL="*",i.INSERT="INSERT",i.UPDATE="UPDATE",i.DELETE="DELETE"})(Mn||(Mn={}));var Fn;(function(i){i.BROADCAST="broadcast",i.PRESENCE="presence",i.POSTGRES_CHANGES="postgres_changes"})(Fn||(Fn={}));var zn;(function(i){i.SUBSCRIBED="SUBSCRIBED",i.TIMED_OUT="TIMED_OUT",i.CLOSED="CLOSED",i.CHANNEL_ERROR="CHANNEL_ERROR"})(zn||(zn={}));class dn{constructor(e,n={config:{}},t){this.topic=e,this.params=n,this.socket=t,this.bindings={},this.state=ce.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""}},n.config),this.timeout=this.socket.timeout,this.joinPush=new Kt(this,pe.join,this.params,this.timeout),this.rejoinTimer=new zr(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=ce.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(r=>r.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=ce.closed,this.socket._remove(this)}),this._onError(r=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,r),this.state=ce.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=ce.errored,this.rejoinTimer.scheduleTimeout())}),this._on(pe.reply,{},(r,s)=>{this._trigger(this._replyEventName(s),r)}),this.presence=new lt(this),this.broadcastEndpointURL=this._broadcastEndpointURL()}subscribe(e,n=this.timeout){var t,r;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:s,presence:o}}=this.params;this._onError(u=>e&&e("CHANNEL_ERROR",u)),this._onClose(()=>e&&e("CLOSED"));const l={},a={broadcast:s,presence:o,postgres_changes:(r=(t=this.bindings.postgres_changes)===null||t===void 0?void 0:t.map(u=>u.filter))!==null&&r!==void 0?r:[]};this.socket.accessToken&&(l.access_token=this.socket.accessToken),this.updateJoinPayload(Object.assign({config:a},l)),this.joinedOnce=!0,this._rejoin(n),this.joinPush.receive("ok",({postgres_changes:u})=>{var c;if(this.socket.accessToken&&this.socket.setAuth(this.socket.accessToken),u===void 0){e&&e("SUBSCRIBED");return}else{const h=this.bindings.postgres_changes,d=(c=h==null?void 0:h.length)!==null&&c!==void 0?c:0,f=[];for(let p=0;p<d;p++){const $=h[p],{filter:{event:k,schema:T,table:A,filter:j}}=$,P=u&&u[p];if(P&&P.event===k&&P.schema===T&&P.table===A&&P.filter===j)f.push(Object.assign(Object.assign({},$),{id:P.id}));else{this.unsubscribe(),e&&e("CHANNEL_ERROR",new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=f,e&&e("SUBSCRIBED");return}}).receive("error",u=>{e&&e("CHANNEL_ERROR",new Error(JSON.stringify(Object.values(u).join(", ")||"error")))}).receive("timeout",()=>{e&&e("TIMED_OUT")})}return this}presenceState(){return this.presence.state}async track(e,n={}){return await this.send({type:"presence",event:"track",payload:e},n.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,n,t){return this._on(e,n,t)}async send(e,n={}){var t,r;if(!this._canPush()&&e.type==="broadcast"){const{event:s,payload:o}=e,l={method:"POST",headers:{apikey:(t=this.socket.apiKey)!==null&&t!==void 0?t:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:o}]})};try{return(await this._fetchWithTimeout(this.broadcastEndpointURL,l,(r=n.timeout)!==null&&r!==void 0?r:this.timeout)).ok?"ok":"error"}catch(a){return a.name==="AbortError"?"timed out":"error"}}else return new Promise(s=>{var o,l,a;const u=this._push(e.type,e,n.timeout||this.timeout);e.type==="broadcast"&&!(!((a=(l=(o=this.params)===null||o===void 0?void 0:o.config)===null||l===void 0?void 0:l.broadcast)===null||a===void 0)&&a.ack)&&s("ok"),u.receive("ok",()=>s("ok")),u.receive("error",()=>s("error")),u.receive("timeout",()=>s("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=ce.leaving;const n=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(pe.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(t=>{const r=new Kt(this,pe.leave,{},e);r.receive("ok",()=>{n(),t("ok")}).receive("timeout",()=>{n(),t("timed out")}).receive("error",()=>{t("error")}),r.send(),this._canPush()||r.trigger("ok",{})})}_broadcastEndpointURL(){let e=this.socket.endPoint;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")+"/api/broadcast"}async _fetchWithTimeout(e,n,t){const r=new AbortController,s=setTimeout(()=>r.abort(),t),o=await this.socket.fetch(e,Object.assign(Object.assign({},n),{signal:r.signal}));return clearTimeout(s),o}_push(e,n,t=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let r=new Kt(this,e,n,t);return this._canPush()?r.send():(r.startTimeout(),this.pushBuffer.push(r)),r}_onMessage(e,n,t){return n}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,n,t){var r,s;const o=e.toLocaleLowerCase(),{close:l,error:a,leave:u,join:c}=pe;if(t&&[l,a,u,c].indexOf(o)>=0&&t!==this._joinRef())return;let d=this._onMessage(o,n,t);if(n&&!d)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(r=this.bindings.postgres_changes)===null||r===void 0||r.filter(f=>{var p,$,k;return((p=f.filter)===null||p===void 0?void 0:p.event)==="*"||((k=($=f.filter)===null||$===void 0?void 0:$.event)===null||k===void 0?void 0:k.toLocaleLowerCase())===o}).map(f=>f.callback(d,t)):(s=this.bindings[o])===null||s===void 0||s.filter(f=>{var p,$,k,T,A,j;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in f){const P=f.id,I=(p=f.filter)===null||p===void 0?void 0:p.event;return P&&(($=n.ids)===null||$===void 0?void 0:$.includes(P))&&(I==="*"||(I==null?void 0:I.toLocaleLowerCase())===((k=n.data)===null||k===void 0?void 0:k.type.toLocaleLowerCase()))}else{const P=(A=(T=f==null?void 0:f.filter)===null||T===void 0?void 0:T.event)===null||A===void 0?void 0:A.toLocaleLowerCase();return P==="*"||P===((j=n==null?void 0:n.event)===null||j===void 0?void 0:j.toLocaleLowerCase())}else return f.type.toLocaleLowerCase()===o}).map(f=>{if(typeof d=="object"&&"ids"in d){const p=d.data,{schema:$,table:k,commit_timestamp:T,type:A,errors:j}=p;d=Object.assign(Object.assign({},{schema:$,table:k,commit_timestamp:T,eventType:A,new:{},old:{},errors:j}),this._getPayloadRecords(p))}f.callback(d,t)})}_isClosed(){return this.state===ce.closed}_isJoined(){return this.state===ce.joined}_isJoining(){return this.state===ce.joining}_isLeaving(){return this.state===ce.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,n,t){const r=e.toLocaleLowerCase(),s={type:r,filter:n,callback:t};return this.bindings[r]?this.bindings[r].push(s):this.bindings[r]=[s],this}_off(e,n){const t=e.toLocaleLowerCase();return this.bindings[t]=this.bindings[t].filter(r=>{var s;return!(((s=r.type)===null||s===void 0?void 0:s.toLocaleLowerCase())===t&&dn.isEqual(r.filter,n))}),this}static isEqual(e,n){if(Object.keys(e).length!==Object.keys(n).length)return!1;for(const t in e)if(e[t]!==n[t])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(pe.close,{},e)}_onError(e){this._on(pe.error,{},n=>e(n))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=ce.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const n={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(n.new=Bn(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(n.old=Bn(e.columns,e.old_record)),n}}const pi=()=>{},mi=typeof WebSocket<"u";class _i{constructor(e,n){var t;this.accessToken=null,this.apiKey=null,this.channels=[],this.endPoint="",this.headers=si,this.params={},this.timeout=Fr,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=pi,this.conn=null,this.sendBuffer=[],this.serializer=new ai,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this._resolveFetch=s=>{let o;return s?o=s:typeof fetch>"u"?o=(...l)=>Xe(()=>Promise.resolve().then(()=>mt),void 0,import.meta.url).then(({default:a})=>a(...l)):o=fetch,(...l)=>o(...l)},this.endPoint=`${e}/${tn.websocket}`,n!=null&&n.transport?this.transport=n.transport:this.transport=null,n!=null&&n.params&&(this.params=n.params),n!=null&&n.headers&&(this.headers=Object.assign(Object.assign({},this.headers),n.headers)),n!=null&&n.timeout&&(this.timeout=n.timeout),n!=null&&n.logger&&(this.logger=n.logger),n!=null&&n.heartbeatIntervalMs&&(this.heartbeatIntervalMs=n.heartbeatIntervalMs);const r=(t=n==null?void 0:n.params)===null||t===void 0?void 0:t.apikey;r&&(this.accessToken=r,this.apiKey=r),this.reconnectAfterMs=n!=null&&n.reconnectAfterMs?n.reconnectAfterMs:s=>[1e3,2e3,5e3,1e4][s-1]||1e4,this.encode=n!=null&&n.encode?n.encode:(s,o)=>o(JSON.stringify(s)),this.decode=n!=null&&n.decode?n.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new zr(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(n==null?void 0:n.fetch)}connect(){if(!this.conn){if(this.transport){this.conn=new this.transport(this._endPointURL(),void 0,{headers:this.headers});return}if(mi){this.conn=new WebSocket(this._endPointURL()),this.setupConnection();return}this.conn=new gi(this._endPointURL(),void 0,{close:()=>{this.conn=null}}),Xe(()=>import("./browser-BImCA5dO.js").then(e=>e.b),[],import.meta.url).then(({default:e})=>{this.conn=new e(this._endPointURL(),void 0,{headers:this.headers}),this.setupConnection()})}}disconnect(e,n){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,n??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(e){const n=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),n}async removeAllChannels(){const e=await Promise.all(this.channels.map(n=>n.unsubscribe()));return this.disconnect(),e}log(e,n,t){this.logger(e,n,t)}connectionState(){switch(this.conn&&this.conn.readyState){case Qe.connecting:return qe.Connecting;case Qe.open:return qe.Open;case Qe.closing:return qe.Closing;default:return qe.Closed}}isConnected(){return this.connectionState()===qe.Open}channel(e,n={config:{}}){const t=new dn(`realtime:${e}`,n,this);return this.channels.push(t),t}push(e){const{topic:n,event:t,payload:r,ref:s}=e,o=()=>{this.encode(e,l=>{var a;(a=this.conn)===null||a===void 0||a.send(l)})};this.log("push",`${n} ${t} (${s})`,r),this.isConnected()?o():this.sendBuffer.push(o)}setAuth(e){this.accessToken=e,this.channels.forEach(n=>{e&&n.updateJoinPayload({access_token:e}),n.joinedOnce&&n._isJoined()&&n._push(pe.access_token,{access_token:e})})}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let n=this.channels.find(t=>t.topic===e&&(t._isJoined()||t._isJoining()));n&&(this.log("transport",`leaving duplicate topic "${e}"`),n.unsubscribe())}_remove(e){this.channels=this.channels.filter(n=>n._joinRef()!==e._joinRef())}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_endPointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:ii}))}_onConnMessage(e){this.decode(e.data,n=>{let{topic:t,event:r,payload:s,ref:o}=n;(o&&o===this.pendingHeartbeatRef||r===(s==null?void 0:s.type))&&(this.pendingHeartbeatRef=null),this.log("receive",`${s.status||""} ${t} ${r} ${o&&"("+o+")"||""}`,s),this.channels.filter(l=>l._isMember(t)).forEach(l=>l._trigger(r,s,o)),this.stateChangeCallbacks.message.forEach(l=>l(n))})}_onConnOpen(){this.log("transport",`connected to ${this._endPointURL()}`),this._flushSendBuffer(),this.reconnectTimer.reset(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this._sendHeartbeat(),this.heartbeatIntervalMs),this.stateChangeCallbacks.open.forEach(e=>e())}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(n=>n(e))}_onConnError(e){this.log("transport",e.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(n=>n(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(pe.error))}_appendParams(e,n){if(Object.keys(n).length===0)return e;const t=e.match(/\?/)?"&":"?",r=new URLSearchParams(n);return`${e}${t}${r}`}_flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(e=this.conn)===null||e===void 0||e.close(oi,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth(this.accessToken)}}}class gi{constructor(e,n,t){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=Qe.connecting,this.send=()=>{},this.url=null,this.url=e,this.close=t.close}}class pn extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function se(i){return typeof i=="object"&&i!==null&&"__isStorageError"in i}class $i extends pn{constructor(e,n){super(e),this.name="StorageApiError",this.status=n}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class Hn extends pn{constructor(e,n){super(e),this.name="StorageUnknownError",this.originalError=n}}var bi=function(i,e,n,t){function r(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function l(c){try{u(t.next(c))}catch(h){o(h)}}function a(c){try{u(t.throw(c))}catch(h){o(h)}}function u(c){c.done?s(c.value):r(c.value).then(l,a)}u((t=t.apply(i,e||[])).next())})};const Jr=i=>{let e;return i?e=i:typeof fetch>"u"?e=(...n)=>Xe(()=>Promise.resolve().then(()=>mt),void 0,import.meta.url).then(({default:t})=>t(...n)):e=fetch,(...n)=>e(...n)},wi=()=>bi(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Xe(()=>Promise.resolve().then(()=>mt),void 0,import.meta.url)).Response:Response});var nt=function(i,e,n,t){function r(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function l(c){try{u(t.next(c))}catch(h){o(h)}}function a(c){try{u(t.throw(c))}catch(h){o(h)}}function u(c){c.done?s(c.value):r(c.value).then(l,a)}u((t=t.apply(i,e||[])).next())})};const Gt=i=>i.msg||i.message||i.error_description||i.error||JSON.stringify(i),vi=(i,e)=>nt(void 0,void 0,void 0,function*(){const n=yield wi();i instanceof n?i.json().then(t=>{e(new $i(Gt(t),i.status||500))}).catch(t=>{e(new Hn(Gt(t),t))}):e(new Hn(Gt(i),i))}),ki=(i,e,n,t)=>{const r={method:i,headers:(e==null?void 0:e.headers)||{}};return i==="GET"?r:(r.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),r.body=JSON.stringify(t),Object.assign(Object.assign({},r),n))};function jt(i,e,n,t,r,s){return nt(this,void 0,void 0,function*(){return new Promise((o,l)=>{i(n,ki(e,t,r,s)).then(a=>{if(!a.ok)throw a;return t!=null&&t.noResolveJson?a:a.json()}).then(a=>o(a)).catch(a=>vi(a,l))})})}function rn(i,e,n,t){return nt(this,void 0,void 0,function*(){return jt(i,"GET",e,n,t)})}function Ce(i,e,n,t,r){return nt(this,void 0,void 0,function*(){return jt(i,"POST",e,t,r,n)})}function yi(i,e,n,t,r){return nt(this,void 0,void 0,function*(){return jt(i,"PUT",e,t,r,n)})}function Kr(i,e,n,t,r){return nt(this,void 0,void 0,function*(){return jt(i,"DELETE",e,t,r,n)})}var he=function(i,e,n,t){function r(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function l(c){try{u(t.next(c))}catch(h){o(h)}}function a(c){try{u(t.throw(c))}catch(h){o(h)}}function u(c){c.done?s(c.value):r(c.value).then(l,a)}u((t=t.apply(i,e||[])).next())})};const Ci={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Jn={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Si{constructor(e,n={},t,r){this.url=e,this.headers=n,this.bucketId=t,this.fetch=Jr(r)}uploadOrUpdate(e,n,t,r){return he(this,void 0,void 0,function*(){try{let s;const o=Object.assign(Object.assign({},Jn),r),l=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(o.upsert)});typeof Blob<"u"&&t instanceof Blob?(s=new FormData,s.append("cacheControl",o.cacheControl),s.append("",t)):typeof FormData<"u"&&t instanceof FormData?(s=t,s.append("cacheControl",o.cacheControl)):(s=t,l["cache-control"]=`max-age=${o.cacheControl}`,l["content-type"]=o.contentType);const a=this._removeEmptyFolders(n),u=this._getFinalPath(a),c=yield this.fetch(`${this.url}/object/${u}`,Object.assign({method:e,body:s,headers:l},o!=null&&o.duplex?{duplex:o.duplex}:{})),h=yield c.json();return c.ok?{data:{path:a,id:h.Id,fullPath:h.Key},error:null}:{data:null,error:h}}catch(s){if(se(s))return{data:null,error:s};throw s}})}upload(e,n,t){return he(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,n,t)})}uploadToSignedUrl(e,n,t,r){return he(this,void 0,void 0,function*(){const s=this._removeEmptyFolders(e),o=this._getFinalPath(s),l=new URL(this.url+`/object/upload/sign/${o}`);l.searchParams.set("token",n);try{let a;const u=Object.assign({upsert:Jn.upsert},r),c=Object.assign(Object.assign({},this.headers),{"x-upsert":String(u.upsert)});typeof Blob<"u"&&t instanceof Blob?(a=new FormData,a.append("cacheControl",u.cacheControl),a.append("",t)):typeof FormData<"u"&&t instanceof FormData?(a=t,a.append("cacheControl",u.cacheControl)):(a=t,c["cache-control"]=`max-age=${u.cacheControl}`,c["content-type"]=u.contentType);const h=yield this.fetch(l.toString(),{method:"PUT",body:a,headers:c}),d=yield h.json();return h.ok?{data:{path:s,fullPath:d.Key},error:null}:{data:null,error:d}}catch(a){if(se(a))return{data:null,error:a};throw a}})}createSignedUploadUrl(e){return he(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e);const t=yield Ce(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:this.headers}),r=new URL(this.url+t.url),s=r.searchParams.get("token");if(!s)throw new pn("No token returned by API");return{data:{signedUrl:r.toString(),path:e,token:s},error:null}}catch(n){if(se(n))return{data:null,error:n};throw n}})}update(e,n,t){return he(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,n,t)})}move(e,n){return he(this,void 0,void 0,function*(){try{return{data:yield Ce(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n},{headers:this.headers}),error:null}}catch(t){if(se(t))return{data:null,error:t};throw t}})}copy(e,n){return he(this,void 0,void 0,function*(){try{return{data:{path:(yield Ce(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n},{headers:this.headers})).Key},error:null}}catch(t){if(se(t))return{data:null,error:t};throw t}})}createSignedUrl(e,n,t){return he(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e),s=yield Ce(this.fetch,`${this.url}/object/sign/${r}`,Object.assign({expiresIn:n},t!=null&&t.transform?{transform:t.transform}:{}),{headers:this.headers});const o=t!=null&&t.download?`&download=${t.download===!0?"":t.download}`:"";return s={signedUrl:encodeURI(`${this.url}${s.signedURL}${o}`)},{data:s,error:null}}catch(r){if(se(r))return{data:null,error:r};throw r}})}createSignedUrls(e,n,t){return he(this,void 0,void 0,function*(){try{const r=yield Ce(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:n,paths:e},{headers:this.headers}),s=t!=null&&t.download?`&download=${t.download===!0?"":t.download}`:"";return{data:r.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${s}`):null})),error:null}}catch(r){if(se(r))return{data:null,error:r};throw r}})}download(e,n){return he(this,void 0,void 0,function*(){const r=typeof(n==null?void 0:n.transform)<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString((n==null?void 0:n.transform)||{}),o=s?`?${s}`:"";try{const l=this._getFinalPath(e);return{data:yield(yield rn(this.fetch,`${this.url}/${r}/${l}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(l){if(se(l))return{data:null,error:l};throw l}})}getPublicUrl(e,n){const t=this._getFinalPath(e),r=[],s=n!=null&&n.download?`download=${n.download===!0?"":n.download}`:"";s!==""&&r.push(s);const l=typeof(n==null?void 0:n.transform)<"u"?"render/image":"object",a=this.transformOptsToQueryString((n==null?void 0:n.transform)||{});a!==""&&r.push(a);let u=r.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${t}${u}`)}}}remove(e){return he(this,void 0,void 0,function*(){try{return{data:yield Kr(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(n){if(se(n))return{data:null,error:n};throw n}})}list(e,n,t){return he(this,void 0,void 0,function*(){try{const r=Object.assign(Object.assign(Object.assign({},Ci),n),{prefix:e||""});return{data:yield Ce(this.fetch,`${this.url}/object/list/${this.bucketId}`,r,{headers:this.headers},t),error:null}}catch(r){if(se(r))return{data:null,error:r};throw r}})}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const n=[];return e.width&&n.push(`width=${e.width}`),e.height&&n.push(`height=${e.height}`),e.resize&&n.push(`resize=${e.resize}`),e.format&&n.push(`format=${e.format}`),e.quality&&n.push(`quality=${e.quality}`),n.join("&")}}const Ei="2.5.5",Oi={"X-Client-Info":`storage-js/${Ei}`};var He=function(i,e,n,t){function r(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function l(c){try{u(t.next(c))}catch(h){o(h)}}function a(c){try{u(t.throw(c))}catch(h){o(h)}}function u(c){c.done?s(c.value):r(c.value).then(l,a)}u((t=t.apply(i,e||[])).next())})};class Ai{constructor(e,n={},t){this.url=e,this.headers=Object.assign(Object.assign({},Oi),n),this.fetch=Jr(t)}listBuckets(){return He(this,void 0,void 0,function*(){try{return{data:yield rn(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(se(e))return{data:null,error:e};throw e}})}getBucket(e){return He(this,void 0,void 0,function*(){try{return{data:yield rn(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(n){if(se(n))return{data:null,error:n};throw n}})}createBucket(e,n={public:!1}){return He(this,void 0,void 0,function*(){try{return{data:yield Ce(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(t){if(se(t))return{data:null,error:t};throw t}})}updateBucket(e,n){return He(this,void 0,void 0,function*(){try{return{data:yield yi(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(t){if(se(t))return{data:null,error:t};throw t}})}emptyBucket(e){return He(this,void 0,void 0,function*(){try{return{data:yield Ce(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(n){if(se(n))return{data:null,error:n};throw n}})}deleteBucket(e){return He(this,void 0,void 0,function*(){try{return{data:yield Kr(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(n){if(se(n))return{data:null,error:n};throw n}})}}class Ti extends Ai{constructor(e,n={},t){super(e,n,t)}from(e){return new Si(this.url,this.headers,e,this.fetch)}}const ji="2.43.4";let ot="";typeof Deno<"u"?ot="deno":typeof document<"u"?ot="web":typeof navigator<"u"&&navigator.product==="ReactNative"?ot="react-native":ot="node";const Pi={"X-Client-Info":`supabase-js-${ot}/${ji}`},Ii={headers:Pi},Ri={schema:"public"},Li={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Di={};var Ui=function(i,e,n,t){function r(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function l(c){try{u(t.next(c))}catch(h){o(h)}}function a(c){try{u(t.throw(c))}catch(h){o(h)}}function u(c){c.done?s(c.value):r(c.value).then(l,a)}u((t=t.apply(i,e||[])).next())})};const qi=i=>{let e;return i?e=i:typeof fetch>"u"?e=fn:e=fetch,(...n)=>e(...n)},Ni=()=>typeof Headers>"u"?Mr:Headers,Bi=(i,e,n)=>{const t=qi(n),r=Ni();return(s,o)=>Ui(void 0,void 0,void 0,function*(){var l;const a=(l=yield e())!==null&&l!==void 0?l:i;let u=new r(o==null?void 0:o.headers);return u.has("apikey")||u.set("apikey",i),u.has("Authorization")||u.set("Authorization",`Bearer ${a}`),t(s,Object.assign(Object.assign({},o),{headers:u}))})};function Mi(i){return i.replace(/\/$/,"")}function Fi(i,e){const{db:n,auth:t,realtime:r,global:s}=i,{db:o,auth:l,realtime:a,global:u}=e;return{db:Object.assign(Object.assign({},o),n),auth:Object.assign(Object.assign({},l),t),realtime:Object.assign(Object.assign({},a),r),global:Object.assign(Object.assign({},u),s)}}const Gr="2.64.2",zi="http://localhost:9999",Hi="supabase.auth.token",Ji={"X-Client-Info":`gotrue-js/${Gr}`},Kn=10,sn="X-Supabase-Api-Version",Vr={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}};function Ki(i){return Math.round(Date.now()/1e3)+i}function Gi(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(i){const e=Math.random()*16|0;return(i=="x"?e:e&3|8).toString(16)})}const de=()=>typeof document<"u",Le={tested:!1,writable:!1},ut=()=>{if(!de())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Le.tested)return Le.writable;const i=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(i,i),globalThis.localStorage.removeItem(i),Le.tested=!0,Le.writable=!0}catch{Le.tested=!0,Le.writable=!1}return Le.writable};function Vt(i){const e={},n=new URL(i);if(n.hash&&n.hash[0]==="#")try{new URLSearchParams(n.hash.substring(1)).forEach((r,s)=>{e[s]=r})}catch{}return n.searchParams.forEach((t,r)=>{e[r]=t}),e}const Wr=i=>{let e;return i?e=i:typeof fetch>"u"?e=(...n)=>Xe(()=>Promise.resolve().then(()=>mt),void 0,import.meta.url).then(({default:t})=>t(...n)):e=fetch,(...n)=>e(...n)},Vi=i=>typeof i=="object"&&i!==null&&"status"in i&&"ok"in i&&"json"in i&&typeof i.json=="function",Qr=async(i,e,n)=>{await i.setItem(e,JSON.stringify(n))},bt=async(i,e)=>{const n=await i.getItem(e);if(!n)return null;try{return JSON.parse(n)}catch{return n}},Wt=async(i,e)=>{await i.removeItem(e)};function Wi(i){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let n="",t,r,s,o,l,a,u,c=0;for(i=i.replace("-","+").replace("_","/");c<i.length;)o=e.indexOf(i.charAt(c++)),l=e.indexOf(i.charAt(c++)),a=e.indexOf(i.charAt(c++)),u=e.indexOf(i.charAt(c++)),t=o<<2|l>>4,r=(l&15)<<4|a>>2,s=(a&3)<<6|u,n=n+String.fromCharCode(t),a!=64&&r!=0&&(n=n+String.fromCharCode(r)),u!=64&&s!=0&&(n=n+String.fromCharCode(s));return n}class Pt{constructor(){this.promise=new Pt.promiseConstructor((e,n)=>{this.resolve=e,this.reject=n})}}Pt.promiseConstructor=Promise;function Gn(i){const e=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}=?$|[a-z0-9_-]{2}(==)?$)$/i,n=i.split(".");if(n.length!==3)throw new Error("JWT is not valid: not a JWT structure");if(!e.test(n[1]))throw new Error("JWT is not valid: payload is not in base64url format");const t=n[1];return JSON.parse(Wi(t))}async function Qi(i){return await new Promise(e=>{setTimeout(()=>e(null),i)})}function Yi(i,e){return new Promise((t,r)=>{(async()=>{for(let s=0;s<1/0;s++)try{const o=await i(s);if(!e(s,null,o)){t(o);return}}catch(o){if(!e(s,o)){r(o);return}}})()})}function Xi(i){return("0"+i.toString(16)).substr(-2)}function Zi(){const e=new Uint32Array(56);if(typeof crypto>"u"){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",t=n.length;let r="";for(let s=0;s<56;s++)r+=n.charAt(Math.floor(Math.random()*t));return r}return crypto.getRandomValues(e),Array.from(e,Xi).join("")}async function xi(i){const n=new TextEncoder().encode(i),t=await crypto.subtle.digest("SHA-256",n),r=new Uint8Array(t);return Array.from(r).map(s=>String.fromCharCode(s)).join("")}function eo(i){return btoa(i).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function to(i){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),i;const n=await xi(i);return eo(n)}async function Je(i,e,n=!1){const t=Zi();let r=t;n&&(r+="/PASSWORD_RECOVERY"),await Qr(i,`${e}-code-verifier`,r);const s=await to(t);return[s,t===s?"plain":"s256"]}const no=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function ro(i){const e=i.headers.get(sn);if(!e||!e.match(no))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}class mn extends Error{constructor(e,n,t){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=n,this.code=t}}function F(i){return typeof i=="object"&&i!==null&&"__isAuthError"in i}class so extends mn{constructor(e,n,t){super(e,n,t),this.name="AuthApiError",this.status=n,this.code=t}}function io(i){return F(i)&&i.name==="AuthApiError"}class Yr extends mn{constructor(e,n){super(e),this.name="AuthUnknownError",this.originalError=n}}class Me extends mn{constructor(e,n,t,r){super(e,t,r),this.name=n,this.status=t}}class De extends Me{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}class Qt extends Me{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class wt extends Me{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class vt extends Me{constructor(e,n=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Vn extends Me{constructor(e,n=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class on extends Me{constructor(e,n){super(e,"AuthRetryableFetchError",n,void 0)}}function Yt(i){return F(i)&&i.name==="AuthRetryableFetchError"}class Wn extends Me{constructor(e,n,t){super(e,"AuthWeakPasswordError",n,"weak_password"),this.reasons=t}}var oo=function(i,e){var n={};for(var t in i)Object.prototype.hasOwnProperty.call(i,t)&&e.indexOf(t)<0&&(n[t]=i[t]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,t=Object.getOwnPropertySymbols(i);r<t.length;r++)e.indexOf(t[r])<0&&Object.prototype.propertyIsEnumerable.call(i,t[r])&&(n[t[r]]=i[t[r]]);return n};const Ue=i=>i.msg||i.message||i.error_description||i.error||JSON.stringify(i),ao=[502,503,504];async function Qn(i){var e;if(!Vi(i))throw new on(Ue(i),0);if(ao.includes(i.status))throw new on(Ue(i),i.status);let n;try{n=await i.json()}catch(s){throw new Yr(Ue(s),s)}let t;const r=ro(i);if(r&&r.getTime()>=Vr["2024-01-01"].timestamp&&typeof n=="object"&&n&&typeof n.code=="string"?t=n.code:typeof n=="object"&&n&&typeof n.error_code=="string"&&(t=n.error_code),t){if(t==="weak_password")throw new Wn(Ue(n),i.status,((e=n.weak_password)===null||e===void 0?void 0:e.reasons)||[])}else if(typeof n=="object"&&n&&typeof n.weak_password=="object"&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((s,o)=>s&&typeof o=="string",!0))throw new Wn(Ue(n),i.status,n.weak_password.reasons);throw new so(Ue(n),i.status||500,t)}const lo=(i,e,n,t)=>{const r={method:i,headers:(e==null?void 0:e.headers)||{}};return i==="GET"?r:(r.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),r.body=JSON.stringify(t),Object.assign(Object.assign({},r),n))};async function z(i,e,n,t){var r;const s=Object.assign({},t==null?void 0:t.headers);s[sn]||(s[sn]=Vr["2024-01-01"].name),t!=null&&t.jwt&&(s.Authorization=`Bearer ${t.jwt}`);const o=(r=t==null?void 0:t.query)!==null&&r!==void 0?r:{};t!=null&&t.redirectTo&&(o.redirect_to=t.redirectTo);const l=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",a=await uo(i,e,n+l,{headers:s,noResolveJson:t==null?void 0:t.noResolveJson},{},t==null?void 0:t.body);return t!=null&&t.xform?t==null?void 0:t.xform(a):{data:Object.assign({},a),error:null}}async function uo(i,e,n,t,r,s){const o=lo(e,t,r,s);let l;try{l=await i(n,Object.assign({},o))}catch(a){throw console.error(a),new on(Ue(a),0)}if(l.ok||await Qn(l),t!=null&&t.noResolveJson)return l;try{return await l.json()}catch(a){await Qn(a)}}function ye(i){var e;let n=null;po(i)&&(n=Object.assign({},i),i.expires_at||(n.expires_at=Ki(i.expires_in)));const t=(e=i.user)!==null&&e!==void 0?e:i;return{data:{session:n,user:t},error:null}}function Yn(i){const e=ye(i);return!e.error&&i.weak_password&&typeof i.weak_password=="object"&&Array.isArray(i.weak_password.reasons)&&i.weak_password.reasons.length&&i.weak_password.message&&typeof i.weak_password.message=="string"&&i.weak_password.reasons.reduce((n,t)=>n&&typeof t=="string",!0)&&(e.data.weak_password=i.weak_password),e}function Se(i){var e;return{data:{user:(e=i.user)!==null&&e!==void 0?e:i},error:null}}function co(i){return{data:i,error:null}}function fo(i){const{action_link:e,email_otp:n,hashed_token:t,redirect_to:r,verification_type:s}=i,o=oo(i,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:e,email_otp:n,hashed_token:t,redirect_to:r,verification_type:s},a=Object.assign({},o);return{data:{properties:l,user:a},error:null}}function ho(i){return i}function po(i){return i.access_token&&i.refresh_token&&i.expires_in}var mo=function(i,e){var n={};for(var t in i)Object.prototype.hasOwnProperty.call(i,t)&&e.indexOf(t)<0&&(n[t]=i[t]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,t=Object.getOwnPropertySymbols(i);r<t.length;r++)e.indexOf(t[r])<0&&Object.prototype.propertyIsEnumerable.call(i,t[r])&&(n[t[r]]=i[t[r]]);return n};class _o{constructor({url:e="",headers:n={},fetch:t}){this.url=e,this.headers=n,this.fetch=Wr(t),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,n="global"){try{return await z(this.fetch,"POST",`${this.url}/logout?scope=${n}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(t){if(F(t))return{data:null,error:t};throw t}}async inviteUserByEmail(e,n={}){try{return await z(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:n.data},headers:this.headers,redirectTo:n.redirectTo,xform:Se})}catch(t){if(F(t))return{data:{user:null},error:t};throw t}}async generateLink(e){try{const{options:n}=e,t=mo(e,["options"]),r=Object.assign(Object.assign({},t),n);return"newEmail"in t&&(r.new_email=t==null?void 0:t.newEmail,delete r.newEmail),await z(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:r,headers:this.headers,xform:fo,redirectTo:n==null?void 0:n.redirectTo})}catch(n){if(F(n))return{data:{properties:null,user:null},error:n};throw n}}async createUser(e){try{return await z(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Se})}catch(n){if(F(n))return{data:{user:null},error:n};throw n}}async listUsers(e){var n,t,r,s,o,l,a;try{const u={nextPage:null,lastPage:0,total:0},c=await z(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(t=(n=e==null?void 0:e.page)===null||n===void 0?void 0:n.toString())!==null&&t!==void 0?t:"",per_page:(s=(r=e==null?void 0:e.perPage)===null||r===void 0?void 0:r.toString())!==null&&s!==void 0?s:""},xform:ho});if(c.error)throw c.error;const h=await c.json(),d=(o=c.headers.get("x-total-count"))!==null&&o!==void 0?o:0,f=(a=(l=c.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&a!==void 0?a:[];return f.length>0&&(f.forEach(p=>{const $=parseInt(p.split(";")[0].split("=")[1].substring(0,1)),k=JSON.parse(p.split(";")[1].split("=")[1]);u[`${k}Page`]=$}),u.total=parseInt(d)),{data:Object.assign(Object.assign({},h),u),error:null}}catch(u){if(F(u))return{data:{users:[]},error:u};throw u}}async getUserById(e){try{return await z(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Se})}catch(n){if(F(n))return{data:{user:null},error:n};throw n}}async updateUserById(e,n){try{return await z(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:n,headers:this.headers,xform:Se})}catch(t){if(F(t))return{data:{user:null},error:t};throw t}}async deleteUser(e,n=!1){try{return await z(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:n},xform:Se})}catch(t){if(F(t))return{data:{user:null},error:t};throw t}}async _listFactors(e){try{const{data:n,error:t}=await z(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:r=>({data:{factors:r},error:null})});return{data:n,error:t}}catch(n){if(F(n))return{data:null,error:n};throw n}}async _deleteFactor(e){try{return{data:await z(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(n){if(F(n))return{data:null,error:n};throw n}}}const go={getItem:i=>ut()?globalThis.localStorage.getItem(i):null,setItem:(i,e)=>{ut()&&globalThis.localStorage.setItem(i,e)},removeItem:i=>{ut()&&globalThis.localStorage.removeItem(i)}};function Xn(i={}){return{getItem:e=>i[e]||null,setItem:(e,n)=>{i[e]=n},removeItem:e=>{delete i[e]}}}function $o(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Ke={debug:!!(globalThis&&ut()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Xr extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class bo extends Xr{}async function wo(i,e,n){Ke.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",i,e);const t=new globalThis.AbortController;return e>0&&setTimeout(()=>{t.abort(),Ke.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",i)},e),await globalThis.navigator.locks.request(i,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:t.signal},async r=>{if(r){Ke.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",i,r.name);try{return await n()}finally{Ke.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",i,r.name)}}else{if(e===0)throw Ke.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",i),new bo(`Acquiring an exclusive Navigator LockManager lock "${i}" immediately failed`);if(Ke.debug)try{const s=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(s,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}})}$o();const vo={url:zi,storageKey:Hi,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Ji,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1},it=30*1e3,Zn=3;async function xn(i,e,n){return await n()}class ht{constructor(e){var n,t;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=ht.nextInstanceID,ht.nextInstanceID+=1,this.instanceID>0&&de()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const r=Object.assign(Object.assign({},vo),e);if(this.logDebugMessages=!!r.debug,typeof r.debug=="function"&&(this.logger=r.debug),this.persistSession=r.persistSession,this.storageKey=r.storageKey,this.autoRefreshToken=r.autoRefreshToken,this.admin=new _o({url:r.url,headers:r.headers,fetch:r.fetch}),this.url=r.url,this.headers=r.headers,this.fetch=Wr(r.fetch),this.lock=r.lock||xn,this.detectSessionInUrl=r.detectSessionInUrl,this.flowType=r.flowType,this.hasCustomAuthorizationHeader=r.hasCustomAuthorizationHeader,r.lock?this.lock=r.lock:de()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=wo:this.lock=xn,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?r.storage?this.storage=r.storage:ut()?this.storage=go:(this.memoryStorage={},this.storage=Xn(this.memoryStorage)):(this.memoryStorage={},this.storage=Xn(this.memoryStorage)),de()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(s){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",s)}(t=this.broadcastChannel)===null||t===void 0||t.addEventListener("message",async s=>{this._debug("received broadcast notification from other tab or client",s),await this._notifyAllSubscribers(s.data.event,s.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Gr}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){try{const e=de()?await this._isPKCEFlow():!1;if(this._debug("#_initialize()","begin","is PKCE flow",e),e||this.detectSessionInUrl&&this._isImplicitGrantFlow()){const{data:n,error:t}=await this._getSessionFromURL(e);if(t)return this._debug("#_initialize()","error detecting session from URL",t),(t==null?void 0:t.message)==="Identity is already linked"||(t==null?void 0:t.message)==="Identity is already linked to another user"?{error:t}:(await this._removeSession(),{error:t});const{session:r,redirectType:s}=n;return this._debug("#_initialize()","detected session in URL",r,"redirect type",s),await this._saveSession(r),setTimeout(async()=>{s==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",r):await this._notifyAllSubscribers("SIGNED_IN",r)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(e){return F(e)?{error:e}:{error:new Yr("Unexpected error during initialization",e)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var n,t,r;try{await this._removeSession();const s=await z(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(t=(n=e==null?void 0:e.options)===null||n===void 0?void 0:n.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:(r=e==null?void 0:e.options)===null||r===void 0?void 0:r.captchaToken}},xform:ye}),{data:o,error:l}=s;if(l||!o)return{data:{user:null,session:null},error:l};const a=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",a)),{data:{user:u,session:a},error:null}}catch(s){if(F(s))return{data:{user:null,session:null},error:s};throw s}}async signUp(e){var n,t,r;try{await this._removeSession();let s;if("email"in e){const{email:c,password:h,options:d}=e;let f=null,p=null;this.flowType==="pkce"&&([f,p]=await Je(this.storage,this.storageKey)),s=await z(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:d==null?void 0:d.emailRedirectTo,body:{email:c,password:h,data:(n=d==null?void 0:d.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken},code_challenge:f,code_challenge_method:p},xform:ye})}else if("phone"in e){const{phone:c,password:h,options:d}=e;s=await z(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:c,password:h,data:(t=d==null?void 0:d.data)!==null&&t!==void 0?t:{},channel:(r=d==null?void 0:d.channel)!==null&&r!==void 0?r:"sms",gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken}},xform:ye})}else throw new wt("You must provide either an email or phone number and a password");const{data:o,error:l}=s;if(l||!o)return{data:{user:null,session:null},error:l};const a=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",a)),{data:{user:u,session:a},error:null}}catch(s){if(F(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithPassword(e){try{await this._removeSession();let n;if("email"in e){const{email:s,password:o,options:l}=e;n=await z(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:Yn})}else if("phone"in e){const{phone:s,password:o,options:l}=e;n=await z(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:Yn})}else throw new wt("You must provide either an email or phone number and a password");const{data:t,error:r}=n;return r?{data:{user:null,session:null},error:r}:!t||!t.session||!t.user?{data:{user:null,session:null},error:new Qt}:(t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),{data:Object.assign({user:t.user,session:t.session},t.weak_password?{weakPassword:t.weak_password}:null),error:r})}catch(n){if(F(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOAuth(e){var n,t,r,s;return await this._removeSession(),await this._handleProviderSignIn(e.provider,{redirectTo:(n=e.options)===null||n===void 0?void 0:n.redirectTo,scopes:(t=e.options)===null||t===void 0?void 0:t.scopes,queryParams:(r=e.options)===null||r===void 0?void 0:r.queryParams,skipBrowserRedirect:(s=e.options)===null||s===void 0?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async _exchangeCodeForSession(e){const n=await bt(this.storage,`${this.storageKey}-code-verifier`),[t,r]=(n??"").split("/"),{data:s,error:o}=await z(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:t},xform:ye});return await Wt(this.storage,`${this.storageKey}-code-verifier`),o?{data:{user:null,session:null,redirectType:null},error:o}:!s||!s.session||!s.user?{data:{user:null,session:null,redirectType:null},error:new Qt}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign(Object.assign({},s),{redirectType:r??null}),error:o})}async signInWithIdToken(e){await this._removeSession();try{const{options:n,provider:t,token:r,access_token:s,nonce:o}=e,l=await z(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:t,id_token:r,access_token:s,nonce:o,gotrue_meta_security:{captcha_token:n==null?void 0:n.captchaToken}},xform:ye}),{data:a,error:u}=l;return u?{data:{user:null,session:null},error:u}:!a||!a.session||!a.user?{data:{user:null,session:null},error:new Qt}:(a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),{data:a,error:u})}catch(n){if(F(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOtp(e){var n,t,r,s,o;try{if(await this._removeSession(),"email"in e){const{email:l,options:a}=e;let u=null,c=null;this.flowType==="pkce"&&([u,c]=await Je(this.storage,this.storageKey));const{error:h}=await z(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(n=a==null?void 0:a.data)!==null&&n!==void 0?n:{},create_user:(t=a==null?void 0:a.shouldCreateUser)!==null&&t!==void 0?t:!0,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken},code_challenge:u,code_challenge_method:c},redirectTo:a==null?void 0:a.emailRedirectTo});return{data:{user:null,session:null},error:h}}if("phone"in e){const{phone:l,options:a}=e,{data:u,error:c}=await z(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(r=a==null?void 0:a.data)!==null&&r!==void 0?r:{},create_user:(s=a==null?void 0:a.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken},channel:(o=a==null?void 0:a.channel)!==null&&o!==void 0?o:"sms"}});return{data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:c}}throw new wt("You must provide either an email or phone number.")}catch(l){if(F(l))return{data:{user:null,session:null},error:l};throw l}}async verifyOtp(e){var n,t;try{e.type!=="email_change"&&e.type!=="phone_change"&&await this._removeSession();let r,s;"options"in e&&(r=(n=e.options)===null||n===void 0?void 0:n.redirectTo,s=(t=e.options)===null||t===void 0?void 0:t.captchaToken);const{data:o,error:l}=await z(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:s}}),redirectTo:r,xform:ye});if(l)throw l;if(!o)throw new Error("An error occurred on token verification.");const a=o.session,u=o.user;return a!=null&&a.access_token&&(await this._saveSession(a),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",a)),{data:{user:u,session:a},error:null}}catch(r){if(F(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithSSO(e){var n,t,r;try{await this._removeSession();let s=null,o=null;return this.flowType==="pkce"&&([s,o]=await Je(this.storage,this.storageKey)),await z(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(t=(n=e.options)===null||n===void 0?void 0:n.redirectTo)!==null&&t!==void 0?t:void 0}),!((r=e==null?void 0:e.options)===null||r===void 0)&&r.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:s,code_challenge_method:o}),headers:this.headers,xform:co})}catch(s){if(F(s))return{data:null,error:s};throw s}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:n},error:t}=e;if(t)throw t;if(!n)throw new De;const{error:r}=await z(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:n.access_token});return{data:{user:null,session:null},error:r}})}catch(e){if(F(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{e.type!="email_change"&&e.type!="phone_change"&&await this._removeSession();const n=`${this.url}/resend`;if("email"in e){const{email:t,type:r,options:s}=e,{error:o}=await z(this.fetch,"POST",n,{headers:this.headers,body:{email:t,type:r,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},redirectTo:s==null?void 0:s.emailRedirectTo});return{data:{user:null,session:null},error:o}}else if("phone"in e){const{phone:t,type:r,options:s}=e,{data:o,error:l}=await z(this.fetch,"POST",n,{headers:this.headers,body:{phone:t,type:r,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}}});return{data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:l}}throw new wt("You must provide either an email or phone number and a type")}catch(n){if(F(n))return{data:{user:null,session:null},error:n};throw n}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async n=>n))}async _acquireLock(e,n){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const t=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),r=(async()=>(await t,await n()))();return this.pendingInLock.push((async()=>{try{await r}catch{}})()),r}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const t=n();for(this.pendingInLock.push((async()=>{try{await t}catch{}})()),await t;this.pendingInLock.length;){const r=[...this.pendingInLock];await Promise.all(r),this.pendingInLock.splice(0,r.length)}return await t}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const n=await this.__loadSession();return await e(n)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const n=await bt(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",n),n!==null&&(this._isValidSession(n)?e=n:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const t=e.expires_at?e.expires_at<=Date.now()/1e3:!1;if(this._debug("#__loadSession()",`session has${t?"":" not"} expired`,"expires_at",e.expires_at),!t){if(this.storage.isServer){const o=this.suppressGetSessionWarning;e=new Proxy(e,{get(a,u,c){return!o&&u==="user"&&console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and many not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),Reflect.get(a,u,c)}})}return{data:{session:e},error:null}}const{session:r,error:s}=await this._callRefreshToken(e.refresh_token);return s?{data:{session:null},error:s}:{data:{session:r},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await z(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Se}):await this._useSession(async n=>{var t,r,s;const{data:o,error:l}=n;if(l)throw l;return!(!((t=o.session)===null||t===void 0)&&t.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new De}:await z(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(s=(r=o.session)===null||r===void 0?void 0:r.access_token)!==null&&s!==void 0?s:void 0,xform:Se})})}catch(n){if(F(n))return{data:{user:null},error:n};throw n}}async updateUser(e,n={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,n))}async _updateUser(e,n={}){try{return await this._useSession(async t=>{const{data:r,error:s}=t;if(s)throw s;if(!r.session)throw new De;const o=r.session;let l=null,a=null;this.flowType==="pkce"&&e.email!=null&&([l,a]=await Je(this.storage,this.storageKey));const{data:u,error:c}=await z(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:n==null?void 0:n.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:l,code_challenge_method:a}),jwt:o.access_token,xform:Se});if(c)throw c;return o.user=u.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}})}catch(t){if(F(t))return{data:{user:null},error:t};throw t}}_decodeJWT(e){return Gn(e)}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new De;const n=Date.now()/1e3;let t=n,r=!0,s=null;const o=Gn(e.access_token);if(o.exp&&(t=o.exp,r=t<=n),r){const{session:l,error:a}=await this._callRefreshToken(e.refresh_token);if(a)return{data:{user:null,session:null},error:a};if(!l)return{data:{user:null,session:null},error:null};s=l}else{const{data:l,error:a}=await this._getUser(e.access_token);if(a)throw a;s={access_token:e.access_token,refresh_token:e.refresh_token,user:l.user,token_type:"bearer",expires_in:t-n,expires_at:t},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return{data:{user:s.user,session:s},error:null}}catch(n){if(F(n))return{data:{session:null,user:null},error:n};throw n}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async n=>{var t;if(!e){const{data:o,error:l}=n;if(l)throw l;e=(t=o.session)!==null&&t!==void 0?t:void 0}if(!(e!=null&&e.refresh_token))throw new De;const{session:r,error:s}=await this._callRefreshToken(e.refresh_token);return s?{data:{user:null,session:null},error:s}:r?{data:{user:r.user,session:r},error:null}:{data:{user:null,session:null},error:null}})}catch(n){if(F(n))return{data:{user:null,session:null},error:n};throw n}}async _getSessionFromURL(e){try{if(!de())throw new vt("No browser detected.");if(this.flowType==="implicit"&&!this._isImplicitGrantFlow())throw new vt("Not a valid implicit grant flow url.");if(this.flowType=="pkce"&&!e)throw new Vn("Not a valid PKCE flow url.");const n=Vt(window.location.href);if(e){if(!n.code)throw new Vn("No code detected.");const{data:A,error:j}=await this._exchangeCodeForSession(n.code);if(j)throw j;const P=new URL(window.location.href);return P.searchParams.delete("code"),window.history.replaceState(window.history.state,"",P.toString()),{data:{session:A.session,redirectType:null},error:null}}if(n.error||n.error_description||n.error_code)throw new vt(n.error_description||"Error in URL with unspecified error_description",{error:n.error||"unspecified_error",code:n.error_code||"unspecified_code"});const{provider_token:t,provider_refresh_token:r,access_token:s,refresh_token:o,expires_in:l,expires_at:a,token_type:u}=n;if(!s||!l||!o||!u)throw new vt("No session defined in URL");const c=Math.round(Date.now()/1e3),h=parseInt(l);let d=c+h;a&&(d=parseInt(a));const f=d-c;f*1e3<=it&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${f}s, should have been closer to ${h}s`);const p=d-h;c-p>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",p,d,c):c-p<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clok for skew",p,d,c);const{data:$,error:k}=await this._getUser(s);if(k)throw k;const T={provider_token:t,provider_refresh_token:r,access_token:s,expires_in:h,expires_at:d,refresh_token:o,token_type:u,user:$.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:T,redirectType:n.type},error:null}}catch(n){if(F(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantFlow(){const e=Vt(window.location.href);return!!(de()&&(e.access_token||e.error_description))}async _isPKCEFlow(){const e=Vt(window.location.href),n=await bt(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&n)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async n=>{var t;const{data:r,error:s}=n;if(s)return{error:s};const o=(t=r.session)===null||t===void 0?void 0:t.access_token;if(o){const{error:l}=await this.admin.signOut(o,e);if(l&&!(io(l)&&(l.status===404||l.status===401||l.status===403)))return{error:l}}return e!=="others"&&(await this._removeSession(),await Wt(this.storage,`${this.storageKey}-code-verifier`),await this._notifyAllSubscribers("SIGNED_OUT",null)),{error:null}})}onAuthStateChange(e){const n=Gi(),t={id:n,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",n),this.stateChangeEmitters.delete(n)}};return this._debug("#onAuthStateChange()","registered callback with id",n),this.stateChangeEmitters.set(n,t),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(n)})))(),{data:{subscription:t}}}async _emitInitialSession(e){return await this._useSession(async n=>{var t,r;try{const{data:{session:s},error:o}=n;if(o)throw o;await((t=this.stateChangeEmitters.get(e))===null||t===void 0?void 0:t.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",e,"session",s)}catch(s){await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",s),console.error(s)}})}async resetPasswordForEmail(e,n={}){let t=null,r=null;this.flowType==="pkce"&&([t,r]=await Je(this.storage,this.storageKey,!0));try{return await z(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:t,code_challenge_method:r,gotrue_meta_security:{captcha_token:n.captchaToken}},headers:this.headers,redirectTo:n.redirectTo})}catch(s){if(F(s))return{data:null,error:s};throw s}}async getUserIdentities(){var e;try{const{data:n,error:t}=await this.getUser();if(t)throw t;return{data:{identities:(e=n.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(n){if(F(n))return{data:null,error:n};throw n}}async linkIdentity(e){var n;try{const{data:t,error:r}=await this._useSession(async s=>{var o,l,a,u,c;const{data:h,error:d}=s;if(d)throw d;const f=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(l=e.options)===null||l===void 0?void 0:l.scopes,queryParams:(a=e.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:!0});return await z(this.fetch,"GET",f,{headers:this.headers,jwt:(c=(u=h.session)===null||u===void 0?void 0:u.access_token)!==null&&c!==void 0?c:void 0})});if(r)throw r;return de()&&!(!((n=e.options)===null||n===void 0)&&n.skipBrowserRedirect)&&window.location.assign(t==null?void 0:t.url),{data:{provider:e.provider,url:t==null?void 0:t.url},error:null}}catch(t){if(F(t))return{data:{provider:e.provider,url:null},error:t};throw t}}async unlinkIdentity(e){try{return await this._useSession(async n=>{var t,r;const{data:s,error:o}=n;if(o)throw o;return await z(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(r=(t=s.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:void 0})})}catch(n){if(F(n))return{data:null,error:n};throw n}}async _refreshAccessToken(e){const n=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{const t=Date.now();return await Yi(async r=>(r>0&&await Qi(200*Math.pow(2,r-1)),this._debug(n,"refreshing attempt",r),await z(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:ye})),(r,s)=>{const o=200*Math.pow(2,r);return s&&Yt(s)&&Date.now()+o-t<it})}catch(t){if(this._debug(n,"error",t),F(t))return{data:{session:null,user:null},error:t};throw t}finally{this._debug(n,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,n){const t=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:n.redirectTo,scopes:n.scopes,queryParams:n.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",n,"url",t),de()&&!n.skipBrowserRedirect&&window.location.assign(t),{data:{provider:e,url:t},error:null}}async _recoverAndRefresh(){var e;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const t=await bt(this.storage,this.storageKey);if(this._debug(n,"session from storage",t),!this._isValidSession(t)){this._debug(n,"session is not valid"),t!==null&&await this._removeSession();return}const r=Math.round(Date.now()/1e3),s=((e=t.expires_at)!==null&&e!==void 0?e:1/0)<r+Kn;if(this._debug(n,`session has${s?"":" not"} expired with margin of ${Kn}s`),s){if(this.autoRefreshToken&&t.refresh_token){const{error:o}=await this._callRefreshToken(t.refresh_token);o&&(console.error(o),Yt(o)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",t)}catch(t){this._debug(n,"error",t),console.error(t);return}finally{this._debug(n,"end")}}async _callRefreshToken(e){var n,t;if(!e)throw new De;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const r=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{this.refreshingDeferred=new Pt;const{data:s,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!s.session)throw new De;await this._saveSession(s.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",s.session);const l={session:s.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(s){if(this._debug(r,"error",s),F(s)){const o={session:null,error:s};return Yt(s)||(await this._removeSession(),await this._notifyAllSubscribers("SIGNED_OUT",null)),(n=this.refreshingDeferred)===null||n===void 0||n.resolve(o),o}throw(t=this.refreshingDeferred)===null||t===void 0||t.reject(s),s}finally{this.refreshingDeferred=null,this._debug(r,"end")}}async _notifyAllSubscribers(e,n,t=!0){const r=`#_notifyAllSubscribers(${e})`;this._debug(r,"begin",n,`broadcast = ${t}`);try{this.broadcastChannel&&t&&this.broadcastChannel.postMessage({event:e,session:n});const s=[],o=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(e,n)}catch(a){s.push(a)}});if(await Promise.all(o),s.length>0){for(let l=0;l<s.length;l+=1)console.error(s[l]);throw s[0]}}finally{this._debug(r,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await Qr(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await Wt(this.storage,this.storageKey)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&de()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(n){console.error("removing visibilitychange callback failed",n)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),it);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async n=>{const{data:{session:t}}=n;if(!t||!t.refresh_token||!t.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const r=Math.floor((t.expires_at*1e3-e)/it);this._debug("#_autoRefreshTokenTick()",`access token expires in ${r} ticks, a tick lasts ${it}ms, refresh threshold is ${Zn} ticks`),r<=Zn&&await this._callRefreshToken(t.refresh_token)})}catch(n){console.error("Auto refresh tick failed with error. This is likely a transient error.",n)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof Xr)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!de()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const n=`#_onVisibilityChanged(${e})`;this._debug(n,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(n,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,n,t){const r=[`provider=${encodeURIComponent(n)}`];if(t!=null&&t.redirectTo&&r.push(`redirect_to=${encodeURIComponent(t.redirectTo)}`),t!=null&&t.scopes&&r.push(`scopes=${encodeURIComponent(t.scopes)}`),this.flowType==="pkce"){const[s,o]=await Je(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(s)}`,code_challenge_method:`${encodeURIComponent(o)}`});r.push(l.toString())}if(t!=null&&t.queryParams){const s=new URLSearchParams(t.queryParams);r.push(s.toString())}return t!=null&&t.skipBrowserRedirect&&r.push(`skip_http_redirect=${t.skipBrowserRedirect}`),`${e}?${r.join("&")}`}async _unenroll(e){try{return await this._useSession(async n=>{var t;const{data:r,error:s}=n;return s?{data:null,error:s}:await z(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(t=r==null?void 0:r.session)===null||t===void 0?void 0:t.access_token})})}catch(n){if(F(n))return{data:null,error:n};throw n}}async _enroll(e){try{return await this._useSession(async n=>{var t,r;const{data:s,error:o}=n;if(o)return{data:null,error:o};const{data:l,error:a}=await z(this.fetch,"POST",`${this.url}/factors`,{body:{friendly_name:e.friendlyName,factor_type:e.factorType,issuer:e.issuer},headers:this.headers,jwt:(t=s==null?void 0:s.session)===null||t===void 0?void 0:t.access_token});return a?{data:null,error:a}:(!((r=l==null?void 0:l.totp)===null||r===void 0)&&r.qr_code&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})})}catch(n){if(F(n))return{data:null,error:n};throw n}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var t;const{data:r,error:s}=n;if(s)return{data:null,error:s};const{data:o,error:l}=await z(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(t=r==null?void 0:r.session)===null||t===void 0?void 0:t.access_token});return l?{data:null,error:l}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:l})})}catch(n){if(F(n))return{data:null,error:n};throw n}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var t;const{data:r,error:s}=n;return s?{data:null,error:s}:await z(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{headers:this.headers,jwt:(t=r==null?void 0:r.session)===null||t===void 0?void 0:t.access_token})})}catch(n){if(F(n))return{data:null,error:n};throw n}})}async _challengeAndVerify(e){const{data:n,error:t}=await this._challenge({factorId:e.factorId});return t?{data:null,error:t}:await this._verify({factorId:e.factorId,challengeId:n.id,code:e.code})}async _listFactors(){const{data:{user:e},error:n}=await this.getUser();if(n)return{data:null,error:n};const t=(e==null?void 0:e.factors)||[],r=t.filter(s=>s.factor_type==="totp"&&s.status==="verified");return{data:{all:t,totp:r},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var n,t;const{data:{session:r},error:s}=e;if(s)return{data:null,error:s};if(!r)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const o=this._decodeJWT(r.access_token);let l=null;o.aal&&(l=o.aal);let a=l;((t=(n=r.user.factors)===null||n===void 0?void 0:n.filter(h=>h.status==="verified"))!==null&&t!==void 0?t:[]).length>0&&(a="aal2");const c=o.amr||[];return{data:{currentLevel:l,nextLevel:a,currentAuthenticationMethods:c},error:null}}))}}ht.nextInstanceID=0;const ko=ht;class yo extends ko{constructor(e){super(e)}}var Co=function(i,e,n,t){function r(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function l(c){try{u(t.next(c))}catch(h){o(h)}}function a(c){try{u(t.throw(c))}catch(h){o(h)}}function u(c){c.done?s(c.value):r(c.value).then(l,a)}u((t=t.apply(i,e||[])).next())})};class So{constructor(e,n,t){var r,s,o;if(this.supabaseUrl=e,this.supabaseKey=n,!e)throw new Error("supabaseUrl is required.");if(!n)throw new Error("supabaseKey is required.");const l=Mi(e);this.realtimeUrl=`${l}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${l}/auth/v1`,this.storageUrl=`${l}/storage/v1`,this.functionsUrl=`${l}/functions/v1`;const a=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,u={db:Ri,realtime:Di,auth:Object.assign(Object.assign({},Li),{storageKey:a}),global:Ii},c=Fi(t??{},u);this.storageKey=(r=c.auth.storageKey)!==null&&r!==void 0?r:"",this.headers=(s=c.global.headers)!==null&&s!==void 0?s:{},this.auth=this._initSupabaseAuthClient((o=c.auth)!==null&&o!==void 0?o:{},this.headers,c.global.fetch),this.fetch=Bi(n,this._getAccessToken.bind(this),c.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers},c.realtime)),this.rest=new hn(`${l}/rest/v1`,{headers:this.headers,schema:c.db.schema,fetch:this.fetch}),this._listenForAuthEvents()}get functions(){return new Gs(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new Ti(this.storageUrl,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,n={},t={}){return this.rest.rpc(e,n,t)}channel(e,n={config:{}}){return this.realtime.channel(e,n)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,n;return Co(this,void 0,void 0,function*(){const{data:t}=yield this.auth.getSession();return(n=(e=t.session)===null||e===void 0?void 0:e.access_token)!==null&&n!==void 0?n:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:n,detectSessionInUrl:t,storage:r,storageKey:s,flowType:o,debug:l},a,u){var c;const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new yo({url:this.authUrl,headers:Object.assign(Object.assign({},h),a),storageKey:s,autoRefreshToken:e,persistSession:n,detectSessionInUrl:t,storage:r,flowType:o,debug:l,fetch:u,hasCustomAuthorizationHeader:(c="Authorization"in this.headers)!==null&&c!==void 0?c:!1})}_initRealtimeClient(e){return new _i(this.realtimeUrl,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((n,t)=>{this._handleTokenChanged(n,"CLIENT",t==null?void 0:t.access_token)})}_handleTokenChanged(e,n,t){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==t?(this.realtime.setAuth(t??null),this.changedAccessToken=t):e==="SIGNED_OUT"&&(this.realtime.setAuth(this.supabaseKey),n=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const Zr=(i,e,n)=>new So(i,e,n),xr="supabase-config",Eo=()=>{const i=localStorage.getItem(xr);if(!i)return null;const e=JSON.parse(i);return Zr(e.supabaseUrl,e.supabaseKey)};let Y=Eo();const Oo=i=>{Y=Zr(i.supabaseUrl,i.supabaseKey),localStorage.setItem(xr,JSON.stringify(i))},yt=Tt(null);function Ao(i){let e,n,t,r;const s=i[2].default,o=Ae(s,i,i[1],null);return{c(){e=O("button"),o&&o.c(),y(e,"class","text-blue-600 hover:text-blue-700")},m(l,a){S(l,e,a),o&&o.m(e,null),n=!0,t||(r=tt(e,"click",function(){et(i[0])&&i[0].apply(this,arguments)}),t=!0)},p(l,[a]){i=l,o&&o.p&&(!n||a&2)&&je(o,s,i,i[1],n?Te(s,i[1],a,null):Pe(i[1]),null)},i(l){n||(m(o,l),n=!0)},o(l){_(o,l),n=!1},d(l){l&&C(e),o&&o.d(l),t=!1,r()}}}function To(i,e,n){let{$$slots:t={},$$scope:r}=e,{onClick:s}=e;return i.$$set=o=>{"onClick"in o&&n(0,s=o.onClick),"$$scope"in o&&n(1,r=o.$$scope)},[s,r,t]}class $e extends N{constructor(e){super(),q(this,e,To,Ao,U,{onClick:0})}}function jo(i){let e,n;return{c(){e=ee("svg"),n=ee("path"),y(n,"stroke-linecap","round"),y(n,"stroke-linejoin","round"),y(n,"d","m2.25 12 8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25"),y(e,"xmlns","http://www.w3.org/2000/svg"),y(e,"fill","none"),y(e,"viewBox","0 0 24 24"),y(e,"stroke-width","1.5"),y(e,"stroke","currentColor"),y(e,"class","size-6 hover:stroke-2")},m(t,r){S(t,e,r),g(e,n)},p:D,d(t){t&&C(e)}}}function Po(i){let e,n;return e=new $e({props:{onClick:i[0],$$slots:{default:[jo]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment)},m(t,r){b(e,t,r),n=!0},p(t,[r]){const s={};r&1&&(s.onClick=t[0]),r&2&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}function Io(i,e,n){let{onClick:t}=e;return i.$$set=r=>{"onClick"in r&&n(0,t=r.onClick)},[t]}class Ro extends N{constructor(e){super(),q(this,e,Io,Po,U,{onClick:0})}}function Lo(i){let e,n;return{c(){e=ee("svg"),n=ee("path"),y(n,"stroke-linecap","round"),y(n,"stroke-linejoin","round"),y(n,"d","m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"),y(e,"xmlns","http://www.w3.org/2000/svg"),y(e,"fill","none"),y(e,"viewBox","0 0 24 24"),y(e,"stroke-width","1.5"),y(e,"stroke","currentColor"),y(e,"class","size-6 hover:stroke-2")},m(t,r){S(t,e,r),g(e,n)},p:D,d(t){t&&C(e)}}}function Do(i){let e,n;return e=new $e({props:{onClick:i[0],$$slots:{default:[Lo]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment)},m(t,r){b(e,t,r),n=!0},p(t,[r]){const s={};r&1&&(s.onClick=t[0]),r&2&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}function Uo(i,e,n){let{onClick:t}=e;return i.$$set=r=>{"onClick"in r&&n(0,t=r.onClick)},[t]}class qo extends N{constructor(e){super(),q(this,e,Uo,Do,U,{onClick:0})}}function No(i){let e,n;return{c(){e=ee("svg"),n=ee("path"),y(n,"stroke-linecap","round"),y(n,"stroke-linejoin","round"),y(n,"d","M12 6.042A8.967 8.967 0 0 0 6 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 0 1 6 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 0 1 6-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0 0 18 18a8.967 8.967 0 0 0-6 2.292m0-14.25v14.25"),y(e,"xmlns","http://www.w3.org/2000/svg"),y(e,"fill","none"),y(e,"viewBox","0 0 24 24"),y(e,"stroke-width","1.5"),y(e,"stroke","currentColor"),y(e,"class","size-6 hover:stroke-2")},m(t,r){S(t,e,r),g(e,n)},p:D,d(t){t&&C(e)}}}function Bo(i){let e,n;return e=new $e({props:{onClick:i[0],$$slots:{default:[No]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment)},m(t,r){b(e,t,r),n=!0},p(t,[r]){const s={};r&1&&(s.onClick=t[0]),r&2&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}function Mo(i,e,n){let{onClick:t}=e;return i.$$set=r=>{"onClick"in r&&n(0,t=r.onClick)},[t]}class Fo extends N{constructor(e){super(),q(this,e,Mo,Bo,U,{onClick:0})}}function zo(i){let e,n;return{c(){e=ee("svg"),n=ee("path"),y(n,"stroke-linecap","round"),y(n,"stroke-linejoin","round"),y(n,"d","M6 6.878V6a2.25 2.25 0 0 1 2.25-2.25h7.5A2.25 2.25 0 0 1 18 6v.878m-12 0c.235-.083.487-.128.75-.128h10.5c.263 0 .515.045.75.128m-12 0A2.25 2.25 0 0 0 4.5 9v.878m13.5-3A2.25 2.25 0 0 1 19.5 9v.878m0 0a2.246 2.246 0 0 0-.75-.128H5.25c-.263 0-.515.045-.75.128m15 0A2.25 2.25 0 0 1 21 12v6a2.25 2.25 0 0 1-2.25 2.25H5.25A2.25 2.25 0 0 1 3 18v-6c0-.98.626-1.813 1.5-2.122"),y(e,"xmlns","http://www.w3.org/2000/svg"),y(e,"fill","none"),y(e,"viewBox","0 0 24 24"),y(e,"stroke-width","1.5"),y(e,"stroke","currentColor"),y(e,"class","size-6 hover:stroke-2")},m(t,r){S(t,e,r),g(e,n)},p:D,d(t){t&&C(e)}}}function Ho(i){let e,n;return e=new $e({props:{onClick:i[0],$$slots:{default:[zo]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment)},m(t,r){b(e,t,r),n=!0},p(t,[r]){const s={};r&1&&(s.onClick=t[0]),r&2&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}function Jo(i,e,n){let{onClick:t}=e;return i.$$set=r=>{"onClick"in r&&n(0,t=r.onClick)},[t]}class Ko extends N{constructor(e){super(),q(this,e,Jo,Ho,U,{onClick:0})}}function Go(i){let e,n;return{c(){e=ee("svg"),n=ee("path"),y(n,"stroke-linecap","round"),y(n,"stroke-linejoin","round"),y(n,"d","M15.75 9V5.25A2.25 2.25 0 0 0 13.5 3h-6a2.25 2.25 0 0 0-2.25 2.25v13.5A2.25 2.25 0 0 0 7.5 21h6a2.25 2.25 0 0 0 2.25-2.25V15m3 0 3-3m0 0-3-3m3 3H9"),y(e,"xmlns","http://www.w3.org/2000/svg"),y(e,"fill","none"),y(e,"viewBox","0 0 24 24"),y(e,"stroke-width","1.5"),y(e,"stroke","currentColor"),y(e,"class","size-6 hover:stroke-2")},m(t,r){S(t,e,r),g(e,n)},p:D,d(t){t&&C(e)}}}function Vo(i){let e,n;return e=new $e({props:{onClick:i[0],$$slots:{default:[Go]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment)},m(t,r){b(e,t,r),n=!0},p(t,[r]){const s={};r&1&&(s.onClick=t[0]),r&2&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}function Wo(i,e,n){let{onClick:t}=e;return i.$$set=r=>{"onClick"in r&&n(0,t=r.onClick)},[t]}class Qo extends N{constructor(e){super(),q(this,e,Wo,Vo,U,{onClick:0})}}function Yo(i){let e,n;return{c(){e=ee("svg"),n=ee("path"),y(n,"stroke-linecap","round"),y(n,"stroke-linejoin","round"),y(n,"d","M15.75 6a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0ZM4.501 20.118a7.5 7.5 0 0 1 14.998 0A17.933 17.933 0 0 1 12 21.75c-2.676 0-5.216-.584-7.499-1.632Z"),y(e,"xmlns","http://www.w3.org/2000/svg"),y(e,"fill","none"),y(e,"viewBox","0 0 24 24"),y(e,"stroke-width","1.5"),y(e,"stroke","currentColor"),y(e,"class","size-6 hover:stroke-2")},m(t,r){S(t,e,r),g(e,n)},p:D,d(t){t&&C(e)}}}function Xo(i){let e,n;return e=new $e({props:{onClick:i[0],$$slots:{default:[Yo]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment)},m(t,r){b(e,t,r),n=!0},p(t,[r]){const s={};r&1&&(s.onClick=t[0]),r&2&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}function Zo(i,e,n){let{onClick:t}=e;return i.$$set=r=>{"onClick"in r&&n(0,t=r.onClick)},[t]}class xo extends N{constructor(e){super(),q(this,e,Zo,Xo,U,{onClick:0})}}function ea(i){let e,n,t,r,s,o,l,a,u,c,h,d,f;return n=new Ro({props:{onClick:i[1]}}),r=new Fo({props:{onClick:i[2]}}),o=new Ko({props:{onClick:i[3]}}),a=new qo({props:{onClick:i[4]}}),c=new xo({props:{onClick:i[5]}}),d=new Qo({props:{onClick:i[0]}}),{c(){e=O("nav"),v(n.$$.fragment),t=E(),v(r.$$.fragment),s=E(),v(o.$$.fragment),l=E(),v(a.$$.fragment),u=E(),v(c.$$.fragment),h=E(),v(d.$$.fragment),y(e,"class","flex justify-end items-center gap-2 mb-4")},m(p,$){S(p,e,$),b(n,e,null),g(e,t),b(r,e,null),g(e,s),b(o,e,null),g(e,l),b(a,e,null),g(e,u),b(c,e,null),g(e,h),b(d,e,null),f=!0},p(p,[$]){const k={};$&1&&(k.onClick=p[0]),d.$set(k)},i(p){f||(m(n.$$.fragment,p),m(r.$$.fragment,p),m(o.$$.fragment,p),m(a.$$.fragment,p),m(c.$$.fragment,p),m(d.$$.fragment,p),f=!0)},o(p){_(n.$$.fragment,p),_(r.$$.fragment,p),_(o.$$.fragment,p),_(a.$$.fragment,p),_(c.$$.fragment,p),_(d.$$.fragment,p),f=!1},d(p){p&&C(e),w(n),w(r),w(o),w(a),w(c),w(d)}}}function ta(i,e,n){let{onLogout:t}=e;const r=()=>H("/"),s=()=>H("/books/list"),o=()=>H("/cache"),l=()=>H("/search"),a=()=>H("/user");return i.$$set=u=>{"onLogout"in u&&n(0,t=u.onLogout)},[t,r,s,o,l,a]}class na extends N{constructor(e){super(),q(this,e,ta,ea,U,{onLogout:0})}}const ie=i=>new Date(i).toLocaleString(),fe=i=>i?"":"Please enter a value!",ra=(i,e)=>Math.floor(Math.random()*(e-i+1)+i),sa=i=>{for(let e=0;e<i.length;e++){const n=ra(0,i.length-1);if(e===n)continue;const t=i[e];i[e]=i[n],i[n]=t}},es=i=>(i=i.trim(),i||null);function ia(i){let e,n,t,r;const s=i[2].default,o=Ae(s,i,i[1],null);return{c(){e=O("form"),o&&o.c(),y(e,"class","flex flex-col gap-5 max-w-md")},m(l,a){S(l,e,a),o&&o.m(e,null),n=!0,t||(r=tt(e,"submit",as(function(){et(i[0])&&i[0].apply(this,arguments)})),t=!0)},p(l,[a]){i=l,o&&o.p&&(!n||a&2)&&je(o,s,i,i[1],n?Te(s,i[1],a,null):Pe(i[1]),null)},i(l){n||(m(o,l),n=!0)},o(l){_(o,l),n=!1},d(l){l&&C(e),o&&o.d(l),t=!1,r()}}}function oa(i,e,n){let{$$slots:t={},$$scope:r}=e,{onSubmit:s}=e;return i.$$set=o=>{"onSubmit"in o&&n(0,s=o.onSubmit),"$$scope"in o&&n(1,r=o.$$scope)},[s,r,t]}class be extends N{constructor(e){super(),q(this,e,oa,ia,U,{onSubmit:0})}}function er(i){let e,n;return{c(){e=O("p"),n=L(i[2]),y(e,"class","text-red-600 text-sm mt-1")},m(t,r){S(t,e,r),g(e,n)},p(t,r){r&4&&B(n,t[2])},d(t){t&&C(e)}}}function aa(i){let e,n,t,r,s,o;const l=i[4].default,a=Ae(l,i,i[3],null);let u=i[2]&&er(i);return{c(){e=O("div"),n=O("label"),t=L(i[1]),r=E(),a&&a.c(),s=E(),u&&u.c(),y(n,"class","block text-gray-700 text-sm font-bold mb-2"),y(n,"for",i[0])},m(c,h){S(c,e,h),g(e,n),g(n,t),g(e,r),a&&a.m(e,null),g(e,s),u&&u.m(e,null),o=!0},p(c,[h]){(!o||h&2)&&B(t,c[1]),(!o||h&1)&&y(n,"for",c[0]),a&&a.p&&(!o||h&8)&&je(a,l,c,c[3],o?Te(l,c[3],h,null):Pe(c[3]),null),c[2]?u?u.p(c,h):(u=er(c),u.c(),u.m(e,null)):u&&(u.d(1),u=null)},i(c){o||(m(a,c),o=!0)},o(c){_(a,c),o=!1},d(c){c&&C(e),a&&a.d(c),u&&u.d()}}}function la(i,e,n){let{$$slots:t={},$$scope:r}=e,{id:s}=e,{label:o}=e,{error:l}=e;return i.$$set=a=>{"id"in a&&n(0,s=a.id),"label"in a&&n(1,o=a.label),"error"in a&&n(2,l=a.error),"$$scope"in a&&n(3,r=a.$$scope)},[s,o,l,r,t]}class _n extends N{constructor(e){super(),q(this,e,la,aa,U,{id:0,label:1,error:2})}}function ua(i){let e,n,t;return{c(){e=O("input"),y(e,"class","input"),y(e,"id",i[2])},m(r,s){S(r,e,s),Ye(e,i[0]),n||(t=tt(e,"input",i[4]),n=!0)},p(r,s){s&4&&y(e,"id",r[2]),s&1&&e.value!==r[0]&&Ye(e,r[0])},d(r){r&&C(e),n=!1,t()}}}function ca(i){let e,n;return e=new _n({props:{id:i[2],label:i[1],error:i[3],$$slots:{default:[ua]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment)},m(t,r){b(e,t,r),n=!0},p(t,[r]){const s={};r&4&&(s.id=t[2]),r&2&&(s.label=t[1]),r&8&&(s.error=t[3]),r&37&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}function fa(i,e,n){let{label:t}=e,{id:r}=e,{value:s}=e,{error:o=""}=e;function l(){s=this.value,n(0,s)}return i.$$set=a=>{"label"in a&&n(1,t=a.label),"id"in a&&n(2,r=a.id),"value"in a&&n(0,s=a.value),"error"in a&&n(3,o=a.error)},[s,t,r,o,l]}class Oe extends N{constructor(e){super(),q(this,e,fa,ca,U,{label:1,id:2,value:0,error:3})}}function ha(i){let e,n;return e=new J({props:{label:"Save"}}),{c(){v(e.$$.fragment)},m(t,r){b(e,t,r),n=!0},p:D,i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}function da(i){let e,n,t,r,s,o,l,a;function u(f){i[6](f)}let c={id:"url",label:"Supabase URL",error:i[1]};i[0]!==void 0&&(c.value=i[0]),e=new Oe({props:c}),x.push(()=>ne(e,"value",u));function h(f){i[7](f)}let d={id:"key",label:"Supabase key",error:i[3]};return i[2]!==void 0&&(d.value=i[2]),r=new Oe({props:d}),x.push(()=>ne(r,"value",h)),l=new Z({props:{$$slots:{default:[ha]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment),t=E(),v(r.$$.fragment),o=E(),v(l.$$.fragment)},m(f,p){b(e,f,p),S(f,t,p),b(r,f,p),S(f,o,p),b(l,f,p),a=!0},p(f,p){const $={};p&2&&($.error=f[1]),!n&&p&1&&(n=!0,$.value=f[0],te(()=>n=!1)),e.$set($);const k={};p&8&&(k.error=f[3]),!s&&p&4&&(s=!0,k.value=f[2],te(()=>s=!1)),r.$set(k);const T={};p&256&&(T.$$scope={dirty:p,ctx:f}),l.$set(T)},i(f){a||(m(e.$$.fragment,f),m(r.$$.fragment,f),m(l.$$.fragment,f),a=!0)},o(f){_(e.$$.fragment,f),_(r.$$.fragment,f),_(l.$$.fragment,f),a=!1},d(f){f&&(C(t),C(o)),w(e,f),w(r,f),w(l,f)}}}function pa(i){let e,n;return e=new be({props:{onSubmit:i[4],$$slots:{default:[da]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment)},m(t,r){b(e,t,r),n=!0},p(t,[r]){const s={};r&271&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}function ma(i,e,n){let{onConfig:t}=e,r="",s="",o="",l="";const a=()=>{n(1,s=fe(r)),n(3,l=fe(o)),!(s||l)&&t({supabaseUrl:r,supabaseKey:o})};function u(h){r=h,n(0,r)}function c(h){o=h,n(2,o)}return i.$$set=h=>{"onConfig"in h&&n(5,t=h.onConfig)},[r,s,o,l,a,t,u,c]}class _a extends N{constructor(e){super(),q(this,e,ma,pa,U,{onConfig:5})}}function ga(i){let e,n;return e=new be({props:{onSubmit:i[4],$$slots:{default:[wa]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment)},m(t,r){b(e,t,r),n=!0},p(t,r){const s={};r&71&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}function $a(i){let e,n,t;return{c(){e=O("div"),e.textContent="Magic link was successfully send!",n=E(),t=O("div"),t.textContent="Please check your E-Mail"},m(r,s){S(r,e,s),S(r,n,s),S(r,t,s)},p:D,i:D,o:D,d(r){r&&(C(e),C(n),C(t))}}}function ba(i){let e,n;return e=new J({props:{disabled:i[2],label:"Magic Link"}}),{c(){v(e.$$.fragment)},m(t,r){b(e,t,r),n=!0},p(t,r){const s={};r&4&&(s.disabled=t[2]),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}function wa(i){let e,n,t,r,s;function o(a){i[5](a)}let l={id:"email",label:"E-Mail",error:i[1]};return i[0]!==void 0&&(l.value=i[0]),e=new Oe({props:l}),x.push(()=>ne(e,"value",o)),r=new Z({props:{$$slots:{default:[ba]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment),t=E(),v(r.$$.fragment)},m(a,u){b(e,a,u),S(a,t,u),b(r,a,u),s=!0},p(a,u){const c={};u&2&&(c.error=a[1]),!n&&u&1&&(n=!0,c.value=a[0],te(()=>n=!1)),e.$set(c);const h={};u&68&&(h.$$scope={dirty:u,ctx:a}),r.$set(h)},i(a){s||(m(e.$$.fragment,a),m(r.$$.fragment,a),s=!0)},o(a){_(e.$$.fragment,a),_(r.$$.fragment,a),s=!1},d(a){a&&C(t),w(e,a),w(r,a)}}}function va(i){let e,n,t,r;const s=[$a,ga],o=[];function l(a,u){return a[3]?0:1}return e=l(i),n=o[e]=s[e](i),{c(){n.c(),t=X()},m(a,u){o[e].m(a,u),S(a,t,u),r=!0},p(a,[u]){let c=e;e=l(a),e===c?o[e].p(a,u):(V(),_(o[c],1,1,()=>{o[c]=null}),W(),n=o[e],n?n.p(a,u):(n=o[e]=s[e](a),n.c()),m(n,1),n.m(t.parentNode,t))},i(a){r||(m(n),r=!0)},o(a){_(n),r=!1},d(a){a&&C(t),o[e].d(a)}}}function ka(i,e,n){let t="",r="",s=!1,o=!1;const l=async()=>{if(n(1,r=fe(t)),r)return;n(2,s=!0);const{data:u,error:c}=await Y.auth.signInWithOtp({email:t});if(n(2,s=!1),c){Q.setAuthError(c);return}u&&(console.log("data",u),n(3,o=!0))};function a(u){t=u,n(0,t)}return[t,r,s,o,l,a]}class ya extends N{constructor(e){super(),q(this,e,ka,va,U,{})}}function Ca(i){let e;return{c(){e=O("div"),e.innerHTML='<svg class="h-8 w-8 animate-spin text-blue-600" viewBox="0 0 100 100"><circle fill="none" stroke-width="10" class="stroke-current opacity-40" cx="50" cy="50" r="40"></circle><circle fill="none" stroke-width="10" class="stroke-current" stroke-dasharray="250" stroke-dashoffset="210" cx="50" cy="50" r="40"></circle></svg>',y(e,"class","flex justify-center")},m(n,t){S(n,e,t)},p:D,i:D,o:D,d(n){n&&C(e)}}}class Sa extends N{constructor(e){super(),q(this,e,null,Ca,U,{})}}function Ea(i){let e,n,t;e=new na({props:{onLogout:i[4]}});const r=i[6].default,s=Ae(r,i,i[5],null);return{c(){v(e.$$.fragment),n=E(),s&&s.c()},m(o,l){b(e,o,l),S(o,n,l),s&&s.m(o,l),t=!0},p(o,l){s&&s.p&&(!t||l&32)&&je(s,r,o,o[5],t?Te(r,o[5],l,null):Pe(o[5]),null)},i(o){t||(m(e.$$.fragment,o),m(s,o),t=!0)},o(o){_(e.$$.fragment,o),_(s,o),t=!1},d(o){o&&C(n),w(e,o),s&&s.d(o)}}}function Oa(i){let e,n,t,r;const s=[ja,Ta],o=[];function l(a,u){return a[1]?0:1}return e=l(i),n=o[e]=s[e](i),{c(){n.c(),t=X()},m(a,u){o[e].m(a,u),S(a,t,u),r=!0},p(a,u){let c=e;e=l(a),e!==c&&(V(),_(o[c],1,1,()=>{o[c]=null}),W(),n=o[e],n||(n=o[e]=s[e](a),n.c()),m(n,1),n.m(t.parentNode,t))},i(a){r||(m(n),r=!0)},o(a){_(n),r=!1},d(a){a&&C(t),o[e].d(a)}}}function Aa(i){let e,n;return e=new _a({props:{onConfig:i[3]}}),{c(){v(e.$$.fragment)},m(t,r){b(e,t,r),n=!0},p:D,i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}function Ta(i){let e,n;return e=new Sa({}),{c(){v(e.$$.fragment)},m(t,r){b(e,t,r),n=!0},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}function ja(i){let e,n;return e=new ya({}),{c(){v(e.$$.fragment)},m(t,r){b(e,t,r),n=!0},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}function Pa(i){let e,n,t,r;const s=[Aa,Oa,Ea],o=[];function l(a,u){return a[0]?a[2]?2:1:0}return e=l(i),n=o[e]=s[e](i),{c(){n.c(),t=X()},m(a,u){o[e].m(a,u),S(a,t,u),r=!0},p(a,[u]){let c=e;e=l(a),e===c?o[e].p(a,u):(V(),_(o[c],1,1,()=>{o[c]=null}),W(),n=o[e],n?n.p(a,u):(n=o[e]=s[e](a),n.c()),m(n,1),n.m(t.parentNode,t))},i(a){r||(m(n),r=!0)},o(a){_(n),r=!1},d(a){a&&C(t),o[e].d(a)}}}function Ia(i,e,n){let t;ln(i,yt,h=>n(2,t=h));let{$$slots:r={},$$scope:s}=e,o=!1,l=!1;const a=()=>Y?(Y.auth.onAuthStateChange((h,d)=>{console.log("auth changed:",d==null?void 0:d.user),d!=null&&d.user?yt.set(d.user):yt.set(null),n(1,l=!0)}),!0):(console.log("supabase is not initialized!"),!1),u=h=>{Oo(h),n(0,o=a())},c=()=>{Y&&t&&Y.auth.signOut()};return me(()=>{n(0,o=a())}),i.$$set=h=>{"$$scope"in h&&n(5,s=h.$$scope)},[o,l,t,u,c,s,r]}class Ra extends N{constructor(e){super(),q(this,e,Ia,Pa,U,{})}}function La(i){let e,n;return{c(){e=O("h2"),n=L(i[0]),y(e,"class","text-2xl font-extrabold")},m(t,r){S(t,e,r),g(e,n)},p(t,[r]){r&1&&B(n,t[0])},i:D,o:D,d(t){t&&C(e)}}}function Da(i,e,n){let{header:t}=e;return i.$$set=r=>{"header"in r&&n(0,t=r.header)},[t]}class oe extends N{constructor(e){super(),q(this,e,Da,La,U,{header:0})}}const dt="session",Ua=(i,e,n)=>{if(i.length==0)return;const t=i.map(s=>({question:s,progress:e}));sa(t);const r={learning:t,learned:[],reverse:n};localStorage.setItem(dt,JSON.stringify(r))},ts=()=>{const i=localStorage.getItem(dt);return i?JSON.parse(i):null},qa=i=>i.learning.length>0?(localStorage.setItem(dt,JSON.stringify(i)),!0):(localStorage.removeItem(dt),!1),Na=()=>{localStorage.removeItem(dt)},tr=i=>{const e=[0,0,0,i.learned.length];return i.learning.forEach(n=>{if(n.progress>2)throw Error(`Invalid progress ${n.progress}`);e[n.progress]++}),e};function Ba(i){let e,n;const t=i[1].default,r=Ae(t,i,i[0],null);return{c(){e=O("div"),r&&r.c(),y(e,"class","flex flex-col gap-5")},m(s,o){S(s,e,o),r&&r.m(e,null),n=!0},p(s,[o]){r&&r.p&&(!n||o&1)&&je(r,t,s,s[0],n?Te(t,s[0],o,null):Pe(s[0]),null)},i(s){n||(m(r,s),n=!0)},o(s){_(r,s),n=!1},d(s){s&&C(e),r&&r.d(s)}}}function Ma(i,e,n){let{$$slots:t={},$$scope:r}=e;return i.$$set=s=>{"$$scope"in s&&n(0,r=s.$$scope)},[r,t]}class ae extends N{constructor(e){super(),q(this,e,Ma,Ba,U,{})}}function nr(i){let e,n;return e=new Z({props:{$$slots:{default:[Fa]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment)},m(t,r){b(e,t,r),n=!0},p(t,r){const s={};r&8&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}function Fa(i){let e,n,t,r;return e=new J({props:{label:"Continue",onClick:i[1]}}),t=new J({props:{label:"End",onClick:i[2]}}),{c(){v(e.$$.fragment),n=E(),v(t.$$.fragment)},m(s,o){b(e,s,o),S(s,n,o),b(t,s,o),r=!0},p:D,i(s){r||(m(e.$$.fragment,s),m(t.$$.fragment,s),r=!0)},o(s){_(e.$$.fragment,s),_(t.$$.fragment,s),r=!1},d(s){s&&C(n),w(e,s),w(t,s)}}}function za(i){let e,n,t,r;e=new oe({props:{header:"Home"}});let s=i[0]&&nr(i);return{c(){v(e.$$.fragment),n=E(),s&&s.c(),t=X()},m(o,l){b(e,o,l),S(o,n,l),s&&s.m(o,l),S(o,t,l),r=!0},p(o,l){o[0]?s?(s.p(o,l),l&1&&m(s,1)):(s=nr(o),s.c(),m(s,1),s.m(t.parentNode,t)):s&&(V(),_(s,1,1,()=>{s=null}),W())},i(o){r||(m(e.$$.fragment,o),m(s),r=!0)},o(o){_(e.$$.fragment,o),_(s),r=!1},d(o){o&&(C(n),C(t)),w(e,o),s&&s.d(o)}}}function Ha(i){let e,n;return e=new ae({props:{$$slots:{default:[za]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment)},m(t,r){b(e,t,r),n=!0},p(t,[r]){const s={};r&9&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}function Ja(i,e,n){let t=!1;const r=()=>{H("/lession/process")},s=()=>{Na(),n(0,t=!1)};return me(()=>{ts()&&n(0,t=!0)}),[t,r,s]}class Ka extends N{constructor(e){super(),q(this,e,Ja,Ha,U,{})}}const _t="cache-",ns=()=>{const i=[];for(let e in localStorage)e.startsWith(_t)&&i.push(e);return i.sort()},Ga=()=>{const i=[];for(let e in localStorage)e.startsWith(_t)&&localStorage.removeItem(e);return i},Va=i=>(localStorage.removeItem(i),ns());function Wa(i){let e,n;return{c(){e=ee("svg"),n=ee("path"),y(n,"stroke-linecap","round"),y(n,"stroke-linejoin","round"),y(n,"d","m9.75 9.75 4.5 4.5m0-4.5-4.5 4.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"),y(e,"xmlns","http://www.w3.org/2000/svg"),y(e,"fill","none"),y(e,"viewBox","0 0 24 24"),y(e,"stroke-width","1.5"),y(e,"stroke","currentColor"),y(e,"class","size-6 hover:stroke-2")},m(t,r){S(t,e,r),g(e,n)},p:D,d(t){t&&C(e)}}}function Qa(i){let e,n;return e=new $e({props:{onClick:i[0],$$slots:{default:[Wa]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment)},m(t,r){b(e,t,r),n=!0},p(t,[r]){const s={};r&1&&(s.onClick=t[0]),r&2&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}function Ya(i,e,n){let{onClick:t}=e;return i.$$set=r=>{"onClick"in r&&n(0,t=r.onClick)},[t]}class It extends N{constructor(e){super(),q(this,e,Ya,Qa,U,{onClick:0})}}function rr(i,e,n){const t=i.slice();return t[4]=e[n],t}function Xa(i){let e;return{c(){e=L("Cache is empty!")},m(n,t){S(n,e,t)},p:D,i:D,o:D,d(n){n&&C(e)}}}function Za(i){let e,n,t,r,s,o,l,a=le(i[0]),u=[];for(let h=0;h<a.length;h+=1)u[h]=sr(rr(i,a,h));const c=h=>_(u[h],1,1,()=>{u[h]=null});return o=new Z({props:{$$slots:{default:[el]},$$scope:{ctx:i}}}),{c(){e=O("table"),n=O("thead"),n.innerHTML="<tr><th>Cache Key</th> <th>Actions</th></tr>",t=E(),r=O("tbody");for(let h=0;h<u.length;h+=1)u[h].c();s=E(),v(o.$$.fragment),y(e,"class","bg-white shadow w-full")},m(h,d){S(h,e,d),g(e,n),g(e,t),g(e,r);for(let f=0;f<u.length;f+=1)u[f]&&u[f].m(r,null);S(h,s,d),b(o,h,d),l=!0},p(h,d){if(d&1){a=le(h[0]);let p;for(p=0;p<a.length;p+=1){const $=rr(h,a,p);u[p]?(u[p].p($,d),m(u[p],1)):(u[p]=sr($),u[p].c(),m(u[p],1),u[p].m(r,null))}for(V(),p=a.length;p<u.length;p+=1)c(p);W()}const f={};d&129&&(f.$$scope={dirty:d,ctx:h}),o.$set(f)},i(h){if(!l){for(let d=0;d<a.length;d+=1)m(u[d]);m(o.$$.fragment,h),l=!0}},o(h){u=u.filter(Boolean);for(let d=0;d<u.length;d+=1)_(u[d]);_(o.$$.fragment,h),l=!1},d(h){h&&(C(e),C(s)),Be(u,h),w(o,h)}}}function xa(i){let e,n;function t(){return i[1](i[4])}return e=new It({props:{onClick:t}}),{c(){v(e.$$.fragment)},m(r,s){b(e,r,s),n=!0},p(r,s){i=r;const o={};s&1&&(o.onClick=t),e.$set(o)},i(r){n||(m(e.$$.fragment,r),n=!0)},o(r){_(e.$$.fragment,r),n=!1},d(r){w(e,r)}}}function sr(i){let e,n,t=i[4]+"",r,s,o,l,a,u;return l=new Z({props:{$$slots:{default:[xa]},$$scope:{ctx:i}}}),{c(){e=O("tr"),n=O("td"),r=L(t),s=E(),o=O("td"),v(l.$$.fragment),a=E()},m(c,h){S(c,e,h),g(e,n),g(n,r),g(e,s),g(e,o),b(l,o,null),g(e,a),u=!0},p(c,h){(!u||h&1)&&t!==(t=c[4]+"")&&B(r,t);const d={};h&129&&(d.$$scope={dirty:h,ctx:c}),l.$set(d)},i(c){u||(m(l.$$.fragment,c),u=!0)},o(c){_(l.$$.fragment,c),u=!1},d(c){c&&C(e),w(l)}}}function el(i){let e,n,t,r;return e=new J({props:{onClick:i[2],label:"Cancel"}}),t=new J({props:{onClick:i[3],label:"Delete all"}}),{c(){v(e.$$.fragment),n=E(),v(t.$$.fragment)},m(s,o){b(e,s,o),S(s,n,o),b(t,s,o),r=!0},p(s,o){const l={};o&1&&(l.onClick=s[3]),t.$set(l)},i(s){r||(m(e.$$.fragment,s),m(t.$$.fragment,s),r=!0)},o(s){_(e.$$.fragment,s),_(t.$$.fragment,s),r=!1},d(s){s&&C(n),w(e,s),w(t,s)}}}function tl(i){let e,n,t,r,s,o;e=new oe({props:{header:"Cache"}});const l=[Za,Xa],a=[];function u(c,h){return c[0].length>0?0:1}return t=u(i),r=a[t]=l[t](i),{c(){v(e.$$.fragment),n=E(),r.c(),s=X()},m(c,h){b(e,c,h),S(c,n,h),a[t].m(c,h),S(c,s,h),o=!0},p(c,h){let d=t;t=u(c),t===d?a[t].p(c,h):(V(),_(a[d],1,1,()=>{a[d]=null}),W(),r=a[t],r?r.p(c,h):(r=a[t]=l[t](c),r.c()),m(r,1),r.m(s.parentNode,s))},i(c){o||(m(e.$$.fragment,c),m(r),o=!0)},o(c){_(e.$$.fragment,c),_(r),o=!1},d(c){c&&(C(n),C(s)),w(e,c),a[t].d(c)}}}function nl(i){let e,n;return e=new ae({props:{$$slots:{default:[tl]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment)},m(t,r){b(e,t,r),n=!0},p(t,[r]){const s={};r&129&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}function rl(i,e,n){let t=[];return me(()=>{n(0,t=ns())}),[t,l=>{n(0,t=Va(l))},()=>H("/"),()=>n(0,t=Ga())]}class sl extends N{constructor(e){super(),q(this,e,rl,nl,U,{})}}function il(i){let e,n,t,r;return e=new oe({props:{header:"Not Found"}}),{c(){v(e.$$.fragment),n=E(),t=O("div"),t.textContent="Not Found"},m(s,o){b(e,s,o),S(s,n,o),S(s,t,o),r=!0},p:D,i(s){r||(m(e.$$.fragment,s),r=!0)},o(s){_(e.$$.fragment,s),r=!1},d(s){s&&(C(n),C(t)),w(e,s)}}}function ol(i){let e,n;return e=new ae({props:{$$slots:{default:[il]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment)},m(t,r){b(e,t,r),n=!0},p(t,[r]){const s={};r&1&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}class al extends N{constructor(e){super(),q(this,e,null,ol,U,{})}}const pt=_t+"books",Rt=async i=>{let{data:e,error:n}=await Y.from("books").select("*").eq("id",i).single();return n&&Q.setDBError(n),e||null},gn=async()=>{const i=localStorage.getItem(pt);if(i)return JSON.parse(i);let{data:e,error:n}=await Y.from("books").select("*");return n&&Q.setDBError(n),e?(localStorage.setItem(pt,JSON.stringify(e)),e):[]},ll=async i=>{const{error:e}=await Y.from("books").delete().eq("id",i);return e?(Q.setDBError(e),[]):(localStorage.removeItem(pt),gn())},ul=async(i,e)=>{const{error:n}=await Y.from("books").insert([{name:i,description:e}]);if(n)return Q.setDBError(n),[];localStorage.removeItem(pt)},cl=async(i,e,n)=>{const{error:t}=await Y.from("books").update({name:e,description:n}).eq("id",i);return t?(Q.setDBError(t),[]):(localStorage.removeItem(pt),gn())};function fl(i){let e,n;return{c(){e=ee("svg"),n=ee("path"),y(n,"stroke-linecap","round"),y(n,"stroke-linejoin","round"),y(n,"d","M3.75 12h16.5m-16.5 3.75h16.5M3.75 19.5h16.5M5.625 4.5h12.75a1.875 1.875 0 0 1 0 3.75H5.625a1.875 1.875 0 0 1 0-3.75Z"),y(e,"xmlns","http://www.w3.org/2000/svg"),y(e,"fill","none"),y(e,"viewBox","0 0 24 24"),y(e,"stroke-width","1.5"),y(e,"stroke","currentColor"),y(e,"class","size-6 hover:stroke-2")},m(t,r){S(t,e,r),g(e,n)},p:D,d(t){t&&C(e)}}}function hl(i){let e,n;return e=new $e({props:{onClick:i[0],$$slots:{default:[fl]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment)},m(t,r){b(e,t,r),n=!0},p(t,[r]){const s={};r&1&&(s.onClick=t[0]),r&2&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}function dl(i,e,n){let{onClick:t}=e;return i.$$set=r=>{"onClick"in r&&n(0,t=r.onClick)},[t]}class rs extends N{constructor(e){super(),q(this,e,dl,hl,U,{onClick:0})}}function pl(i){let e,n;return{c(){e=ee("svg"),n=ee("path"),y(n,"stroke-linecap","round"),y(n,"stroke-linejoin","round"),y(n,"d","m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"),y(e,"xmlns","http://www.w3.org/2000/svg"),y(e,"fill","none"),y(e,"viewBox","0 0 24 24"),y(e,"stroke-width","1.5"),y(e,"stroke","currentColor"),y(e,"class","size-6 hover:stroke-2")},m(t,r){S(t,e,r),g(e,n)},p:D,d(t){t&&C(e)}}}function ml(i){let e,n;return e=new $e({props:{onClick:i[0],$$slots:{default:[pl]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment)},m(t,r){b(e,t,r),n=!0},p(t,[r]){const s={};r&1&&(s.onClick=t[0]),r&2&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}function _l(i,e,n){let{onClick:t}=e;return i.$$set=r=>{"onClick"in r&&n(0,t=r.onClick)},[t]}class $n extends N{constructor(e){super(),q(this,e,_l,ml,U,{onClick:0})}}function ir(i){let e,n;return e=new Br({props:{title:i[1],buttons:i[2],$$slots:{default:[gl]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment)},m(t,r){b(e,t,r),n=!0},p(t,r){const s={};r&2&&(s.title=t[1]),r&9&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}function gl(i){let e=i[0].getMessage(i[0])+"",n;return{c(){n=L(e)},m(t,r){S(t,n,r)},p(t,r){r&1&&e!==(e=t[0].getMessage(t[0])+"")&&B(n,e)},d(t){t&&C(n)}}}function $l(i){let e,n,t=i[0].entry&&ir(i);return{c(){t&&t.c(),e=X()},m(r,s){t&&t.m(r,s),S(r,e,s),n=!0},p(r,[s]){r[0].entry?t?(t.p(r,s),s&1&&m(t,1)):(t=ir(r),t.c(),m(t,1),t.m(e.parentNode,e)):t&&(V(),_(t,1,1,()=>{t=null}),W())},i(r){n||(m(t),n=!0)},o(r){_(t),n=!1},d(r){r&&C(e),t&&t.d(r)}}}function bl(i,e,n){let{title:t}=e,{deleteEntry:r}=e;const s=[{label:"Close",onclick:()=>{n(0,r.entry=null,r)}},{label:"Delete",onclick:()=>{r.entry&&(r.onDelete(r.entry),n(0,r.entry=null,r))}}];return i.$$set=o=>{"title"in o&&n(1,t=o.title),"deleteEntry"in o&&n(0,r=o.deleteEntry)},[r,t,s]}class bn extends N{constructor(e){super(),q(this,e,bl,$l,U,{title:1,deleteEntry:0})}}function or(i,e,n){const t=i.slice();return t[7]=e[n],t}function wl(i){let e,n,t,r,s,o;function l(){return i[2](i[7])}e=new It({props:{onClick:l}});function a(){return i[3](i[7])}t=new $n({props:{onClick:a}});function u(){return i[4](i[7])}return s=new rs({props:{onClick:u}}),{c(){v(e.$$.fragment),n=E(),v(t.$$.fragment),r=E(),v(s.$$.fragment)},m(c,h){b(e,c,h),S(c,n,h),b(t,c,h),S(c,r,h),b(s,c,h),o=!0},p(c,h){i=c;const d={};h&3&&(d.onClick=l),e.$set(d);const f={};h&1&&(f.onClick=a),t.$set(f);const p={};h&1&&(p.onClick=u),s.$set(p)},i(c){o||(m(e.$$.fragment,c),m(t.$$.fragment,c),m(s.$$.fragment,c),o=!0)},o(c){_(e.$$.fragment,c),_(t.$$.fragment,c),_(s.$$.fragment,c),o=!1},d(c){c&&(C(n),C(r)),w(e,c),w(t,c),w(s,c)}}}function ar(i){let e,n,t=i[7].id+"",r,s,o,l=i[7].name+"",a,u,c,h=i[7].description+"",d,f,p,$=ie(i[7].modified)+"",k,T,A,j,P,I;return j=new Z({props:{$$slots:{default:[wl]},$$scope:{ctx:i}}}),{c(){e=O("tr"),n=O("td"),r=L(t),s=E(),o=O("td"),a=L(l),u=E(),c=O("td"),d=L(h),f=E(),p=O("td"),k=L($),T=E(),A=O("td"),v(j.$$.fragment),P=E()},m(R,M){S(R,e,M),g(e,n),g(n,r),g(e,s),g(e,o),g(o,a),g(e,u),g(e,c),g(c,d),g(e,f),g(e,p),g(p,k),g(e,T),g(e,A),b(j,A,null),g(e,P),I=!0},p(R,M){(!I||M&1)&&t!==(t=R[7].id+"")&&B(r,t),(!I||M&1)&&l!==(l=R[7].name+"")&&B(a,l),(!I||M&1)&&h!==(h=R[7].description+"")&&B(d,h),(!I||M&1)&&$!==($=ie(R[7].modified)+"")&&B(k,$);const K={};M&1027&&(K.$$scope={dirty:M,ctx:R}),j.$set(K)},i(R){I||(m(j.$$.fragment,R),I=!0)},o(R){_(j.$$.fragment,R),I=!1},d(R){R&&C(e),w(j)}}}function vl(i){let e,n,t,r;return e=new J({props:{onClick:i[5],label:"Cancel"}}),t=new J({props:{onClick:i[6],label:"Create"}}),{c(){v(e.$$.fragment),n=E(),v(t.$$.fragment)},m(s,o){b(e,s,o),S(s,n,o),b(t,s,o),r=!0},p:D,i(s){r||(m(e.$$.fragment,s),m(t.$$.fragment,s),r=!0)},o(s){_(e.$$.fragment,s),_(t.$$.fragment,s),r=!1},d(s){s&&C(n),w(e,s),w(t,s)}}}function kl(i){let e,n,t,r,s,o,l,a,u;e=new oe({props:{header:"List Books"}});let c=le(i[0]),h=[];for(let f=0;f<c.length;f+=1)h[f]=ar(or(i,c,f));const d=f=>_(h[f],1,1,()=>{h[f]=null});return a=new Z({props:{$$slots:{default:[vl]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment),n=E(),t=O("table"),r=O("thead"),r.innerHTML="<tr><th>ID</th> <th>Name</th> <th>Description</th> <th>Modified</th> <th>Actions</th></tr>",s=E(),o=O("tbody");for(let f=0;f<h.length;f+=1)h[f].c();l=E(),v(a.$$.fragment),y(t,"class","bg-white shadow w-full")},m(f,p){b(e,f,p),S(f,n,p),S(f,t,p),g(t,r),g(t,s),g(t,o);for(let $=0;$<h.length;$+=1)h[$]&&h[$].m(o,null);S(f,l,p),b(a,f,p),u=!0},p(f,p){if(p&3){c=le(f[0]);let k;for(k=0;k<c.length;k+=1){const T=or(f,c,k);h[k]?(h[k].p(T,p),m(h[k],1)):(h[k]=ar(T),h[k].c(),m(h[k],1),h[k].m(o,null))}for(V(),k=c.length;k<h.length;k+=1)d(k);W()}const $={};p&1024&&($.$$scope={dirty:p,ctx:f}),a.$set($)},i(f){if(!u){m(e.$$.fragment,f);for(let p=0;p<c.length;p+=1)m(h[p]);m(a.$$.fragment,f),u=!0}},o(f){_(e.$$.fragment,f),h=h.filter(Boolean);for(let p=0;p<h.length;p+=1)_(h[p]);_(a.$$.fragment,f),u=!1},d(f){f&&(C(n),C(t),C(l)),w(e,f),Be(h,f),w(a,f)}}}function yl(i){let e,n,t,r;return e=new ae({props:{$$slots:{default:[kl]},$$scope:{ctx:i}}}),t=new bn({props:{title:"Delete Book",deleteEntry:i[1]}}),{c(){v(e.$$.fragment),n=E(),v(t.$$.fragment)},m(s,o){b(e,s,o),S(s,n,o),b(t,s,o),r=!0},p(s,[o]){const l={};o&1027&&(l.$$scope={dirty:o,ctx:s}),e.$set(l);const a={};o&2&&(a.deleteEntry=s[1]),t.$set(a)},i(s){r||(m(e.$$.fragment,s),m(t.$$.fragment,s),r=!0)},o(s){_(e.$$.fragment,s),_(t.$$.fragment,s),r=!1},d(s){s&&C(n),w(e,s),w(t,s)}}}function Cl(i,e,n){let t=[],r={entry:null,onDelete:c=>{ll(c.id).then(h=>{n(0,t=h)})},getMessage:c=>`Do you wnat to delete the book: '${c.id}'?`};return me(async()=>{n(0,t=await gn())}),[t,r,async c=>{n(1,r.entry=c,r)},c=>{H("/books/update/"+c.id)},c=>{H("/chapters/list/"+c.id)},()=>H("/books/list"),()=>H("/books/create")]}class Sl extends N{constructor(e){super(),q(this,e,Cl,yl,U,{})}}function El(i){let e,n,t;return{c(){e=O("textarea"),y(e,"class","input"),y(e,"id",i[2])},m(r,s){S(r,e,s),Ye(e,i[0]),n||(t=tt(e,"input",i[4]),n=!0)},p(r,s){s&4&&y(e,"id",r[2]),s&1&&Ye(e,r[0])},d(r){r&&C(e),n=!1,t()}}}function Ol(i){let e,n;return e=new _n({props:{id:i[2],label:i[1],error:i[3],$$slots:{default:[El]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment)},m(t,r){b(e,t,r),n=!0},p(t,[r]){const s={};r&4&&(s.id=t[2]),r&2&&(s.label=t[1]),r&8&&(s.error=t[3]),r&37&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}function Al(i,e,n){let{label:t}=e,{id:r}=e,{value:s}=e,{error:o}=e;function l(){s=this.value,n(0,s)}return i.$$set=a=>{"label"in a&&n(1,t=a.label),"id"in a&&n(2,r=a.id),"value"in a&&n(0,s=a.value),"error"in a&&n(3,o=a.error)},[s,t,r,o,l]}class Ee extends N{constructor(e){super(),q(this,e,Al,Ol,U,{label:1,id:2,value:0,error:3})}}function Tl(i){let e,n,t,r;return e=new J({props:{onClick:i[7],label:"Cancel"}}),t=new J({props:{label:"Create"}}),{c(){v(e.$$.fragment),n=E(),v(t.$$.fragment)},m(s,o){b(e,s,o),S(s,n,o),b(t,s,o),r=!0},p:D,i(s){r||(m(e.$$.fragment,s),m(t.$$.fragment,s),r=!0)},o(s){_(e.$$.fragment,s),_(t.$$.fragment,s),r=!1},d(s){s&&C(n),w(e,s),w(t,s)}}}function jl(i){let e,n,t,r,s,o,l,a;function u(f){i[5](f)}let c={id:"name",label:"Book name",error:i[1]};i[0]!==void 0&&(c.value=i[0]),e=new Oe({props:c}),x.push(()=>ne(e,"value",u));function h(f){i[6](f)}let d={id:"description",label:"Book description",error:i[3]};return i[2]!==void 0&&(d.value=i[2]),r=new Ee({props:d}),x.push(()=>ne(r,"value",h)),l=new Z({props:{$$slots:{default:[Tl]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment),t=E(),v(r.$$.fragment),o=E(),v(l.$$.fragment)},m(f,p){b(e,f,p),S(f,t,p),b(r,f,p),S(f,o,p),b(l,f,p),a=!0},p(f,p){const $={};p&2&&($.error=f[1]),!n&&p&1&&(n=!0,$.value=f[0],te(()=>n=!1)),e.$set($);const k={};p&8&&(k.error=f[3]),!s&&p&4&&(s=!0,k.value=f[2],te(()=>s=!1)),r.$set(k);const T={};p&256&&(T.$$scope={dirty:p,ctx:f}),l.$set(T)},i(f){a||(m(e.$$.fragment,f),m(r.$$.fragment,f),m(l.$$.fragment,f),a=!0)},o(f){_(e.$$.fragment,f),_(r.$$.fragment,f),_(l.$$.fragment,f),a=!1},d(f){f&&(C(t),C(o)),w(e,f),w(r,f),w(l,f)}}}function Pl(i){let e,n,t,r;return e=new oe({props:{header:"Create Book"}}),t=new be({props:{onSubmit:i[4],$$slots:{default:[jl]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment),n=E(),v(t.$$.fragment)},m(s,o){b(e,s,o),S(s,n,o),b(t,s,o),r=!0},p(s,o){const l={};o&271&&(l.$$scope={dirty:o,ctx:s}),t.$set(l)},i(s){r||(m(e.$$.fragment,s),m(t.$$.fragment,s),r=!0)},o(s){_(e.$$.fragment,s),_(t.$$.fragment,s),r=!1},d(s){s&&C(n),w(e,s),w(t,s)}}}function Il(i){let e,n;return e=new ae({props:{$$slots:{default:[Pl]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment)},m(t,r){b(e,t,r),n=!0},p(t,[r]){const s={};r&271&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}function Rl(i,e,n){let t="",r="",s="",o="";const l=async()=>{n(1,r=fe(t)),n(3,o=fe(s)),!(r||o)&&(await ul(t,s),H("/books/list"))};function a(h){t=h,n(0,t)}function u(h){s=h,n(2,s)}return[t,r,s,o,l,a,u,()=>H("/books/list")]}class Ll extends N{constructor(e){super(),q(this,e,Rl,Il,U,{})}}function lr(i){let e,n,t=i[0].id+"",r,s,o,l=ie(i[0].modified)+"",a,u,c,h;return c=new be({props:{onSubmit:i[5],$$slots:{default:[Ul]},$$scope:{ctx:i}}}),{c(){e=O("div"),n=O("span"),r=L(t),s=E(),o=O("span"),a=L(l),u=E(),v(c.$$.fragment),y(e,"class","mb-4 text-small")},m(d,f){S(d,e,f),g(e,n),g(n,r),g(e,s),g(e,o),g(o,a),S(d,u,f),b(c,d,f),h=!0},p(d,f){(!h||f&1)&&t!==(t=d[0].id+"")&&B(r,t),(!h||f&1)&&l!==(l=ie(d[0].modified)+"")&&B(a,l);const p={};f&1054&&(p.$$scope={dirty:f,ctx:d}),c.$set(p)},i(d){h||(m(c.$$.fragment,d),h=!0)},o(d){_(c.$$.fragment,d),h=!1},d(d){d&&(C(e),C(u)),w(c,d)}}}function Dl(i){let e,n,t,r;return e=new J({props:{onClick:i[9],label:"Cancel"}}),t=new J({props:{label:"Update"}}),{c(){v(e.$$.fragment),n=E(),v(t.$$.fragment)},m(s,o){b(e,s,o),S(s,n,o),b(t,s,o),r=!0},p:D,i(s){r||(m(e.$$.fragment,s),m(t.$$.fragment,s),r=!0)},o(s){_(e.$$.fragment,s),_(t.$$.fragment,s),r=!1},d(s){s&&C(n),w(e,s),w(t,s)}}}function Ul(i){let e,n,t,r,s,o,l,a;function u(f){i[7](f)}let c={id:"name",label:"Book name",error:i[2]};i[1]!==void 0&&(c.value=i[1]),e=new Oe({props:c}),x.push(()=>ne(e,"value",u));function h(f){i[8](f)}let d={id:"description",label:"Book description",error:i[4]};return i[3]!==void 0&&(d.value=i[3]),r=new Ee({props:d}),x.push(()=>ne(r,"value",h)),l=new Z({props:{$$slots:{default:[Dl]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment),t=E(),v(r.$$.fragment),o=E(),v(l.$$.fragment)},m(f,p){b(e,f,p),S(f,t,p),b(r,f,p),S(f,o,p),b(l,f,p),a=!0},p(f,p){const $={};p&4&&($.error=f[2]),!n&&p&2&&(n=!0,$.value=f[1],te(()=>n=!1)),e.$set($);const k={};p&16&&(k.error=f[4]),!s&&p&8&&(s=!0,k.value=f[3],te(()=>s=!1)),r.$set(k);const T={};p&1024&&(T.$$scope={dirty:p,ctx:f}),l.$set(T)},i(f){a||(m(e.$$.fragment,f),m(r.$$.fragment,f),m(l.$$.fragment,f),a=!0)},o(f){_(e.$$.fragment,f),_(r.$$.fragment,f),_(l.$$.fragment,f),a=!1},d(f){f&&(C(t),C(o)),w(e,f),w(r,f),w(l,f)}}}function ql(i){let e,n,t,r;e=new oe({props:{header:"Update Book"}});let s=i[0]&&lr(i);return{c(){v(e.$$.fragment),n=E(),s&&s.c(),t=X()},m(o,l){b(e,o,l),S(o,n,l),s&&s.m(o,l),S(o,t,l),r=!0},p(o,l){o[0]?s?(s.p(o,l),l&1&&m(s,1)):(s=lr(o),s.c(),m(s,1),s.m(t.parentNode,t)):s&&(V(),_(s,1,1,()=>{s=null}),W())},i(o){r||(m(e.$$.fragment,o),m(s),r=!0)},o(o){_(e.$$.fragment,o),_(s),r=!1},d(o){o&&(C(n),C(t)),w(e,o),s&&s.d(o)}}}function Nl(i){let e,n;return e=new ae({props:{$$slots:{default:[ql]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment)},m(t,r){b(e,t,r),n=!0},p(t,[r]){const s={};r&1055&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}function Bl(i,e,n){let{params:t={id:""}}=e,r=null,s="",o="",l="",a="";const u=async()=>{if(n(2,o=fe(s)),n(4,a=fe(l)),!(o||a)){if(!r){Q.setString("No book!!");return}await cl(r.id,s,l),H("/books/list")}};me(async()=>{n(0,r=await Rt(parseInt(t.id))),r&&(n(1,s=r.name),n(3,l=r.description))});function c(f){s=f,n(1,s)}function h(f){l=f,n(3,l)}const d=()=>H("/books/list");return i.$$set=f=>{"params"in f&&n(6,t=f.params)},[r,s,o,l,a,u,t,c,h,d]}class Ml extends N{constructor(e){super(),q(this,e,Bl,Nl,U,{params:6})}}const Fl=_t+"chapters",Lt=i=>`${Fl}#${i}`,wn=async i=>{let{data:e,error:n}=await Y.from("chapters").select("*").eq("id",i).single();return n&&Q.setDBError(n),e||null},vn=async i=>{const e=Lt(i),n=localStorage.getItem(e);if(n)return JSON.parse(n);let{data:t,error:r}=await Y.from("chapters").select("*").eq("book_id",i).order("id");return r&&Q.setDBError(r),t?(localStorage.setItem(e,JSON.stringify(t)),t):[]},zl=async(i,e)=>{const{error:n}=await Y.from("chapters").delete().eq("id",i);return n?(Q.setDBError(n),[]):(localStorage.removeItem(Lt(e)),vn(e))},Hl=async(i,e,n)=>{const{error:t}=await Y.from("chapters").update({name:n}).eq("id",i);return t?(Q.setDBError(t),[]):(localStorage.removeItem(Lt(e)),vn(e))},Jl=async(i,e)=>{const{error:n}=await Y.from("chapters").insert([{book_id:i,name:e}]);if(n)return Q.setDBError(n),[];localStorage.removeItem(Lt(i))};function Kl(i){let e,n;const t=i[1].default,r=Ae(t,i,i[0],null);return{c(){e=O("div"),r&&r.c(),y(e,"class","border rounded shadow px-4 py-4")},m(s,o){S(s,e,o),r&&r.m(e,null),n=!0},p(s,[o]){r&&r.p&&(!n||o&1)&&je(r,t,s,s[0],n?Te(t,s[0],o,null):Pe(s[0]),null)},i(s){n||(m(r,s),n=!0)},o(s){_(r,s),n=!1},d(s){s&&C(e),r&&r.d(s)}}}function Gl(i,e,n){let{$$slots:t={},$$scope:r}=e;return i.$$set=s=>{"$$scope"in s&&n(0,r=s.$$scope)},[r,t]}class Vl extends N{constructor(e){super(),q(this,e,Gl,Kl,U,{})}}function ur(i){let e,n,t,r=i[0].name+"",s,o,l,a,u=i[0].id+"",c,h,d=ie(i[0].modified)+"",f,p,$=i[0].description&&cr(i);return{c(){e=O("div"),n=O("div"),t=O("div"),s=L(r),o=E(),l=O("div"),a=L("Book-Id: "),c=L(u),h=L(" - Modified: "),f=L(d),p=E(),$&&$.c(),y(t,"class","text-lg font-semibold"),y(l,"class","text-sm"),y(n,"class","flex justify-between mb-2")},m(k,T){S(k,e,T),g(e,n),g(n,t),g(t,s),g(n,o),g(n,l),g(l,a),g(l,c),g(l,h),g(l,f),g(e,p),$&&$.m(e,null)},p(k,T){T&1&&r!==(r=k[0].name+"")&&B(s,r),T&1&&u!==(u=k[0].id+"")&&B(c,u),T&1&&d!==(d=ie(k[0].modified)+"")&&B(f,d),k[0].description?$?$.p(k,T):($=cr(k),$.c(),$.m(e,null)):$&&($.d(1),$=null)},d(k){k&&C(e),$&&$.d()}}}function cr(i){let e,n=i[0].description+"",t;return{c(){e=O("p"),t=L(n),y(e,"class","mt-2 pt-2 border-t text-sm")},m(r,s){S(r,e,s),g(e,t)},p(r,s){s&1&&n!==(n=r[0].description+"")&&B(t,n)},d(r){r&&C(e)}}}function fr(i){let e,n,t=i[1].name+"",r,s,o,l,a=i[1].id+"",u,c,h=ie(i[1].modified)+"",d;return{c(){e=O("div"),n=O("div"),r=L(t),s=E(),o=O("div"),l=L("Chapter-Id: "),u=L(a),c=L(" - Modified: "),d=L(h),y(n,"class","text font-medium"),y(o,"class","text-sm"),y(e,"class","flex justify-between mb-2")},m(f,p){S(f,e,p),g(e,n),g(n,r),g(e,s),g(e,o),g(o,l),g(o,u),g(o,c),g(o,d)},p(f,p){p&2&&t!==(t=f[1].name+"")&&B(r,t),p&2&&a!==(a=f[1].id+"")&&B(u,a),p&2&&h!==(h=ie(f[1].modified)+"")&&B(d,h)},d(f){f&&C(e)}}}function Wl(i){let e,n,t=i[0]&&ur(i),r=i[1]&&fr(i);return{c(){e=O("div"),t&&t.c(),n=E(),r&&r.c(),y(e,"class","flex flex-col gap-5")},m(s,o){S(s,e,o),t&&t.m(e,null),g(e,n),r&&r.m(e,null)},p(s,o){s[0]?t?t.p(s,o):(t=ur(s),t.c(),t.m(e,n)):t&&(t.d(1),t=null),s[1]?r?r.p(s,o):(r=fr(s),r.c(),r.m(e,null)):r&&(r.d(1),r=null)},d(s){s&&C(e),t&&t.d(),r&&r.d()}}}function Ql(i){let e,n;return e=new Vl({props:{$$slots:{default:[Wl]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment)},m(t,r){b(e,t,r),n=!0},p(t,[r]){const s={};r&7&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}function Yl(i,e,n){let{book:t=null}=e,{chapter:r=null}=e;return i.$$set=s=>{"book"in s&&n(0,t=s.book),"chapter"in s&&n(1,r=s.chapter)},[t,r]}class kn extends N{constructor(e){super(),q(this,e,Yl,Ql,U,{book:0,chapter:1})}}function Xl(i){let e,n;return{c(){e=ee("svg"),n=ee("path"),y(n,"stroke-linecap","round"),y(n,"stroke-linejoin","round"),y(n,"d","m12.75 15 3-3m0 0-3-3m3 3h-7.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"),y(e,"xmlns","http://www.w3.org/2000/svg"),y(e,"fill","none"),y(e,"viewBox","0 0 24 24"),y(e,"stroke-width","1.5"),y(e,"stroke","currentColor"),y(e,"class","size-6 hover:stroke-2")},m(t,r){S(t,e,r),g(e,n)},p:D,d(t){t&&C(e)}}}function Zl(i){let e,n;return e=new $e({props:{onClick:i[0],$$slots:{default:[Xl]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment)},m(t,r){b(e,t,r),n=!0},p(t,[r]){const s={};r&1&&(s.onClick=t[0]),r&2&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}function xl(i,e,n){let{onClick:t}=e;return i.$$set=r=>{"onClick"in r&&n(0,t=r.onClick)},[t]}class eu extends N{constructor(e){super(),q(this,e,xl,Zl,U,{onClick:0})}}function hr(i,e,n){const t=i.slice();return t[10]=e[n],t}function tu(i){let e,n,t,r,s,o,l,a;function u(){return i[4](i[10])}e=new It({props:{onClick:u}});function c(){return i[5](i[10])}t=new $n({props:{onClick:c}});function h(){return i[6](i[10])}s=new rs({props:{onClick:h}});function d(){return i[7](i[10])}return l=new eu({props:{onClick:d}}),{c(){v(e.$$.fragment),n=E(),v(t.$$.fragment),r=E(),v(s.$$.fragment),o=E(),v(l.$$.fragment)},m(f,p){b(e,f,p),S(f,n,p),b(t,f,p),S(f,r,p),b(s,f,p),S(f,o,p),b(l,f,p),a=!0},p(f,p){i=f;const $={};p&12&&($.onClick=u),e.$set($);const k={};p&4&&(k.onClick=c),t.$set(k);const T={};p&4&&(T.onClick=h),s.$set(T);const A={};p&4&&(A.onClick=d),l.$set(A)},i(f){a||(m(e.$$.fragment,f),m(t.$$.fragment,f),m(s.$$.fragment,f),m(l.$$.fragment,f),a=!0)},o(f){_(e.$$.fragment,f),_(t.$$.fragment,f),_(s.$$.fragment,f),_(l.$$.fragment,f),a=!1},d(f){f&&(C(n),C(r),C(o)),w(e,f),w(t,f),w(s,f),w(l,f)}}}function dr(i){let e,n,t=i[10].id+"",r,s,o,l=i[10].name+"",a,u,c,h=ie(i[10].modified)+"",d,f,p,$,k,T;return $=new Z({props:{$$slots:{default:[tu]},$$scope:{ctx:i}}}),{c(){e=O("tr"),n=O("td"),r=L(t),s=E(),o=O("td"),a=L(l),u=E(),c=O("td"),d=L(h),f=E(),p=O("td"),v($.$$.fragment),k=E()},m(A,j){S(A,e,j),g(e,n),g(n,r),g(e,s),g(e,o),g(o,a),g(e,u),g(e,c),g(c,d),g(e,f),g(e,p),b($,p,null),g(e,k),T=!0},p(A,j){(!T||j&4)&&t!==(t=A[10].id+"")&&B(r,t),(!T||j&4)&&l!==(l=A[10].name+"")&&B(a,l),(!T||j&4)&&h!==(h=ie(A[10].modified)+"")&&B(d,h);const P={};j&8204&&(P.$$scope={dirty:j,ctx:A}),$.$set(P)},i(A){T||(m($.$$.fragment,A),T=!0)},o(A){_($.$$.fragment,A),T=!1},d(A){A&&C(e),w($)}}}function nu(i){let e,n,t,r;return e=new J({props:{onClick:i[8],label:"Cancel"}}),t=new J({props:{onClick:i[9],label:"Create"}}),{c(){v(e.$$.fragment),n=E(),v(t.$$.fragment)},m(s,o){b(e,s,o),S(s,n,o),b(t,s,o),r=!0},p(s,o){const l={};o&1&&(l.onClick=s[9]),t.$set(l)},i(s){r||(m(e.$$.fragment,s),m(t.$$.fragment,s),r=!0)},o(s){_(e.$$.fragment,s),_(t.$$.fragment,s),r=!1},d(s){s&&C(n),w(e,s),w(t,s)}}}function ru(i){let e,n,t,r,s,o,l,a,u,c,h;e=new oe({props:{header:"List Chapters"}}),t=new kn({props:{book:i[1]}});let d=le(i[2]),f=[];for(let $=0;$<d.length;$+=1)f[$]=dr(hr(i,d,$));const p=$=>_(f[$],1,1,()=>{f[$]=null});return c=new Z({props:{$$slots:{default:[nu]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment),n=E(),v(t.$$.fragment),r=E(),s=O("table"),o=O("thead"),o.innerHTML="<tr><th>ID</th> <th>Name</th> <th>Modified</th> <th>Actions</th></tr>",l=E(),a=O("tbody");for(let $=0;$<f.length;$+=1)f[$].c();u=E(),v(c.$$.fragment),y(s,"class","bg-white shadow w-full")},m($,k){b(e,$,k),S($,n,k),b(t,$,k),S($,r,k),S($,s,k),g(s,o),g(s,l),g(s,a);for(let T=0;T<f.length;T+=1)f[T]&&f[T].m(a,null);S($,u,k),b(c,$,k),h=!0},p($,k){const T={};if(k&2&&(T.book=$[1]),t.$set(T),k&12){d=le($[2]);let j;for(j=0;j<d.length;j+=1){const P=hr($,d,j);f[j]?(f[j].p(P,k),m(f[j],1)):(f[j]=dr(P),f[j].c(),m(f[j],1),f[j].m(a,null))}for(V(),j=d.length;j<f.length;j+=1)p(j);W()}const A={};k&8193&&(A.$$scope={dirty:k,ctx:$}),c.$set(A)},i($){if(!h){m(e.$$.fragment,$),m(t.$$.fragment,$);for(let k=0;k<d.length;k+=1)m(f[k]);m(c.$$.fragment,$),h=!0}},o($){_(e.$$.fragment,$),_(t.$$.fragment,$),f=f.filter(Boolean);for(let k=0;k<f.length;k+=1)_(f[k]);_(c.$$.fragment,$),h=!1},d($){$&&(C(n),C(r),C(s),C(u)),w(e,$),w(t,$),Be(f,$),w(c,$)}}}function su(i){let e,n,t,r;return e=new ae({props:{$$slots:{default:[ru]},$$scope:{ctx:i}}}),t=new bn({props:{title:"Delete Chapter",deleteEntry:i[3]}}),{c(){v(e.$$.fragment),n=E(),v(t.$$.fragment)},m(s,o){b(e,s,o),S(s,n,o),b(t,s,o),r=!0},p(s,[o]){const l={};o&8207&&(l.$$scope={dirty:o,ctx:s}),e.$set(l);const a={};o&8&&(a.deleteEntry=s[3]),t.$set(a)},i(s){r||(m(e.$$.fragment,s),m(t.$$.fragment,s),r=!0)},o(s){_(e.$$.fragment,s),_(t.$$.fragment,s),r=!1},d(s){s&&C(n),w(e,s),w(t,s)}}}function iu(i,e,n){let{params:t={id:0}}=e,r,s=[],o={entry:null,onDelete:f=>{zl(f.id,f.book_id).then(p=>n(2,s=p))},getMessage:f=>`Do you wnat to delete the chapter: '${f.id}'?`};me(async()=>{n(1,r=await Rt(t.id)),r&&n(2,s=await vn(r.id))});const l=async f=>{n(3,o.entry=f,o)},a=f=>{H("/chapters/update/"+f.id)},u=f=>{H("/questions/list/"+f.id)},c=f=>{H("/lession/prepare/"+f.id)},h=()=>H("/books/list"),d=()=>H("/chapters/create/"+t.id);return i.$$set=f=>{"params"in f&&n(0,t=f.params)},[t,r,s,o,l,a,u,c,h,d]}class ou extends N{constructor(e){super(),q(this,e,iu,su,U,{params:0})}}function au(i){let e,n,t,r;return e=new J({props:{onClick:i[5],label:"Cancel"}}),t=new J({props:{label:"Create"}}),{c(){v(e.$$.fragment),n=E(),v(t.$$.fragment)},m(s,o){b(e,s,o),S(s,n,o),b(t,s,o),r=!0},p(s,o){const l={};o&1&&(l.onClick=s[5]),e.$set(l)},i(s){r||(m(e.$$.fragment,s),m(t.$$.fragment,s),r=!0)},o(s){_(e.$$.fragment,s),_(t.$$.fragment,s),r=!1},d(s){s&&C(n),w(e,s),w(t,s)}}}function lu(i){let e,n,t,r,s;function o(a){i[4](a)}let l={id:"name",label:"Chapter name",error:i[2]};return i[1]!==void 0&&(l.value=i[1]),e=new Oe({props:l}),x.push(()=>ne(e,"value",o)),r=new Z({props:{$$slots:{default:[au]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment),t=E(),v(r.$$.fragment)},m(a,u){b(e,a,u),S(a,t,u),b(r,a,u),s=!0},p(a,u){const c={};u&4&&(c.error=a[2]),!n&&u&2&&(n=!0,c.value=a[1],te(()=>n=!1)),e.$set(c);const h={};u&65&&(h.$$scope={dirty:u,ctx:a}),r.$set(h)},i(a){s||(m(e.$$.fragment,a),m(r.$$.fragment,a),s=!0)},o(a){_(e.$$.fragment,a),_(r.$$.fragment,a),s=!1},d(a){a&&C(t),w(e,a),w(r,a)}}}function uu(i){let e,n,t,r;return e=new oe({props:{header:"Create Book"}}),t=new be({props:{onSubmit:i[3],$$slots:{default:[lu]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment),n=E(),v(t.$$.fragment)},m(s,o){b(e,s,o),S(s,n,o),b(t,s,o),r=!0},p(s,o){const l={};o&71&&(l.$$scope={dirty:o,ctx:s}),t.$set(l)},i(s){r||(m(e.$$.fragment,s),m(t.$$.fragment,s),r=!0)},o(s){_(e.$$.fragment,s),_(t.$$.fragment,s),r=!1},d(s){s&&C(n),w(e,s),w(t,s)}}}function cu(i){let e,n;return e=new ae({props:{$$slots:{default:[uu]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment)},m(t,r){b(e,t,r),n=!0},p(t,[r]){const s={};r&71&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}function fu(i,e,n){let{params:t={book_id:0}}=e,r="",s="";const o=async()=>{n(2,s=fe(r)),!s&&(await Jl(t.book_id,r),H("/chapters/list/"+t.book_id))};function l(u){r=u,n(1,r)}const a=()=>H("/chapters/list/"+t.book_id);return i.$$set=u=>{"params"in u&&n(0,t=u.params)},[t,r,s,o,l,a]}class hu extends N{constructor(e){super(),q(this,e,fu,cu,U,{params:0})}}function pr(i){let e,n,t=i[0].id+"",r,s,o,l=ie(i[0].modified)+"",a,u,c,h;return c=new be({props:{onSubmit:i[3],$$slots:{default:[pu]},$$scope:{ctx:i}}}),{c(){e=O("div"),n=O("span"),r=L(t),s=E(),o=O("span"),a=L(l),u=E(),v(c.$$.fragment),y(e,"class","mb-4 text-small")},m(d,f){S(d,e,f),g(e,n),g(n,r),g(e,s),g(e,o),g(o,a),S(d,u,f),b(c,d,f),h=!0},p(d,f){(!h||f&1)&&t!==(t=d[0].id+"")&&B(r,t),(!h||f&1)&&l!==(l=ie(d[0].modified)+"")&&B(a,l);const p={};f&135&&(p.$$scope={dirty:f,ctx:d}),c.$set(p)},i(d){h||(m(c.$$.fragment,d),h=!0)},o(d){_(c.$$.fragment,d),h=!1},d(d){d&&(C(e),C(u)),w(c,d)}}}function du(i){let e,n,t,r;return e=new J({props:{onClick:i[6],label:"Cancel"}}),t=new J({props:{label:"Create"}}),{c(){v(e.$$.fragment),n=E(),v(t.$$.fragment)},m(s,o){b(e,s,o),S(s,n,o),b(t,s,o),r=!0},p(s,o){const l={};o&1&&(l.onClick=s[6]),e.$set(l)},i(s){r||(m(e.$$.fragment,s),m(t.$$.fragment,s),r=!0)},o(s){_(e.$$.fragment,s),_(t.$$.fragment,s),r=!1},d(s){s&&C(n),w(e,s),w(t,s)}}}function pu(i){let e,n,t,r,s;function o(a){i[5](a)}let l={id:"name",label:"Chapter name",error:i[2]};return i[1]!==void 0&&(l.value=i[1]),e=new Oe({props:l}),x.push(()=>ne(e,"value",o)),r=new Z({props:{$$slots:{default:[du]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment),t=E(),v(r.$$.fragment)},m(a,u){b(e,a,u),S(a,t,u),b(r,a,u),s=!0},p(a,u){const c={};u&4&&(c.error=a[2]),!n&&u&2&&(n=!0,c.value=a[1],te(()=>n=!1)),e.$set(c);const h={};u&129&&(h.$$scope={dirty:u,ctx:a}),r.$set(h)},i(a){s||(m(e.$$.fragment,a),m(r.$$.fragment,a),s=!0)},o(a){_(e.$$.fragment,a),_(r.$$.fragment,a),s=!1},d(a){a&&C(t),w(e,a),w(r,a)}}}function mu(i){let e,n,t,r;e=new oe({props:{header:"Update Book"}});let s=i[0]&&pr(i);return{c(){v(e.$$.fragment),n=E(),s&&s.c(),t=X()},m(o,l){b(e,o,l),S(o,n,l),s&&s.m(o,l),S(o,t,l),r=!0},p(o,l){o[0]?s?(s.p(o,l),l&1&&m(s,1)):(s=pr(o),s.c(),m(s,1),s.m(t.parentNode,t)):s&&(V(),_(s,1,1,()=>{s=null}),W())},i(o){r||(m(e.$$.fragment,o),m(s),r=!0)},o(o){_(e.$$.fragment,o),_(s),r=!1},d(o){o&&(C(n),C(t)),w(e,o),s&&s.d(o)}}}function _u(i){let e,n;return e=new ae({props:{$$slots:{default:[mu]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment)},m(t,r){b(e,t,r),n=!0},p(t,[r]){const s={};r&135&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}function gu(i,e,n){let{params:t={id:""}}=e,r=null,s="",o="";const l=async()=>{if(n(2,o=fe(s)),!o){if(!r){Q.setString("No chapter!!");return}await Hl(r.id,r.book_id,s),H("/chapters/list/"+r.book_id)}};me(async()=>{n(0,r=await wn(parseInt(t.id))),r&&n(1,s=r.name)});function a(c){s=c,n(1,s)}const u=()=>H("/chapters/list/"+(r==null?void 0:r.book_id));return i.$$set=c=>{"params"in c&&n(4,t=c.params)},[r,s,o,l,t,a,u]}class $u extends N{constructor(e){super(),q(this,e,gu,_u,U,{params:4})}}const bu=_t+"questions",Dt=i=>`${bu}#${i}`,wu=async i=>{let{data:e,error:n}=await Y.from("questions").select("*").eq("id",i).single();return n&&Q.setDBError(n),e||null},Ut=async i=>{const e=Dt(i),n=localStorage.getItem(e);if(n)return JSON.parse(n);let{data:t,error:r}=await Y.from("questions").select("*").eq("chapter_id",i).order("id");return r&&Q.setDBError(r),t?(localStorage.setItem(e,JSON.stringify(t)),t):[]},vu=async(i,e)=>{const{error:n}=await Y.from("questions").delete().eq("id",i);return n?(Q.setDBError(n),[]):(localStorage.removeItem(Dt(e)),Ut(e))},ku=async(i,e,n,t)=>{const{error:r}=await Y.from("questions").insert([{chapter_id:i,quest:e,answer:n,details:t}]);if(r)return Q.setDBError(r),[];localStorage.removeItem(Dt(i))},yu=async(i,e,n,t,r)=>{const{error:s}=await Y.from("questions").update({quest:n,answer:t,details:r}).eq("id",i);return s?(Q.setDBError(s),[]):(localStorage.removeItem(Dt(e)),Ut(e))},Xt=10,Cu=async(i,e)=>{const{data:n,error:t}=await Y.from("questions").select().ilike(e,`%${i}%`).limit(Xt+1);return t?(Q.setDBError(t),{questions:[],hasMore:!1}):(console.log("search-like:",i,"where:",e,"data:",n),{questions:n.slice(0,Xt),hasMore:n.length==Xt+1})};function Su(i){let e,n;return{c(){e=O("div"),n=L(i[0]),y(e,"class","text-xs font-medium rounded-full shadow-sm bg-teal-500 text-white py-1.5 px-3")},m(t,r){S(t,e,r),g(e,n)},p(t,[r]){r&1&&B(n,t[0])},i:D,o:D,d(t){t&&C(e)}}}function Eu(i,e,n){let{text:t}=e;return i.$$set=r=>{"text"in r&&n(0,t=r.text)},[t]}class Ou extends N{constructor(e){super(),q(this,e,Eu,Su,U,{text:0})}}function mr(i){let e,n;return e=new Ou({props:{text:`Progress: ${i[1]} / 3`}}),{c(){v(e.$$.fragment)},m(t,r){b(e,t,r),n=!0},p(t,r){const s={};r&2&&(s.text=`Progress: ${t[1]} / 3`),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}function _r(i){let e,n,t,r,s=(i[3]?i[0].quest:i[0].answer)+"",o,l,a,u=i[0].details&&gr(i);return{c(){e=O("div"),n=O("div"),n.textContent="Answer",t=E(),r=O("div"),o=L(s),l=E(),u&&u.c(),a=X(),y(n,"class","text-sm font-bold"),y(r,"class","px-3 py-3 mt-2 border border-gray-400 rounded shadow-sm whitespace-pre-line bg-yellow-50")},m(c,h){S(c,e,h),g(e,n),g(e,t),g(e,r),g(r,o),S(c,l,h),u&&u.m(c,h),S(c,a,h)},p(c,h){h&9&&s!==(s=(c[3]?c[0].quest:c[0].answer)+"")&&B(o,s),c[0].details?u?u.p(c,h):(u=gr(c),u.c(),u.m(a.parentNode,a)):u&&(u.d(1),u=null)},d(c){c&&(C(e),C(l),C(a)),u&&u.d(c)}}}function gr(i){let e,n,t,r,s=i[0].details+"",o;return{c(){e=O("div"),n=O("div"),n.textContent="Details",t=E(),r=O("div"),o=L(s),y(n,"class","text-sm font-bold"),y(r,"class","px-3 py-3 mt-2 border border-gray-400 rounded shadow-sm whitespace-pre-line bg-yellow-50")},m(l,a){S(l,e,a),g(e,n),g(e,t),g(e,r),g(r,o)},p(l,a){a&1&&s!==(s=l[0].details+"")&&B(o,s)},d(l){l&&C(e)}}}function Au(i){let e,n,t,r,s,o=i[0].id+"",l,a,u,c,h,d=ie(i[0].modified)+"",f,p,$,k=(i[3]?i[0].answer:i[0].quest)+"",T,A,j,P=i[1]>=0&&mr(i),I=i[2]&&_r(i);return{c(){e=O("div"),n=O("div"),t=O("div"),r=O("div"),s=L("Question Id: "),l=L(o),a=E(),P&&P.c(),u=E(),c=O("div"),h=L("Modified: "),f=L(d),p=E(),$=O("div"),T=L(k),A=E(),I&&I.c(),y(r,"class","text-sm font-bold"),y(c,"class","text-sm"),y(t,"class","flex justify-between items-end"),y($,"class","px-3 py-3 mt-2 border border-gray-400 rounded shadow-sm whitespace-pre-line bg-yellow-100"),y(e,"class","flex flex-col gap-3")},m(R,M){S(R,e,M),g(e,n),g(n,t),g(t,r),g(r,s),g(r,l),g(t,a),P&&P.m(t,null),g(t,u),g(t,c),g(c,h),g(c,f),g(n,p),g(n,$),g($,T),g(e,A),I&&I.m(e,null),j=!0},p(R,[M]){(!j||M&1)&&o!==(o=R[0].id+"")&&B(l,o),R[1]>=0?P?(P.p(R,M),M&2&&m(P,1)):(P=mr(R),P.c(),m(P,1),P.m(t,u)):P&&(V(),_(P,1,1,()=>{P=null}),W()),(!j||M&1)&&d!==(d=ie(R[0].modified)+"")&&B(f,d),(!j||M&9)&&k!==(k=(R[3]?R[0].answer:R[0].quest)+"")&&B(T,k),R[2]?I?I.p(R,M):(I=_r(R),I.c(),I.m(e,null)):I&&(I.d(1),I=null)},i(R){j||(m(P),j=!0)},o(R){_(P),j=!1},d(R){R&&C(e),P&&P.d(),I&&I.d()}}}function Tu(i,e,n){let{question:t}=e,{progress:r=-1}=e,{showAnswer:s=!0}=e,{reverse:o=!1}=e;return i.$$set=l=>{"question"in l&&n(0,t=l.question),"progress"in l&&n(1,r=l.progress),"showAnswer"in l&&n(2,s=l.showAnswer),"reverse"in l&&n(3,o=l.reverse)},[t,r,s,o]}class yn extends N{constructor(e){super(),q(this,e,Tu,Au,U,{question:0,progress:1,showAnswer:2,reverse:3})}}function $r(i,e,n){const t=i.slice();return t[9]=e[n],t}function ju(i){let e,n,t,r;function s(){return i[5](i[9])}e=new It({props:{onClick:s}});function o(){return i[6](i[9])}return t=new $n({props:{onClick:o}}),{c(){v(e.$$.fragment),n=E(),v(t.$$.fragment)},m(l,a){b(e,l,a),S(l,n,a),b(t,l,a),r=!0},p(l,a){i=l;const u={};a&24&&(u.onClick=s),e.$set(u);const c={};a&8&&(c.onClick=o),t.$set(c)},i(l){r||(m(e.$$.fragment,l),m(t.$$.fragment,l),r=!0)},o(l){_(e.$$.fragment,l),_(t.$$.fragment,l),r=!1},d(l){l&&C(n),w(e,l),w(t,l)}}}function br(i){let e,n,t,r,s,o,l;return n=new yn({props:{question:i[9]}}),s=new Z({props:{$$slots:{default:[ju]},$$scope:{ctx:i}}}),{c(){e=O("div"),v(n.$$.fragment),t=E(),r=O("div"),v(s.$$.fragment),o=E(),y(r,"class","mt-2 flex justify-end")},m(a,u){S(a,e,u),b(n,e,null),g(e,t),g(e,r),b(s,r,null),g(e,o),l=!0},p(a,u){const c={};u&8&&(c.question=a[9]),n.$set(c);const h={};u&4120&&(h.$$scope={dirty:u,ctx:a}),s.$set(h)},i(a){l||(m(n.$$.fragment,a),m(s.$$.fragment,a),l=!0)},o(a){_(n.$$.fragment,a),_(s.$$.fragment,a),l=!1},d(a){a&&C(e),w(n),w(s)}}}function Pu(i){let e,n,t,r;return e=new J({props:{onClick:i[7],label:"Cancel"}}),t=new J({props:{onClick:i[8],label:"Create"}}),{c(){v(e.$$.fragment),n=E(),v(t.$$.fragment)},m(s,o){b(e,s,o),S(s,n,o),b(t,s,o),r=!0},p(s,o){const l={};o&4&&(l.onClick=s[7]),e.$set(l);const a={};o&1&&(a.onClick=s[8]),t.$set(a)},i(s){r||(m(e.$$.fragment,s),m(t.$$.fragment,s),r=!0)},o(s){_(e.$$.fragment,s),_(t.$$.fragment,s),r=!1},d(s){s&&C(n),w(e,s),w(t,s)}}}function Iu(i){let e,n,t,r,s,o,l,a;e=new oe({props:{header:"List Chapters"}}),t=new kn({props:{book:i[1],chapter:i[2]}});let u=le(i[3]),c=[];for(let d=0;d<u.length;d+=1)c[d]=br($r(i,u,d));const h=d=>_(c[d],1,1,()=>{c[d]=null});return l=new Z({props:{$$slots:{default:[Pu]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment),n=E(),v(t.$$.fragment),r=E(),s=O("div");for(let d=0;d<c.length;d+=1)c[d].c();o=E(),v(l.$$.fragment),y(s,"class","flex flex-col gap-5")},m(d,f){b(e,d,f),S(d,n,f),b(t,d,f),S(d,r,f),S(d,s,f);for(let p=0;p<c.length;p+=1)c[p]&&c[p].m(s,null);S(d,o,f),b(l,d,f),a=!0},p(d,f){const p={};if(f&2&&(p.book=d[1]),f&4&&(p.chapter=d[2]),t.$set(p),f&24){u=le(d[3]);let k;for(k=0;k<u.length;k+=1){const T=$r(d,u,k);c[k]?(c[k].p(T,f),m(c[k],1)):(c[k]=br(T),c[k].c(),m(c[k],1),c[k].m(s,null))}for(V(),k=u.length;k<c.length;k+=1)h(k);W()}const $={};f&4101&&($.$$scope={dirty:f,ctx:d}),l.$set($)},i(d){if(!a){m(e.$$.fragment,d),m(t.$$.fragment,d);for(let f=0;f<u.length;f+=1)m(c[f]);m(l.$$.fragment,d),a=!0}},o(d){_(e.$$.fragment,d),_(t.$$.fragment,d),c=c.filter(Boolean);for(let f=0;f<c.length;f+=1)_(c[f]);_(l.$$.fragment,d),a=!1},d(d){d&&(C(n),C(r),C(s),C(o)),w(e,d),w(t,d),Be(c,d),w(l,d)}}}function Ru(i){let e,n,t,r;return e=new ae({props:{$$slots:{default:[Iu]},$$scope:{ctx:i}}}),t=new bn({props:{title:"Delete Question",deleteEntry:i[4]}}),{c(){v(e.$$.fragment),n=E(),v(t.$$.fragment)},m(s,o){b(e,s,o),S(s,n,o),b(t,s,o),r=!0},p(s,[o]){const l={};o&4127&&(l.$$scope={dirty:o,ctx:s}),e.$set(l);const a={};o&16&&(a.deleteEntry=s[4]),t.$set(a)},i(s){r||(m(e.$$.fragment,s),m(t.$$.fragment,s),r=!0)},o(s){_(e.$$.fragment,s),_(t.$$.fragment,s),r=!1},d(s){s&&C(n),w(e,s),w(t,s)}}}function Lu(i,e,n){let{params:t={id:0}}=e,r,s,o=[];me(async()=>{n(2,s=await wn(t.id)),s&&(n(3,o=await Ut(s.id)),n(1,r=await Rt(s.book_id)))});let l={entry:null,onDelete:d=>{vu(d.id,d.chapter_id).then(f=>{n(3,o=f)})},getMessage:d=>`Do you wnat to delete the question: '${d.id}'?`};const a=d=>{n(4,l.entry=d,l)},u=d=>H("/questions/update/"+d.id),c=()=>H("/chapters/list/"+(s==null?void 0:s.book_id)),h=()=>H("/questions/create/"+t.id);return i.$$set=d=>{"params"in d&&n(0,t=d.params)},[t,r,s,o,l,a,u,c,h]}class Du extends N{constructor(e){super(),q(this,e,Lu,Ru,U,{params:0})}}function wr(i){let e,n,t=i[0].id+"",r,s,o,l=ie(i[0].modified)+"",a,u,c,h;return c=new be({props:{onSubmit:i[6],$$slots:{default:[qu]},$$scope:{ctx:i}}}),{c(){e=O("div"),n=O("span"),r=L(t),s=E(),o=O("span"),a=L(l),u=E(),v(c.$$.fragment),y(e,"class","mb-4 text-small")},m(d,f){S(d,e,f),g(e,n),g(n,r),g(e,s),g(e,o),g(o,a),S(d,u,f),b(c,d,f),h=!0},p(d,f){(!h||f&1)&&t!==(t=d[0].id+"")&&B(r,t),(!h||f&1)&&l!==(l=ie(d[0].modified)+"")&&B(a,l);const p={};f&4159&&(p.$$scope={dirty:f,ctx:d}),c.$set(p)},i(d){h||(m(c.$$.fragment,d),h=!0)},o(d){_(c.$$.fragment,d),h=!1},d(d){d&&(C(e),C(u)),w(c,d)}}}function Uu(i){let e,n,t,r;return e=new J({props:{onClick:i[11],label:"Cancel"}}),t=new J({props:{label:"Update"}}),{c(){v(e.$$.fragment),n=E(),v(t.$$.fragment)},m(s,o){b(e,s,o),S(s,n,o),b(t,s,o),r=!0},p(s,o){const l={};o&1&&(l.onClick=s[11]),e.$set(l)},i(s){r||(m(e.$$.fragment,s),m(t.$$.fragment,s),r=!0)},o(s){_(e.$$.fragment,s),_(t.$$.fragment,s),r=!1},d(s){s&&C(n),w(e,s),w(t,s)}}}function qu(i){let e,n,t,r,s,o,l,a,u,c,h;function d(A){i[8](A)}let f={id:"question",label:"Questione",error:i[2]};i[1]!==void 0&&(f.value=i[1]),e=new Ee({props:f}),x.push(()=>ne(e,"value",d));function p(A){i[9](A)}let $={id:"answer",label:"Answer",error:i[4]};i[3]!==void 0&&($.value=i[3]),r=new Ee({props:$}),x.push(()=>ne(r,"value",p));function k(A){i[10](A)}let T={id:"details",label:"Details",error:Mu};return i[5]!==void 0&&(T.value=i[5]),l=new Ee({props:T}),x.push(()=>ne(l,"value",k)),c=new Z({props:{$$slots:{default:[Uu]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment),t=E(),v(r.$$.fragment),o=E(),v(l.$$.fragment),u=E(),v(c.$$.fragment)},m(A,j){b(e,A,j),S(A,t,j),b(r,A,j),S(A,o,j),b(l,A,j),S(A,u,j),b(c,A,j),h=!0},p(A,j){const P={};j&4&&(P.error=A[2]),!n&&j&2&&(n=!0,P.value=A[1],te(()=>n=!1)),e.$set(P);const I={};j&16&&(I.error=A[4]),!s&&j&8&&(s=!0,I.value=A[3],te(()=>s=!1)),r.$set(I);const R={};!a&&j&32&&(a=!0,R.value=A[5],te(()=>a=!1)),l.$set(R);const M={};j&4097&&(M.$$scope={dirty:j,ctx:A}),c.$set(M)},i(A){h||(m(e.$$.fragment,A),m(r.$$.fragment,A),m(l.$$.fragment,A),m(c.$$.fragment,A),h=!0)},o(A){_(e.$$.fragment,A),_(r.$$.fragment,A),_(l.$$.fragment,A),_(c.$$.fragment,A),h=!1},d(A){A&&(C(t),C(o),C(u)),w(e,A),w(r,A),w(l,A),w(c,A)}}}function Nu(i){let e,n,t,r;e=new oe({props:{header:"Update Book"}});let s=i[0]&&wr(i);return{c(){v(e.$$.fragment),n=E(),s&&s.c(),t=X()},m(o,l){b(e,o,l),S(o,n,l),s&&s.m(o,l),S(o,t,l),r=!0},p(o,l){o[0]?s?(s.p(o,l),l&1&&m(s,1)):(s=wr(o),s.c(),m(s,1),s.m(t.parentNode,t)):s&&(V(),_(s,1,1,()=>{s=null}),W())},i(o){r||(m(e.$$.fragment,o),m(s),r=!0)},o(o){_(e.$$.fragment,o),_(s),r=!1},d(o){o&&(C(n),C(t)),w(e,o),s&&s.d(o)}}}function Bu(i){let e,n;return e=new ae({props:{$$slots:{default:[Nu]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment)},m(t,r){b(e,t,r),n=!0},p(t,[r]){const s={};r&4159&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}let Mu="";function Fu(i,e,n){let{params:t={id:""}}=e,r=null,s="",o="",l="",a="",u="";const c=async()=>{const $={quest:s.trim(),answer:l.trim()};if(n(2,o=fe($.quest)),n(4,a=fe($.answer)),!(o||a)){if(!r){Q.setString("No question!!");return}await yu(r.id,r.chapter_id,$.quest,$.answer,es(u)),H("/questions/list/"+r.chapter_id)}};me(async()=>{n(0,r=await wu(parseInt(t.id))),r&&(n(1,s=r.quest),n(3,l=r.answer),n(5,u=r.details?r.details:""))});function h($){s=$,n(1,s)}function d($){l=$,n(3,l)}function f($){u=$,n(5,u)}const p=()=>H("/questions/list/"+(r==null?void 0:r.chapter_id));return i.$$set=$=>{"params"in $&&n(7,t=$.params)},[r,s,o,l,a,u,c,t,h,d,f,p]}class zu extends N{constructor(e){super(),q(this,e,Fu,Bu,U,{params:7})}}function Hu(i){let e,n,t,r;return e=new J({props:{onClick:i[10],label:"Cancel"}}),t=new J({props:{label:"Create"}}),{c(){v(e.$$.fragment),n=E(),v(t.$$.fragment)},m(s,o){b(e,s,o),S(s,n,o),b(t,s,o),r=!0},p(s,o){const l={};o&1&&(l.onClick=s[10]),e.$set(l)},i(s){r||(m(e.$$.fragment,s),m(t.$$.fragment,s),r=!0)},o(s){_(e.$$.fragment,s),_(t.$$.fragment,s),r=!1},d(s){s&&C(n),w(e,s),w(t,s)}}}function Ju(i){let e,n,t,r,s,o,l,a,u,c,h;function d(A){i[7](A)}let f={id:"question",label:"Question",error:i[2]};i[1]!==void 0&&(f.value=i[1]),e=new Ee({props:f}),x.push(()=>ne(e,"value",d));function p(A){i[8](A)}let $={id:"answer",label:"Answer",error:i[4]};i[3]!==void 0&&($.value=i[3]),r=new Ee({props:$}),x.push(()=>ne(r,"value",p));function k(A){i[9](A)}let T={id:"details",label:"Details",error:Vu};return i[5]!==void 0&&(T.value=i[5]),l=new Ee({props:T}),x.push(()=>ne(l,"value",k)),c=new Z({props:{$$slots:{default:[Hu]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment),t=E(),v(r.$$.fragment),o=E(),v(l.$$.fragment),u=E(),v(c.$$.fragment)},m(A,j){b(e,A,j),S(A,t,j),b(r,A,j),S(A,o,j),b(l,A,j),S(A,u,j),b(c,A,j),h=!0},p(A,j){const P={};j&4&&(P.error=A[2]),!n&&j&2&&(n=!0,P.value=A[1],te(()=>n=!1)),e.$set(P);const I={};j&16&&(I.error=A[4]),!s&&j&8&&(s=!0,I.value=A[3],te(()=>s=!1)),r.$set(I);const R={};!a&&j&32&&(a=!0,R.value=A[5],te(()=>a=!1)),l.$set(R);const M={};j&2049&&(M.$$scope={dirty:j,ctx:A}),c.$set(M)},i(A){h||(m(e.$$.fragment,A),m(r.$$.fragment,A),m(l.$$.fragment,A),m(c.$$.fragment,A),h=!0)},o(A){_(e.$$.fragment,A),_(r.$$.fragment,A),_(l.$$.fragment,A),_(c.$$.fragment,A),h=!1},d(A){A&&(C(t),C(o),C(u)),w(e,A),w(r,A),w(l,A),w(c,A)}}}function Ku(i){let e,n,t,r;return e=new oe({props:{header:"Create Question"}}),t=new be({props:{onSubmit:i[6],$$slots:{default:[Ju]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment),n=E(),v(t.$$.fragment)},m(s,o){b(e,s,o),S(s,n,o),b(t,s,o),r=!0},p(s,o){const l={};o&2111&&(l.$$scope={dirty:o,ctx:s}),t.$set(l)},i(s){r||(m(e.$$.fragment,s),m(t.$$.fragment,s),r=!0)},o(s){_(e.$$.fragment,s),_(t.$$.fragment,s),r=!1},d(s){s&&C(n),w(e,s),w(t,s)}}}function Gu(i){let e,n;return e=new ae({props:{$$slots:{default:[Ku]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment)},m(t,r){b(e,t,r),n=!0},p(t,[r]){const s={};r&2111&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}let Vu="";function Wu(i,e,n){let{params:t={chapter_id:0}}=e,r="",s="",o="",l="",a="";const u=async()=>{const p={question:r.trim(),answer:o.trim()};n(2,s=fe(p.question)),n(4,l=fe(p.answer)),!(s||l)&&(await ku(t.chapter_id,p.question,p.answer,es(a)),H("/questions/list/"+t.chapter_id))};function c(p){r=p,n(1,r)}function h(p){o=p,n(3,o)}function d(p){a=p,n(5,a)}const f=()=>H("/questions/list/"+t.chapter_id);return i.$$set=p=>{"params"in p&&n(0,t=p.params)},[t,r,s,o,l,a,u,c,h,d,f]}class Qu extends N{constructor(e){super(),q(this,e,Wu,Gu,U,{params:0})}}function vr(i,e,n){const t=i.slice();return t[6]=e[n],t}function kr(i){let e,n=i[6].label+"",t,r,s;return{c(){e=O("option"),t=L(n),e.__value=r=i[6].value,Ye(e,e.__value),e.selected=s=i[6].value===i[0]},m(o,l){S(o,e,l),g(e,t)},p(o,l){l&8&&n!==(n=o[6].label+"")&&B(t,n),l&8&&r!==(r=o[6].value)&&(e.__value=r,Ye(e,e.__value)),l&9&&s!==(s=o[6].value===o[0])&&(e.selected=s)},d(o){o&&C(e)}}}function Yu(i){let e,n,t,r=le(i[3]),s=[];for(let o=0;o<r.length;o+=1)s[o]=kr(vr(i,r,o));return{c(){e=O("select");for(let o=0;o<s.length;o+=1)s[o].c();y(e,"id",i[2]),y(e,"name",i[2]),y(e,"class","input"),i[0]===void 0&&St(()=>i[5].call(e))},m(o,l){S(o,e,l);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(e,null);Tn(e,i[0],!0),n||(t=tt(e,"change",i[5]),n=!0)},p(o,l){if(l&9){r=le(o[3]);let a;for(a=0;a<r.length;a+=1){const u=vr(o,r,a);s[a]?s[a].p(u,l):(s[a]=kr(u),s[a].c(),s[a].m(e,null))}for(;a<s.length;a+=1)s[a].d(1);s.length=r.length}l&4&&y(e,"id",o[2]),l&4&&y(e,"name",o[2]),l&9&&Tn(e,o[0])},d(o){o&&C(e),Be(s,o),n=!1,t()}}}function Xu(i){let e,n;return e=new _n({props:{id:i[2],label:i[1],error:i[4],$$slots:{default:[Yu]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment)},m(t,r){b(e,t,r),n=!0},p(t,[r]){const s={};r&4&&(s.id=t[2]),r&2&&(s.label=t[1]),r&16&&(s.error=t[4]),r&525&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}function Zu(i,e,n){let{label:t}=e,{id:r}=e,{value:s}=e,{options:o}=e,{error:l=""}=e;function a(){s=us(this),n(0,s),n(3,o)}return i.$$set=u=>{"label"in u&&n(1,t=u.label),"id"in u&&n(2,r=u.id),"value"in u&&n(0,s=u.value),"options"in u&&n(3,o=u.options),"error"in u&&n(4,l=u.error)},[s,t,r,o,l,a]}class an extends N{constructor(e){super(),q(this,e,Zu,Xu,U,{label:1,id:2,value:0,options:3,error:4})}}function yr(i){let e,n,t=i[2].length+"",r;return{c(){e=O("div"),n=L("Length: "),r=L(t)},m(s,o){S(s,e,o),g(e,n),g(e,r)},p(s,o){o&4&&t!==(t=s[2].length+"")&&B(r,t)},d(s){s&&C(e)}}}function Cr(i){let e,n;return e=new be({props:{onSubmit:i[9],$$slots:{default:[ec]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment)},m(t,r){b(e,t,r),n=!0},p(t,r){const s={};r&16410&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}function xu(i){let e,n,t,r;return e=new J({props:{onClick:i[13],label:"Cancel"}}),t=new J({props:{label:"Start"}}),{c(){v(e.$$.fragment),n=E(),v(t.$$.fragment)},m(s,o){b(e,s,o),S(s,n,o),b(t,s,o),r=!0},p(s,o){const l={};o&2&&(l.onClick=s[13]),e.$set(l)},i(s){r||(m(e.$$.fragment,s),m(t.$$.fragment,s),r=!0)},o(s){_(e.$$.fragment,s),_(t.$$.fragment,s),r=!1},d(s){s&&C(n),w(e,s),w(t,s)}}}function ec(i){let e,n,t,r,s,o,l,a,u;function c(p){i[11](p)}let h={id:"correct",label:"Correct Answers",options:i[6],error:i[5]};i[3]!==void 0&&(h.value=i[3]),n=new an({props:h}),x.push(()=>ne(n,"value",c));function d(p){i[12](p)}let f={id:"reverse",label:"Reverse Answers",options:i[8],error:i[7]};return i[4]!==void 0&&(f.value=i[4]),s=new an({props:f}),x.push(()=>ne(s,"value",d)),a=new Z({props:{$$slots:{default:[xu]},$$scope:{ctx:i}}}),{c(){e=O("div"),v(n.$$.fragment),r=E(),v(s.$$.fragment),l=E(),v(a.$$.fragment),y(e,"class","flex flex-row gap-4")},m(p,$){S(p,e,$),b(n,e,null),g(e,r),b(s,e,null),S(p,l,$),b(a,p,$),u=!0},p(p,$){const k={};!t&&$&8&&(t=!0,k.value=p[3],te(()=>t=!1)),n.$set(k);const T={};!o&&$&16&&(o=!0,T.value=p[4],te(()=>o=!1)),s.$set(T);const A={};$&16386&&(A.$$scope={dirty:$,ctx:p}),a.$set(A)},i(p){u||(m(n.$$.fragment,p),m(s.$$.fragment,p),m(a.$$.fragment,p),u=!0)},o(p){_(n.$$.fragment,p),_(s.$$.fragment,p),_(a.$$.fragment,p),u=!1},d(p){p&&(C(e),C(l)),w(n),w(s),w(a,p)}}}function tc(i){let e,n,t,r,s,o,l;e=new oe({props:{header:"List Chapters"}}),t=new kn({props:{book:i[0],chapter:i[1]}});let a=i[1]&&yr(i),u=i[2].length!==0&&Cr(i);return{c(){v(e.$$.fragment),n=E(),v(t.$$.fragment),r=E(),a&&a.c(),s=E(),u&&u.c(),o=X()},m(c,h){b(e,c,h),S(c,n,h),b(t,c,h),S(c,r,h),a&&a.m(c,h),S(c,s,h),u&&u.m(c,h),S(c,o,h),l=!0},p(c,h){const d={};h&1&&(d.book=c[0]),h&2&&(d.chapter=c[1]),t.$set(d),c[1]?a?a.p(c,h):(a=yr(c),a.c(),a.m(s.parentNode,s)):a&&(a.d(1),a=null),c[2].length!==0?u?(u.p(c,h),h&4&&m(u,1)):(u=Cr(c),u.c(),m(u,1),u.m(o.parentNode,o)):u&&(V(),_(u,1,1,()=>{u=null}),W())},i(c){l||(m(e.$$.fragment,c),m(t.$$.fragment,c),m(u),l=!0)},o(c){_(e.$$.fragment,c),_(t.$$.fragment,c),_(u),l=!1},d(c){c&&(C(n),C(r),C(s),C(o)),w(e,c),w(t,c),a&&a.d(c),u&&u.d(c)}}}function nc(i){let e,n;return e=new ae({props:{$$slots:{default:[tc]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment)},m(t,r){b(e,t,r),n=!0},p(t,[r]){const s={};r&16415&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}function rc(i,e,n){let{params:t={id:0}}=e,r,s,o=[],l="1",a,u=[{label:"0",value:"0"},{label:"1",value:"1"},{label:"2",value:"2"},{label:"3",value:"3"}],c="false",h,d=[{label:"True",value:"true"},{label:"False",value:"false"}];me(async()=>{n(1,s=await wn(t.id)),s&&(n(2,o=await Ut(s.id)),n(0,r=await Rt(s.book_id)),o.length===0&&Q.setString("No questions found for this chapter!"))});const f=async()=>{Ua(o,parseInt(l),c==="true"),H("/lession/process")};function p(T){l=T,n(3,l)}function $(T){c=T,n(4,c)}const k=()=>H("/chapters/list/"+(s==null?void 0:s.book_id));return i.$$set=T=>{"params"in T&&n(10,t=T.params)},[r,s,o,l,c,a,u,h,d,f,t,p,$,k]}class sc extends N{constructor(e){super(),q(this,e,rc,nc,U,{params:10})}}function ic(i){let e,n,t,r,s,o,l=i[0][0]+"",a,u,c,h,d,f,p=i[0][1]+"",$,k,T,A,j,P,I=i[0][2]+"",R,M,K,re,we,ve,Ie=i[0][3]+"",Re;return{c(){e=O("div"),n=O("table"),t=O("tr"),r=O("td"),r.textContent="No correct answers",s=E(),o=O("td"),a=L(l),u=E(),c=O("tr"),h=O("td"),h.textContent="One correct answer",d=E(),f=O("td"),$=L(p),k=E(),T=O("tr"),A=O("td"),A.textContent="Two correct answers",j=E(),P=O("td"),R=L(I),M=E(),K=O("tr"),re=O("td"),re.textContent="Learned",we=E(),ve=O("td"),Re=L(Ie),y(r,"class","px-4 py-1 m-1 border-r border-gray-300"),y(o,"class","px-4 py-1 m-1"),y(t,"class",""),y(h,"class","px-4 py-1 m-1 border-r border-gray-300"),y(f,"class","px-4 py-1 m-1"),y(c,"class",""),y(A,"class","px-4 py-1 m-1 border-r border-gray-300"),y(P,"class","px-4 py-1 m-1"),y(T,"class",""),y(re,"class","px-4 py-1 m-1 border-r border-gray-300"),y(ve,"class","px-4 py-1 m-1"),y(K,"class",""),y(e,"class","border border-gray-300 rounded shadow-sm max-w-60 py-3")},m(ue,_e){S(ue,e,_e),g(e,n),g(n,t),g(t,r),g(t,s),g(t,o),g(o,a),g(n,u),g(n,c),g(c,h),g(c,d),g(c,f),g(f,$),g(n,k),g(n,T),g(T,A),g(T,j),g(T,P),g(P,R),g(n,M),g(n,K),g(K,re),g(K,we),g(K,ve),g(ve,Re)},p(ue,[_e]){_e&1&&l!==(l=ue[0][0]+"")&&B(a,l),_e&1&&p!==(p=ue[0][1]+"")&&B($,p),_e&1&&I!==(I=ue[0][2]+"")&&B(R,I),_e&1&&Ie!==(Ie=ue[0][3]+"")&&B(Re,Ie)},i:D,o:D,d(ue){ue&&C(e)}}}function oc(i,e,n){let{progress:t}=e;return i.$$set=r=>{"progress"in r&&n(0,t=r.progress)},[t]}class ac extends N{constructor(e){super(),q(this,e,oc,ic,U,{progress:0})}}function lc(i){let e,n;return e=new yn({props:{question:i[2].question,showAnswer:i[4],progress:i[2].progress,reverse:i[0].reverse}}),{c(){v(e.$$.fragment)},m(t,r){b(e,t,r),n=!0},p(t,r){const s={};r&4&&(s.question=t[2].question),r&16&&(s.showAnswer=t[4]),r&4&&(s.progress=t[2].progress),r&1&&(s.reverse=t[0].reverse),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}function uc(i){let e;return{c(){e=O("p"),e.textContent="End"},m(n,t){S(n,e,t)},p:D,i:D,o:D,d(n){n&&C(e)}}}function Sr(i){let e,n,t=i[2]&&Er(i);return{c(){t&&t.c(),e=X()},m(r,s){t&&t.m(r,s),S(r,e,s),n=!0},p(r,s){r[2]?t?(t.p(r,s),s&4&&m(t,1)):(t=Er(r),t.c(),m(t,1),t.m(e.parentNode,e)):t&&(V(),_(t,1,1,()=>{t=null}),W())},i(r){n||(m(t),n=!0)},o(r){_(t),n=!1},d(r){r&&C(e),t&&t.d(r)}}}function Er(i){let e,n,t,r;const s=[fc,cc],o=[];function l(a,u){return a[4]?1:0}return e=l(i),n=o[e]=s[e](i),{c(){n.c(),t=X()},m(a,u){o[e].m(a,u),S(a,t,u),r=!0},p(a,u){let c=e;e=l(a),e===c?o[e].p(a,u):(V(),_(o[c],1,1,()=>{o[c]=null}),W(),n=o[e],n?n.p(a,u):(n=o[e]=s[e](a),n.c()),m(n,1),n.m(t.parentNode,t))},i(a){r||(m(n),r=!0)},o(a){_(n),r=!1},d(a){a&&C(t),o[e].d(a)}}}function cc(i){let e,n,t,r,s,o,l,a;return e=new J({props:{label:"Correct",onClick:i[6]}}),t=new J({props:{label:"Wrong",onClick:i[7]}}),s=new J({props:{label:"Learned",onClick:i[8]}}),l=new J({props:{label:"Skip",onClick:i[9]}}),{c(){v(e.$$.fragment),n=E(),v(t.$$.fragment),r=E(),v(s.$$.fragment),o=E(),v(l.$$.fragment)},m(u,c){b(e,u,c),S(u,n,c),b(t,u,c),S(u,r,c),b(s,u,c),S(u,o,c),b(l,u,c),a=!0},p:D,i(u){a||(m(e.$$.fragment,u),m(t.$$.fragment,u),m(s.$$.fragment,u),m(l.$$.fragment,u),a=!0)},o(u){_(e.$$.fragment,u),_(t.$$.fragment,u),_(s.$$.fragment,u),_(l.$$.fragment,u),a=!1},d(u){u&&(C(n),C(r),C(o)),w(e,u),w(t,u),w(s,u),w(l,u)}}}function fc(i){let e,n;return e=new J({props:{label:"Show",onClick:i[5]}}),{c(){v(e.$$.fragment)},m(t,r){b(e,t,r),n=!0},p:D,i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}function hc(i){let e,n,t,r;e=new J({props:{label:"Stop",onClick:i[10]}});let s=!i[3]&&Sr(i);return{c(){v(e.$$.fragment),n=E(),s&&s.c(),t=X()},m(o,l){b(e,o,l),S(o,n,l),s&&s.m(o,l),S(o,t,l),r=!0},p(o,l){o[3]?s&&(V(),_(s,1,1,()=>{s=null}),W()):s?(s.p(o,l),l&8&&m(s,1)):(s=Sr(o),s.c(),m(s,1),s.m(t.parentNode,t))},i(o){r||(m(e.$$.fragment,o),m(s),r=!0)},o(o){_(e.$$.fragment,o),_(s),r=!1},d(o){o&&(C(n),C(t)),w(e,o),s&&s.d(o)}}}function dc(i){let e,n,t,r,s,o,l,a,u;e=new oe({props:{header:"Lession"}}),t=new ac({props:{progress:i[1]}});const c=[uc,lc],h=[];function d(f,p){return f[3]?0:f[2]?1:-1}return~(s=d(i))&&(o=h[s]=c[s](i)),a=new Z({props:{$$slots:{default:[hc]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment),n=E(),v(t.$$.fragment),r=E(),o&&o.c(),l=E(),v(a.$$.fragment)},m(f,p){b(e,f,p),S(f,n,p),b(t,f,p),S(f,r,p),~s&&h[s].m(f,p),S(f,l,p),b(a,f,p),u=!0},p(f,p){const $={};p&2&&($.progress=f[1]),t.$set($);let k=s;s=d(f),s===k?~s&&h[s].p(f,p):(o&&(V(),_(h[k],1,1,()=>{h[k]=null}),W()),~s?(o=h[s],o?o.p(f,p):(o=h[s]=c[s](f),o.c()),m(o,1),o.m(l.parentNode,l)):o=null);const T={};p&8220&&(T.$$scope={dirty:p,ctx:f}),a.$set(T)},i(f){u||(m(e.$$.fragment,f),m(t.$$.fragment,f),m(o),m(a.$$.fragment,f),u=!0)},o(f){_(e.$$.fragment,f),_(t.$$.fragment,f),_(o),_(a.$$.fragment,f),u=!1},d(f){f&&(C(n),C(r),C(l)),w(e,f),w(t,f),~s&&h[s].d(f),w(a,f)}}}function pc(i){let e,n;return e=new ae({props:{$$slots:{default:[dc]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment)},m(t,r){b(e,t,r),n=!0},p(t,[r]){const s={};r&8223&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}function mc(i,e,n){let t,r=[0,0,0,0],s,o=!1,l=!1;const a=()=>{n(4,l=!0)},u=k=>{if(n(2,s.progress=k,s),s.progress<3?t.learning.push(s):t.learned.push(s),n(1,r=tr(t)),!qa(t)){n(3,o=!0);return}$()},c=()=>{u(s.progress+1)},h=()=>{u(0)},d=()=>{u(3)},f=()=>{u(s.progress)},p=()=>{H("/")},$=()=>{const k=t.learning.shift();k?(n(2,s=k),n(4,l=!1)):n(3,o=!0)};return me(()=>{const k=ts();if(!k){Q.setString("No lession found!");return}n(0,t=k),n(1,r=tr(t)),$()}),[t,r,s,o,l,a,c,h,d,f,p]}class _c extends N{constructor(e){super(),q(this,e,mc,pc,U,{})}}function Or(i,e,n){const t=i.slice();return t[8]=e[n],t}function gc(i){let e,n;return e=new J({props:{disabled:i[4],label:"Search"}}),{c(){v(e.$$.fragment)},m(t,r){b(e,t,r),n=!0},p(t,r){const s={};r&16&&(s.disabled=t[4]),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}function $c(i){let e,n,t,r,s,o,l,a;function u(f){i[6](f)}let c={id:"search",label:"Search Text"};i[0]!==void 0&&(c.value=i[0]),e=new Oe({props:c}),x.push(()=>ne(e,"value",u));function h(f){i[7](f)}let d={id:"where",label:"Where",options:[{label:"Question",value:"quest"},{label:"Answer",value:"answer"},{label:"Details",value:"details"}]};return i[2]!==void 0&&(d.value=i[2]),r=new an({props:d}),x.push(()=>ne(r,"value",h)),l=new Z({props:{$$slots:{default:[gc]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment),t=E(),v(r.$$.fragment),o=E(),v(l.$$.fragment)},m(f,p){b(e,f,p),S(f,t,p),b(r,f,p),S(f,o,p),b(l,f,p),a=!0},p(f,p){const $={};!n&&p&1&&(n=!0,$.value=f[0],te(()=>n=!1)),e.$set($);const k={};!s&&p&4&&(s=!0,k.value=f[2],te(()=>s=!1)),r.$set(k);const T={};p&2064&&(T.$$scope={dirty:p,ctx:f}),l.$set(T)},i(f){a||(m(e.$$.fragment,f),m(r.$$.fragment,f),m(l.$$.fragment,f),a=!0)},o(f){_(e.$$.fragment,f),_(r.$$.fragment,f),_(l.$$.fragment,f),a=!1},d(f){f&&(C(t),C(o)),w(e,f),w(r,f),w(l,f)}}}function bc(i){let e;return{c(){e=O("p"),e.textContent="Nothing found ..."},m(n,t){S(n,e,t)},p:D,i:D,o:D,d(n){n&&C(e)}}}function wc(i){let e,n,t,r=i[3].hasMore&&Ar(),s=le(i[3].questions),o=[];for(let a=0;a<s.length;a+=1)o[a]=Tr(Or(i,s,a));const l=a=>_(o[a],1,1,()=>{o[a]=null});return{c(){r&&r.c(),e=E();for(let a=0;a<o.length;a+=1)o[a].c();n=X()},m(a,u){r&&r.m(a,u),S(a,e,u);for(let c=0;c<o.length;c+=1)o[c]&&o[c].m(a,u);S(a,n,u),t=!0},p(a,u){if(a[3].hasMore?r||(r=Ar(),r.c(),r.m(e.parentNode,e)):r&&(r.d(1),r=null),u&8){s=le(a[3].questions);let c;for(c=0;c<s.length;c+=1){const h=Or(a,s,c);o[c]?(o[c].p(h,u),m(o[c],1)):(o[c]=Tr(h),o[c].c(),m(o[c],1),o[c].m(n.parentNode,n))}for(V(),c=s.length;c<o.length;c+=1)l(c);W()}},i(a){if(!t){for(let u=0;u<s.length;u+=1)m(o[u]);t=!0}},o(a){o=o.filter(Boolean);for(let u=0;u<o.length;u+=1)_(o[u]);t=!1},d(a){a&&(C(e),C(n)),r&&r.d(a),Be(o,a)}}}function Ar(i){let e;return{c(){e=O("div"),e.textContent="has more ...",y(e,"class","text-red-700")},m(n,t){S(n,e,t)},d(n){n&&C(e)}}}function Tr(i){let e,n;return e=new yn({props:{question:i[8]}}),{c(){v(e.$$.fragment)},m(t,r){b(e,t,r),n=!0},p(t,r){const s={};r&8&&(s.question=t[8]),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}function vc(i){let e,n,t,r,s,o,l,a;e=new oe({props:{header:"Search Questions"}}),t=new be({props:{onSubmit:i[5],$$slots:{default:[$c]},$$scope:{ctx:i}}});const u=[wc,bc],c=[];function h(d,f){return d[3]&&d[3].questions.length>0?0:d[1]!==""?1:-1}return~(o=h(i))&&(l=c[o]=u[o](i)),{c(){v(e.$$.fragment),n=E(),v(t.$$.fragment),r=E(),s=O("div"),l&&l.c(),y(s,"class","flex flex-col gap-16")},m(d,f){b(e,d,f),S(d,n,f),b(t,d,f),S(d,r,f),S(d,s,f),~o&&c[o].m(s,null),a=!0},p(d,f){const p={};f&2069&&(p.$$scope={dirty:f,ctx:d}),t.$set(p);let $=o;o=h(d),o===$?~o&&c[o].p(d,f):(l&&(V(),_(c[$],1,1,()=>{c[$]=null}),W()),~o?(l=c[o],l?l.p(d,f):(l=c[o]=u[o](d),l.c()),m(l,1),l.m(s,null)):l=null)},i(d){a||(m(e.$$.fragment,d),m(t.$$.fragment,d),m(l),a=!0)},o(d){_(e.$$.fragment,d),_(t.$$.fragment,d),_(l),a=!1},d(d){d&&(C(n),C(r),C(s)),w(e,d),w(t,d),~o&&c[o].d()}}}function kc(i){let e,n;return e=new ae({props:{$$slots:{default:[vc]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment)},m(t,r){b(e,t,r),n=!0},p(t,[r]){const s={};r&2079&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}function yc(i,e,n){let t,r="",s="",o="quest",l;const a=async()=>{n(3,l=await Cu(r,o)),n(1,s=r)};function u(h){r=h,n(0,r)}function c(h){o=h,n(2,o)}return i.$$.update=()=>{i.$$.dirty&3&&n(4,t=r.length<3||r===s)},[r,s,o,l,t,a,u,c]}class Cc extends N{constructor(e){super(),q(this,e,yc,kc,U,{})}}function Sc(i){let e;return{c(){e=O("p"),e.textContent="User is not logged in"},m(n,t){S(n,e,t)},p:D,d(n){n&&C(e)}}}function Ec(i){let e,n,t,r,s,o,l,a,u=i[0].id+"",c,h,d,f,p,$,k=i[0].email+"",T,A,j,P,I,R,M=i[0].created_at+"",K,re,we,ve,Ie,Re,ue=i[0].aud+"",_e,Cn,rt,qt,Sn,Nt,gt=JSON.stringify(i[0].user_metadata)+"",Bt,En,st,Mt,On,Ft,$t=JSON.stringify(i[0].app_metadata)+"",zt;return{c(){e=O("table"),n=O("thead"),n.innerHTML="<tr><th>Key</th> <th>Value</th></tr>",t=E(),r=O("tbody"),s=O("tr"),o=O("td"),o.textContent="Id",l=E(),a=O("td"),c=L(u),h=E(),d=O("tr"),f=O("td"),f.textContent="Email",p=E(),$=O("td"),T=L(k),A=E(),j=O("tr"),P=O("td"),P.textContent="Created",I=E(),R=O("td"),K=L(M),re=E(),we=O("tr"),ve=O("td"),ve.textContent="Aud",Ie=E(),Re=O("td"),_e=L(ue),Cn=E(),rt=O("tr"),qt=O("td"),qt.textContent="User Metadata",Sn=E(),Nt=O("td"),Bt=L(gt),En=E(),st=O("tr"),Mt=O("td"),Mt.textContent="App Metatata",On=E(),Ft=O("td"),zt=L($t),y(e,"class","bg-white shadow w-full")},m(ge,ke){S(ge,e,ke),g(e,n),g(e,t),g(e,r),g(r,s),g(s,o),g(s,l),g(s,a),g(a,c),g(r,h),g(r,d),g(d,f),g(d,p),g(d,$),g($,T),g(r,A),g(r,j),g(j,P),g(j,I),g(j,R),g(R,K),g(r,re),g(r,we),g(we,ve),g(we,Ie),g(we,Re),g(Re,_e),g(r,Cn),g(r,rt),g(rt,qt),g(rt,Sn),g(rt,Nt),g(Nt,Bt),g(r,En),g(r,st),g(st,Mt),g(st,On),g(st,Ft),g(Ft,zt)},p(ge,ke){ke&1&&u!==(u=ge[0].id+"")&&B(c,u),ke&1&&k!==(k=ge[0].email+"")&&B(T,k),ke&1&&M!==(M=ge[0].created_at+"")&&B(K,M),ke&1&&ue!==(ue=ge[0].aud+"")&&B(_e,ue),ke&1&&gt!==(gt=JSON.stringify(ge[0].user_metadata)+"")&&B(Bt,gt),ke&1&&$t!==($t=JSON.stringify(ge[0].app_metadata)+"")&&B(zt,$t)},d(ge){ge&&C(e)}}}function Oc(i){let e,n;return e=new J({props:{onClick:i[1],label:"Cancel"}}),{c(){v(e.$$.fragment)},m(t,r){b(e,t,r),n=!0},p:D,i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}function Ac(i){let e,n,t,r,s;e=new oe({props:{header:"User"}});function o(u,c){return u[0]?Ec:Sc}let l=o(i),a=l(i);return r=new Z({props:{$$slots:{default:[Oc]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment),n=E(),a.c(),t=E(),v(r.$$.fragment)},m(u,c){b(e,u,c),S(u,n,c),a.m(u,c),S(u,t,c),b(r,u,c),s=!0},p(u,c){l===(l=o(u))&&a?a.p(u,c):(a.d(1),a=l(u),a&&(a.c(),a.m(t.parentNode,t)));const h={};c&4&&(h.$$scope={dirty:c,ctx:u}),r.$set(h)},i(u){s||(m(e.$$.fragment,u),m(r.$$.fragment,u),s=!0)},o(u){_(e.$$.fragment,u),_(r.$$.fragment,u),s=!1},d(u){u&&(C(n),C(t)),w(e,u),a.d(u),w(r,u)}}}function Tc(i){let e,n;return e=new ae({props:{$$slots:{default:[Ac]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment)},m(t,r){b(e,t,r),n=!0},p(t,[r]){const s={};r&5&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}function jc(i,e,n){let t;return ln(i,yt,s=>n(0,t=s)),[t,()=>H("/")]}class Pc extends N{constructor(e){super(),q(this,e,jc,Tc,U,{})}}function Ic(i){let e,n;return e=new Cs({props:{routes:i[0]}}),{c(){v(e.$$.fragment)},m(t,r){b(e,t,r),n=!0},p:D,i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}function Rc(i){let e,n,t,r,s,o,l;return n=new Ns({}),r=new Ra({props:{$$slots:{default:[Ic]},$$scope:{ctx:i}}}),{c(){e=O("main"),v(n.$$.fragment),t=E(),v(r.$$.fragment),s=E(),o=O("footer"),o.textContent="by Volker Senkel 2024",y(o,"class","text-sm text-end my-4 pt-2 border-t"),y(e,"class","text-gray-600 max-w-screen-lg m-auto mt-4")},m(a,u){S(a,e,u),b(n,e,null),g(e,t),b(r,e,null),g(e,s),g(e,o),l=!0},p(a,[u]){const c={};u&2&&(c.$$scope={dirty:u,ctx:a}),r.$set(c)},i(a){l||(m(n.$$.fragment,a),m(r.$$.fragment,a),l=!0)},o(a){_(n.$$.fragment,a),_(r.$$.fragment,a),l=!1},d(a){a&&C(e),w(n),w(r)}}}function Lc(i){return[{"/":Ka,"/books/list":Sl,"/books/create":Ll,"/books/update/:id":Ml,"/chapters/list/:id":ou,"/chapters/create/:book_id":hu,"/chapters/update/:id":$u,"/questions/list/:id":Du,"/questions/create/:chapter_id":Qu,"/questions/update/:id":zu,"/lession/prepare/:id":sc,"/lession/process":_c,"/cache":sl,"/search":Cc,"/User":Pc,"*":al}]}class Dc extends N{constructor(e){super(),q(this,e,Lc,Rc,U,{})}}new Dc({target:document.getElementById("app")});
