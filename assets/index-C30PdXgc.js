var ls=Object.defineProperty;var us=(i,e,n)=>e in i?ls(i,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):i[e]=n;var zt=(i,e,n)=>(us(i,typeof e!="symbol"?e+"":e,n),n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))t(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&t(o)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function t(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}})();function L(){}function it(i,e){for(const n in e)i[n]=e[n];return i}function Dr(i){return i()}function Tn(){return Object.create(null)}function Ve(i){i.forEach(Dr)}function We(i){return typeof i=="function"}function D(i,e){return i!=i?e==e:i!==e||i&&typeof i=="object"||typeof i=="function"}function cs(i){return Object.keys(i).length===0}function qr(i,...e){if(i==null){for(const t of e)t(void 0);return L}const n=i.subscribe(...e);return n.unsubscribe?()=>n.unsubscribe():n}function an(i,e,n){i.$$.on_destroy.push(qr(e,n))}function Se(i,e,n,t){if(i){const r=Ur(i,e,n,t);return i[0](r)}}function Ur(i,e,n,t){return i[1]&&t?it(n.ctx.slice(),i[1](t(e))):n.ctx}function Ce(i,e,n,t){if(i[2]&&t){const r=i[2](t(n));if(e.dirty===void 0)return r;if(typeof r=="object"){const s=[],o=Math.max(e.dirty.length,r.length);for(let l=0;l<o;l+=1)s[l]=e.dirty[l]|r[l];return s}return e.dirty|r}return e.dirty}function Ee(i,e,n,t,r,s){if(r){const o=Ur(e,n,t,s);i.p(o,r)}}function Oe(i){if(i.ctx.length>32){const e=[],n=i.ctx.length/32;for(let t=0;t<n;t++)e[t]=-1;return e}return-1}function $(i,e){i.appendChild(e)}function y(i,e,n){i.insertBefore(e,n||null)}function k(i){i.parentNode&&i.parentNode.removeChild(i)}function Ae(i,e){for(let n=0;n<i.length;n+=1)i[n]&&i[n].d(e)}function O(i){return document.createElement(i)}function ee(i){return document.createElementNS("http://www.w3.org/2000/svg",i)}function R(i){return document.createTextNode(i)}function E(){return R(" ")}function X(){return R("")}function Qe(i,e,n,t){return i.addEventListener(e,n,t),()=>i.removeEventListener(e,n,t)}function fs(i){return function(e){return e.preventDefault(),i.call(this,e)}}function C(i,e,n){n==null?i.removeAttribute(e):i.getAttribute(e)!==n&&i.setAttribute(e,n)}function hs(i){return Array.from(i.childNodes)}function B(i,e){e=""+e,i.data!==e&&(i.data=e)}function Je(i,e){i.value=e??""}function jn(i,e,n){for(let t=0;t<i.options.length;t+=1){const r=i.options[t];if(r.__value===e){r.selected=!0;return}}(!n||e!==void 0)&&(i.selectedIndex=-1)}function ds(i){const e=i.querySelector(":checked");return e&&e.__value}function ps(i,e,{bubbles:n=!1,cancelable:t=!1}={}){return new CustomEvent(i,{detail:e,bubbles:n,cancelable:t})}function vt(i,e){return new i(e)}let ot;function nt(i){ot=i}function Ct(){if(!ot)throw new Error("Function called outside component initialization");return ot}function pe(i){Ct().$$.on_mount.push(i)}function ms(i){Ct().$$.after_update.push(i)}function _s(i){Ct().$$.on_destroy.push(i)}function gs(){const i=Ct();return(e,n,{cancelable:t=!1}={})=>{const r=i.$$.callbacks[e];if(r){const s=ps(e,n,{cancelable:t});return r.slice().forEach(o=>{o.call(i,s)}),!s.defaultPrevented}return!0}}function Pn(i,e){const n=i.$$.callbacks[e.type];n&&n.slice().forEach(t=>t.call(this,e))}const Me=[],x=[];let ze=[];const Xt=[],Nr=Promise.resolve();let Zt=!1;function Br(){Zt||(Zt=!0,Nr.then(Mr))}function ln(){return Br(),Nr}function kt(i){ze.push(i)}function te(i){Xt.push(i)}const Ht=new Set;let De=0;function Mr(){if(De!==0)return;const i=ot;do{try{for(;De<Me.length;){const e=Me[De];De++,nt(e),$s(e.$$)}}catch(e){throw Me.length=0,De=0,e}for(nt(null),Me.length=0,De=0;x.length;)x.pop()();for(let e=0;e<ze.length;e+=1){const n=ze[e];Ht.has(n)||(Ht.add(n),n())}ze.length=0}while(Me.length);for(;Xt.length;)Xt.pop()();Zt=!1,Ht.clear(),nt(i)}function $s(i){if(i.fragment!==null){i.update(),Ve(i.before_update);const e=i.dirty;i.dirty=[-1],i.fragment&&i.fragment.p(i.ctx,e),i.after_update.forEach(kt)}}function bs(i){const e=[],n=[];ze.forEach(t=>i.indexOf(t)===-1?e.push(t):n.push(t)),n.forEach(t=>t()),ze=e}const bt=new Set;let Re;function K(){Re={r:0,c:[],p:Re}}function G(){Re.r||Ve(Re.c),Re=Re.p}function m(i,e){i&&i.i&&(bt.delete(i),i.i(e))}function _(i,e,n,t){if(i&&i.o){if(bt.has(i))return;bt.add(i),Re.c.push(()=>{bt.delete(i),t&&(n&&i.d(1),t())}),i.o(e)}else t&&t()}function se(i){return(i==null?void 0:i.length)!==void 0?i:Array.from(i)}function yt(i,e){const n={},t={},r={$$scope:1};let s=i.length;for(;s--;){const o=i[s],l=e[s];if(l){for(const a in o)a in l||(t[a]=1);for(const a in l)r[a]||(n[a]=l[a],r[a]=1);i[s]=l}else for(const a in o)r[a]=1}for(const o in t)o in n||(n[o]=void 0);return n}function St(i){return typeof i=="object"&&i!==null?i:{}}function ne(i,e,n){const t=i.$$.props[e];t!==void 0&&(i.$$.bound[t]=n,n(i.$$.ctx[t]))}function v(i){i&&i.c()}function b(i,e,n){const{fragment:t,after_update:r}=i.$$;t&&t.m(e,n),kt(()=>{const s=i.$$.on_mount.map(Dr).filter(We);i.$$.on_destroy?i.$$.on_destroy.push(...s):Ve(s),i.$$.on_mount=[]}),r.forEach(kt)}function w(i,e){const n=i.$$;n.fragment!==null&&(bs(n.after_update),Ve(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function ws(i,e){i.$$.dirty[0]===-1&&(Me.push(i),Br(),i.$$.dirty.fill(0)),i.$$.dirty[e/31|0]|=1<<e%31}function U(i,e,n,t,r,s,o=null,l=[-1]){const a=ot;nt(i);const u=i.$$={fragment:null,ctx:[],props:s,update:L,not_equal:r,bound:Tn(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(a?a.$$.context:[])),callbacks:Tn(),dirty:l,skip_bound:!1,root:e.target||a.$$.root};o&&o(u.root);let c=!1;if(u.ctx=n?n(i,e.props||{},(h,p,...f)=>{const d=f.length?f[0]:p;return u.ctx&&r(u.ctx[h],u.ctx[h]=d)&&(!u.skip_bound&&u.bound[h]&&u.bound[h](d),c&&ws(i,h)),p}):[],u.update(),c=!0,Ve(u.before_update),u.fragment=t?t(u.ctx):!1,e.target){if(e.hydrate){const h=hs(e.target);u.fragment&&u.fragment.l(h),h.forEach(k)}else u.fragment&&u.fragment.c();e.intro&&m(i.$$.fragment),b(i,e.target,e.anchor),Mr()}nt(a)}class N{constructor(){zt(this,"$$");zt(this,"$$set")}$destroy(){w(this,1),this.$destroy=L}$on(e,n){if(!We(n))return L;const t=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return t.push(n),()=>{const r=t.indexOf(n);r!==-1&&t.splice(r,1)}}$set(e){this.$$set&&!cs(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const vs="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(vs);const qe=[];function Fr(i,e){return{subscribe:Et(i,e).subscribe}}function Et(i,e=L){let n;const t=new Set;function r(l){if(D(i,l)&&(i=l,n)){const a=!qe.length;for(const u of t)u[1](),qe.push(u,i);if(a){for(let u=0;u<qe.length;u+=2)qe[u][0](qe[u+1]);qe.length=0}}}function s(l){r(l(i))}function o(l,a=L){const u=[l,a];return t.add(u),t.size===1&&(n=e(r,s)||L),l(i),()=>{t.delete(u),t.size===0&&n&&(n(),n=null)}}return{set:r,update:s,subscribe:o}}function zr(i,e,n){const t=!Array.isArray(i),r=t?[i]:i;if(!r.every(Boolean))throw new Error("derived() expects stores as input, got a falsy value");const s=e.length<2;return Fr(n,(o,l)=>{let a=!1;const u=[];let c=0,h=L;const p=()=>{if(c)return;h();const d=e(t?u[0]:u,o,l);s?o(d):h=We(d)?d:L},f=r.map((d,g)=>qr(d,S=>{u[g]=S,c&=~(1<<g),a&&p()},()=>{c|=1<<g}));return a=!0,p(),function(){Ve(f),h(),a=!1}})}function ks(i,e){if(i instanceof RegExp)return{keys:!1,pattern:i};var n,t,r,s,o=[],l="",a=i.split("/");for(a[0]||a.shift();r=a.shift();)n=r[0],n==="*"?(o.push("wild"),l+="/(.*)"):n===":"?(t=r.indexOf("?",1),s=r.indexOf(".",1),o.push(r.substring(1,~t?t:~s?s:r.length)),l+=~t&&!~s?"(?:/([^/]+?))?":"/([^/]+?)",~s&&(l+=(~t?"?":"")+"\\"+r.substring(s))):l+="/"+r;return{keys:o,pattern:new RegExp("^"+l+"/?$","i")}}function ys(i){let e,n,t;const r=[i[2]];var s=i[0];function o(l,a){let u={};for(let c=0;c<r.length;c+=1)u=it(u,r[c]);return a!==void 0&&a&4&&(u=it(u,yt(r,[St(l[2])]))),{props:u}}return s&&(e=vt(s,o(i)),e.$on("routeEvent",i[7])),{c(){e&&v(e.$$.fragment),n=X()},m(l,a){e&&b(e,l,a),y(l,n,a),t=!0},p(l,a){if(a&1&&s!==(s=l[0])){if(e){K();const u=e;_(u.$$.fragment,1,0,()=>{w(u,1)}),G()}s?(e=vt(s,o(l,a)),e.$on("routeEvent",l[7]),v(e.$$.fragment),m(e.$$.fragment,1),b(e,n.parentNode,n)):e=null}else if(s){const u=a&4?yt(r,[St(l[2])]):{};e.$set(u)}},i(l){t||(e&&m(e.$$.fragment,l),t=!0)},o(l){e&&_(e.$$.fragment,l),t=!1},d(l){l&&k(n),e&&w(e,l)}}}function Ss(i){let e,n,t;const r=[{params:i[1]},i[2]];var s=i[0];function o(l,a){let u={};for(let c=0;c<r.length;c+=1)u=it(u,r[c]);return a!==void 0&&a&6&&(u=it(u,yt(r,[a&2&&{params:l[1]},a&4&&St(l[2])]))),{props:u}}return s&&(e=vt(s,o(i)),e.$on("routeEvent",i[6])),{c(){e&&v(e.$$.fragment),n=X()},m(l,a){e&&b(e,l,a),y(l,n,a),t=!0},p(l,a){if(a&1&&s!==(s=l[0])){if(e){K();const u=e;_(u.$$.fragment,1,0,()=>{w(u,1)}),G()}s?(e=vt(s,o(l,a)),e.$on("routeEvent",l[6]),v(e.$$.fragment),m(e.$$.fragment,1),b(e,n.parentNode,n)):e=null}else if(s){const u=a&6?yt(r,[a&2&&{params:l[1]},a&4&&St(l[2])]):{};e.$set(u)}},i(l){t||(e&&m(e.$$.fragment,l),t=!0)},o(l){e&&_(e.$$.fragment,l),t=!1},d(l){l&&k(n),e&&w(e,l)}}}function Cs(i){let e,n,t,r;const s=[Ss,ys],o=[];function l(a,u){return a[1]?0:1}return e=l(i),n=o[e]=s[e](i),{c(){n.c(),t=X()},m(a,u){o[e].m(a,u),y(a,t,u),r=!0},p(a,[u]){let c=e;e=l(a),e===c?o[e].p(a,u):(K(),_(o[c],1,1,()=>{o[c]=null}),G(),n=o[e],n?n.p(a,u):(n=o[e]=s[e](a),n.c()),m(n,1),n.m(t.parentNode,t))},i(a){r||(m(n),r=!0)},o(a){_(n),r=!1},d(a){a&&k(t),o[e].d(a)}}}function In(){const i=window.location.href.indexOf("#/");let e=i>-1?window.location.href.substr(i+1):"/";const n=e.indexOf("?");let t="";return n>-1&&(t=e.substr(n+1),e=e.substr(0,n)),{location:e,querystring:t}}const un=Fr(null,function(e){e(In());const n=()=>{e(In())};return window.addEventListener("hashchange",n,!1),function(){window.removeEventListener("hashchange",n,!1)}});zr(un,i=>i.location);zr(un,i=>i.querystring);const Rn=Et(void 0);async function H(i){if(!i||i.length<1||i.charAt(0)!="/"&&i.indexOf("#/")!==0)throw Error("Invalid parameter location");await ln(),history.replaceState({...history.state,__svelte_spa_router_scrollX:window.scrollX,__svelte_spa_router_scrollY:window.scrollY},void 0),window.location.hash=(i.charAt(0)=="#"?"":"#")+i}async function Ln(){await ln(),window.history.back()}function Es(i){i?window.scrollTo(i.__svelte_spa_router_scrollX,i.__svelte_spa_router_scrollY):window.scrollTo(0,0)}function Os(i,e,n){let{routes:t={}}=e,{prefix:r=""}=e,{restoreScrollState:s=!1}=e;class o{constructor(I,q){if(!q||typeof q!="function"&&(typeof q!="object"||q._sveltesparouter!==!0))throw Error("Invalid component object");if(!I||typeof I=="string"&&(I.length<1||I.charAt(0)!="/"&&I.charAt(0)!="*")||typeof I=="object"&&!(I instanceof RegExp))throw Error('Invalid value for "path" argument - strings must start with / or *');const{pattern:J,keys:Q}=ks(I);this.path=I,typeof q=="object"&&q._sveltesparouter===!0?(this.component=q.component,this.conditions=q.conditions||[],this.userData=q.userData,this.props=q.props||{}):(this.component=()=>Promise.resolve(q),this.conditions=[],this.props={}),this._pattern=J,this._keys=Q}match(I){if(r){if(typeof r=="string")if(I.startsWith(r))I=I.substr(r.length)||"/";else return null;else if(r instanceof RegExp){const fe=I.match(r);if(fe&&fe[0])I=I.substr(fe[0].length)||"/";else return null}}const q=this._pattern.exec(I);if(q===null)return null;if(this._keys===!1)return q;const J={};let Q=0;for(;Q<this._keys.length;){try{J[this._keys[Q]]=decodeURIComponent(q[Q+1]||"")||null}catch{J[this._keys[Q]]=null}Q++}return J}async checkConditions(I){for(let q=0;q<this.conditions.length;q++)if(!await this.conditions[q](I))return!1;return!0}}const l=[];t instanceof Map?t.forEach((P,I)=>{l.push(new o(I,P))}):Object.keys(t).forEach(P=>{l.push(new o(P,t[P]))});let a=null,u=null,c={};const h=gs();async function p(P,I){await ln(),h(P,I)}let f=null,d=null;s&&(d=P=>{P.state&&(P.state.__svelte_spa_router_scrollY||P.state.__svelte_spa_router_scrollX)?f=P.state:f=null},window.addEventListener("popstate",d),ms(()=>{Es(f)}));let g=null,S=null;const T=un.subscribe(async P=>{g=P;let I=0;for(;I<l.length;){const q=l[I].match(P.location);if(!q){I++;continue}const J={route:l[I].path,location:P.location,querystring:P.querystring,userData:l[I].userData,params:q&&typeof q=="object"&&Object.keys(q).length?q:null};if(!await l[I].checkConditions(J)){n(0,a=null),S=null,p("conditionsFailed",J);return}p("routeLoading",Object.assign({},J));const Q=l[I].component;if(S!=Q){Q.loading?(n(0,a=Q.loading),S=Q,n(1,u=Q.loadingParams),n(2,c={}),p("routeLoaded",Object.assign({},J,{component:a,name:a.name,params:u}))):(n(0,a=null),S=null);const fe=await Q();if(P!=g)return;n(0,a=fe&&fe.default||fe),S=Q}q&&typeof q=="object"&&Object.keys(q).length?n(1,u=q):n(1,u=null),n(2,c=l[I].props),p("routeLoaded",Object.assign({},J,{component:a,name:a.name,params:u})).then(()=>{Rn.set(u)});return}n(0,a=null),S=null,Rn.set(void 0)});_s(()=>{T(),d&&window.removeEventListener("popstate",d)});function A(P){Pn.call(this,i,P)}function j(P){Pn.call(this,i,P)}return i.$$set=P=>{"routes"in P&&n(3,t=P.routes),"prefix"in P&&n(4,r=P.prefix),"restoreScrollState"in P&&n(5,s=P.restoreScrollState)},i.$$.update=()=>{i.$$.dirty&32&&(history.scrollRestoration=s?"manual":"auto")},[a,u,c,t,r,s,A,j]}class As extends N{constructor(e){super(),U(this,e,Os,Cs,D,{routes:3,prefix:4,restoreScrollState:5})}}function Ts(){const{subscribe:i,set:e,update:n}=Et(null);return{subscribe:i,setDBError:t=>e({msg:t.message,details:t.details}),setAuthError:t=>{e({msg:t.message})},setString:(t,r)=>e({msg:t,details:r}),reset:()=>e(null)}}const W=Ts();function js(i){let e,n,t,r;return{c(){e=O("button"),n=R(i[0]),C(e,"class","btn"),e.disabled=i[2],C(e,"type","button")},m(s,o){y(s,e,o),$(e,n),t||(r=Qe(e,"click",function(){We(i[1])&&i[1].apply(this,arguments)}),t=!0)},p(s,o){i=s,o&1&&B(n,i[0]),o&4&&(e.disabled=i[2])},d(s){s&&k(e),t=!1,r()}}}function Ps(i){let e,n;return{c(){e=O("button"),n=R(i[0]),C(e,"class","btn"),e.disabled=i[2],C(e,"type","submit")},m(t,r){y(t,e,r),$(e,n)},p(t,r){r&1&&B(n,t[0]),r&4&&(e.disabled=t[2])},d(t){t&&k(e)}}}function Is(i){let e;function n(s,o){return s[1]==null?Ps:js}let t=n(i),r=t(i);return{c(){r.c(),e=X()},m(s,o){r.m(s,o),y(s,e,o)},p(s,[o]){t===(t=n(s))&&r?r.p(s,o):(r.d(1),r=t(s),r&&(r.c(),r.m(e.parentNode,e)))},i:L,o:L,d(s){s&&k(e),r.d(s)}}}function Rs(i,e,n){let{label:t}=e,{onClick:r=null}=e,{disabled:s=!1}=e;return i.$$set=o=>{"label"in o&&n(0,t=o.label),"onClick"in o&&n(1,r=o.onClick),"disabled"in o&&n(2,s=o.disabled)},[t,r,s]}class z extends N{constructor(e){super(),U(this,e,Rs,Is,D,{label:0,onClick:1,disabled:2})}}function Ls(i){let e,n;const t=i[1].default,r=Se(t,i,i[0],null);return{c(){e=O("div"),r&&r.c(),C(e,"class","flex gap-4")},m(s,o){y(s,e,o),r&&r.m(e,null),n=!0},p(s,[o]){r&&r.p&&(!n||o&1)&&Ee(r,t,s,s[0],n?Ce(t,s[0],o,null):Oe(s[0]),null)},i(s){n||(m(r,s),n=!0)},o(s){_(r,s),n=!1},d(s){s&&k(e),r&&r.d(s)}}}function Ds(i,e,n){let{$$slots:t={},$$scope:r}=e;return i.$$set=s=>{"$$scope"in s&&n(0,r=s.$$scope)},[r,t]}class Z extends N{constructor(e){super(),U(this,e,Ds,Ls,D,{})}}function Dn(i,e,n){const t=i.slice();return t[5]=e[n],t}function qn(i){let e,n;return e=new z({props:{label:i[5].label,onClick:i[5].onclick}}),{c(){v(e.$$.fragment)},m(t,r){b(e,t,r),n=!0},p(t,r){const s={};r&2&&(s.label=t[5].label),r&2&&(s.onClick=t[5].onclick),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}function qs(i){let e,n,t=se(i[1]),r=[];for(let o=0;o<t.length;o+=1)r[o]=qn(Dn(i,t,o));const s=o=>_(r[o],1,1,()=>{r[o]=null});return{c(){for(let o=0;o<r.length;o+=1)r[o].c();e=X()},m(o,l){for(let a=0;a<r.length;a+=1)r[a]&&r[a].m(o,l);y(o,e,l),n=!0},p(o,l){if(l&2){t=se(o[1]);let a;for(a=0;a<t.length;a+=1){const u=Dn(o,t,a);r[a]?(r[a].p(u,l),m(r[a],1)):(r[a]=qn(u),r[a].c(),m(r[a],1),r[a].m(e.parentNode,e))}for(K(),a=t.length;a<r.length;a+=1)s(a);G()}},i(o){if(!n){for(let l=0;l<t.length;l+=1)m(r[l]);n=!0}},o(o){r=r.filter(Boolean);for(let l=0;l<r.length;l+=1)_(r[l]);n=!1},d(o){o&&k(e),Ae(r,o)}}}function Us(i){let e,n,t,r,s,o,l,a,u,c,h;const p=i[3].default,f=Se(p,i,i[4],null);return c=new Z({props:{$$slots:{default:[qs]},$$scope:{ctx:i}}}),{c(){e=O("div"),n=O("div"),t=O("div"),r=R(i[0]),o=E(),l=O("div"),f&&f.c(),a=E(),u=O("div"),v(c.$$.fragment),C(t,"class",s="text-lg pb-2 border-b "+(i[2]==="error"?"text-red-900":"")),C(l,"class","my-6"),C(n,"class","relative top-1/3 mx-auto max-w-md bg-white rounded shadow p-6"),C(e,"class","fixed z-50 inset-0 bg-black bg-opacity-50 overflow-y-auto h-full w-full")},m(d,g){y(d,e,g),$(e,n),$(n,t),$(t,r),$(n,o),$(n,l),f&&f.m(l,null),$(n,a),$(n,u),b(c,u,null),h=!0},p(d,[g]){(!h||g&1)&&B(r,d[0]),(!h||g&4&&s!==(s="text-lg pb-2 border-b "+(d[2]==="error"?"text-red-900":"")))&&C(t,"class",s),f&&f.p&&(!h||g&16)&&Ee(f,p,d,d[4],h?Ce(p,d[4],g,null):Oe(d[4]),null);const S={};g&18&&(S.$$scope={dirty:g,ctx:d}),c.$set(S)},i(d){h||(m(f,d),m(c.$$.fragment,d),h=!0)},o(d){_(f,d),_(c.$$.fragment,d),h=!1},d(d){d&&k(e),f&&f.d(d),w(c)}}}function Ns(i,e,n){let{$$slots:t={},$$scope:r}=e,{title:s}=e,{buttons:o}=e,{type:l="ok"}=e;return i.$$set=a=>{"title"in a&&n(0,s=a.title),"buttons"in a&&n(1,o=a.buttons),"type"in a&&n(2,l=a.type),"$$scope"in a&&n(4,r=a.$$scope)},[s,o,l,t,r]}class Hr extends N{constructor(e){super(),U(this,e,Ns,Us,D,{title:0,buttons:1,type:2})}}function Un(i){let e,n;return e=new Hr({props:{title:"Errors",buttons:i[1],type:"error",$$slots:{default:[Bs]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment)},m(t,r){b(e,t,r),n=!0},p(t,r){const s={};r&5&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}function Nn(i){let e,n=i[0].details+"",t;return{c(){e=O("p"),t=R(n),C(e,"class","text-sm pt-3")},m(r,s){y(r,e,s),$(e,t)},p(r,s){s&1&&n!==(n=r[0].details+"")&&B(t,n)},d(r){r&&k(e)}}}function Bs(i){let e=i[0].msg+"",n,t,r,s=i[0].details&&Nn(i);return{c(){n=R(e),t=E(),s&&s.c(),r=X()},m(o,l){y(o,n,l),y(o,t,l),s&&s.m(o,l),y(o,r,l)},p(o,l){l&1&&e!==(e=o[0].msg+"")&&B(n,e),o[0].details?s?s.p(o,l):(s=Nn(o),s.c(),s.m(r.parentNode,r)):s&&(s.d(1),s=null)},d(o){o&&(k(n),k(t),k(r)),s&&s.d(o)}}}function Ms(i){let e,n,t=i[0]!==null&&Un(i);return{c(){t&&t.c(),e=X()},m(r,s){t&&t.m(r,s),y(r,e,s),n=!0},p(r,[s]){r[0]!==null?t?(t.p(r,s),s&1&&m(t,1)):(t=Un(r),t.c(),m(t,1),t.m(e.parentNode,e)):t&&(K(),_(t,1,1,()=>{t=null}),G())},i(r){n||(m(t),n=!0)},o(r){_(t),n=!1},d(r){r&&k(e),t&&t.d(r)}}}function Fs(i,e,n){let t;return an(i,W,s=>n(0,t=s)),[t,[{label:"OK",onclick:()=>{W.reset()}}]]}class zs extends N{constructor(e){super(),U(this,e,Fs,Ms,D,{})}}const Hs="modulepreload",Js=function(i,e){return new URL(i,e).href},Bn={},Ke=function(e,n,t){let r=Promise.resolve();if(n&&n.length>0){const s=document.getElementsByTagName("link"),o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));r=Promise.all(n.map(a=>{if(a=Js(a,t),a in Bn)return;Bn[a]=!0;const u=a.endsWith(".css"),c=u?'[rel="stylesheet"]':"";if(!!t)for(let f=s.length-1;f>=0;f--){const d=s[f];if(d.href===a&&(!u||d.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${a}"]${c}`))return;const p=document.createElement("link");if(p.rel=u?"stylesheet":Hs,u||(p.as="script",p.crossOrigin=""),p.href=a,l&&p.setAttribute("nonce",l),document.head.appendChild(p),u)return new Promise((f,d)=>{p.addEventListener("load",f),p.addEventListener("error",()=>d(new Error(`Unable to preload CSS for ${a}`)))})}))}return r.then(()=>e()).catch(s=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=s,window.dispatchEvent(o),!o.defaultPrevented)throw s})},Ks=i=>{let e;return i?e=i:typeof fetch>"u"?e=(...n)=>Ke(()=>Promise.resolve().then(()=>ct),void 0,import.meta.url).then(({default:t})=>t(...n)):e=fetch,(...n)=>e(...n)};class cn extends Error{constructor(e,n="FunctionsError",t){super(e),this.name=n,this.context=t}}class Gs extends cn{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Vs extends cn{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Ws extends cn{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var xt;(function(i){i.Any="any",i.ApNortheast1="ap-northeast-1",i.ApNortheast2="ap-northeast-2",i.ApSouth1="ap-south-1",i.ApSoutheast1="ap-southeast-1",i.ApSoutheast2="ap-southeast-2",i.CaCentral1="ca-central-1",i.EuCentral1="eu-central-1",i.EuWest1="eu-west-1",i.EuWest2="eu-west-2",i.EuWest3="eu-west-3",i.SaEast1="sa-east-1",i.UsEast1="us-east-1",i.UsWest1="us-west-1",i.UsWest2="us-west-2"})(xt||(xt={}));var Qs=function(i,e,n,t){function r(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function l(c){try{u(t.next(c))}catch(h){o(h)}}function a(c){try{u(t.throw(c))}catch(h){o(h)}}function u(c){c.done?s(c.value):r(c.value).then(l,a)}u((t=t.apply(i,e||[])).next())})};class Ys{constructor(e,{headers:n={},customFetch:t,region:r=xt.Any}={}){this.url=e,this.headers=n,this.region=r,this.fetch=Ks(t)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,n={}){var t;return Qs(this,void 0,void 0,function*(){try{const{headers:r,method:s,body:o}=n;let l={},{region:a}=n;a||(a=this.region),a&&a!=="any"&&(l["x-region"]=a);let u;o&&(r&&!Object.prototype.hasOwnProperty.call(r,"Content-Type")||!r)&&(typeof Blob<"u"&&o instanceof Blob||o instanceof ArrayBuffer?(l["Content-Type"]="application/octet-stream",u=o):typeof o=="string"?(l["Content-Type"]="text/plain",u=o):typeof FormData<"u"&&o instanceof FormData?u=o:(l["Content-Type"]="application/json",u=JSON.stringify(o)));const c=yield this.fetch(`${this.url}/${e}`,{method:s||"POST",headers:Object.assign(Object.assign(Object.assign({},l),this.headers),r),body:u}).catch(d=>{throw new Gs(d)}),h=c.headers.get("x-relay-error");if(h&&h==="true")throw new Vs(c);if(!c.ok)throw new Ws(c);let p=((t=c.headers.get("Content-Type"))!==null&&t!==void 0?t:"text/plain").split(";")[0].trim(),f;return p==="application/json"?f=yield c.json():p==="application/octet-stream"?f=yield c.blob():p==="text/event-stream"?f=c:p==="multipart/form-data"?f=yield c.formData():f=yield c.text(),{data:f,error:null}}catch(r){return{data:null,error:r}}})}}var Xs=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Ge=Xs();const Zs=Ge.fetch,fn=Ge.fetch.bind(Ge),Jr=Ge.Headers,xs=Ge.Request,ei=Ge.Response,ct=Object.freeze(Object.defineProperty({__proto__:null,Headers:Jr,Request:xs,Response:ei,default:fn,fetch:Zs},Symbol.toStringTag,{value:"Module"}));class ti extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}}class ni{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=fn:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}then(e,n){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const t=this.fetch;let r=t(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async s=>{var o,l,a;let u=null,c=null,h=null,p=s.status,f=s.statusText;if(s.ok){if(this.method!=="HEAD"){const T=await s.text();T===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?c=T:c=JSON.parse(T))}const g=(o=this.headers.Prefer)===null||o===void 0?void 0:o.match(/count=(exact|planned|estimated)/),S=(l=s.headers.get("content-range"))===null||l===void 0?void 0:l.split("/");g&&S&&S.length>1&&(h=parseInt(S[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(c)&&(c.length>1?(u={code:"PGRST116",details:`Results contain ${c.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},c=null,h=null,p=406,f="Not Acceptable"):c.length===1?c=c[0]:c=null)}else{const g=await s.text();try{u=JSON.parse(g),Array.isArray(u)&&s.status===404&&(c=[],u=null,p=200,f="OK")}catch{s.status===404&&g===""?(p=204,f="No Content"):u={message:g}}if(u&&this.isMaybeSingle&&(!((a=u==null?void 0:u.details)===null||a===void 0)&&a.includes("0 rows"))&&(u=null,p=200,f="OK"),u&&this.shouldThrowOnError)throw new ti(u)}return{error:u,data:c,count:h,status:p,statusText:f}});return this.shouldThrowOnError||(r=r.catch(s=>{var o,l,a;return{error:{message:`${(o=s==null?void 0:s.name)!==null&&o!==void 0?o:"FetchError"}: ${s==null?void 0:s.message}`,details:`${(l=s==null?void 0:s.stack)!==null&&l!==void 0?l:""}`,hint:"",code:`${(a=s==null?void 0:s.code)!==null&&a!==void 0?a:""}`},data:null,count:null,status:0,statusText:""}})),r.then(e,n)}}class ri extends ni{select(e){let n=!1;const t=(e??"*").split("").map(r=>/\s/.test(r)&&!n?"":(r==='"'&&(n=!n),r)).join("");return this.url.searchParams.set("select",t),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e,{ascending:n=!0,nullsFirst:t,foreignTable:r,referencedTable:s=r}={}){const o=s?`${s}.order`:"order",l=this.url.searchParams.get(o);return this.url.searchParams.set(o,`${l?`${l},`:""}${e}.${n?"asc":"desc"}${t===void 0?"":t?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:n,referencedTable:t=n}={}){const r=typeof t>"u"?"limit":`${t}.limit`;return this.url.searchParams.set(r,`${e}`),this}range(e,n,{foreignTable:t,referencedTable:r=t}={}){const s=typeof r>"u"?"offset":`${r}.offset`,o=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(s,`${e}`),this.url.searchParams.set(o,`${n-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:e=!1,verbose:n=!1,settings:t=!1,buffers:r=!1,wal:s=!1,format:o="text"}={}){var l;const a=[e?"analyze":null,n?"verbose":null,t?"settings":null,r?"buffers":null,s?"wal":null].filter(Boolean).join("|"),u=(l=this.headers.Accept)!==null&&l!==void 0?l:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${o}; for="${u}"; options=${a};`,o==="json"?this:this}rollback(){var e;return((e=this.headers.Prefer)!==null&&e!==void 0?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}class Fe extends ri{eq(e,n){return this.url.searchParams.append(e,`eq.${n}`),this}neq(e,n){return this.url.searchParams.append(e,`neq.${n}`),this}gt(e,n){return this.url.searchParams.append(e,`gt.${n}`),this}gte(e,n){return this.url.searchParams.append(e,`gte.${n}`),this}lt(e,n){return this.url.searchParams.append(e,`lt.${n}`),this}lte(e,n){return this.url.searchParams.append(e,`lte.${n}`),this}like(e,n){return this.url.searchParams.append(e,`like.${n}`),this}likeAllOf(e,n){return this.url.searchParams.append(e,`like(all).{${n.join(",")}}`),this}likeAnyOf(e,n){return this.url.searchParams.append(e,`like(any).{${n.join(",")}}`),this}ilike(e,n){return this.url.searchParams.append(e,`ilike.${n}`),this}ilikeAllOf(e,n){return this.url.searchParams.append(e,`ilike(all).{${n.join(",")}}`),this}ilikeAnyOf(e,n){return this.url.searchParams.append(e,`ilike(any).{${n.join(",")}}`),this}is(e,n){return this.url.searchParams.append(e,`is.${n}`),this}in(e,n){const t=Array.from(new Set(n)).map(r=>typeof r=="string"&&new RegExp("[,()]").test(r)?`"${r}"`:`${r}`).join(",");return this.url.searchParams.append(e,`in.(${t})`),this}contains(e,n){return typeof n=="string"?this.url.searchParams.append(e,`cs.${n}`):Array.isArray(n)?this.url.searchParams.append(e,`cs.{${n.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(n)}`),this}containedBy(e,n){return typeof n=="string"?this.url.searchParams.append(e,`cd.${n}`):Array.isArray(n)?this.url.searchParams.append(e,`cd.{${n.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(n)}`),this}rangeGt(e,n){return this.url.searchParams.append(e,`sr.${n}`),this}rangeGte(e,n){return this.url.searchParams.append(e,`nxl.${n}`),this}rangeLt(e,n){return this.url.searchParams.append(e,`sl.${n}`),this}rangeLte(e,n){return this.url.searchParams.append(e,`nxr.${n}`),this}rangeAdjacent(e,n){return this.url.searchParams.append(e,`adj.${n}`),this}overlaps(e,n){return typeof n=="string"?this.url.searchParams.append(e,`ov.${n}`):this.url.searchParams.append(e,`ov.{${n.join(",")}}`),this}textSearch(e,n,{config:t,type:r}={}){let s="";r==="plain"?s="pl":r==="phrase"?s="ph":r==="websearch"&&(s="w");const o=t===void 0?"":`(${t})`;return this.url.searchParams.append(e,`${s}fts${o}.${n}`),this}match(e){return Object.entries(e).forEach(([n,t])=>{this.url.searchParams.append(n,`eq.${t}`)}),this}not(e,n,t){return this.url.searchParams.append(e,`not.${n}.${t}`),this}or(e,{foreignTable:n,referencedTable:t=n}={}){const r=t?`${t}.or`:"or";return this.url.searchParams.append(r,`(${e})`),this}filter(e,n,t){return this.url.searchParams.append(e,`${n}.${t}`),this}}class si{constructor(e,{headers:n={},schema:t,fetch:r}){this.url=e,this.headers=n,this.schema=t,this.fetch=r}select(e,{head:n=!1,count:t}={}){const r=n?"HEAD":"GET";let s=!1;const o=(e??"*").split("").map(l=>/\s/.test(l)&&!s?"":(l==='"'&&(s=!s),l)).join("");return this.url.searchParams.set("select",o),t&&(this.headers.Prefer=`count=${t}`),new Fe({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e,{count:n,defaultToNull:t=!0}={}){const r="POST",s=[];if(this.headers.Prefer&&s.push(this.headers.Prefer),n&&s.push(`count=${n}`),t||s.push("missing=default"),this.headers.Prefer=s.join(","),Array.isArray(e)){const o=e.reduce((l,a)=>l.concat(Object.keys(a)),[]);if(o.length>0){const l=[...new Set(o)].map(a=>`"${a}"`);this.url.searchParams.set("columns",l.join(","))}}return new Fe({method:r,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e,{onConflict:n,ignoreDuplicates:t=!1,count:r,defaultToNull:s=!0}={}){const o="POST",l=[`resolution=${t?"ignore":"merge"}-duplicates`];if(n!==void 0&&this.url.searchParams.set("on_conflict",n),this.headers.Prefer&&l.push(this.headers.Prefer),r&&l.push(`count=${r}`),s||l.push("missing=default"),this.headers.Prefer=l.join(","),Array.isArray(e)){const a=e.reduce((u,c)=>u.concat(Object.keys(c)),[]);if(a.length>0){const u=[...new Set(a)].map(c=>`"${c}"`);this.url.searchParams.set("columns",u.join(","))}}return new Fe({method:o,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e,{count:n}={}){const t="PATCH",r=[];return this.headers.Prefer&&r.push(this.headers.Prefer),n&&r.push(`count=${n}`),this.headers.Prefer=r.join(","),new Fe({method:t,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete({count:e}={}){const n="DELETE",t=[];return e&&t.push(`count=${e}`),this.headers.Prefer&&t.unshift(this.headers.Prefer),this.headers.Prefer=t.join(","),new Fe({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}const ii="1.15.2",oi={"X-Client-Info":`postgrest-js/${ii}`};class hn{constructor(e,{headers:n={},schema:t,fetch:r}={}){this.url=e,this.headers=Object.assign(Object.assign({},oi),n),this.schemaName=t,this.fetch=r}from(e){const n=new URL(`${this.url}/${e}`);return new si(n,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new hn(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,n={},{head:t=!1,get:r=!1,count:s}={}){let o;const l=new URL(`${this.url}/rpc/${e}`);let a;t||r?(o=t?"HEAD":"GET",Object.entries(n).filter(([c,h])=>h!==void 0).map(([c,h])=>[c,Array.isArray(h)?`{${h.join(",")}}`:`${h}`]).forEach(([c,h])=>{l.searchParams.append(c,h)})):(o="POST",a=n);const u=Object.assign({},this.headers);return s&&(u.Prefer=`count=${s}`),new Fe({method:o,url:l,headers:u,schema:this.schemaName,body:a,fetch:this.fetch,allowEmpty:!1})}}const ai="2.9.5",li={"X-Client-Info":`realtime-js/${ai}`},ui="1.0.0",Kr=1e4,ci=1e3;var He;(function(i){i[i.connecting=0]="connecting",i[i.open=1]="open",i[i.closing=2]="closing",i[i.closed=3]="closed"})(He||(He={}));var le;(function(i){i.closed="closed",i.errored="errored",i.joined="joined",i.joining="joining",i.leaving="leaving"})(le||(le={}));var de;(function(i){i.close="phx_close",i.error="phx_error",i.join="phx_join",i.reply="phx_reply",i.leave="phx_leave",i.access_token="access_token"})(de||(de={}));var en;(function(i){i.websocket="websocket"})(en||(en={}));var Ie;(function(i){i.Connecting="connecting",i.Open="open",i.Closing="closing",i.Closed="closed"})(Ie||(Ie={}));class Gr{constructor(e,n){this.callback=e,this.timerCalc=n,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=n}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}class fi{constructor(){this.HEADER_LENGTH=1}decode(e,n){return e.constructor===ArrayBuffer?n(this._binaryDecode(e)):n(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const n=new DataView(e),t=new TextDecoder;return this._decodeBroadcast(e,n,t)}_decodeBroadcast(e,n,t){const r=n.getUint8(1),s=n.getUint8(2);let o=this.HEADER_LENGTH+2;const l=t.decode(e.slice(o,o+r));o=o+r;const a=t.decode(e.slice(o,o+s));o=o+s;const u=JSON.parse(t.decode(e.slice(o,e.byteLength)));return{ref:null,topic:l,event:a,payload:u}}}class Jt{constructor(e,n,t={},r=Kr){this.channel=e,this.event=n,this.payload=t,this.timeout=r,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,n){var t;return this._hasReceived(e)&&n((t=this.receivedResp)===null||t===void 0?void 0:t.response),this.recHooks.push({status:e,callback:n}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=n=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=n,this._matchReceive(n)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,n){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:n})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:n}){this.recHooks.filter(t=>t.status===e).forEach(t=>t.callback(n))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Mn;(function(i){i.SYNC="sync",i.JOIN="join",i.LEAVE="leave"})(Mn||(Mn={}));class rt{constructor(e,n){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const t=(n==null?void 0:n.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(t.state,{},r=>{const{onJoin:s,onLeave:o,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=rt.syncState(this.state,r,s,o),this.pendingDiffs.forEach(a=>{this.state=rt.syncDiff(this.state,a,s,o)}),this.pendingDiffs=[],l()}),this.channel._on(t.diff,{},r=>{const{onJoin:s,onLeave:o,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(r):(this.state=rt.syncDiff(this.state,r,s,o),l())}),this.onJoin((r,s,o)=>{this.channel._trigger("presence",{event:"join",key:r,currentPresences:s,newPresences:o})}),this.onLeave((r,s,o)=>{this.channel._trigger("presence",{event:"leave",key:r,currentPresences:s,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,n,t,r){const s=this.cloneDeep(e),o=this.transformState(n),l={},a={};return this.map(s,(u,c)=>{o[u]||(a[u]=c)}),this.map(o,(u,c)=>{const h=s[u];if(h){const p=c.map(S=>S.presence_ref),f=h.map(S=>S.presence_ref),d=c.filter(S=>f.indexOf(S.presence_ref)<0),g=h.filter(S=>p.indexOf(S.presence_ref)<0);d.length>0&&(l[u]=d),g.length>0&&(a[u]=g)}else l[u]=c}),this.syncDiff(s,{joins:l,leaves:a},t,r)}static syncDiff(e,n,t,r){const{joins:s,leaves:o}={joins:this.transformState(n.joins),leaves:this.transformState(n.leaves)};return t||(t=()=>{}),r||(r=()=>{}),this.map(s,(l,a)=>{var u;const c=(u=e[l])!==null&&u!==void 0?u:[];if(e[l]=this.cloneDeep(a),c.length>0){const h=e[l].map(f=>f.presence_ref),p=c.filter(f=>h.indexOf(f.presence_ref)<0);e[l].unshift(...p)}t(l,c,a)}),this.map(o,(l,a)=>{let u=e[l];if(!u)return;const c=a.map(h=>h.presence_ref);u=u.filter(h=>c.indexOf(h.presence_ref)<0),e[l]=u,r(l,u,a),u.length===0&&delete e[l]}),e}static map(e,n){return Object.getOwnPropertyNames(e).map(t=>n(t,e[t]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((n,t)=>{const r=e[t];return"metas"in r?n[t]=r.metas.map(s=>(s.presence_ref=s.phx_ref,delete s.phx_ref,delete s.phx_ref_prev,s)):n[t]=r,n},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var V;(function(i){i.abstime="abstime",i.bool="bool",i.date="date",i.daterange="daterange",i.float4="float4",i.float8="float8",i.int2="int2",i.int4="int4",i.int4range="int4range",i.int8="int8",i.int8range="int8range",i.json="json",i.jsonb="jsonb",i.money="money",i.numeric="numeric",i.oid="oid",i.reltime="reltime",i.text="text",i.time="time",i.timestamp="timestamp",i.timestamptz="timestamptz",i.timetz="timetz",i.tsrange="tsrange",i.tstzrange="tstzrange"})(V||(V={}));const Fn=(i,e,n={})=>{var t;const r=(t=n.skipTypes)!==null&&t!==void 0?t:[];return Object.keys(e).reduce((s,o)=>(s[o]=hi(o,i,e,r),s),{})},hi=(i,e,n,t)=>{const r=e.find(l=>l.name===i),s=r==null?void 0:r.type,o=n[i];return s&&!t.includes(s)?Vr(s,o):tn(o)},Vr=(i,e)=>{if(i.charAt(0)==="_"){const n=i.slice(1,i.length);return _i(e,n)}switch(i){case V.bool:return di(e);case V.float4:case V.float8:case V.int2:case V.int4:case V.int8:case V.numeric:case V.oid:return pi(e);case V.json:case V.jsonb:return mi(e);case V.timestamp:return gi(e);case V.abstime:case V.date:case V.daterange:case V.int4range:case V.int8range:case V.money:case V.reltime:case V.text:case V.time:case V.timestamptz:case V.timetz:case V.tsrange:case V.tstzrange:return tn(e);default:return tn(e)}},tn=i=>i,di=i=>{switch(i){case"t":return!0;case"f":return!1;default:return i}},pi=i=>{if(typeof i=="string"){const e=parseFloat(i);if(!Number.isNaN(e))return e}return i},mi=i=>{if(typeof i=="string")try{return JSON.parse(i)}catch(e){return console.log(`JSON parse error: ${e}`),i}return i},_i=(i,e)=>{if(typeof i!="string")return i;const n=i.length-1,t=i[n];if(i[0]==="{"&&t==="}"){let s;const o=i.slice(1,n);try{s=JSON.parse("["+o+"]")}catch{s=o?o.split(","):[]}return s.map(l=>Vr(e,l))}return i},gi=i=>typeof i=="string"?i.replace(" ","T"):i;var zn;(function(i){i.ALL="*",i.INSERT="INSERT",i.UPDATE="UPDATE",i.DELETE="DELETE"})(zn||(zn={}));var Hn;(function(i){i.BROADCAST="broadcast",i.PRESENCE="presence",i.POSTGRES_CHANGES="postgres_changes"})(Hn||(Hn={}));var Jn;(function(i){i.SUBSCRIBED="SUBSCRIBED",i.TIMED_OUT="TIMED_OUT",i.CLOSED="CLOSED",i.CHANNEL_ERROR="CHANNEL_ERROR"})(Jn||(Jn={}));class dn{constructor(e,n={config:{}},t){this.topic=e,this.params=n,this.socket=t,this.bindings={},this.state=le.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""}},n.config),this.timeout=this.socket.timeout,this.joinPush=new Jt(this,de.join,this.params,this.timeout),this.rejoinTimer=new Gr(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=le.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(r=>r.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=le.closed,this.socket._remove(this)}),this._onError(r=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,r),this.state=le.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=le.errored,this.rejoinTimer.scheduleTimeout())}),this._on(de.reply,{},(r,s)=>{this._trigger(this._replyEventName(s),r)}),this.presence=new rt(this),this.broadcastEndpointURL=this._broadcastEndpointURL()}subscribe(e,n=this.timeout){var t,r;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:s,presence:o}}=this.params;this._onError(u=>e&&e("CHANNEL_ERROR",u)),this._onClose(()=>e&&e("CLOSED"));const l={},a={broadcast:s,presence:o,postgres_changes:(r=(t=this.bindings.postgres_changes)===null||t===void 0?void 0:t.map(u=>u.filter))!==null&&r!==void 0?r:[]};this.socket.accessToken&&(l.access_token=this.socket.accessToken),this.updateJoinPayload(Object.assign({config:a},l)),this.joinedOnce=!0,this._rejoin(n),this.joinPush.receive("ok",({postgres_changes:u})=>{var c;if(this.socket.accessToken&&this.socket.setAuth(this.socket.accessToken),u===void 0){e&&e("SUBSCRIBED");return}else{const h=this.bindings.postgres_changes,p=(c=h==null?void 0:h.length)!==null&&c!==void 0?c:0,f=[];for(let d=0;d<p;d++){const g=h[d],{filter:{event:S,schema:T,table:A,filter:j}}=g,P=u&&u[d];if(P&&P.event===S&&P.schema===T&&P.table===A&&P.filter===j)f.push(Object.assign(Object.assign({},g),{id:P.id}));else{this.unsubscribe(),e&&e("CHANNEL_ERROR",new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=f,e&&e("SUBSCRIBED");return}}).receive("error",u=>{e&&e("CHANNEL_ERROR",new Error(JSON.stringify(Object.values(u).join(", ")||"error")))}).receive("timeout",()=>{e&&e("TIMED_OUT")})}return this}presenceState(){return this.presence.state}async track(e,n={}){return await this.send({type:"presence",event:"track",payload:e},n.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,n,t){return this._on(e,n,t)}async send(e,n={}){var t,r;if(!this._canPush()&&e.type==="broadcast"){const{event:s,payload:o}=e,l={method:"POST",headers:{apikey:(t=this.socket.apiKey)!==null&&t!==void 0?t:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:o}]})};try{return(await this._fetchWithTimeout(this.broadcastEndpointURL,l,(r=n.timeout)!==null&&r!==void 0?r:this.timeout)).ok?"ok":"error"}catch(a){return a.name==="AbortError"?"timed out":"error"}}else return new Promise(s=>{var o,l,a;const u=this._push(e.type,e,n.timeout||this.timeout);e.type==="broadcast"&&!(!((a=(l=(o=this.params)===null||o===void 0?void 0:o.config)===null||l===void 0?void 0:l.broadcast)===null||a===void 0)&&a.ack)&&s("ok"),u.receive("ok",()=>s("ok")),u.receive("error",()=>s("error")),u.receive("timeout",()=>s("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=le.leaving;const n=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(de.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(t=>{const r=new Jt(this,de.leave,{},e);r.receive("ok",()=>{n(),t("ok")}).receive("timeout",()=>{n(),t("timed out")}).receive("error",()=>{t("error")}),r.send(),this._canPush()||r.trigger("ok",{})})}_broadcastEndpointURL(){let e=this.socket.endPoint;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")+"/api/broadcast"}async _fetchWithTimeout(e,n,t){const r=new AbortController,s=setTimeout(()=>r.abort(),t),o=await this.socket.fetch(e,Object.assign(Object.assign({},n),{signal:r.signal}));return clearTimeout(s),o}_push(e,n,t=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let r=new Jt(this,e,n,t);return this._canPush()?r.send():(r.startTimeout(),this.pushBuffer.push(r)),r}_onMessage(e,n,t){return n}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,n,t){var r,s;const o=e.toLocaleLowerCase(),{close:l,error:a,leave:u,join:c}=de;if(t&&[l,a,u,c].indexOf(o)>=0&&t!==this._joinRef())return;let p=this._onMessage(o,n,t);if(n&&!p)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(r=this.bindings.postgres_changes)===null||r===void 0||r.filter(f=>{var d,g,S;return((d=f.filter)===null||d===void 0?void 0:d.event)==="*"||((S=(g=f.filter)===null||g===void 0?void 0:g.event)===null||S===void 0?void 0:S.toLocaleLowerCase())===o}).map(f=>f.callback(p,t)):(s=this.bindings[o])===null||s===void 0||s.filter(f=>{var d,g,S,T,A,j;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in f){const P=f.id,I=(d=f.filter)===null||d===void 0?void 0:d.event;return P&&((g=n.ids)===null||g===void 0?void 0:g.includes(P))&&(I==="*"||(I==null?void 0:I.toLocaleLowerCase())===((S=n.data)===null||S===void 0?void 0:S.type.toLocaleLowerCase()))}else{const P=(A=(T=f==null?void 0:f.filter)===null||T===void 0?void 0:T.event)===null||A===void 0?void 0:A.toLocaleLowerCase();return P==="*"||P===((j=n==null?void 0:n.event)===null||j===void 0?void 0:j.toLocaleLowerCase())}else return f.type.toLocaleLowerCase()===o}).map(f=>{if(typeof p=="object"&&"ids"in p){const d=p.data,{schema:g,table:S,commit_timestamp:T,type:A,errors:j}=d;p=Object.assign(Object.assign({},{schema:g,table:S,commit_timestamp:T,eventType:A,new:{},old:{},errors:j}),this._getPayloadRecords(d))}f.callback(p,t)})}_isClosed(){return this.state===le.closed}_isJoined(){return this.state===le.joined}_isJoining(){return this.state===le.joining}_isLeaving(){return this.state===le.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,n,t){const r=e.toLocaleLowerCase(),s={type:r,filter:n,callback:t};return this.bindings[r]?this.bindings[r].push(s):this.bindings[r]=[s],this}_off(e,n){const t=e.toLocaleLowerCase();return this.bindings[t]=this.bindings[t].filter(r=>{var s;return!(((s=r.type)===null||s===void 0?void 0:s.toLocaleLowerCase())===t&&dn.isEqual(r.filter,n))}),this}static isEqual(e,n){if(Object.keys(e).length!==Object.keys(n).length)return!1;for(const t in e)if(e[t]!==n[t])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(de.close,{},e)}_onError(e){this._on(de.error,{},n=>e(n))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=le.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const n={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(n.new=Fn(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(n.old=Fn(e.columns,e.old_record)),n}}const $i=()=>{},bi=typeof WebSocket<"u";class wi{constructor(e,n){var t;this.accessToken=null,this.apiKey=null,this.channels=[],this.endPoint="",this.headers=li,this.params={},this.timeout=Kr,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=$i,this.conn=null,this.sendBuffer=[],this.serializer=new fi,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this._resolveFetch=s=>{let o;return s?o=s:typeof fetch>"u"?o=(...l)=>Ke(()=>Promise.resolve().then(()=>ct),void 0,import.meta.url).then(({default:a})=>a(...l)):o=fetch,(...l)=>o(...l)},this.endPoint=`${e}/${en.websocket}`,n!=null&&n.transport?this.transport=n.transport:this.transport=null,n!=null&&n.params&&(this.params=n.params),n!=null&&n.headers&&(this.headers=Object.assign(Object.assign({},this.headers),n.headers)),n!=null&&n.timeout&&(this.timeout=n.timeout),n!=null&&n.logger&&(this.logger=n.logger),n!=null&&n.heartbeatIntervalMs&&(this.heartbeatIntervalMs=n.heartbeatIntervalMs);const r=(t=n==null?void 0:n.params)===null||t===void 0?void 0:t.apikey;r&&(this.accessToken=r,this.apiKey=r),this.reconnectAfterMs=n!=null&&n.reconnectAfterMs?n.reconnectAfterMs:s=>[1e3,2e3,5e3,1e4][s-1]||1e4,this.encode=n!=null&&n.encode?n.encode:(s,o)=>o(JSON.stringify(s)),this.decode=n!=null&&n.decode?n.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new Gr(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(n==null?void 0:n.fetch)}connect(){if(!this.conn){if(this.transport){this.conn=new this.transport(this._endPointURL(),void 0,{headers:this.headers});return}if(bi){this.conn=new WebSocket(this._endPointURL()),this.setupConnection();return}this.conn=new vi(this._endPointURL(),void 0,{close:()=>{this.conn=null}}),Ke(()=>import("./browser-BImCA5dO.js").then(e=>e.b),[],import.meta.url).then(({default:e})=>{this.conn=new e(this._endPointURL(),void 0,{headers:this.headers}),this.setupConnection()})}}disconnect(e,n){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,n??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(e){const n=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),n}async removeAllChannels(){const e=await Promise.all(this.channels.map(n=>n.unsubscribe()));return this.disconnect(),e}log(e,n,t){this.logger(e,n,t)}connectionState(){switch(this.conn&&this.conn.readyState){case He.connecting:return Ie.Connecting;case He.open:return Ie.Open;case He.closing:return Ie.Closing;default:return Ie.Closed}}isConnected(){return this.connectionState()===Ie.Open}channel(e,n={config:{}}){const t=new dn(`realtime:${e}`,n,this);return this.channels.push(t),t}push(e){const{topic:n,event:t,payload:r,ref:s}=e,o=()=>{this.encode(e,l=>{var a;(a=this.conn)===null||a===void 0||a.send(l)})};this.log("push",`${n} ${t} (${s})`,r),this.isConnected()?o():this.sendBuffer.push(o)}setAuth(e){this.accessToken=e,this.channels.forEach(n=>{e&&n.updateJoinPayload({access_token:e}),n.joinedOnce&&n._isJoined()&&n._push(de.access_token,{access_token:e})})}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let n=this.channels.find(t=>t.topic===e&&(t._isJoined()||t._isJoining()));n&&(this.log("transport",`leaving duplicate topic "${e}"`),n.unsubscribe())}_remove(e){this.channels=this.channels.filter(n=>n._joinRef()!==e._joinRef())}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_endPointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:ui}))}_onConnMessage(e){this.decode(e.data,n=>{let{topic:t,event:r,payload:s,ref:o}=n;(o&&o===this.pendingHeartbeatRef||r===(s==null?void 0:s.type))&&(this.pendingHeartbeatRef=null),this.log("receive",`${s.status||""} ${t} ${r} ${o&&"("+o+")"||""}`,s),this.channels.filter(l=>l._isMember(t)).forEach(l=>l._trigger(r,s,o)),this.stateChangeCallbacks.message.forEach(l=>l(n))})}_onConnOpen(){this.log("transport",`connected to ${this._endPointURL()}`),this._flushSendBuffer(),this.reconnectTimer.reset(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this._sendHeartbeat(),this.heartbeatIntervalMs),this.stateChangeCallbacks.open.forEach(e=>e())}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(n=>n(e))}_onConnError(e){this.log("transport",e.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(n=>n(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(de.error))}_appendParams(e,n){if(Object.keys(n).length===0)return e;const t=e.match(/\?/)?"&":"?",r=new URLSearchParams(n);return`${e}${t}${r}`}_flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(e=this.conn)===null||e===void 0||e.close(ci,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth(this.accessToken)}}}class vi{constructor(e,n,t){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=He.connecting,this.send=()=>{},this.url=null,this.url=e,this.close=t.close}}class pn extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function re(i){return typeof i=="object"&&i!==null&&"__isStorageError"in i}class ki extends pn{constructor(e,n){super(e),this.name="StorageApiError",this.status=n}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class Kn extends pn{constructor(e,n){super(e),this.name="StorageUnknownError",this.originalError=n}}var yi=function(i,e,n,t){function r(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function l(c){try{u(t.next(c))}catch(h){o(h)}}function a(c){try{u(t.throw(c))}catch(h){o(h)}}function u(c){c.done?s(c.value):r(c.value).then(l,a)}u((t=t.apply(i,e||[])).next())})};const Wr=i=>{let e;return i?e=i:typeof fetch>"u"?e=(...n)=>Ke(()=>Promise.resolve().then(()=>ct),void 0,import.meta.url).then(({default:t})=>t(...n)):e=fetch,(...n)=>e(...n)},Si=()=>yi(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Ke(()=>Promise.resolve().then(()=>ct),void 0,import.meta.url)).Response:Response});var Ye=function(i,e,n,t){function r(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function l(c){try{u(t.next(c))}catch(h){o(h)}}function a(c){try{u(t.throw(c))}catch(h){o(h)}}function u(c){c.done?s(c.value):r(c.value).then(l,a)}u((t=t.apply(i,e||[])).next())})};const Kt=i=>i.msg||i.message||i.error_description||i.error||JSON.stringify(i),Ci=(i,e)=>Ye(void 0,void 0,void 0,function*(){const n=yield Si();i instanceof n?i.json().then(t=>{e(new ki(Kt(t),i.status||500))}).catch(t=>{e(new Kn(Kt(t),t))}):e(new Kn(Kt(i),i))}),Ei=(i,e,n,t)=>{const r={method:i,headers:(e==null?void 0:e.headers)||{}};return i==="GET"?r:(r.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),r.body=JSON.stringify(t),Object.assign(Object.assign({},r),n))};function Ot(i,e,n,t,r,s){return Ye(this,void 0,void 0,function*(){return new Promise((o,l)=>{i(n,Ei(e,t,r,s)).then(a=>{if(!a.ok)throw a;return t!=null&&t.noResolveJson?a:a.json()}).then(a=>o(a)).catch(a=>Ci(a,l))})})}function nn(i,e,n,t){return Ye(this,void 0,void 0,function*(){return Ot(i,"GET",e,n,t)})}function we(i,e,n,t,r){return Ye(this,void 0,void 0,function*(){return Ot(i,"POST",e,t,r,n)})}function Oi(i,e,n,t,r){return Ye(this,void 0,void 0,function*(){return Ot(i,"PUT",e,t,r,n)})}function Qr(i,e,n,t,r){return Ye(this,void 0,void 0,function*(){return Ot(i,"DELETE",e,t,r,n)})}var ce=function(i,e,n,t){function r(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function l(c){try{u(t.next(c))}catch(h){o(h)}}function a(c){try{u(t.throw(c))}catch(h){o(h)}}function u(c){c.done?s(c.value):r(c.value).then(l,a)}u((t=t.apply(i,e||[])).next())})};const Ai={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Gn={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Ti{constructor(e,n={},t,r){this.url=e,this.headers=n,this.bucketId=t,this.fetch=Wr(r)}uploadOrUpdate(e,n,t,r){return ce(this,void 0,void 0,function*(){try{let s;const o=Object.assign(Object.assign({},Gn),r),l=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(o.upsert)});typeof Blob<"u"&&t instanceof Blob?(s=new FormData,s.append("cacheControl",o.cacheControl),s.append("",t)):typeof FormData<"u"&&t instanceof FormData?(s=t,s.append("cacheControl",o.cacheControl)):(s=t,l["cache-control"]=`max-age=${o.cacheControl}`,l["content-type"]=o.contentType);const a=this._removeEmptyFolders(n),u=this._getFinalPath(a),c=yield this.fetch(`${this.url}/object/${u}`,Object.assign({method:e,body:s,headers:l},o!=null&&o.duplex?{duplex:o.duplex}:{})),h=yield c.json();return c.ok?{data:{path:a,id:h.Id,fullPath:h.Key},error:null}:{data:null,error:h}}catch(s){if(re(s))return{data:null,error:s};throw s}})}upload(e,n,t){return ce(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,n,t)})}uploadToSignedUrl(e,n,t,r){return ce(this,void 0,void 0,function*(){const s=this._removeEmptyFolders(e),o=this._getFinalPath(s),l=new URL(this.url+`/object/upload/sign/${o}`);l.searchParams.set("token",n);try{let a;const u=Object.assign({upsert:Gn.upsert},r),c=Object.assign(Object.assign({},this.headers),{"x-upsert":String(u.upsert)});typeof Blob<"u"&&t instanceof Blob?(a=new FormData,a.append("cacheControl",u.cacheControl),a.append("",t)):typeof FormData<"u"&&t instanceof FormData?(a=t,a.append("cacheControl",u.cacheControl)):(a=t,c["cache-control"]=`max-age=${u.cacheControl}`,c["content-type"]=u.contentType);const h=yield this.fetch(l.toString(),{method:"PUT",body:a,headers:c}),p=yield h.json();return h.ok?{data:{path:s,fullPath:p.Key},error:null}:{data:null,error:p}}catch(a){if(re(a))return{data:null,error:a};throw a}})}createSignedUploadUrl(e){return ce(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e);const t=yield we(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:this.headers}),r=new URL(this.url+t.url),s=r.searchParams.get("token");if(!s)throw new pn("No token returned by API");return{data:{signedUrl:r.toString(),path:e,token:s},error:null}}catch(n){if(re(n))return{data:null,error:n};throw n}})}update(e,n,t){return ce(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,n,t)})}move(e,n){return ce(this,void 0,void 0,function*(){try{return{data:yield we(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n},{headers:this.headers}),error:null}}catch(t){if(re(t))return{data:null,error:t};throw t}})}copy(e,n){return ce(this,void 0,void 0,function*(){try{return{data:{path:(yield we(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n},{headers:this.headers})).Key},error:null}}catch(t){if(re(t))return{data:null,error:t};throw t}})}createSignedUrl(e,n,t){return ce(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e),s=yield we(this.fetch,`${this.url}/object/sign/${r}`,Object.assign({expiresIn:n},t!=null&&t.transform?{transform:t.transform}:{}),{headers:this.headers});const o=t!=null&&t.download?`&download=${t.download===!0?"":t.download}`:"";return s={signedUrl:encodeURI(`${this.url}${s.signedURL}${o}`)},{data:s,error:null}}catch(r){if(re(r))return{data:null,error:r};throw r}})}createSignedUrls(e,n,t){return ce(this,void 0,void 0,function*(){try{const r=yield we(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:n,paths:e},{headers:this.headers}),s=t!=null&&t.download?`&download=${t.download===!0?"":t.download}`:"";return{data:r.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${s}`):null})),error:null}}catch(r){if(re(r))return{data:null,error:r};throw r}})}download(e,n){return ce(this,void 0,void 0,function*(){const r=typeof(n==null?void 0:n.transform)<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString((n==null?void 0:n.transform)||{}),o=s?`?${s}`:"";try{const l=this._getFinalPath(e);return{data:yield(yield nn(this.fetch,`${this.url}/${r}/${l}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(l){if(re(l))return{data:null,error:l};throw l}})}getPublicUrl(e,n){const t=this._getFinalPath(e),r=[],s=n!=null&&n.download?`download=${n.download===!0?"":n.download}`:"";s!==""&&r.push(s);const l=typeof(n==null?void 0:n.transform)<"u"?"render/image":"object",a=this.transformOptsToQueryString((n==null?void 0:n.transform)||{});a!==""&&r.push(a);let u=r.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${t}${u}`)}}}remove(e){return ce(this,void 0,void 0,function*(){try{return{data:yield Qr(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(n){if(re(n))return{data:null,error:n};throw n}})}list(e,n,t){return ce(this,void 0,void 0,function*(){try{const r=Object.assign(Object.assign(Object.assign({},Ai),n),{prefix:e||""});return{data:yield we(this.fetch,`${this.url}/object/list/${this.bucketId}`,r,{headers:this.headers},t),error:null}}catch(r){if(re(r))return{data:null,error:r};throw r}})}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const n=[];return e.width&&n.push(`width=${e.width}`),e.height&&n.push(`height=${e.height}`),e.resize&&n.push(`resize=${e.resize}`),e.format&&n.push(`format=${e.format}`),e.quality&&n.push(`quality=${e.quality}`),n.join("&")}}const ji="2.5.5",Pi={"X-Client-Info":`storage-js/${ji}`};var Ue=function(i,e,n,t){function r(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function l(c){try{u(t.next(c))}catch(h){o(h)}}function a(c){try{u(t.throw(c))}catch(h){o(h)}}function u(c){c.done?s(c.value):r(c.value).then(l,a)}u((t=t.apply(i,e||[])).next())})};class Ii{constructor(e,n={},t){this.url=e,this.headers=Object.assign(Object.assign({},Pi),n),this.fetch=Wr(t)}listBuckets(){return Ue(this,void 0,void 0,function*(){try{return{data:yield nn(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(re(e))return{data:null,error:e};throw e}})}getBucket(e){return Ue(this,void 0,void 0,function*(){try{return{data:yield nn(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(n){if(re(n))return{data:null,error:n};throw n}})}createBucket(e,n={public:!1}){return Ue(this,void 0,void 0,function*(){try{return{data:yield we(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(t){if(re(t))return{data:null,error:t};throw t}})}updateBucket(e,n){return Ue(this,void 0,void 0,function*(){try{return{data:yield Oi(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(t){if(re(t))return{data:null,error:t};throw t}})}emptyBucket(e){return Ue(this,void 0,void 0,function*(){try{return{data:yield we(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(n){if(re(n))return{data:null,error:n};throw n}})}deleteBucket(e){return Ue(this,void 0,void 0,function*(){try{return{data:yield Qr(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(n){if(re(n))return{data:null,error:n};throw n}})}}class Ri extends Ii{constructor(e,n={},t){super(e,n,t)}from(e){return new Ti(this.url,this.headers,e,this.fetch)}}const Li="2.43.4";let tt="";typeof Deno<"u"?tt="deno":typeof document<"u"?tt="web":typeof navigator<"u"&&navigator.product==="ReactNative"?tt="react-native":tt="node";const Di={"X-Client-Info":`supabase-js-${tt}/${Li}`},qi={headers:Di},Ui={schema:"public"},Ni={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Bi={};var Mi=function(i,e,n,t){function r(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function l(c){try{u(t.next(c))}catch(h){o(h)}}function a(c){try{u(t.throw(c))}catch(h){o(h)}}function u(c){c.done?s(c.value):r(c.value).then(l,a)}u((t=t.apply(i,e||[])).next())})};const Fi=i=>{let e;return i?e=i:typeof fetch>"u"?e=fn:e=fetch,(...n)=>e(...n)},zi=()=>typeof Headers>"u"?Jr:Headers,Hi=(i,e,n)=>{const t=Fi(n),r=zi();return(s,o)=>Mi(void 0,void 0,void 0,function*(){var l;const a=(l=yield e())!==null&&l!==void 0?l:i;let u=new r(o==null?void 0:o.headers);return u.has("apikey")||u.set("apikey",i),u.has("Authorization")||u.set("Authorization",`Bearer ${a}`),t(s,Object.assign(Object.assign({},o),{headers:u}))})};function Ji(i){return i.replace(/\/$/,"")}function Ki(i,e){const{db:n,auth:t,realtime:r,global:s}=i,{db:o,auth:l,realtime:a,global:u}=e;return{db:Object.assign(Object.assign({},o),n),auth:Object.assign(Object.assign({},l),t),realtime:Object.assign(Object.assign({},a),r),global:Object.assign(Object.assign({},u),s)}}const Yr="2.64.2",Gi="http://localhost:9999",Vi="supabase.auth.token",Wi={"X-Client-Info":`gotrue-js/${Yr}`},Vn=10,rn="X-Supabase-Api-Version",Xr={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}};function Qi(i){return Math.round(Date.now()/1e3)+i}function Yi(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(i){const e=Math.random()*16|0;return(i=="x"?e:e&3|8).toString(16)})}const he=()=>typeof document<"u",Te={tested:!1,writable:!1},st=()=>{if(!he())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Te.tested)return Te.writable;const i=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(i,i),globalThis.localStorage.removeItem(i),Te.tested=!0,Te.writable=!0}catch{Te.tested=!0,Te.writable=!1}return Te.writable};function Gt(i){const e={},n=new URL(i);if(n.hash&&n.hash[0]==="#")try{new URLSearchParams(n.hash.substring(1)).forEach((r,s)=>{e[s]=r})}catch{}return n.searchParams.forEach((t,r)=>{e[r]=t}),e}const Zr=i=>{let e;return i?e=i:typeof fetch>"u"?e=(...n)=>Ke(()=>Promise.resolve().then(()=>ct),void 0,import.meta.url).then(({default:t})=>t(...n)):e=fetch,(...n)=>e(...n)},Xi=i=>typeof i=="object"&&i!==null&&"status"in i&&"ok"in i&&"json"in i&&typeof i.json=="function",xr=async(i,e,n)=>{await i.setItem(e,JSON.stringify(n))},_t=async(i,e)=>{const n=await i.getItem(e);if(!n)return null;try{return JSON.parse(n)}catch{return n}},Vt=async(i,e)=>{await i.removeItem(e)};function Zi(i){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let n="",t,r,s,o,l,a,u,c=0;for(i=i.replace("-","+").replace("_","/");c<i.length;)o=e.indexOf(i.charAt(c++)),l=e.indexOf(i.charAt(c++)),a=e.indexOf(i.charAt(c++)),u=e.indexOf(i.charAt(c++)),t=o<<2|l>>4,r=(l&15)<<4|a>>2,s=(a&3)<<6|u,n=n+String.fromCharCode(t),a!=64&&r!=0&&(n=n+String.fromCharCode(r)),u!=64&&s!=0&&(n=n+String.fromCharCode(s));return n}class At{constructor(){this.promise=new At.promiseConstructor((e,n)=>{this.resolve=e,this.reject=n})}}At.promiseConstructor=Promise;function Wn(i){const e=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}=?$|[a-z0-9_-]{2}(==)?$)$/i,n=i.split(".");if(n.length!==3)throw new Error("JWT is not valid: not a JWT structure");if(!e.test(n[1]))throw new Error("JWT is not valid: payload is not in base64url format");const t=n[1];return JSON.parse(Zi(t))}async function xi(i){return await new Promise(e=>{setTimeout(()=>e(null),i)})}function eo(i,e){return new Promise((t,r)=>{(async()=>{for(let s=0;s<1/0;s++)try{const o=await i(s);if(!e(s,null,o)){t(o);return}}catch(o){if(!e(s,o)){r(o);return}}})()})}function to(i){return("0"+i.toString(16)).substr(-2)}function no(){const e=new Uint32Array(56);if(typeof crypto>"u"){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",t=n.length;let r="";for(let s=0;s<56;s++)r+=n.charAt(Math.floor(Math.random()*t));return r}return crypto.getRandomValues(e),Array.from(e,to).join("")}async function ro(i){const n=new TextEncoder().encode(i),t=await crypto.subtle.digest("SHA-256",n),r=new Uint8Array(t);return Array.from(r).map(s=>String.fromCharCode(s)).join("")}function so(i){return btoa(i).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function io(i){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),i;const n=await ro(i);return so(n)}async function Ne(i,e,n=!1){const t=no();let r=t;n&&(r+="/PASSWORD_RECOVERY"),await xr(i,`${e}-code-verifier`,r);const s=await io(t);return[s,t===s?"plain":"s256"]}const oo=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function ao(i){const e=i.headers.get(rn);if(!e||!e.match(oo))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}class mn extends Error{constructor(e,n,t){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=n,this.code=t}}function M(i){return typeof i=="object"&&i!==null&&"__isAuthError"in i}class lo extends mn{constructor(e,n,t){super(e,n,t),this.name="AuthApiError",this.status=n,this.code=t}}function uo(i){return M(i)&&i.name==="AuthApiError"}class es extends mn{constructor(e,n){super(e),this.name="AuthUnknownError",this.originalError=n}}class Le extends mn{constructor(e,n,t,r){super(e,t,r),this.name=n,this.status=t}}class je extends Le{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}class Wt extends Le{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class gt extends Le{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class $t extends Le{constructor(e,n=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Qn extends Le{constructor(e,n=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class sn extends Le{constructor(e,n){super(e,"AuthRetryableFetchError",n,void 0)}}function Qt(i){return M(i)&&i.name==="AuthRetryableFetchError"}class Yn extends Le{constructor(e,n,t){super(e,"AuthWeakPasswordError",n,"weak_password"),this.reasons=t}}var co=function(i,e){var n={};for(var t in i)Object.prototype.hasOwnProperty.call(i,t)&&e.indexOf(t)<0&&(n[t]=i[t]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,t=Object.getOwnPropertySymbols(i);r<t.length;r++)e.indexOf(t[r])<0&&Object.prototype.propertyIsEnumerable.call(i,t[r])&&(n[t[r]]=i[t[r]]);return n};const Pe=i=>i.msg||i.message||i.error_description||i.error||JSON.stringify(i),fo=[502,503,504];async function Xn(i){var e;if(!Xi(i))throw new sn(Pe(i),0);if(fo.includes(i.status))throw new sn(Pe(i),i.status);let n;try{n=await i.json()}catch(s){throw new es(Pe(s),s)}let t;const r=ao(i);if(r&&r.getTime()>=Xr["2024-01-01"].timestamp&&typeof n=="object"&&n&&typeof n.code=="string"?t=n.code:typeof n=="object"&&n&&typeof n.error_code=="string"&&(t=n.error_code),t){if(t==="weak_password")throw new Yn(Pe(n),i.status,((e=n.weak_password)===null||e===void 0?void 0:e.reasons)||[])}else if(typeof n=="object"&&n&&typeof n.weak_password=="object"&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((s,o)=>s&&typeof o=="string",!0))throw new Yn(Pe(n),i.status,n.weak_password.reasons);throw new lo(Pe(n),i.status||500,t)}const ho=(i,e,n,t)=>{const r={method:i,headers:(e==null?void 0:e.headers)||{}};return i==="GET"?r:(r.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),r.body=JSON.stringify(t),Object.assign(Object.assign({},r),n))};async function F(i,e,n,t){var r;const s=Object.assign({},t==null?void 0:t.headers);s[rn]||(s[rn]=Xr["2024-01-01"].name),t!=null&&t.jwt&&(s.Authorization=`Bearer ${t.jwt}`);const o=(r=t==null?void 0:t.query)!==null&&r!==void 0?r:{};t!=null&&t.redirectTo&&(o.redirect_to=t.redirectTo);const l=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",a=await po(i,e,n+l,{headers:s,noResolveJson:t==null?void 0:t.noResolveJson},{},t==null?void 0:t.body);return t!=null&&t.xform?t==null?void 0:t.xform(a):{data:Object.assign({},a),error:null}}async function po(i,e,n,t,r,s){const o=ho(e,t,r,s);let l;try{l=await i(n,Object.assign({},o))}catch(a){throw console.error(a),new sn(Pe(a),0)}if(l.ok||await Xn(l),t!=null&&t.noResolveJson)return l;try{return await l.json()}catch(a){await Xn(a)}}function be(i){var e;let n=null;$o(i)&&(n=Object.assign({},i),i.expires_at||(n.expires_at=Qi(i.expires_in)));const t=(e=i.user)!==null&&e!==void 0?e:i;return{data:{session:n,user:t},error:null}}function Zn(i){const e=be(i);return!e.error&&i.weak_password&&typeof i.weak_password=="object"&&Array.isArray(i.weak_password.reasons)&&i.weak_password.reasons.length&&i.weak_password.message&&typeof i.weak_password.message=="string"&&i.weak_password.reasons.reduce((n,t)=>n&&typeof t=="string",!0)&&(e.data.weak_password=i.weak_password),e}function ve(i){var e;return{data:{user:(e=i.user)!==null&&e!==void 0?e:i},error:null}}function mo(i){return{data:i,error:null}}function _o(i){const{action_link:e,email_otp:n,hashed_token:t,redirect_to:r,verification_type:s}=i,o=co(i,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:e,email_otp:n,hashed_token:t,redirect_to:r,verification_type:s},a=Object.assign({},o);return{data:{properties:l,user:a},error:null}}function go(i){return i}function $o(i){return i.access_token&&i.refresh_token&&i.expires_in}var bo=function(i,e){var n={};for(var t in i)Object.prototype.hasOwnProperty.call(i,t)&&e.indexOf(t)<0&&(n[t]=i[t]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,t=Object.getOwnPropertySymbols(i);r<t.length;r++)e.indexOf(t[r])<0&&Object.prototype.propertyIsEnumerable.call(i,t[r])&&(n[t[r]]=i[t[r]]);return n};class wo{constructor({url:e="",headers:n={},fetch:t}){this.url=e,this.headers=n,this.fetch=Zr(t),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,n="global"){try{return await F(this.fetch,"POST",`${this.url}/logout?scope=${n}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(t){if(M(t))return{data:null,error:t};throw t}}async inviteUserByEmail(e,n={}){try{return await F(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:n.data},headers:this.headers,redirectTo:n.redirectTo,xform:ve})}catch(t){if(M(t))return{data:{user:null},error:t};throw t}}async generateLink(e){try{const{options:n}=e,t=bo(e,["options"]),r=Object.assign(Object.assign({},t),n);return"newEmail"in t&&(r.new_email=t==null?void 0:t.newEmail,delete r.newEmail),await F(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:r,headers:this.headers,xform:_o,redirectTo:n==null?void 0:n.redirectTo})}catch(n){if(M(n))return{data:{properties:null,user:null},error:n};throw n}}async createUser(e){try{return await F(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:ve})}catch(n){if(M(n))return{data:{user:null},error:n};throw n}}async listUsers(e){var n,t,r,s,o,l,a;try{const u={nextPage:null,lastPage:0,total:0},c=await F(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(t=(n=e==null?void 0:e.page)===null||n===void 0?void 0:n.toString())!==null&&t!==void 0?t:"",per_page:(s=(r=e==null?void 0:e.perPage)===null||r===void 0?void 0:r.toString())!==null&&s!==void 0?s:""},xform:go});if(c.error)throw c.error;const h=await c.json(),p=(o=c.headers.get("x-total-count"))!==null&&o!==void 0?o:0,f=(a=(l=c.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&a!==void 0?a:[];return f.length>0&&(f.forEach(d=>{const g=parseInt(d.split(";")[0].split("=")[1].substring(0,1)),S=JSON.parse(d.split(";")[1].split("=")[1]);u[`${S}Page`]=g}),u.total=parseInt(p)),{data:Object.assign(Object.assign({},h),u),error:null}}catch(u){if(M(u))return{data:{users:[]},error:u};throw u}}async getUserById(e){try{return await F(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:ve})}catch(n){if(M(n))return{data:{user:null},error:n};throw n}}async updateUserById(e,n){try{return await F(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:n,headers:this.headers,xform:ve})}catch(t){if(M(t))return{data:{user:null},error:t};throw t}}async deleteUser(e,n=!1){try{return await F(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:n},xform:ve})}catch(t){if(M(t))return{data:{user:null},error:t};throw t}}async _listFactors(e){try{const{data:n,error:t}=await F(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:r=>({data:{factors:r},error:null})});return{data:n,error:t}}catch(n){if(M(n))return{data:null,error:n};throw n}}async _deleteFactor(e){try{return{data:await F(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(n){if(M(n))return{data:null,error:n};throw n}}}const vo={getItem:i=>st()?globalThis.localStorage.getItem(i):null,setItem:(i,e)=>{st()&&globalThis.localStorage.setItem(i,e)},removeItem:i=>{st()&&globalThis.localStorage.removeItem(i)}};function xn(i={}){return{getItem:e=>i[e]||null,setItem:(e,n)=>{i[e]=n},removeItem:e=>{delete i[e]}}}function ko(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Be={debug:!!(globalThis&&st()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class ts extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class yo extends ts{}async function So(i,e,n){Be.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",i,e);const t=new globalThis.AbortController;return e>0&&setTimeout(()=>{t.abort(),Be.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",i)},e),await globalThis.navigator.locks.request(i,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:t.signal},async r=>{if(r){Be.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",i,r.name);try{return await n()}finally{Be.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",i,r.name)}}else{if(e===0)throw Be.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",i),new yo(`Acquiring an exclusive Navigator LockManager lock "${i}" immediately failed`);if(Be.debug)try{const s=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(s,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}})}ko();const Co={url:Gi,storageKey:Vi,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Wi,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1},et=30*1e3,er=3;async function tr(i,e,n){return await n()}class at{constructor(e){var n,t;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=at.nextInstanceID,at.nextInstanceID+=1,this.instanceID>0&&he()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const r=Object.assign(Object.assign({},Co),e);if(this.logDebugMessages=!!r.debug,typeof r.debug=="function"&&(this.logger=r.debug),this.persistSession=r.persistSession,this.storageKey=r.storageKey,this.autoRefreshToken=r.autoRefreshToken,this.admin=new wo({url:r.url,headers:r.headers,fetch:r.fetch}),this.url=r.url,this.headers=r.headers,this.fetch=Zr(r.fetch),this.lock=r.lock||tr,this.detectSessionInUrl=r.detectSessionInUrl,this.flowType=r.flowType,this.hasCustomAuthorizationHeader=r.hasCustomAuthorizationHeader,r.lock?this.lock=r.lock:he()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=So:this.lock=tr,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?r.storage?this.storage=r.storage:st()?this.storage=vo:(this.memoryStorage={},this.storage=xn(this.memoryStorage)):(this.memoryStorage={},this.storage=xn(this.memoryStorage)),he()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(s){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",s)}(t=this.broadcastChannel)===null||t===void 0||t.addEventListener("message",async s=>{this._debug("received broadcast notification from other tab or client",s),await this._notifyAllSubscribers(s.data.event,s.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Yr}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){try{const e=he()?await this._isPKCEFlow():!1;if(this._debug("#_initialize()","begin","is PKCE flow",e),e||this.detectSessionInUrl&&this._isImplicitGrantFlow()){const{data:n,error:t}=await this._getSessionFromURL(e);if(t)return this._debug("#_initialize()","error detecting session from URL",t),(t==null?void 0:t.message)==="Identity is already linked"||(t==null?void 0:t.message)==="Identity is already linked to another user"?{error:t}:(await this._removeSession(),{error:t});const{session:r,redirectType:s}=n;return this._debug("#_initialize()","detected session in URL",r,"redirect type",s),await this._saveSession(r),setTimeout(async()=>{s==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",r):await this._notifyAllSubscribers("SIGNED_IN",r)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(e){return M(e)?{error:e}:{error:new es("Unexpected error during initialization",e)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var n,t,r;try{await this._removeSession();const s=await F(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(t=(n=e==null?void 0:e.options)===null||n===void 0?void 0:n.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:(r=e==null?void 0:e.options)===null||r===void 0?void 0:r.captchaToken}},xform:be}),{data:o,error:l}=s;if(l||!o)return{data:{user:null,session:null},error:l};const a=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",a)),{data:{user:u,session:a},error:null}}catch(s){if(M(s))return{data:{user:null,session:null},error:s};throw s}}async signUp(e){var n,t,r;try{await this._removeSession();let s;if("email"in e){const{email:c,password:h,options:p}=e;let f=null,d=null;this.flowType==="pkce"&&([f,d]=await Ne(this.storage,this.storageKey)),s=await F(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:p==null?void 0:p.emailRedirectTo,body:{email:c,password:h,data:(n=p==null?void 0:p.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:p==null?void 0:p.captchaToken},code_challenge:f,code_challenge_method:d},xform:be})}else if("phone"in e){const{phone:c,password:h,options:p}=e;s=await F(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:c,password:h,data:(t=p==null?void 0:p.data)!==null&&t!==void 0?t:{},channel:(r=p==null?void 0:p.channel)!==null&&r!==void 0?r:"sms",gotrue_meta_security:{captcha_token:p==null?void 0:p.captchaToken}},xform:be})}else throw new gt("You must provide either an email or phone number and a password");const{data:o,error:l}=s;if(l||!o)return{data:{user:null,session:null},error:l};const a=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",a)),{data:{user:u,session:a},error:null}}catch(s){if(M(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithPassword(e){try{await this._removeSession();let n;if("email"in e){const{email:s,password:o,options:l}=e;n=await F(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:Zn})}else if("phone"in e){const{phone:s,password:o,options:l}=e;n=await F(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:Zn})}else throw new gt("You must provide either an email or phone number and a password");const{data:t,error:r}=n;return r?{data:{user:null,session:null},error:r}:!t||!t.session||!t.user?{data:{user:null,session:null},error:new Wt}:(t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),{data:Object.assign({user:t.user,session:t.session},t.weak_password?{weakPassword:t.weak_password}:null),error:r})}catch(n){if(M(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOAuth(e){var n,t,r,s;return await this._removeSession(),await this._handleProviderSignIn(e.provider,{redirectTo:(n=e.options)===null||n===void 0?void 0:n.redirectTo,scopes:(t=e.options)===null||t===void 0?void 0:t.scopes,queryParams:(r=e.options)===null||r===void 0?void 0:r.queryParams,skipBrowserRedirect:(s=e.options)===null||s===void 0?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async _exchangeCodeForSession(e){const n=await _t(this.storage,`${this.storageKey}-code-verifier`),[t,r]=(n??"").split("/"),{data:s,error:o}=await F(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:t},xform:be});return await Vt(this.storage,`${this.storageKey}-code-verifier`),o?{data:{user:null,session:null,redirectType:null},error:o}:!s||!s.session||!s.user?{data:{user:null,session:null,redirectType:null},error:new Wt}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign(Object.assign({},s),{redirectType:r??null}),error:o})}async signInWithIdToken(e){await this._removeSession();try{const{options:n,provider:t,token:r,access_token:s,nonce:o}=e,l=await F(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:t,id_token:r,access_token:s,nonce:o,gotrue_meta_security:{captcha_token:n==null?void 0:n.captchaToken}},xform:be}),{data:a,error:u}=l;return u?{data:{user:null,session:null},error:u}:!a||!a.session||!a.user?{data:{user:null,session:null},error:new Wt}:(a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),{data:a,error:u})}catch(n){if(M(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOtp(e){var n,t,r,s,o;try{if(await this._removeSession(),"email"in e){const{email:l,options:a}=e;let u=null,c=null;this.flowType==="pkce"&&([u,c]=await Ne(this.storage,this.storageKey));const{error:h}=await F(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(n=a==null?void 0:a.data)!==null&&n!==void 0?n:{},create_user:(t=a==null?void 0:a.shouldCreateUser)!==null&&t!==void 0?t:!0,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken},code_challenge:u,code_challenge_method:c},redirectTo:a==null?void 0:a.emailRedirectTo});return{data:{user:null,session:null},error:h}}if("phone"in e){const{phone:l,options:a}=e,{data:u,error:c}=await F(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(r=a==null?void 0:a.data)!==null&&r!==void 0?r:{},create_user:(s=a==null?void 0:a.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken},channel:(o=a==null?void 0:a.channel)!==null&&o!==void 0?o:"sms"}});return{data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:c}}throw new gt("You must provide either an email or phone number.")}catch(l){if(M(l))return{data:{user:null,session:null},error:l};throw l}}async verifyOtp(e){var n,t;try{e.type!=="email_change"&&e.type!=="phone_change"&&await this._removeSession();let r,s;"options"in e&&(r=(n=e.options)===null||n===void 0?void 0:n.redirectTo,s=(t=e.options)===null||t===void 0?void 0:t.captchaToken);const{data:o,error:l}=await F(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:s}}),redirectTo:r,xform:be});if(l)throw l;if(!o)throw new Error("An error occurred on token verification.");const a=o.session,u=o.user;return a!=null&&a.access_token&&(await this._saveSession(a),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",a)),{data:{user:u,session:a},error:null}}catch(r){if(M(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithSSO(e){var n,t,r;try{await this._removeSession();let s=null,o=null;return this.flowType==="pkce"&&([s,o]=await Ne(this.storage,this.storageKey)),await F(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(t=(n=e.options)===null||n===void 0?void 0:n.redirectTo)!==null&&t!==void 0?t:void 0}),!((r=e==null?void 0:e.options)===null||r===void 0)&&r.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:s,code_challenge_method:o}),headers:this.headers,xform:mo})}catch(s){if(M(s))return{data:null,error:s};throw s}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:n},error:t}=e;if(t)throw t;if(!n)throw new je;const{error:r}=await F(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:n.access_token});return{data:{user:null,session:null},error:r}})}catch(e){if(M(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{e.type!="email_change"&&e.type!="phone_change"&&await this._removeSession();const n=`${this.url}/resend`;if("email"in e){const{email:t,type:r,options:s}=e,{error:o}=await F(this.fetch,"POST",n,{headers:this.headers,body:{email:t,type:r,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},redirectTo:s==null?void 0:s.emailRedirectTo});return{data:{user:null,session:null},error:o}}else if("phone"in e){const{phone:t,type:r,options:s}=e,{data:o,error:l}=await F(this.fetch,"POST",n,{headers:this.headers,body:{phone:t,type:r,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}}});return{data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:l}}throw new gt("You must provide either an email or phone number and a type")}catch(n){if(M(n))return{data:{user:null,session:null},error:n};throw n}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async n=>n))}async _acquireLock(e,n){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const t=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),r=(async()=>(await t,await n()))();return this.pendingInLock.push((async()=>{try{await r}catch{}})()),r}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const t=n();for(this.pendingInLock.push((async()=>{try{await t}catch{}})()),await t;this.pendingInLock.length;){const r=[...this.pendingInLock];await Promise.all(r),this.pendingInLock.splice(0,r.length)}return await t}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const n=await this.__loadSession();return await e(n)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const n=await _t(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",n),n!==null&&(this._isValidSession(n)?e=n:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const t=e.expires_at?e.expires_at<=Date.now()/1e3:!1;if(this._debug("#__loadSession()",`session has${t?"":" not"} expired`,"expires_at",e.expires_at),!t){if(this.storage.isServer){const o=this.suppressGetSessionWarning;e=new Proxy(e,{get(a,u,c){return!o&&u==="user"&&console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and many not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),Reflect.get(a,u,c)}})}return{data:{session:e},error:null}}const{session:r,error:s}=await this._callRefreshToken(e.refresh_token);return s?{data:{session:null},error:s}:{data:{session:r},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await F(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:ve}):await this._useSession(async n=>{var t,r,s;const{data:o,error:l}=n;if(l)throw l;return!(!((t=o.session)===null||t===void 0)&&t.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new je}:await F(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(s=(r=o.session)===null||r===void 0?void 0:r.access_token)!==null&&s!==void 0?s:void 0,xform:ve})})}catch(n){if(M(n))return{data:{user:null},error:n};throw n}}async updateUser(e,n={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,n))}async _updateUser(e,n={}){try{return await this._useSession(async t=>{const{data:r,error:s}=t;if(s)throw s;if(!r.session)throw new je;const o=r.session;let l=null,a=null;this.flowType==="pkce"&&e.email!=null&&([l,a]=await Ne(this.storage,this.storageKey));const{data:u,error:c}=await F(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:n==null?void 0:n.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:l,code_challenge_method:a}),jwt:o.access_token,xform:ve});if(c)throw c;return o.user=u.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}})}catch(t){if(M(t))return{data:{user:null},error:t};throw t}}_decodeJWT(e){return Wn(e)}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new je;const n=Date.now()/1e3;let t=n,r=!0,s=null;const o=Wn(e.access_token);if(o.exp&&(t=o.exp,r=t<=n),r){const{session:l,error:a}=await this._callRefreshToken(e.refresh_token);if(a)return{data:{user:null,session:null},error:a};if(!l)return{data:{user:null,session:null},error:null};s=l}else{const{data:l,error:a}=await this._getUser(e.access_token);if(a)throw a;s={access_token:e.access_token,refresh_token:e.refresh_token,user:l.user,token_type:"bearer",expires_in:t-n,expires_at:t},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return{data:{user:s.user,session:s},error:null}}catch(n){if(M(n))return{data:{session:null,user:null},error:n};throw n}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async n=>{var t;if(!e){const{data:o,error:l}=n;if(l)throw l;e=(t=o.session)!==null&&t!==void 0?t:void 0}if(!(e!=null&&e.refresh_token))throw new je;const{session:r,error:s}=await this._callRefreshToken(e.refresh_token);return s?{data:{user:null,session:null},error:s}:r?{data:{user:r.user,session:r},error:null}:{data:{user:null,session:null},error:null}})}catch(n){if(M(n))return{data:{user:null,session:null},error:n};throw n}}async _getSessionFromURL(e){try{if(!he())throw new $t("No browser detected.");if(this.flowType==="implicit"&&!this._isImplicitGrantFlow())throw new $t("Not a valid implicit grant flow url.");if(this.flowType=="pkce"&&!e)throw new Qn("Not a valid PKCE flow url.");const n=Gt(window.location.href);if(e){if(!n.code)throw new Qn("No code detected.");const{data:A,error:j}=await this._exchangeCodeForSession(n.code);if(j)throw j;const P=new URL(window.location.href);return P.searchParams.delete("code"),window.history.replaceState(window.history.state,"",P.toString()),{data:{session:A.session,redirectType:null},error:null}}if(n.error||n.error_description||n.error_code)throw new $t(n.error_description||"Error in URL with unspecified error_description",{error:n.error||"unspecified_error",code:n.error_code||"unspecified_code"});const{provider_token:t,provider_refresh_token:r,access_token:s,refresh_token:o,expires_in:l,expires_at:a,token_type:u}=n;if(!s||!l||!o||!u)throw new $t("No session defined in URL");const c=Math.round(Date.now()/1e3),h=parseInt(l);let p=c+h;a&&(p=parseInt(a));const f=p-c;f*1e3<=et&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${f}s, should have been closer to ${h}s`);const d=p-h;c-d>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",d,p,c):c-d<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clok for skew",d,p,c);const{data:g,error:S}=await this._getUser(s);if(S)throw S;const T={provider_token:t,provider_refresh_token:r,access_token:s,expires_in:h,expires_at:p,refresh_token:o,token_type:u,user:g.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:T,redirectType:n.type},error:null}}catch(n){if(M(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantFlow(){const e=Gt(window.location.href);return!!(he()&&(e.access_token||e.error_description))}async _isPKCEFlow(){const e=Gt(window.location.href),n=await _t(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&n)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async n=>{var t;const{data:r,error:s}=n;if(s)return{error:s};const o=(t=r.session)===null||t===void 0?void 0:t.access_token;if(o){const{error:l}=await this.admin.signOut(o,e);if(l&&!(uo(l)&&(l.status===404||l.status===401||l.status===403)))return{error:l}}return e!=="others"&&(await this._removeSession(),await Vt(this.storage,`${this.storageKey}-code-verifier`),await this._notifyAllSubscribers("SIGNED_OUT",null)),{error:null}})}onAuthStateChange(e){const n=Yi(),t={id:n,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",n),this.stateChangeEmitters.delete(n)}};return this._debug("#onAuthStateChange()","registered callback with id",n),this.stateChangeEmitters.set(n,t),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(n)})))(),{data:{subscription:t}}}async _emitInitialSession(e){return await this._useSession(async n=>{var t,r;try{const{data:{session:s},error:o}=n;if(o)throw o;await((t=this.stateChangeEmitters.get(e))===null||t===void 0?void 0:t.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",e,"session",s)}catch(s){await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",s),console.error(s)}})}async resetPasswordForEmail(e,n={}){let t=null,r=null;this.flowType==="pkce"&&([t,r]=await Ne(this.storage,this.storageKey,!0));try{return await F(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:t,code_challenge_method:r,gotrue_meta_security:{captcha_token:n.captchaToken}},headers:this.headers,redirectTo:n.redirectTo})}catch(s){if(M(s))return{data:null,error:s};throw s}}async getUserIdentities(){var e;try{const{data:n,error:t}=await this.getUser();if(t)throw t;return{data:{identities:(e=n.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(n){if(M(n))return{data:null,error:n};throw n}}async linkIdentity(e){var n;try{const{data:t,error:r}=await this._useSession(async s=>{var o,l,a,u,c;const{data:h,error:p}=s;if(p)throw p;const f=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(l=e.options)===null||l===void 0?void 0:l.scopes,queryParams:(a=e.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:!0});return await F(this.fetch,"GET",f,{headers:this.headers,jwt:(c=(u=h.session)===null||u===void 0?void 0:u.access_token)!==null&&c!==void 0?c:void 0})});if(r)throw r;return he()&&!(!((n=e.options)===null||n===void 0)&&n.skipBrowserRedirect)&&window.location.assign(t==null?void 0:t.url),{data:{provider:e.provider,url:t==null?void 0:t.url},error:null}}catch(t){if(M(t))return{data:{provider:e.provider,url:null},error:t};throw t}}async unlinkIdentity(e){try{return await this._useSession(async n=>{var t,r;const{data:s,error:o}=n;if(o)throw o;return await F(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(r=(t=s.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:void 0})})}catch(n){if(M(n))return{data:null,error:n};throw n}}async _refreshAccessToken(e){const n=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{const t=Date.now();return await eo(async r=>(r>0&&await xi(200*Math.pow(2,r-1)),this._debug(n,"refreshing attempt",r),await F(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:be})),(r,s)=>{const o=200*Math.pow(2,r);return s&&Qt(s)&&Date.now()+o-t<et})}catch(t){if(this._debug(n,"error",t),M(t))return{data:{session:null,user:null},error:t};throw t}finally{this._debug(n,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,n){const t=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:n.redirectTo,scopes:n.scopes,queryParams:n.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",n,"url",t),he()&&!n.skipBrowserRedirect&&window.location.assign(t),{data:{provider:e,url:t},error:null}}async _recoverAndRefresh(){var e;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const t=await _t(this.storage,this.storageKey);if(this._debug(n,"session from storage",t),!this._isValidSession(t)){this._debug(n,"session is not valid"),t!==null&&await this._removeSession();return}const r=Math.round(Date.now()/1e3),s=((e=t.expires_at)!==null&&e!==void 0?e:1/0)<r+Vn;if(this._debug(n,`session has${s?"":" not"} expired with margin of ${Vn}s`),s){if(this.autoRefreshToken&&t.refresh_token){const{error:o}=await this._callRefreshToken(t.refresh_token);o&&(console.error(o),Qt(o)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",t)}catch(t){this._debug(n,"error",t),console.error(t);return}finally{this._debug(n,"end")}}async _callRefreshToken(e){var n,t;if(!e)throw new je;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const r=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{this.refreshingDeferred=new At;const{data:s,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!s.session)throw new je;await this._saveSession(s.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",s.session);const l={session:s.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(s){if(this._debug(r,"error",s),M(s)){const o={session:null,error:s};return Qt(s)||(await this._removeSession(),await this._notifyAllSubscribers("SIGNED_OUT",null)),(n=this.refreshingDeferred)===null||n===void 0||n.resolve(o),o}throw(t=this.refreshingDeferred)===null||t===void 0||t.reject(s),s}finally{this.refreshingDeferred=null,this._debug(r,"end")}}async _notifyAllSubscribers(e,n,t=!0){const r=`#_notifyAllSubscribers(${e})`;this._debug(r,"begin",n,`broadcast = ${t}`);try{this.broadcastChannel&&t&&this.broadcastChannel.postMessage({event:e,session:n});const s=[],o=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(e,n)}catch(a){s.push(a)}});if(await Promise.all(o),s.length>0){for(let l=0;l<s.length;l+=1)console.error(s[l]);throw s[0]}}finally{this._debug(r,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await xr(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await Vt(this.storage,this.storageKey)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&he()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(n){console.error("removing visibilitychange callback failed",n)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),et);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async n=>{const{data:{session:t}}=n;if(!t||!t.refresh_token||!t.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const r=Math.floor((t.expires_at*1e3-e)/et);this._debug("#_autoRefreshTokenTick()",`access token expires in ${r} ticks, a tick lasts ${et}ms, refresh threshold is ${er} ticks`),r<=er&&await this._callRefreshToken(t.refresh_token)})}catch(n){console.error("Auto refresh tick failed with error. This is likely a transient error.",n)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof ts)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!he()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const n=`#_onVisibilityChanged(${e})`;this._debug(n,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(n,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,n,t){const r=[`provider=${encodeURIComponent(n)}`];if(t!=null&&t.redirectTo&&r.push(`redirect_to=${encodeURIComponent(t.redirectTo)}`),t!=null&&t.scopes&&r.push(`scopes=${encodeURIComponent(t.scopes)}`),this.flowType==="pkce"){const[s,o]=await Ne(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(s)}`,code_challenge_method:`${encodeURIComponent(o)}`});r.push(l.toString())}if(t!=null&&t.queryParams){const s=new URLSearchParams(t.queryParams);r.push(s.toString())}return t!=null&&t.skipBrowserRedirect&&r.push(`skip_http_redirect=${t.skipBrowserRedirect}`),`${e}?${r.join("&")}`}async _unenroll(e){try{return await this._useSession(async n=>{var t;const{data:r,error:s}=n;return s?{data:null,error:s}:await F(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(t=r==null?void 0:r.session)===null||t===void 0?void 0:t.access_token})})}catch(n){if(M(n))return{data:null,error:n};throw n}}async _enroll(e){try{return await this._useSession(async n=>{var t,r;const{data:s,error:o}=n;if(o)return{data:null,error:o};const{data:l,error:a}=await F(this.fetch,"POST",`${this.url}/factors`,{body:{friendly_name:e.friendlyName,factor_type:e.factorType,issuer:e.issuer},headers:this.headers,jwt:(t=s==null?void 0:s.session)===null||t===void 0?void 0:t.access_token});return a?{data:null,error:a}:(!((r=l==null?void 0:l.totp)===null||r===void 0)&&r.qr_code&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})})}catch(n){if(M(n))return{data:null,error:n};throw n}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var t;const{data:r,error:s}=n;if(s)return{data:null,error:s};const{data:o,error:l}=await F(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(t=r==null?void 0:r.session)===null||t===void 0?void 0:t.access_token});return l?{data:null,error:l}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:l})})}catch(n){if(M(n))return{data:null,error:n};throw n}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var t;const{data:r,error:s}=n;return s?{data:null,error:s}:await F(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{headers:this.headers,jwt:(t=r==null?void 0:r.session)===null||t===void 0?void 0:t.access_token})})}catch(n){if(M(n))return{data:null,error:n};throw n}})}async _challengeAndVerify(e){const{data:n,error:t}=await this._challenge({factorId:e.factorId});return t?{data:null,error:t}:await this._verify({factorId:e.factorId,challengeId:n.id,code:e.code})}async _listFactors(){const{data:{user:e},error:n}=await this.getUser();if(n)return{data:null,error:n};const t=(e==null?void 0:e.factors)||[],r=t.filter(s=>s.factor_type==="totp"&&s.status==="verified");return{data:{all:t,totp:r},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var n,t;const{data:{session:r},error:s}=e;if(s)return{data:null,error:s};if(!r)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const o=this._decodeJWT(r.access_token);let l=null;o.aal&&(l=o.aal);let a=l;((t=(n=r.user.factors)===null||n===void 0?void 0:n.filter(h=>h.status==="verified"))!==null&&t!==void 0?t:[]).length>0&&(a="aal2");const c=o.amr||[];return{data:{currentLevel:l,nextLevel:a,currentAuthenticationMethods:c},error:null}}))}}at.nextInstanceID=0;const Eo=at;class Oo extends Eo{constructor(e){super(e)}}var Ao=function(i,e,n,t){function r(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function l(c){try{u(t.next(c))}catch(h){o(h)}}function a(c){try{u(t.throw(c))}catch(h){o(h)}}function u(c){c.done?s(c.value):r(c.value).then(l,a)}u((t=t.apply(i,e||[])).next())})};class To{constructor(e,n,t){var r,s,o;if(this.supabaseUrl=e,this.supabaseKey=n,!e)throw new Error("supabaseUrl is required.");if(!n)throw new Error("supabaseKey is required.");const l=Ji(e);this.realtimeUrl=`${l}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${l}/auth/v1`,this.storageUrl=`${l}/storage/v1`,this.functionsUrl=`${l}/functions/v1`;const a=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,u={db:Ui,realtime:Bi,auth:Object.assign(Object.assign({},Ni),{storageKey:a}),global:qi},c=Ki(t??{},u);this.storageKey=(r=c.auth.storageKey)!==null&&r!==void 0?r:"",this.headers=(s=c.global.headers)!==null&&s!==void 0?s:{},this.auth=this._initSupabaseAuthClient((o=c.auth)!==null&&o!==void 0?o:{},this.headers,c.global.fetch),this.fetch=Hi(n,this._getAccessToken.bind(this),c.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers},c.realtime)),this.rest=new hn(`${l}/rest/v1`,{headers:this.headers,schema:c.db.schema,fetch:this.fetch}),this._listenForAuthEvents()}get functions(){return new Ys(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new Ri(this.storageUrl,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,n={},t={}){return this.rest.rpc(e,n,t)}channel(e,n={config:{}}){return this.realtime.channel(e,n)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,n;return Ao(this,void 0,void 0,function*(){const{data:t}=yield this.auth.getSession();return(n=(e=t.session)===null||e===void 0?void 0:e.access_token)!==null&&n!==void 0?n:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:n,detectSessionInUrl:t,storage:r,storageKey:s,flowType:o,debug:l},a,u){var c;const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Oo({url:this.authUrl,headers:Object.assign(Object.assign({},h),a),storageKey:s,autoRefreshToken:e,persistSession:n,detectSessionInUrl:t,storage:r,flowType:o,debug:l,fetch:u,hasCustomAuthorizationHeader:(c="Authorization"in this.headers)!==null&&c!==void 0?c:!1})}_initRealtimeClient(e){return new wi(this.realtimeUrl,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((n,t)=>{this._handleTokenChanged(n,"CLIENT",t==null?void 0:t.access_token)})}_handleTokenChanged(e,n,t){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==t?(this.realtime.setAuth(t??null),this.changedAccessToken=t):e==="SIGNED_OUT"&&(this.realtime.setAuth(this.supabaseKey),n=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const ns=(i,e,n)=>new To(i,e,n),rs="supabase-config",jo=()=>{const i=localStorage.getItem(rs);if(!i)return null;const e=JSON.parse(i);return ns(e.supabaseUrl,e.supabaseKey)};let Y=jo();const Po=i=>{Y=ns(i.supabaseUrl,i.supabaseKey),localStorage.setItem(rs,JSON.stringify(i))},wt=Et(null);function Io(i){let e,n,t,r;const s=i[2].default,o=Se(s,i,i[1],null);return{c(){e=O("button"),o&&o.c(),C(e,"class","text-blue-600 hover:text-blue-700")},m(l,a){y(l,e,a),o&&o.m(e,null),n=!0,t||(r=Qe(e,"click",function(){We(i[0])&&i[0].apply(this,arguments)}),t=!0)},p(l,[a]){i=l,o&&o.p&&(!n||a&2)&&Ee(o,s,i,i[1],n?Ce(s,i[1],a,null):Oe(i[1]),null)},i(l){n||(m(o,l),n=!0)},o(l){_(o,l),n=!1},d(l){l&&k(e),o&&o.d(l),t=!1,r()}}}function Ro(i,e,n){let{$$slots:t={},$$scope:r}=e,{onClick:s}=e;return i.$$set=o=>{"onClick"in o&&n(0,s=o.onClick),"$$scope"in o&&n(1,r=o.$$scope)},[s,r,t]}class _e extends N{constructor(e){super(),U(this,e,Ro,Io,D,{onClick:0})}}function Lo(i){let e,n;return{c(){e=ee("svg"),n=ee("path"),C(n,"stroke-linecap","round"),C(n,"stroke-linejoin","round"),C(n,"d","m2.25 12 8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25"),C(e,"xmlns","http://www.w3.org/2000/svg"),C(e,"fill","none"),C(e,"viewBox","0 0 24 24"),C(e,"stroke-width","1.5"),C(e,"stroke","currentColor"),C(e,"class","size-6 hover:stroke-2")},m(t,r){y(t,e,r),$(e,n)},p:L,d(t){t&&k(e)}}}function Do(i){let e,n;return e=new _e({props:{onClick:i[0],$$slots:{default:[Lo]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment)},m(t,r){b(e,t,r),n=!0},p(t,[r]){const s={};r&1&&(s.onClick=t[0]),r&2&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}function qo(i,e,n){let{onClick:t}=e;return i.$$set=r=>{"onClick"in r&&n(0,t=r.onClick)},[t]}class Uo extends N{constructor(e){super(),U(this,e,qo,Do,D,{onClick:0})}}function No(i){let e,n;return{c(){e=ee("svg"),n=ee("path"),C(n,"stroke-linecap","round"),C(n,"stroke-linejoin","round"),C(n,"d","m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"),C(e,"xmlns","http://www.w3.org/2000/svg"),C(e,"fill","none"),C(e,"viewBox","0 0 24 24"),C(e,"stroke-width","1.5"),C(e,"stroke","currentColor"),C(e,"class","size-6 hover:stroke-2")},m(t,r){y(t,e,r),$(e,n)},p:L,d(t){t&&k(e)}}}function Bo(i){let e,n;return e=new _e({props:{onClick:i[0],$$slots:{default:[No]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment)},m(t,r){b(e,t,r),n=!0},p(t,[r]){const s={};r&1&&(s.onClick=t[0]),r&2&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}function Mo(i,e,n){let{onClick:t}=e;return i.$$set=r=>{"onClick"in r&&n(0,t=r.onClick)},[t]}class Fo extends N{constructor(e){super(),U(this,e,Mo,Bo,D,{onClick:0})}}function zo(i){let e,n;return{c(){e=ee("svg"),n=ee("path"),C(n,"stroke-linecap","round"),C(n,"stroke-linejoin","round"),C(n,"d","M12 6.042A8.967 8.967 0 0 0 6 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 0 1 6 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 0 1 6-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0 0 18 18a8.967 8.967 0 0 0-6 2.292m0-14.25v14.25"),C(e,"xmlns","http://www.w3.org/2000/svg"),C(e,"fill","none"),C(e,"viewBox","0 0 24 24"),C(e,"stroke-width","1.5"),C(e,"stroke","currentColor"),C(e,"class","size-6 hover:stroke-2")},m(t,r){y(t,e,r),$(e,n)},p:L,d(t){t&&k(e)}}}function Ho(i){let e,n;return e=new _e({props:{onClick:i[0],$$slots:{default:[zo]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment)},m(t,r){b(e,t,r),n=!0},p(t,[r]){const s={};r&1&&(s.onClick=t[0]),r&2&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}function Jo(i,e,n){let{onClick:t}=e;return i.$$set=r=>{"onClick"in r&&n(0,t=r.onClick)},[t]}class Ko extends N{constructor(e){super(),U(this,e,Jo,Ho,D,{onClick:0})}}function Go(i){let e,n;return{c(){e=ee("svg"),n=ee("path"),C(n,"stroke-linecap","round"),C(n,"stroke-linejoin","round"),C(n,"d","M6 6.878V6a2.25 2.25 0 0 1 2.25-2.25h7.5A2.25 2.25 0 0 1 18 6v.878m-12 0c.235-.083.487-.128.75-.128h10.5c.263 0 .515.045.75.128m-12 0A2.25 2.25 0 0 0 4.5 9v.878m13.5-3A2.25 2.25 0 0 1 19.5 9v.878m0 0a2.246 2.246 0 0 0-.75-.128H5.25c-.263 0-.515.045-.75.128m15 0A2.25 2.25 0 0 1 21 12v6a2.25 2.25 0 0 1-2.25 2.25H5.25A2.25 2.25 0 0 1 3 18v-6c0-.98.626-1.813 1.5-2.122"),C(e,"xmlns","http://www.w3.org/2000/svg"),C(e,"fill","none"),C(e,"viewBox","0 0 24 24"),C(e,"stroke-width","1.5"),C(e,"stroke","currentColor"),C(e,"class","size-6 hover:stroke-2")},m(t,r){y(t,e,r),$(e,n)},p:L,d(t){t&&k(e)}}}function Vo(i){let e,n;return e=new _e({props:{onClick:i[0],$$slots:{default:[Go]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment)},m(t,r){b(e,t,r),n=!0},p(t,[r]){const s={};r&1&&(s.onClick=t[0]),r&2&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}function Wo(i,e,n){let{onClick:t}=e;return i.$$set=r=>{"onClick"in r&&n(0,t=r.onClick)},[t]}class Qo extends N{constructor(e){super(),U(this,e,Wo,Vo,D,{onClick:0})}}function Yo(i){let e,n;return{c(){e=ee("svg"),n=ee("path"),C(n,"stroke-linecap","round"),C(n,"stroke-linejoin","round"),C(n,"d","M15.75 9V5.25A2.25 2.25 0 0 0 13.5 3h-6a2.25 2.25 0 0 0-2.25 2.25v13.5A2.25 2.25 0 0 0 7.5 21h6a2.25 2.25 0 0 0 2.25-2.25V15m3 0 3-3m0 0-3-3m3 3H9"),C(e,"xmlns","http://www.w3.org/2000/svg"),C(e,"fill","none"),C(e,"viewBox","0 0 24 24"),C(e,"stroke-width","1.5"),C(e,"stroke","currentColor"),C(e,"class","size-6 hover:stroke-2")},m(t,r){y(t,e,r),$(e,n)},p:L,d(t){t&&k(e)}}}function Xo(i){let e,n;return e=new _e({props:{onClick:i[0],$$slots:{default:[Yo]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment)},m(t,r){b(e,t,r),n=!0},p(t,[r]){const s={};r&1&&(s.onClick=t[0]),r&2&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}function Zo(i,e,n){let{onClick:t}=e;return i.$$set=r=>{"onClick"in r&&n(0,t=r.onClick)},[t]}class xo extends N{constructor(e){super(),U(this,e,Zo,Xo,D,{onClick:0})}}function ea(i){let e,n;return{c(){e=ee("svg"),n=ee("path"),C(n,"stroke-linecap","round"),C(n,"stroke-linejoin","round"),C(n,"d","M15.75 6a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0ZM4.501 20.118a7.5 7.5 0 0 1 14.998 0A17.933 17.933 0 0 1 12 21.75c-2.676 0-5.216-.584-7.499-1.632Z"),C(e,"xmlns","http://www.w3.org/2000/svg"),C(e,"fill","none"),C(e,"viewBox","0 0 24 24"),C(e,"stroke-width","1.5"),C(e,"stroke","currentColor"),C(e,"class","size-6 hover:stroke-2")},m(t,r){y(t,e,r),$(e,n)},p:L,d(t){t&&k(e)}}}function ta(i){let e,n;return e=new _e({props:{onClick:i[0],$$slots:{default:[ea]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment)},m(t,r){b(e,t,r),n=!0},p(t,[r]){const s={};r&1&&(s.onClick=t[0]),r&2&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}function na(i,e,n){let{onClick:t}=e;return i.$$set=r=>{"onClick"in r&&n(0,t=r.onClick)},[t]}class ra extends N{constructor(e){super(),U(this,e,na,ta,D,{onClick:0})}}function sa(i){let e,n,t,r,s,o,l,a,u,c,h,p,f;return n=new Uo({props:{onClick:i[1]}}),r=new Ko({props:{onClick:i[2]}}),o=new Qo({props:{onClick:i[3]}}),a=new Fo({props:{onClick:i[4]}}),c=new ra({props:{onClick:i[5]}}),p=new xo({props:{onClick:i[0]}}),{c(){e=O("nav"),v(n.$$.fragment),t=E(),v(r.$$.fragment),s=E(),v(o.$$.fragment),l=E(),v(a.$$.fragment),u=E(),v(c.$$.fragment),h=E(),v(p.$$.fragment),C(e,"class","flex justify-end items-center gap-2 mb-4")},m(d,g){y(d,e,g),b(n,e,null),$(e,t),b(r,e,null),$(e,s),b(o,e,null),$(e,l),b(a,e,null),$(e,u),b(c,e,null),$(e,h),b(p,e,null),f=!0},p(d,[g]){const S={};g&1&&(S.onClick=d[0]),p.$set(S)},i(d){f||(m(n.$$.fragment,d),m(r.$$.fragment,d),m(o.$$.fragment,d),m(a.$$.fragment,d),m(c.$$.fragment,d),m(p.$$.fragment,d),f=!0)},o(d){_(n.$$.fragment,d),_(r.$$.fragment,d),_(o.$$.fragment,d),_(a.$$.fragment,d),_(c.$$.fragment,d),_(p.$$.fragment,d),f=!1},d(d){d&&k(e),w(n),w(r),w(o),w(a),w(c),w(p)}}}function ia(i,e,n){let{onLogout:t}=e;const r=()=>H("/"),s=()=>H("/books/list"),o=()=>H("/cache"),l=()=>H("/search"),a=()=>H("/user");return i.$$set=u=>{"onLogout"in u&&n(0,t=u.onLogout)},[t,r,s,o,l,a]}class oa extends N{constructor(e){super(),U(this,e,ia,sa,D,{onLogout:0})}}const ie=i=>new Date(i).toLocaleString(),ue=i=>i?"":"Please enter a value!",aa=(i,e)=>Math.floor(Math.random()*(e-i+1)+i),la=i=>{for(let e=0;e<i.length;e++){const n=aa(0,i.length-1);if(e===n)continue;const t=i[e];i[e]=i[n],i[n]=t}},ss=i=>(i=i.trim(),i||null);function ua(i){let e,n,t,r;const s=i[2].default,o=Se(s,i,i[1],null);return{c(){e=O("form"),o&&o.c(),C(e,"class","flex flex-col gap-5 max-w-md")},m(l,a){y(l,e,a),o&&o.m(e,null),n=!0,t||(r=Qe(e,"submit",fs(function(){We(i[0])&&i[0].apply(this,arguments)})),t=!0)},p(l,[a]){i=l,o&&o.p&&(!n||a&2)&&Ee(o,s,i,i[1],n?Ce(s,i[1],a,null):Oe(i[1]),null)},i(l){n||(m(o,l),n=!0)},o(l){_(o,l),n=!1},d(l){l&&k(e),o&&o.d(l),t=!1,r()}}}function ca(i,e,n){let{$$slots:t={},$$scope:r}=e,{onSubmit:s}=e;return i.$$set=o=>{"onSubmit"in o&&n(0,s=o.onSubmit),"$$scope"in o&&n(1,r=o.$$scope)},[s,r,t]}class ge extends N{constructor(e){super(),U(this,e,ca,ua,D,{onSubmit:0})}}function nr(i){let e,n;return{c(){e=O("p"),n=R(i[2]),C(e,"class","text-red-600 text-sm mt-1")},m(t,r){y(t,e,r),$(e,n)},p(t,r){r&4&&B(n,t[2])},d(t){t&&k(e)}}}function fa(i){let e,n,t,r,s,o;const l=i[4].default,a=Se(l,i,i[3],null);let u=i[2]&&nr(i);return{c(){e=O("div"),n=O("label"),t=R(i[1]),r=E(),a&&a.c(),s=E(),u&&u.c(),C(n,"class","block text-gray-700 text-sm font-bold mb-2"),C(n,"for",i[0])},m(c,h){y(c,e,h),$(e,n),$(n,t),$(e,r),a&&a.m(e,null),$(e,s),u&&u.m(e,null),o=!0},p(c,[h]){(!o||h&2)&&B(t,c[1]),(!o||h&1)&&C(n,"for",c[0]),a&&a.p&&(!o||h&8)&&Ee(a,l,c,c[3],o?Ce(l,c[3],h,null):Oe(c[3]),null),c[2]?u?u.p(c,h):(u=nr(c),u.c(),u.m(e,null)):u&&(u.d(1),u=null)},i(c){o||(m(a,c),o=!0)},o(c){_(a,c),o=!1},d(c){c&&k(e),a&&a.d(c),u&&u.d()}}}function ha(i,e,n){let{$$slots:t={},$$scope:r}=e,{id:s}=e,{label:o}=e,{error:l}=e;return i.$$set=a=>{"id"in a&&n(0,s=a.id),"label"in a&&n(1,o=a.label),"error"in a&&n(2,l=a.error),"$$scope"in a&&n(3,r=a.$$scope)},[s,o,l,r,t]}class _n extends N{constructor(e){super(),U(this,e,ha,fa,D,{id:0,label:1,error:2})}}function da(i){let e,n,t;return{c(){e=O("input"),C(e,"class","input"),C(e,"id",i[2])},m(r,s){y(r,e,s),Je(e,i[0]),n||(t=Qe(e,"input",i[4]),n=!0)},p(r,s){s&4&&C(e,"id",r[2]),s&1&&e.value!==r[0]&&Je(e,r[0])},d(r){r&&k(e),n=!1,t()}}}function pa(i){let e,n;return e=new _n({props:{id:i[2],label:i[1],error:i[3],$$slots:{default:[da]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment)},m(t,r){b(e,t,r),n=!0},p(t,[r]){const s={};r&4&&(s.id=t[2]),r&2&&(s.label=t[1]),r&8&&(s.error=t[3]),r&37&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}function ma(i,e,n){let{label:t}=e,{id:r}=e,{value:s}=e,{error:o=""}=e;function l(){s=this.value,n(0,s)}return i.$$set=a=>{"label"in a&&n(1,t=a.label),"id"in a&&n(2,r=a.id),"value"in a&&n(0,s=a.value),"error"in a&&n(3,o=a.error)},[s,t,r,o,l]}class ye extends N{constructor(e){super(),U(this,e,ma,pa,D,{label:1,id:2,value:0,error:3})}}function _a(i){let e,n;return e=new z({props:{label:"Save"}}),{c(){v(e.$$.fragment)},m(t,r){b(e,t,r),n=!0},p:L,i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}function ga(i){let e,n,t,r,s,o,l,a;function u(f){i[6](f)}let c={id:"url",label:"Supabase URL",error:i[1]};i[0]!==void 0&&(c.value=i[0]),e=new ye({props:c}),x.push(()=>ne(e,"value",u));function h(f){i[7](f)}let p={id:"key",label:"Supabase key",error:i[3]};return i[2]!==void 0&&(p.value=i[2]),r=new ye({props:p}),x.push(()=>ne(r,"value",h)),l=new Z({props:{$$slots:{default:[_a]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment),t=E(),v(r.$$.fragment),o=E(),v(l.$$.fragment)},m(f,d){b(e,f,d),y(f,t,d),b(r,f,d),y(f,o,d),b(l,f,d),a=!0},p(f,d){const g={};d&2&&(g.error=f[1]),!n&&d&1&&(n=!0,g.value=f[0],te(()=>n=!1)),e.$set(g);const S={};d&8&&(S.error=f[3]),!s&&d&4&&(s=!0,S.value=f[2],te(()=>s=!1)),r.$set(S);const T={};d&256&&(T.$$scope={dirty:d,ctx:f}),l.$set(T)},i(f){a||(m(e.$$.fragment,f),m(r.$$.fragment,f),m(l.$$.fragment,f),a=!0)},o(f){_(e.$$.fragment,f),_(r.$$.fragment,f),_(l.$$.fragment,f),a=!1},d(f){f&&(k(t),k(o)),w(e,f),w(r,f),w(l,f)}}}function $a(i){let e,n;return e=new ge({props:{onSubmit:i[4],$$slots:{default:[ga]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment)},m(t,r){b(e,t,r),n=!0},p(t,[r]){const s={};r&271&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}function ba(i,e,n){let{onConfig:t}=e,r="",s="",o="",l="";const a=()=>{n(1,s=ue(r)),n(3,l=ue(o)),!(s||l)&&t({supabaseUrl:r,supabaseKey:o})};function u(h){r=h,n(0,r)}function c(h){o=h,n(2,o)}return i.$$set=h=>{"onConfig"in h&&n(5,t=h.onConfig)},[r,s,o,l,a,t,u,c]}class wa extends N{constructor(e){super(),U(this,e,ba,$a,D,{onConfig:5})}}function va(i){let e,n;return e=new ge({props:{onSubmit:i[4],$$slots:{default:[Sa]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment)},m(t,r){b(e,t,r),n=!0},p(t,r){const s={};r&71&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}function ka(i){let e,n,t;return{c(){e=O("div"),e.textContent="Magic link was successfully send!",n=E(),t=O("div"),t.textContent="Please check your E-Mail"},m(r,s){y(r,e,s),y(r,n,s),y(r,t,s)},p:L,i:L,o:L,d(r){r&&(k(e),k(n),k(t))}}}function ya(i){let e,n;return e=new z({props:{disabled:i[2],label:"Magic Link"}}),{c(){v(e.$$.fragment)},m(t,r){b(e,t,r),n=!0},p(t,r){const s={};r&4&&(s.disabled=t[2]),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}function Sa(i){let e,n,t,r,s;function o(a){i[5](a)}let l={id:"email",label:"E-Mail",error:i[1]};return i[0]!==void 0&&(l.value=i[0]),e=new ye({props:l}),x.push(()=>ne(e,"value",o)),r=new Z({props:{$$slots:{default:[ya]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment),t=E(),v(r.$$.fragment)},m(a,u){b(e,a,u),y(a,t,u),b(r,a,u),s=!0},p(a,u){const c={};u&2&&(c.error=a[1]),!n&&u&1&&(n=!0,c.value=a[0],te(()=>n=!1)),e.$set(c);const h={};u&68&&(h.$$scope={dirty:u,ctx:a}),r.$set(h)},i(a){s||(m(e.$$.fragment,a),m(r.$$.fragment,a),s=!0)},o(a){_(e.$$.fragment,a),_(r.$$.fragment,a),s=!1},d(a){a&&k(t),w(e,a),w(r,a)}}}function Ca(i){let e,n,t,r;const s=[ka,va],o=[];function l(a,u){return a[3]?0:1}return e=l(i),n=o[e]=s[e](i),{c(){n.c(),t=X()},m(a,u){o[e].m(a,u),y(a,t,u),r=!0},p(a,[u]){let c=e;e=l(a),e===c?o[e].p(a,u):(K(),_(o[c],1,1,()=>{o[c]=null}),G(),n=o[e],n?n.p(a,u):(n=o[e]=s[e](a),n.c()),m(n,1),n.m(t.parentNode,t))},i(a){r||(m(n),r=!0)},o(a){_(n),r=!1},d(a){a&&k(t),o[e].d(a)}}}function Ea(i,e,n){let t="",r="",s=!1,o=!1;const l=async()=>{if(n(1,r=ue(t)),r)return;n(2,s=!0);const{data:u,error:c}=await Y.auth.signInWithOtp({email:t});if(n(2,s=!1),c){W.setAuthError(c);return}u&&(console.log("data",u),n(3,o=!0))};function a(u){t=u,n(0,t)}return[t,r,s,o,l,a]}class Oa extends N{constructor(e){super(),U(this,e,Ea,Ca,D,{})}}function Aa(i){let e;return{c(){e=O("div"),e.innerHTML='<svg class="h-8 w-8 animate-spin text-blue-600" viewBox="0 0 100 100"><circle fill="none" stroke-width="10" class="stroke-current opacity-40" cx="50" cy="50" r="40"></circle><circle fill="none" stroke-width="10" class="stroke-current" stroke-dasharray="250" stroke-dashoffset="210" cx="50" cy="50" r="40"></circle></svg>',C(e,"class","flex justify-center")},m(n,t){y(n,e,t)},p:L,i:L,o:L,d(n){n&&k(e)}}}class Ta extends N{constructor(e){super(),U(this,e,null,Aa,D,{})}}function ja(i){let e,n,t;e=new oa({props:{onLogout:i[4]}});const r=i[6].default,s=Se(r,i,i[5],null);return{c(){v(e.$$.fragment),n=E(),s&&s.c()},m(o,l){b(e,o,l),y(o,n,l),s&&s.m(o,l),t=!0},p(o,l){s&&s.p&&(!t||l&32)&&Ee(s,r,o,o[5],t?Ce(r,o[5],l,null):Oe(o[5]),null)},i(o){t||(m(e.$$.fragment,o),m(s,o),t=!0)},o(o){_(e.$$.fragment,o),_(s,o),t=!1},d(o){o&&k(n),w(e,o),s&&s.d(o)}}}function Pa(i){let e,n,t,r;const s=[La,Ra],o=[];function l(a,u){return a[1]?0:1}return e=l(i),n=o[e]=s[e](i),{c(){n.c(),t=X()},m(a,u){o[e].m(a,u),y(a,t,u),r=!0},p(a,u){let c=e;e=l(a),e!==c&&(K(),_(o[c],1,1,()=>{o[c]=null}),G(),n=o[e],n||(n=o[e]=s[e](a),n.c()),m(n,1),n.m(t.parentNode,t))},i(a){r||(m(n),r=!0)},o(a){_(n),r=!1},d(a){a&&k(t),o[e].d(a)}}}function Ia(i){let e,n;return e=new wa({props:{onConfig:i[3]}}),{c(){v(e.$$.fragment)},m(t,r){b(e,t,r),n=!0},p:L,i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}function Ra(i){let e,n;return e=new Ta({}),{c(){v(e.$$.fragment)},m(t,r){b(e,t,r),n=!0},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}function La(i){let e,n;return e=new Oa({}),{c(){v(e.$$.fragment)},m(t,r){b(e,t,r),n=!0},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}function Da(i){let e,n,t,r;const s=[Ia,Pa,ja],o=[];function l(a,u){return a[0]?a[2]?2:1:0}return e=l(i),n=o[e]=s[e](i),{c(){n.c(),t=X()},m(a,u){o[e].m(a,u),y(a,t,u),r=!0},p(a,[u]){let c=e;e=l(a),e===c?o[e].p(a,u):(K(),_(o[c],1,1,()=>{o[c]=null}),G(),n=o[e],n?n.p(a,u):(n=o[e]=s[e](a),n.c()),m(n,1),n.m(t.parentNode,t))},i(a){r||(m(n),r=!0)},o(a){_(n),r=!1},d(a){a&&k(t),o[e].d(a)}}}function qa(i,e,n){let t;an(i,wt,h=>n(2,t=h));let{$$slots:r={},$$scope:s}=e,o=!1,l=!1;const a=()=>Y?(Y.auth.onAuthStateChange((h,p)=>{console.log("auth changed:",p==null?void 0:p.user),p!=null&&p.user?wt.set(p.user):wt.set(null),n(1,l=!0)}),!0):(console.log("supabase is not initialized!"),!1),u=h=>{Po(h),n(0,o=a())},c=()=>{Y&&t&&Y.auth.signOut()};return pe(()=>{n(0,o=a())}),i.$$set=h=>{"$$scope"in h&&n(5,s=h.$$scope)},[o,l,t,u,c,s,r]}class Ua extends N{constructor(e){super(),U(this,e,qa,Da,D,{})}}function Na(i){let e,n;return{c(){e=O("h2"),n=R(i[0]),C(e,"class","text-2xl font-extrabold")},m(t,r){y(t,e,r),$(e,n)},p(t,[r]){r&1&&B(n,t[0])},i:L,o:L,d(t){t&&k(e)}}}function Ba(i,e,n){let{header:t}=e;return i.$$set=r=>{"header"in r&&n(0,t=r.header)},[t]}class oe extends N{constructor(e){super(),U(this,e,Ba,Na,D,{header:0})}}const ft="cache-",is=()=>{const i=[];for(let e in localStorage)e.startsWith(ft)&&i.push(e);return i.sort()},Ma=()=>{const i=[];for(let e in localStorage)e.startsWith(ft)&&localStorage.removeItem(e);return i},Fa=i=>(localStorage.removeItem(i),is()),za=ft+"questions",Tt=i=>`${za}#${i}`,Ha=async i=>{let{data:e,error:n}=await Y.from("questions").select("*").eq("id",i).single();return n&&W.setDBError(n),e||null},ht=async i=>{const e=Tt(i),n=localStorage.getItem(e);if(n)return JSON.parse(n);let{data:t,error:r}=await Y.from("questions").select("*").eq("chapter_id",i).order("id");return r&&W.setDBError(r),t?(localStorage.setItem(e,JSON.stringify(t)),t):[]},Ja=async(i,e)=>{const{error:n}=await Y.from("questions").delete().eq("id",i);return n?(W.setDBError(n),[]):(localStorage.removeItem(Tt(e)),ht(e))},Ka=async(i,e,n,t)=>{const{error:r}=await Y.from("questions").insert([{chapter_id:i,quest:e,answer:n,details:t}]);if(r)return W.setDBError(r),[];localStorage.removeItem(Tt(i))},Ga=async(i,e,n,t,r)=>{const{error:s}=await Y.from("questions").update({quest:n,answer:t,details:r}).eq("id",i);return s?(W.setDBError(s),[]):(localStorage.removeItem(Tt(e)),ht(e))},Yt=10,Va=async(i,e)=>{const{data:n,error:t}=await Y.from("questions").select().ilike(e,`%${i}%`).limit(Yt+1);return t?(W.setDBError(t),{questions:[],hasMore:!1}):(console.log("search-like:",i,"where:",e,"data:",n),{questions:n.slice(0,Yt),hasMore:n.length==Yt+1})},lt="session",Wa=(i,e,n)=>{if(i.length==0)return;const t=i.map(s=>({question:s,progress:e}));la(t);const r={learning:t,learned:[],reverse:n};localStorage.setItem(lt,JSON.stringify(r))},os=()=>{const i=localStorage.getItem(lt);return i?JSON.parse(i):null},Qa=i=>i.learning.length>0?(localStorage.setItem(lt,JSON.stringify(i)),!0):(localStorage.removeItem(lt),!1),Ya=()=>{localStorage.removeItem(lt)},rr=i=>{const e=[0,0,0,i.learned.length];return i.learning.forEach(n=>{if(n.progress>2)throw Error(`Invalid progress ${n.progress}`);e[n.progress]++}),e},Xa=()=>{let i=-1,e=[];return async n=>{n.chapter_id!==i&&(i=n.chapter_id,e=await ht(i),console.log("loaded chapter for refresh:",i));const t=e.find(r=>r.id===n.id);return t===void 0?(W.setString("Unable to refresh lession!",`Question not found: ${n.id}`),n):t}},Za=async i=>{let e=Xa();for(let n of i.learned)n.question=await e(n.question);for(let n of i.learning)n.question=await e(n.question);return i};function xa(i){let e,n;const t=i[1].default,r=Se(t,i,i[0],null);return{c(){e=O("div"),r&&r.c(),C(e,"class","flex flex-col gap-5")},m(s,o){y(s,e,o),r&&r.m(e,null),n=!0},p(s,[o]){r&&r.p&&(!n||o&1)&&Ee(r,t,s,s[0],n?Ce(t,s[0],o,null):Oe(s[0]),null)},i(s){n||(m(r,s),n=!0)},o(s){_(r,s),n=!1},d(s){s&&k(e),r&&r.d(s)}}}function el(i,e,n){let{$$slots:t={},$$scope:r}=e;return i.$$set=s=>{"$$scope"in s&&n(0,r=s.$$scope)},[r,t]}class ae extends N{constructor(e){super(),U(this,e,el,xa,D,{})}}function sr(i){let e,n;return e=new Z({props:{$$slots:{default:[tl]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment)},m(t,r){b(e,t,r),n=!0},p(t,r){const s={};r&8&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}function tl(i){let e,n,t,r;return e=new z({props:{label:"Continue",onClick:i[1]}}),t=new z({props:{label:"End",onClick:i[2]}}),{c(){v(e.$$.fragment),n=E(),v(t.$$.fragment)},m(s,o){b(e,s,o),y(s,n,o),b(t,s,o),r=!0},p:L,i(s){r||(m(e.$$.fragment,s),m(t.$$.fragment,s),r=!0)},o(s){_(e.$$.fragment,s),_(t.$$.fragment,s),r=!1},d(s){s&&k(n),w(e,s),w(t,s)}}}function nl(i){let e,n,t,r;e=new oe({props:{header:"Home"}});let s=i[0]&&sr(i);return{c(){v(e.$$.fragment),n=E(),s&&s.c(),t=X()},m(o,l){b(e,o,l),y(o,n,l),s&&s.m(o,l),y(o,t,l),r=!0},p(o,l){o[0]?s?(s.p(o,l),l&1&&m(s,1)):(s=sr(o),s.c(),m(s,1),s.m(t.parentNode,t)):s&&(K(),_(s,1,1,()=>{s=null}),G())},i(o){r||(m(e.$$.fragment,o),m(s),r=!0)},o(o){_(e.$$.fragment,o),_(s),r=!1},d(o){o&&(k(n),k(t)),w(e,o),s&&s.d(o)}}}function rl(i){let e,n;return e=new ae({props:{$$slots:{default:[nl]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment)},m(t,r){b(e,t,r),n=!0},p(t,[r]){const s={};r&9&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}function sl(i,e,n){let t=!1;const r=()=>{H("/lession/process")},s=()=>{Ya(),n(0,t=!1)};return pe(()=>{os()&&n(0,t=!0)}),[t,r,s]}class il extends N{constructor(e){super(),U(this,e,sl,rl,D,{})}}function ol(i){let e,n;return{c(){e=ee("svg"),n=ee("path"),C(n,"stroke-linecap","round"),C(n,"stroke-linejoin","round"),C(n,"d","m9.75 9.75 4.5 4.5m0-4.5-4.5 4.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"),C(e,"xmlns","http://www.w3.org/2000/svg"),C(e,"fill","none"),C(e,"viewBox","0 0 24 24"),C(e,"stroke-width","1.5"),C(e,"stroke","currentColor"),C(e,"class","size-6 hover:stroke-2")},m(t,r){y(t,e,r),$(e,n)},p:L,d(t){t&&k(e)}}}function al(i){let e,n;return e=new _e({props:{onClick:i[0],$$slots:{default:[ol]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment)},m(t,r){b(e,t,r),n=!0},p(t,[r]){const s={};r&1&&(s.onClick=t[0]),r&2&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}function ll(i,e,n){let{onClick:t}=e;return i.$$set=r=>{"onClick"in r&&n(0,t=r.onClick)},[t]}class jt extends N{constructor(e){super(),U(this,e,ll,al,D,{onClick:0})}}function ir(i,e,n){const t=i.slice();return t[4]=e[n],t}function ul(i){let e;return{c(){e=R("Cache is empty!")},m(n,t){y(n,e,t)},p:L,i:L,o:L,d(n){n&&k(e)}}}function cl(i){let e,n,t,r,s,o,l,a=se(i[0]),u=[];for(let h=0;h<a.length;h+=1)u[h]=or(ir(i,a,h));const c=h=>_(u[h],1,1,()=>{u[h]=null});return o=new Z({props:{$$slots:{default:[hl]},$$scope:{ctx:i}}}),{c(){e=O("table"),n=O("thead"),n.innerHTML="<tr><th>Cache Key</th> <th>Actions</th></tr>",t=E(),r=O("tbody");for(let h=0;h<u.length;h+=1)u[h].c();s=E(),v(o.$$.fragment),C(e,"class","w-full")},m(h,p){y(h,e,p),$(e,n),$(e,t),$(e,r);for(let f=0;f<u.length;f+=1)u[f]&&u[f].m(r,null);y(h,s,p),b(o,h,p),l=!0},p(h,p){if(p&1){a=se(h[0]);let d;for(d=0;d<a.length;d+=1){const g=ir(h,a,d);u[d]?(u[d].p(g,p),m(u[d],1)):(u[d]=or(g),u[d].c(),m(u[d],1),u[d].m(r,null))}for(K(),d=a.length;d<u.length;d+=1)c(d);G()}const f={};p&129&&(f.$$scope={dirty:p,ctx:h}),o.$set(f)},i(h){if(!l){for(let p=0;p<a.length;p+=1)m(u[p]);m(o.$$.fragment,h),l=!0}},o(h){u=u.filter(Boolean);for(let p=0;p<u.length;p+=1)_(u[p]);_(o.$$.fragment,h),l=!1},d(h){h&&(k(e),k(s)),Ae(u,h),w(o,h)}}}function fl(i){let e,n;function t(){return i[1](i[4])}return e=new jt({props:{onClick:t}}),{c(){v(e.$$.fragment)},m(r,s){b(e,r,s),n=!0},p(r,s){i=r;const o={};s&1&&(o.onClick=t),e.$set(o)},i(r){n||(m(e.$$.fragment,r),n=!0)},o(r){_(e.$$.fragment,r),n=!1},d(r){w(e,r)}}}function or(i){let e,n,t=i[4]+"",r,s,o,l,a,u;return l=new Z({props:{$$slots:{default:[fl]},$$scope:{ctx:i}}}),{c(){e=O("tr"),n=O("td"),r=R(t),s=E(),o=O("td"),v(l.$$.fragment),a=E()},m(c,h){y(c,e,h),$(e,n),$(n,r),$(e,s),$(e,o),b(l,o,null),$(e,a),u=!0},p(c,h){(!u||h&1)&&t!==(t=c[4]+"")&&B(r,t);const p={};h&129&&(p.$$scope={dirty:h,ctx:c}),l.$set(p)},i(c){u||(m(l.$$.fragment,c),u=!0)},o(c){_(l.$$.fragment,c),u=!1},d(c){c&&k(e),w(l)}}}function hl(i){let e,n,t,r;return e=new z({props:{onClick:i[2],label:"Cancel"}}),t=new z({props:{onClick:i[3],label:"Delete all"}}),{c(){v(e.$$.fragment),n=E(),v(t.$$.fragment)},m(s,o){b(e,s,o),y(s,n,o),b(t,s,o),r=!0},p(s,o){const l={};o&1&&(l.onClick=s[3]),t.$set(l)},i(s){r||(m(e.$$.fragment,s),m(t.$$.fragment,s),r=!0)},o(s){_(e.$$.fragment,s),_(t.$$.fragment,s),r=!1},d(s){s&&k(n),w(e,s),w(t,s)}}}function dl(i){let e,n,t,r,s,o;e=new oe({props:{header:"Cache"}});const l=[cl,ul],a=[];function u(c,h){return c[0].length>0?0:1}return t=u(i),r=a[t]=l[t](i),{c(){v(e.$$.fragment),n=E(),r.c(),s=X()},m(c,h){b(e,c,h),y(c,n,h),a[t].m(c,h),y(c,s,h),o=!0},p(c,h){let p=t;t=u(c),t===p?a[t].p(c,h):(K(),_(a[p],1,1,()=>{a[p]=null}),G(),r=a[t],r?r.p(c,h):(r=a[t]=l[t](c),r.c()),m(r,1),r.m(s.parentNode,s))},i(c){o||(m(e.$$.fragment,c),m(r),o=!0)},o(c){_(e.$$.fragment,c),_(r),o=!1},d(c){c&&(k(n),k(s)),w(e,c),a[t].d(c)}}}function pl(i){let e,n;return e=new ae({props:{$$slots:{default:[dl]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment)},m(t,r){b(e,t,r),n=!0},p(t,[r]){const s={};r&129&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}function ml(i,e,n){let t=[];return pe(()=>{n(0,t=is())}),[t,l=>{n(0,t=Fa(l))},()=>H("/"),()=>n(0,t=Ma())]}class _l extends N{constructor(e){super(),U(this,e,ml,pl,D,{})}}function gl(i){let e,n,t,r;return e=new oe({props:{header:"Not Found"}}),{c(){v(e.$$.fragment),n=E(),t=O("div"),t.textContent="Not Found"},m(s,o){b(e,s,o),y(s,n,o),y(s,t,o),r=!0},p:L,i(s){r||(m(e.$$.fragment,s),r=!0)},o(s){_(e.$$.fragment,s),r=!1},d(s){s&&(k(n),k(t)),w(e,s)}}}function $l(i){let e,n;return e=new ae({props:{$$slots:{default:[gl]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment)},m(t,r){b(e,t,r),n=!0},p(t,[r]){const s={};r&1&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}class bl extends N{constructor(e){super(),U(this,e,null,$l,D,{})}}const ut=ft+"books",Pt=async i=>{let{data:e,error:n}=await Y.from("books").select("*").eq("id",i).single();return n&&W.setDBError(n),e||null},gn=async()=>{const i=localStorage.getItem(ut);if(i)return JSON.parse(i);let{data:e,error:n}=await Y.from("books").select("*");return n&&W.setDBError(n),e?(localStorage.setItem(ut,JSON.stringify(e)),e):[]},wl=async i=>{const{error:e}=await Y.from("books").delete().eq("id",i);return e?(W.setDBError(e),[]):(localStorage.removeItem(ut),gn())},vl=async(i,e)=>{const{error:n}=await Y.from("books").insert([{name:i,description:e}]);if(n)return W.setDBError(n),[];localStorage.removeItem(ut)},kl=async(i,e,n)=>{const{error:t}=await Y.from("books").update({name:e,description:n}).eq("id",i);return t?(W.setDBError(t),[]):(localStorage.removeItem(ut),gn())};function yl(i){let e,n;return{c(){e=ee("svg"),n=ee("path"),C(n,"stroke-linecap","round"),C(n,"stroke-linejoin","round"),C(n,"d","M3.75 12h16.5m-16.5 3.75h16.5M3.75 19.5h16.5M5.625 4.5h12.75a1.875 1.875 0 0 1 0 3.75H5.625a1.875 1.875 0 0 1 0-3.75Z"),C(e,"xmlns","http://www.w3.org/2000/svg"),C(e,"fill","none"),C(e,"viewBox","0 0 24 24"),C(e,"stroke-width","1.5"),C(e,"stroke","currentColor"),C(e,"class","size-6 hover:stroke-2")},m(t,r){y(t,e,r),$(e,n)},p:L,d(t){t&&k(e)}}}function Sl(i){let e,n;return e=new _e({props:{onClick:i[0],$$slots:{default:[yl]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment)},m(t,r){b(e,t,r),n=!0},p(t,[r]){const s={};r&1&&(s.onClick=t[0]),r&2&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}function Cl(i,e,n){let{onClick:t}=e;return i.$$set=r=>{"onClick"in r&&n(0,t=r.onClick)},[t]}class as extends N{constructor(e){super(),U(this,e,Cl,Sl,D,{onClick:0})}}function El(i){let e,n;return{c(){e=ee("svg"),n=ee("path"),C(n,"stroke-linecap","round"),C(n,"stroke-linejoin","round"),C(n,"d","m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"),C(e,"xmlns","http://www.w3.org/2000/svg"),C(e,"fill","none"),C(e,"viewBox","0 0 24 24"),C(e,"stroke-width","1.5"),C(e,"stroke","currentColor"),C(e,"class","size-6 hover:stroke-2")},m(t,r){y(t,e,r),$(e,n)},p:L,d(t){t&&k(e)}}}function Ol(i){let e,n;return e=new _e({props:{onClick:i[0],$$slots:{default:[El]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment)},m(t,r){b(e,t,r),n=!0},p(t,[r]){const s={};r&1&&(s.onClick=t[0]),r&2&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}function Al(i,e,n){let{onClick:t}=e;return i.$$set=r=>{"onClick"in r&&n(0,t=r.onClick)},[t]}class $n extends N{constructor(e){super(),U(this,e,Al,Ol,D,{onClick:0})}}function ar(i){let e,n;return e=new Hr({props:{title:i[1],buttons:i[2],$$slots:{default:[Tl]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment)},m(t,r){b(e,t,r),n=!0},p(t,r){const s={};r&2&&(s.title=t[1]),r&9&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}function Tl(i){let e=i[0].getMessage(i[0])+"",n;return{c(){n=R(e)},m(t,r){y(t,n,r)},p(t,r){r&1&&e!==(e=t[0].getMessage(t[0])+"")&&B(n,e)},d(t){t&&k(n)}}}function jl(i){let e,n,t=i[0].entry&&ar(i);return{c(){t&&t.c(),e=X()},m(r,s){t&&t.m(r,s),y(r,e,s),n=!0},p(r,[s]){r[0].entry?t?(t.p(r,s),s&1&&m(t,1)):(t=ar(r),t.c(),m(t,1),t.m(e.parentNode,e)):t&&(K(),_(t,1,1,()=>{t=null}),G())},i(r){n||(m(t),n=!0)},o(r){_(t),n=!1},d(r){r&&k(e),t&&t.d(r)}}}function Pl(i,e,n){let{title:t}=e,{deleteEntry:r}=e;const s=[{label:"Close",onclick:()=>{n(0,r.entry=null,r)}},{label:"Delete",onclick:()=>{r.entry&&(r.onDelete(r.entry),n(0,r.entry=null,r))}}];return i.$$set=o=>{"title"in o&&n(1,t=o.title),"deleteEntry"in o&&n(0,r=o.deleteEntry)},[r,t,s]}class bn extends N{constructor(e){super(),U(this,e,Pl,jl,D,{title:1,deleteEntry:0})}}function lr(i,e,n){const t=i.slice();return t[7]=e[n],t}function Il(i){let e,n,t,r,s,o;function l(){return i[2](i[7])}e=new jt({props:{onClick:l}});function a(){return i[3](i[7])}t=new $n({props:{onClick:a}});function u(){return i[4](i[7])}return s=new as({props:{onClick:u}}),{c(){v(e.$$.fragment),n=E(),v(t.$$.fragment),r=E(),v(s.$$.fragment)},m(c,h){b(e,c,h),y(c,n,h),b(t,c,h),y(c,r,h),b(s,c,h),o=!0},p(c,h){i=c;const p={};h&3&&(p.onClick=l),e.$set(p);const f={};h&1&&(f.onClick=a),t.$set(f);const d={};h&1&&(d.onClick=u),s.$set(d)},i(c){o||(m(e.$$.fragment,c),m(t.$$.fragment,c),m(s.$$.fragment,c),o=!0)},o(c){_(e.$$.fragment,c),_(t.$$.fragment,c),_(s.$$.fragment,c),o=!1},d(c){c&&(k(n),k(r)),w(e,c),w(t,c),w(s,c)}}}function ur(i){let e,n,t=i[7].id+"",r,s,o,l=i[7].name+"",a,u,c,h=i[7].description+"",p,f,d,g=ie(i[7].modified)+"",S,T,A,j,P,I;return j=new Z({props:{$$slots:{default:[Il]},$$scope:{ctx:i}}}),{c(){e=O("tr"),n=O("td"),r=R(t),s=E(),o=O("td"),a=R(l),u=E(),c=O("td"),p=R(h),f=E(),d=O("td"),S=R(g),T=E(),A=O("td"),v(j.$$.fragment),P=E()},m(q,J){y(q,e,J),$(e,n),$(n,r),$(e,s),$(e,o),$(o,a),$(e,u),$(e,c),$(c,p),$(e,f),$(e,d),$(d,S),$(e,T),$(e,A),b(j,A,null),$(e,P),I=!0},p(q,J){(!I||J&1)&&t!==(t=q[7].id+"")&&B(r,t),(!I||J&1)&&l!==(l=q[7].name+"")&&B(a,l),(!I||J&1)&&h!==(h=q[7].description+"")&&B(p,h),(!I||J&1)&&g!==(g=ie(q[7].modified)+"")&&B(S,g);const Q={};J&1027&&(Q.$$scope={dirty:J,ctx:q}),j.$set(Q)},i(q){I||(m(j.$$.fragment,q),I=!0)},o(q){_(j.$$.fragment,q),I=!1},d(q){q&&k(e),w(j)}}}function Rl(i){let e,n,t,r;return e=new z({props:{onClick:i[5],label:"Cancel"}}),t=new z({props:{onClick:i[6],label:"Create"}}),{c(){v(e.$$.fragment),n=E(),v(t.$$.fragment)},m(s,o){b(e,s,o),y(s,n,o),b(t,s,o),r=!0},p:L,i(s){r||(m(e.$$.fragment,s),m(t.$$.fragment,s),r=!0)},o(s){_(e.$$.fragment,s),_(t.$$.fragment,s),r=!1},d(s){s&&k(n),w(e,s),w(t,s)}}}function Ll(i){let e,n,t,r,s,o,l,a,u;e=new oe({props:{header:"List Books"}});let c=se(i[0]),h=[];for(let f=0;f<c.length;f+=1)h[f]=ur(lr(i,c,f));const p=f=>_(h[f],1,1,()=>{h[f]=null});return a=new Z({props:{$$slots:{default:[Rl]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment),n=E(),t=O("table"),r=O("thead"),r.innerHTML="<tr><th>ID</th> <th>Name</th> <th>Description</th> <th>Modified</th> <th>Actions</th></tr>",s=E(),o=O("tbody");for(let f=0;f<h.length;f+=1)h[f].c();l=E(),v(a.$$.fragment),C(t,"class","w-full")},m(f,d){b(e,f,d),y(f,n,d),y(f,t,d),$(t,r),$(t,s),$(t,o);for(let g=0;g<h.length;g+=1)h[g]&&h[g].m(o,null);y(f,l,d),b(a,f,d),u=!0},p(f,d){if(d&3){c=se(f[0]);let S;for(S=0;S<c.length;S+=1){const T=lr(f,c,S);h[S]?(h[S].p(T,d),m(h[S],1)):(h[S]=ur(T),h[S].c(),m(h[S],1),h[S].m(o,null))}for(K(),S=c.length;S<h.length;S+=1)p(S);G()}const g={};d&1024&&(g.$$scope={dirty:d,ctx:f}),a.$set(g)},i(f){if(!u){m(e.$$.fragment,f);for(let d=0;d<c.length;d+=1)m(h[d]);m(a.$$.fragment,f),u=!0}},o(f){_(e.$$.fragment,f),h=h.filter(Boolean);for(let d=0;d<h.length;d+=1)_(h[d]);_(a.$$.fragment,f),u=!1},d(f){f&&(k(n),k(t),k(l)),w(e,f),Ae(h,f),w(a,f)}}}function Dl(i){let e,n,t,r;return e=new ae({props:{$$slots:{default:[Ll]},$$scope:{ctx:i}}}),t=new bn({props:{title:"Delete Book",deleteEntry:i[1]}}),{c(){v(e.$$.fragment),n=E(),v(t.$$.fragment)},m(s,o){b(e,s,o),y(s,n,o),b(t,s,o),r=!0},p(s,[o]){const l={};o&1027&&(l.$$scope={dirty:o,ctx:s}),e.$set(l);const a={};o&2&&(a.deleteEntry=s[1]),t.$set(a)},i(s){r||(m(e.$$.fragment,s),m(t.$$.fragment,s),r=!0)},o(s){_(e.$$.fragment,s),_(t.$$.fragment,s),r=!1},d(s){s&&k(n),w(e,s),w(t,s)}}}function ql(i,e,n){let t=[],r={entry:null,onDelete:c=>{wl(c.id).then(h=>{n(0,t=h)})},getMessage:c=>`Do you wnat to delete the book: '${c.id}'?`};return pe(async()=>{n(0,t=await gn())}),[t,r,async c=>{n(1,r.entry=c,r)},c=>{H("/books/update/"+c.id)},c=>{H("/chapters/list/"+c.id)},()=>H("/books/list"),()=>H("/books/create")]}class Ul extends N{constructor(e){super(),U(this,e,ql,Dl,D,{})}}function Nl(i){let e,n,t;return{c(){e=O("textarea"),C(e,"class","input"),C(e,"id",i[2])},m(r,s){y(r,e,s),Je(e,i[0]),n||(t=Qe(e,"input",i[4]),n=!0)},p(r,s){s&4&&C(e,"id",r[2]),s&1&&Je(e,r[0])},d(r){r&&k(e),n=!1,t()}}}function Bl(i){let e,n;return e=new _n({props:{id:i[2],label:i[1],error:i[3],$$slots:{default:[Nl]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment)},m(t,r){b(e,t,r),n=!0},p(t,[r]){const s={};r&4&&(s.id=t[2]),r&2&&(s.label=t[1]),r&8&&(s.error=t[3]),r&37&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}function Ml(i,e,n){let{label:t}=e,{id:r}=e,{value:s}=e,{error:o}=e;function l(){s=this.value,n(0,s)}return i.$$set=a=>{"label"in a&&n(1,t=a.label),"id"in a&&n(2,r=a.id),"value"in a&&n(0,s=a.value),"error"in a&&n(3,o=a.error)},[s,t,r,o,l]}class ke extends N{constructor(e){super(),U(this,e,Ml,Bl,D,{label:1,id:2,value:0,error:3})}}function Fl(i){let e,n,t,r;return e=new z({props:{onClick:i[7],label:"Cancel"}}),t=new z({props:{label:"Create"}}),{c(){v(e.$$.fragment),n=E(),v(t.$$.fragment)},m(s,o){b(e,s,o),y(s,n,o),b(t,s,o),r=!0},p:L,i(s){r||(m(e.$$.fragment,s),m(t.$$.fragment,s),r=!0)},o(s){_(e.$$.fragment,s),_(t.$$.fragment,s),r=!1},d(s){s&&k(n),w(e,s),w(t,s)}}}function zl(i){let e,n,t,r,s,o,l,a;function u(f){i[5](f)}let c={id:"name",label:"Book name",error:i[1]};i[0]!==void 0&&(c.value=i[0]),e=new ye({props:c}),x.push(()=>ne(e,"value",u));function h(f){i[6](f)}let p={id:"description",label:"Book description",error:i[3]};return i[2]!==void 0&&(p.value=i[2]),r=new ke({props:p}),x.push(()=>ne(r,"value",h)),l=new Z({props:{$$slots:{default:[Fl]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment),t=E(),v(r.$$.fragment),o=E(),v(l.$$.fragment)},m(f,d){b(e,f,d),y(f,t,d),b(r,f,d),y(f,o,d),b(l,f,d),a=!0},p(f,d){const g={};d&2&&(g.error=f[1]),!n&&d&1&&(n=!0,g.value=f[0],te(()=>n=!1)),e.$set(g);const S={};d&8&&(S.error=f[3]),!s&&d&4&&(s=!0,S.value=f[2],te(()=>s=!1)),r.$set(S);const T={};d&256&&(T.$$scope={dirty:d,ctx:f}),l.$set(T)},i(f){a||(m(e.$$.fragment,f),m(r.$$.fragment,f),m(l.$$.fragment,f),a=!0)},o(f){_(e.$$.fragment,f),_(r.$$.fragment,f),_(l.$$.fragment,f),a=!1},d(f){f&&(k(t),k(o)),w(e,f),w(r,f),w(l,f)}}}function Hl(i){let e,n,t,r;return e=new oe({props:{header:"Create Book"}}),t=new ge({props:{onSubmit:i[4],$$slots:{default:[zl]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment),n=E(),v(t.$$.fragment)},m(s,o){b(e,s,o),y(s,n,o),b(t,s,o),r=!0},p(s,o){const l={};o&271&&(l.$$scope={dirty:o,ctx:s}),t.$set(l)},i(s){r||(m(e.$$.fragment,s),m(t.$$.fragment,s),r=!0)},o(s){_(e.$$.fragment,s),_(t.$$.fragment,s),r=!1},d(s){s&&k(n),w(e,s),w(t,s)}}}function Jl(i){let e,n;return e=new ae({props:{$$slots:{default:[Hl]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment)},m(t,r){b(e,t,r),n=!0},p(t,[r]){const s={};r&271&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}function Kl(i,e,n){let t="",r="",s="",o="";const l=async()=>{n(1,r=ue(t)),n(3,o=ue(s)),!(r||o)&&(await vl(t,s),H("/books/list"))};function a(h){t=h,n(0,t)}function u(h){s=h,n(2,s)}return[t,r,s,o,l,a,u,()=>H("/books/list")]}class Gl extends N{constructor(e){super(),U(this,e,Kl,Jl,D,{})}}function cr(i){let e,n,t=i[0].id+"",r,s,o,l=ie(i[0].modified)+"",a,u,c,h;return c=new ge({props:{onSubmit:i[5],$$slots:{default:[Wl]},$$scope:{ctx:i}}}),{c(){e=O("div"),n=O("span"),r=R(t),s=E(),o=O("span"),a=R(l),u=E(),v(c.$$.fragment),C(e,"class","mb-4 text-small")},m(p,f){y(p,e,f),$(e,n),$(n,r),$(e,s),$(e,o),$(o,a),y(p,u,f),b(c,p,f),h=!0},p(p,f){(!h||f&1)&&t!==(t=p[0].id+"")&&B(r,t),(!h||f&1)&&l!==(l=ie(p[0].modified)+"")&&B(a,l);const d={};f&1054&&(d.$$scope={dirty:f,ctx:p}),c.$set(d)},i(p){h||(m(c.$$.fragment,p),h=!0)},o(p){_(c.$$.fragment,p),h=!1},d(p){p&&(k(e),k(u)),w(c,p)}}}function Vl(i){let e,n,t,r;return e=new z({props:{onClick:i[9],label:"Cancel"}}),t=new z({props:{label:"Update"}}),{c(){v(e.$$.fragment),n=E(),v(t.$$.fragment)},m(s,o){b(e,s,o),y(s,n,o),b(t,s,o),r=!0},p:L,i(s){r||(m(e.$$.fragment,s),m(t.$$.fragment,s),r=!0)},o(s){_(e.$$.fragment,s),_(t.$$.fragment,s),r=!1},d(s){s&&k(n),w(e,s),w(t,s)}}}function Wl(i){let e,n,t,r,s,o,l,a;function u(f){i[7](f)}let c={id:"name",label:"Book name",error:i[2]};i[1]!==void 0&&(c.value=i[1]),e=new ye({props:c}),x.push(()=>ne(e,"value",u));function h(f){i[8](f)}let p={id:"description",label:"Book description",error:i[4]};return i[3]!==void 0&&(p.value=i[3]),r=new ke({props:p}),x.push(()=>ne(r,"value",h)),l=new Z({props:{$$slots:{default:[Vl]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment),t=E(),v(r.$$.fragment),o=E(),v(l.$$.fragment)},m(f,d){b(e,f,d),y(f,t,d),b(r,f,d),y(f,o,d),b(l,f,d),a=!0},p(f,d){const g={};d&4&&(g.error=f[2]),!n&&d&2&&(n=!0,g.value=f[1],te(()=>n=!1)),e.$set(g);const S={};d&16&&(S.error=f[4]),!s&&d&8&&(s=!0,S.value=f[3],te(()=>s=!1)),r.$set(S);const T={};d&1024&&(T.$$scope={dirty:d,ctx:f}),l.$set(T)},i(f){a||(m(e.$$.fragment,f),m(r.$$.fragment,f),m(l.$$.fragment,f),a=!0)},o(f){_(e.$$.fragment,f),_(r.$$.fragment,f),_(l.$$.fragment,f),a=!1},d(f){f&&(k(t),k(o)),w(e,f),w(r,f),w(l,f)}}}function Ql(i){let e,n,t,r;e=new oe({props:{header:"Update Book"}});let s=i[0]&&cr(i);return{c(){v(e.$$.fragment),n=E(),s&&s.c(),t=X()},m(o,l){b(e,o,l),y(o,n,l),s&&s.m(o,l),y(o,t,l),r=!0},p(o,l){o[0]?s?(s.p(o,l),l&1&&m(s,1)):(s=cr(o),s.c(),m(s,1),s.m(t.parentNode,t)):s&&(K(),_(s,1,1,()=>{s=null}),G())},i(o){r||(m(e.$$.fragment,o),m(s),r=!0)},o(o){_(e.$$.fragment,o),_(s),r=!1},d(o){o&&(k(n),k(t)),w(e,o),s&&s.d(o)}}}function Yl(i){let e,n;return e=new ae({props:{$$slots:{default:[Ql]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment)},m(t,r){b(e,t,r),n=!0},p(t,[r]){const s={};r&1055&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}function Xl(i,e,n){let{params:t={id:""}}=e,r=null,s="",o="",l="",a="";const u=async()=>{if(n(2,o=ue(s)),n(4,a=ue(l)),!(o||a)){if(!r){W.setString("No book!!");return}await kl(r.id,s,l),H("/books/list")}};pe(async()=>{n(0,r=await Pt(parseInt(t.id))),r&&(n(1,s=r.name),n(3,l=r.description))});function c(f){s=f,n(1,s)}function h(f){l=f,n(3,l)}const p=()=>H("/books/list");return i.$$set=f=>{"params"in f&&n(6,t=f.params)},[r,s,o,l,a,u,t,c,h,p]}class Zl extends N{constructor(e){super(),U(this,e,Xl,Yl,D,{params:6})}}const xl=ft+"chapters",It=i=>`${xl}#${i}`,wn=async i=>{let{data:e,error:n}=await Y.from("chapters").select("*").eq("id",i).single();return n&&W.setDBError(n),e||null},vn=async i=>{const e=It(i),n=localStorage.getItem(e);if(n)return JSON.parse(n);let{data:t,error:r}=await Y.from("chapters").select("*").eq("book_id",i).order("id");return r&&W.setDBError(r),t?(localStorage.setItem(e,JSON.stringify(t)),t):[]},eu=async(i,e)=>{const{error:n}=await Y.from("chapters").delete().eq("id",i);return n?(W.setDBError(n),[]):(localStorage.removeItem(It(e)),vn(e))},tu=async(i,e,n)=>{const{error:t}=await Y.from("chapters").update({name:n}).eq("id",i);return t?(W.setDBError(t),[]):(localStorage.removeItem(It(e)),vn(e))},nu=async(i,e)=>{const{error:n}=await Y.from("chapters").insert([{book_id:i,name:e}]);if(n)return W.setDBError(n),[];localStorage.removeItem(It(i))};function ru(i){let e,n;const t=i[1].default,r=Se(t,i,i[0],null);return{c(){e=O("div"),r&&r.c(),C(e,"class","border rounded shadow px-4 py-4")},m(s,o){y(s,e,o),r&&r.m(e,null),n=!0},p(s,[o]){r&&r.p&&(!n||o&1)&&Ee(r,t,s,s[0],n?Ce(t,s[0],o,null):Oe(s[0]),null)},i(s){n||(m(r,s),n=!0)},o(s){_(r,s),n=!1},d(s){s&&k(e),r&&r.d(s)}}}function su(i,e,n){let{$$slots:t={},$$scope:r}=e;return i.$$set=s=>{"$$scope"in s&&n(0,r=s.$$scope)},[r,t]}class iu extends N{constructor(e){super(),U(this,e,su,ru,D,{})}}function fr(i){let e,n,t,r=i[0].name+"",s,o,l,a,u=i[0].id+"",c,h,p=ie(i[0].modified)+"",f,d,g=i[0].description&&hr(i);return{c(){e=O("div"),n=O("div"),t=O("div"),s=R(r),o=E(),l=O("div"),a=R("Book-Id: "),c=R(u),h=R(" - Modified: "),f=R(p),d=E(),g&&g.c(),C(t,"class","text-lg font-semibold"),C(l,"class","text-sm"),C(n,"class","flex justify-between mb-2")},m(S,T){y(S,e,T),$(e,n),$(n,t),$(t,s),$(n,o),$(n,l),$(l,a),$(l,c),$(l,h),$(l,f),$(e,d),g&&g.m(e,null)},p(S,T){T&1&&r!==(r=S[0].name+"")&&B(s,r),T&1&&u!==(u=S[0].id+"")&&B(c,u),T&1&&p!==(p=ie(S[0].modified)+"")&&B(f,p),S[0].description?g?g.p(S,T):(g=hr(S),g.c(),g.m(e,null)):g&&(g.d(1),g=null)},d(S){S&&k(e),g&&g.d()}}}function hr(i){let e,n=i[0].description+"",t;return{c(){e=O("p"),t=R(n),C(e,"class","mt-2 pt-2 border-t text-sm")},m(r,s){y(r,e,s),$(e,t)},p(r,s){s&1&&n!==(n=r[0].description+"")&&B(t,n)},d(r){r&&k(e)}}}function dr(i){let e,n,t=i[1].name+"",r,s,o,l,a=i[1].id+"",u,c,h=ie(i[1].modified)+"",p;return{c(){e=O("div"),n=O("div"),r=R(t),s=E(),o=O("div"),l=R("Chapter-Id: "),u=R(a),c=R(" - Modified: "),p=R(h),C(n,"class","text font-medium"),C(o,"class","text-sm"),C(e,"class","flex justify-between mb-2")},m(f,d){y(f,e,d),$(e,n),$(n,r),$(e,s),$(e,o),$(o,l),$(o,u),$(o,c),$(o,p)},p(f,d){d&2&&t!==(t=f[1].name+"")&&B(r,t),d&2&&a!==(a=f[1].id+"")&&B(u,a),d&2&&h!==(h=ie(f[1].modified)+"")&&B(p,h)},d(f){f&&k(e)}}}function ou(i){let e,n,t=i[0]&&fr(i),r=i[1]&&dr(i);return{c(){e=O("div"),t&&t.c(),n=E(),r&&r.c(),C(e,"class","flex flex-col gap-5")},m(s,o){y(s,e,o),t&&t.m(e,null),$(e,n),r&&r.m(e,null)},p(s,o){s[0]?t?t.p(s,o):(t=fr(s),t.c(),t.m(e,n)):t&&(t.d(1),t=null),s[1]?r?r.p(s,o):(r=dr(s),r.c(),r.m(e,null)):r&&(r.d(1),r=null)},d(s){s&&k(e),t&&t.d(),r&&r.d()}}}function au(i){let e,n;return e=new iu({props:{$$slots:{default:[ou]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment)},m(t,r){b(e,t,r),n=!0},p(t,[r]){const s={};r&7&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}function lu(i,e,n){let{book:t=null}=e,{chapter:r=null}=e;return i.$$set=s=>{"book"in s&&n(0,t=s.book),"chapter"in s&&n(1,r=s.chapter)},[t,r]}class kn extends N{constructor(e){super(),U(this,e,lu,au,D,{book:0,chapter:1})}}function uu(i){let e,n;return{c(){e=ee("svg"),n=ee("path"),C(n,"stroke-linecap","round"),C(n,"stroke-linejoin","round"),C(n,"d","m12.75 15 3-3m0 0-3-3m3 3h-7.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"),C(e,"xmlns","http://www.w3.org/2000/svg"),C(e,"fill","none"),C(e,"viewBox","0 0 24 24"),C(e,"stroke-width","1.5"),C(e,"stroke","currentColor"),C(e,"class","size-6 hover:stroke-2")},m(t,r){y(t,e,r),$(e,n)},p:L,d(t){t&&k(e)}}}function cu(i){let e,n;return e=new _e({props:{onClick:i[0],$$slots:{default:[uu]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment)},m(t,r){b(e,t,r),n=!0},p(t,[r]){const s={};r&1&&(s.onClick=t[0]),r&2&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}function fu(i,e,n){let{onClick:t}=e;return i.$$set=r=>{"onClick"in r&&n(0,t=r.onClick)},[t]}class hu extends N{constructor(e){super(),U(this,e,fu,cu,D,{onClick:0})}}function pr(i,e,n){const t=i.slice();return t[10]=e[n],t}function du(i){let e,n,t,r,s,o,l,a;function u(){return i[4](i[10])}e=new jt({props:{onClick:u}});function c(){return i[5](i[10])}t=new $n({props:{onClick:c}});function h(){return i[6](i[10])}s=new as({props:{onClick:h}});function p(){return i[7](i[10])}return l=new hu({props:{onClick:p}}),{c(){v(e.$$.fragment),n=E(),v(t.$$.fragment),r=E(),v(s.$$.fragment),o=E(),v(l.$$.fragment)},m(f,d){b(e,f,d),y(f,n,d),b(t,f,d),y(f,r,d),b(s,f,d),y(f,o,d),b(l,f,d),a=!0},p(f,d){i=f;const g={};d&12&&(g.onClick=u),e.$set(g);const S={};d&4&&(S.onClick=c),t.$set(S);const T={};d&4&&(T.onClick=h),s.$set(T);const A={};d&4&&(A.onClick=p),l.$set(A)},i(f){a||(m(e.$$.fragment,f),m(t.$$.fragment,f),m(s.$$.fragment,f),m(l.$$.fragment,f),a=!0)},o(f){_(e.$$.fragment,f),_(t.$$.fragment,f),_(s.$$.fragment,f),_(l.$$.fragment,f),a=!1},d(f){f&&(k(n),k(r),k(o)),w(e,f),w(t,f),w(s,f),w(l,f)}}}function mr(i){let e,n,t=i[10].id+"",r,s,o,l=i[10].name+"",a,u,c,h=ie(i[10].modified)+"",p,f,d,g,S,T;return g=new Z({props:{$$slots:{default:[du]},$$scope:{ctx:i}}}),{c(){e=O("tr"),n=O("td"),r=R(t),s=E(),o=O("td"),a=R(l),u=E(),c=O("td"),p=R(h),f=E(),d=O("td"),v(g.$$.fragment),S=E()},m(A,j){y(A,e,j),$(e,n),$(n,r),$(e,s),$(e,o),$(o,a),$(e,u),$(e,c),$(c,p),$(e,f),$(e,d),b(g,d,null),$(e,S),T=!0},p(A,j){(!T||j&4)&&t!==(t=A[10].id+"")&&B(r,t),(!T||j&4)&&l!==(l=A[10].name+"")&&B(a,l),(!T||j&4)&&h!==(h=ie(A[10].modified)+"")&&B(p,h);const P={};j&8204&&(P.$$scope={dirty:j,ctx:A}),g.$set(P)},i(A){T||(m(g.$$.fragment,A),T=!0)},o(A){_(g.$$.fragment,A),T=!1},d(A){A&&k(e),w(g)}}}function pu(i){let e,n,t,r;return e=new z({props:{onClick:i[8],label:"Cancel"}}),t=new z({props:{onClick:i[9],label:"Create"}}),{c(){v(e.$$.fragment),n=E(),v(t.$$.fragment)},m(s,o){b(e,s,o),y(s,n,o),b(t,s,o),r=!0},p(s,o){const l={};o&1&&(l.onClick=s[9]),t.$set(l)},i(s){r||(m(e.$$.fragment,s),m(t.$$.fragment,s),r=!0)},o(s){_(e.$$.fragment,s),_(t.$$.fragment,s),r=!1},d(s){s&&k(n),w(e,s),w(t,s)}}}function mu(i){let e,n,t,r,s,o,l,a,u,c,h;e=new oe({props:{header:"List Chapters"}}),t=new kn({props:{book:i[1]}});let p=se(i[2]),f=[];for(let g=0;g<p.length;g+=1)f[g]=mr(pr(i,p,g));const d=g=>_(f[g],1,1,()=>{f[g]=null});return c=new Z({props:{$$slots:{default:[pu]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment),n=E(),v(t.$$.fragment),r=E(),s=O("table"),o=O("thead"),o.innerHTML="<tr><th>ID</th> <th>Name</th> <th>Modified</th> <th>Actions</th></tr>",l=E(),a=O("tbody");for(let g=0;g<f.length;g+=1)f[g].c();u=E(),v(c.$$.fragment),C(s,"class","w-full")},m(g,S){b(e,g,S),y(g,n,S),b(t,g,S),y(g,r,S),y(g,s,S),$(s,o),$(s,l),$(s,a);for(let T=0;T<f.length;T+=1)f[T]&&f[T].m(a,null);y(g,u,S),b(c,g,S),h=!0},p(g,S){const T={};if(S&2&&(T.book=g[1]),t.$set(T),S&12){p=se(g[2]);let j;for(j=0;j<p.length;j+=1){const P=pr(g,p,j);f[j]?(f[j].p(P,S),m(f[j],1)):(f[j]=mr(P),f[j].c(),m(f[j],1),f[j].m(a,null))}for(K(),j=p.length;j<f.length;j+=1)d(j);G()}const A={};S&8193&&(A.$$scope={dirty:S,ctx:g}),c.$set(A)},i(g){if(!h){m(e.$$.fragment,g),m(t.$$.fragment,g);for(let S=0;S<p.length;S+=1)m(f[S]);m(c.$$.fragment,g),h=!0}},o(g){_(e.$$.fragment,g),_(t.$$.fragment,g),f=f.filter(Boolean);for(let S=0;S<f.length;S+=1)_(f[S]);_(c.$$.fragment,g),h=!1},d(g){g&&(k(n),k(r),k(s),k(u)),w(e,g),w(t,g),Ae(f,g),w(c,g)}}}function _u(i){let e,n,t,r;return e=new ae({props:{$$slots:{default:[mu]},$$scope:{ctx:i}}}),t=new bn({props:{title:"Delete Chapter",deleteEntry:i[3]}}),{c(){v(e.$$.fragment),n=E(),v(t.$$.fragment)},m(s,o){b(e,s,o),y(s,n,o),b(t,s,o),r=!0},p(s,[o]){const l={};o&8207&&(l.$$scope={dirty:o,ctx:s}),e.$set(l);const a={};o&8&&(a.deleteEntry=s[3]),t.$set(a)},i(s){r||(m(e.$$.fragment,s),m(t.$$.fragment,s),r=!0)},o(s){_(e.$$.fragment,s),_(t.$$.fragment,s),r=!1},d(s){s&&k(n),w(e,s),w(t,s)}}}function gu(i,e,n){let{params:t={id:0}}=e,r,s=[],o={entry:null,onDelete:f=>{eu(f.id,f.book_id).then(d=>n(2,s=d))},getMessage:f=>`Do you wnat to delete the chapter: '${f.id}'?`};pe(async()=>{n(1,r=await Pt(t.id)),r&&n(2,s=await vn(r.id))});const l=async f=>{n(3,o.entry=f,o)},a=f=>{H("/chapters/update/"+f.id)},u=f=>{H("/questions/list/"+f.id)},c=f=>{H("/lession/prepare/"+f.id)},h=()=>H("/books/list"),p=()=>H("/chapters/create/"+t.id);return i.$$set=f=>{"params"in f&&n(0,t=f.params)},[t,r,s,o,l,a,u,c,h,p]}class $u extends N{constructor(e){super(),U(this,e,gu,_u,D,{params:0})}}function bu(i){let e,n,t,r;return e=new z({props:{onClick:i[5],label:"Cancel"}}),t=new z({props:{label:"Create"}}),{c(){v(e.$$.fragment),n=E(),v(t.$$.fragment)},m(s,o){b(e,s,o),y(s,n,o),b(t,s,o),r=!0},p(s,o){const l={};o&1&&(l.onClick=s[5]),e.$set(l)},i(s){r||(m(e.$$.fragment,s),m(t.$$.fragment,s),r=!0)},o(s){_(e.$$.fragment,s),_(t.$$.fragment,s),r=!1},d(s){s&&k(n),w(e,s),w(t,s)}}}function wu(i){let e,n,t,r,s;function o(a){i[4](a)}let l={id:"name",label:"Chapter name",error:i[2]};return i[1]!==void 0&&(l.value=i[1]),e=new ye({props:l}),x.push(()=>ne(e,"value",o)),r=new Z({props:{$$slots:{default:[bu]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment),t=E(),v(r.$$.fragment)},m(a,u){b(e,a,u),y(a,t,u),b(r,a,u),s=!0},p(a,u){const c={};u&4&&(c.error=a[2]),!n&&u&2&&(n=!0,c.value=a[1],te(()=>n=!1)),e.$set(c);const h={};u&65&&(h.$$scope={dirty:u,ctx:a}),r.$set(h)},i(a){s||(m(e.$$.fragment,a),m(r.$$.fragment,a),s=!0)},o(a){_(e.$$.fragment,a),_(r.$$.fragment,a),s=!1},d(a){a&&k(t),w(e,a),w(r,a)}}}function vu(i){let e,n,t,r;return e=new oe({props:{header:"Create Book"}}),t=new ge({props:{onSubmit:i[3],$$slots:{default:[wu]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment),n=E(),v(t.$$.fragment)},m(s,o){b(e,s,o),y(s,n,o),b(t,s,o),r=!0},p(s,o){const l={};o&71&&(l.$$scope={dirty:o,ctx:s}),t.$set(l)},i(s){r||(m(e.$$.fragment,s),m(t.$$.fragment,s),r=!0)},o(s){_(e.$$.fragment,s),_(t.$$.fragment,s),r=!1},d(s){s&&k(n),w(e,s),w(t,s)}}}function ku(i){let e,n;return e=new ae({props:{$$slots:{default:[vu]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment)},m(t,r){b(e,t,r),n=!0},p(t,[r]){const s={};r&71&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}function yu(i,e,n){let{params:t={book_id:0}}=e,r="",s="";const o=async()=>{n(2,s=ue(r)),!s&&(await nu(t.book_id,r),H("/chapters/list/"+t.book_id))};function l(u){r=u,n(1,r)}const a=()=>H("/chapters/list/"+t.book_id);return i.$$set=u=>{"params"in u&&n(0,t=u.params)},[t,r,s,o,l,a]}class Su extends N{constructor(e){super(),U(this,e,yu,ku,D,{params:0})}}function _r(i){let e,n,t=i[0].id+"",r,s,o,l=ie(i[0].modified)+"",a,u,c,h;return c=new ge({props:{onSubmit:i[3],$$slots:{default:[Eu]},$$scope:{ctx:i}}}),{c(){e=O("div"),n=O("span"),r=R(t),s=E(),o=O("span"),a=R(l),u=E(),v(c.$$.fragment),C(e,"class","mb-4 text-small")},m(p,f){y(p,e,f),$(e,n),$(n,r),$(e,s),$(e,o),$(o,a),y(p,u,f),b(c,p,f),h=!0},p(p,f){(!h||f&1)&&t!==(t=p[0].id+"")&&B(r,t),(!h||f&1)&&l!==(l=ie(p[0].modified)+"")&&B(a,l);const d={};f&135&&(d.$$scope={dirty:f,ctx:p}),c.$set(d)},i(p){h||(m(c.$$.fragment,p),h=!0)},o(p){_(c.$$.fragment,p),h=!1},d(p){p&&(k(e),k(u)),w(c,p)}}}function Cu(i){let e,n,t,r;return e=new z({props:{onClick:i[6],label:"Cancel"}}),t=new z({props:{label:"Create"}}),{c(){v(e.$$.fragment),n=E(),v(t.$$.fragment)},m(s,o){b(e,s,o),y(s,n,o),b(t,s,o),r=!0},p(s,o){const l={};o&1&&(l.onClick=s[6]),e.$set(l)},i(s){r||(m(e.$$.fragment,s),m(t.$$.fragment,s),r=!0)},o(s){_(e.$$.fragment,s),_(t.$$.fragment,s),r=!1},d(s){s&&k(n),w(e,s),w(t,s)}}}function Eu(i){let e,n,t,r,s;function o(a){i[5](a)}let l={id:"name",label:"Chapter name",error:i[2]};return i[1]!==void 0&&(l.value=i[1]),e=new ye({props:l}),x.push(()=>ne(e,"value",o)),r=new Z({props:{$$slots:{default:[Cu]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment),t=E(),v(r.$$.fragment)},m(a,u){b(e,a,u),y(a,t,u),b(r,a,u),s=!0},p(a,u){const c={};u&4&&(c.error=a[2]),!n&&u&2&&(n=!0,c.value=a[1],te(()=>n=!1)),e.$set(c);const h={};u&129&&(h.$$scope={dirty:u,ctx:a}),r.$set(h)},i(a){s||(m(e.$$.fragment,a),m(r.$$.fragment,a),s=!0)},o(a){_(e.$$.fragment,a),_(r.$$.fragment,a),s=!1},d(a){a&&k(t),w(e,a),w(r,a)}}}function Ou(i){let e,n,t,r;e=new oe({props:{header:"Update Book"}});let s=i[0]&&_r(i);return{c(){v(e.$$.fragment),n=E(),s&&s.c(),t=X()},m(o,l){b(e,o,l),y(o,n,l),s&&s.m(o,l),y(o,t,l),r=!0},p(o,l){o[0]?s?(s.p(o,l),l&1&&m(s,1)):(s=_r(o),s.c(),m(s,1),s.m(t.parentNode,t)):s&&(K(),_(s,1,1,()=>{s=null}),G())},i(o){r||(m(e.$$.fragment,o),m(s),r=!0)},o(o){_(e.$$.fragment,o),_(s),r=!1},d(o){o&&(k(n),k(t)),w(e,o),s&&s.d(o)}}}function Au(i){let e,n;return e=new ae({props:{$$slots:{default:[Ou]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment)},m(t,r){b(e,t,r),n=!0},p(t,[r]){const s={};r&135&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}function Tu(i,e,n){let{params:t={id:""}}=e,r=null,s="",o="";const l=async()=>{if(n(2,o=ue(s)),!o){if(!r){W.setString("No chapter!!");return}await tu(r.id,r.book_id,s),H("/chapters/list/"+r.book_id)}};pe(async()=>{n(0,r=await wn(parseInt(t.id))),r&&n(1,s=r.name)});function a(c){s=c,n(1,s)}const u=()=>H("/chapters/list/"+(r==null?void 0:r.book_id));return i.$$set=c=>{"params"in c&&n(4,t=c.params)},[r,s,o,l,t,a,u]}class ju extends N{constructor(e){super(),U(this,e,Tu,Au,D,{params:4})}}function Pu(i){let e,n;return{c(){e=O("div"),n=R(i[0]),C(e,"class","text-xs font-bold rounded-full shadow-sm bg-teal-600 text-white py-1.5 px-3")},m(t,r){y(t,e,r),$(e,n)},p(t,[r]){r&1&&B(n,t[0])},i:L,o:L,d(t){t&&k(e)}}}function Iu(i,e,n){let{text:t}=e;return i.$$set=r=>{"text"in r&&n(0,t=r.text)},[t]}class Ru extends N{constructor(e){super(),U(this,e,Iu,Pu,D,{text:0})}}function gr(i){let e,n;return e=new Ru({props:{text:`Progress: ${i[1]} / 3`}}),{c(){v(e.$$.fragment)},m(t,r){b(e,t,r),n=!0},p(t,r){const s={};r&2&&(s.text=`Progress: ${t[1]} / 3`),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}function Lu(i){let e,n,t,r=i[0].id+"",s,o,l,a,u,c=ie(i[0].modified)+"",h,p,f=i[1]>=0&&gr(i);return{c(){e=O("div"),n=O("div"),t=R("Question Id: "),s=R(r),o=E(),f&&f.c(),l=E(),a=O("div"),u=R("Modified: "),h=R(c),C(n,"class","text-sm font-bold"),C(a,"class","text-sm"),C(e,"class","flex justify-between items-end")},m(d,g){y(d,e,g),$(e,n),$(n,t),$(n,s),$(e,o),f&&f.m(e,null),$(e,l),$(e,a),$(a,u),$(a,h),p=!0},p(d,[g]){(!p||g&1)&&r!==(r=d[0].id+"")&&B(s,r),d[1]>=0?f?(f.p(d,g),g&2&&m(f,1)):(f=gr(d),f.c(),m(f,1),f.m(e,l)):f&&(K(),_(f,1,1,()=>{f=null}),G()),(!p||g&1)&&c!==(c=ie(d[0].modified)+"")&&B(h,c)},i(d){p||(m(f),p=!0)},o(d){_(f),p=!1},d(d){d&&k(e),f&&f.d()}}}function Du(i,e,n){let{question:t}=e,{progress:r=-1}=e;return i.$$set=s=>{"question"in s&&n(0,t=s.question),"progress"in s&&n(1,r=s.progress)},[t,r]}class qu extends N{constructor(e){super(),U(this,e,Du,Lu,D,{question:0,progress:1})}}function $r(i){let e,n;return e=new jt({props:{onClick:i[1]}}),{c(){v(e.$$.fragment)},m(t,r){b(e,t,r),n=!0},p(t,r){const s={};r&2&&(s.onClick=t[1]),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}function Uu(i){let e,n,t,r=i[1]&&$r(i);return n=new $n({props:{onClick:i[2]}}),{c(){r&&r.c(),e=E(),v(n.$$.fragment)},m(s,o){r&&r.m(s,o),y(s,e,o),b(n,s,o),t=!0},p(s,o){s[1]?r?(r.p(s,o),o&2&&m(r,1)):(r=$r(s),r.c(),m(r,1),r.m(e.parentNode,e)):r&&(K(),_(r,1,1,()=>{r=null}),G());const l={};o&1&&(l.onClick=s[2]),n.$set(l)},i(s){t||(m(r),m(n.$$.fragment,s),t=!0)},o(s){_(r),_(n.$$.fragment,s),t=!1},d(s){s&&k(e),r&&r.d(s),w(n,s)}}}function Nu(i){let e,n,t;return n=new Z({props:{$$slots:{default:[Uu]},$$scope:{ctx:i}}}),{c(){e=O("div"),v(n.$$.fragment),C(e,"class","mt-2 flex justify-end")},m(r,s){y(r,e,s),b(n,e,null),t=!0},p(r,[s]){const o={};s&11&&(o.$$scope={dirty:s,ctx:r}),n.$set(o)},i(r){t||(m(n.$$.fragment,r),t=!0)},o(r){_(n.$$.fragment,r),t=!1},d(r){r&&k(e),w(n)}}}function Bu(i,e,n){let{question:t}=e,{onDelete:r=null}=e;const s=()=>H("/questions/update/"+t.id);return i.$$set=o=>{"question"in o&&n(0,t=o.question),"onDelete"in o&&n(1,r=o.onDelete)},[t,r,s]}class Mu extends N{constructor(e){super(),U(this,e,Bu,Nu,D,{question:0,onDelete:1})}}function br(i){let e,n,t,r,s=(i[3]?i[0].quest:i[0].answer)+"",o,l,a,u=i[0].details&&wr(i);return{c(){e=O("div"),n=O("div"),n.textContent="Answer",t=E(),r=O("div"),o=R(s),l=E(),u&&u.c(),a=X(),C(n,"class","text-sm font-bold"),C(r,"class","px-4 py-3 mt-2 border border-gray-300 rounded shadow-sm whitespace-pre-line bg-yellow-50")},m(c,h){y(c,e,h),$(e,n),$(e,t),$(e,r),$(r,o),y(c,l,h),u&&u.m(c,h),y(c,a,h)},p(c,h){h&9&&s!==(s=(c[3]?c[0].quest:c[0].answer)+"")&&B(o,s),c[0].details?u?u.p(c,h):(u=wr(c),u.c(),u.m(a.parentNode,a)):u&&(u.d(1),u=null)},d(c){c&&(k(e),k(l),k(a)),u&&u.d(c)}}}function wr(i){let e,n,t,r,s=i[0].details+"",o;return{c(){e=O("div"),n=O("div"),n.textContent="Details",t=E(),r=O("div"),o=R(s),C(n,"class","text-sm font-bold"),C(r,"class","px-4 py-3 mt-2 border border-gray-300 rounded shadow-sm whitespace-pre-line bg-yellow-50")},m(l,a){y(l,e,a),$(e,n),$(e,t),$(e,r),$(r,o)},p(l,a){a&1&&s!==(s=l[0].details+"")&&B(o,s)},d(l){l&&k(e)}}}function Fu(i){let e,n,t,r,s,o,l=(i[3]?i[0].answer:i[0].quest)+"",a,u,c,h,p;r=new qu({props:{question:i[0],progress:i[1]}});let f=i[2]&&br(i);return h=new Mu({props:{question:i[0],onDelete:i[4]}}),{c(){e=O("div"),n=O("div"),t=O("div"),v(r.$$.fragment),s=E(),o=O("div"),a=R(l),u=E(),f&&f.c(),c=E(),v(h.$$.fragment),C(o,"class","px-4 py-3 mt-2 border border-gray-300 rounded shadow-sm whitespace-pre-line bg-yellow-100"),C(n,"class","flex flex-col gap-3")},m(d,g){y(d,e,g),$(e,n),$(n,t),b(r,t,null),$(t,s),$(t,o),$(o,a),$(n,u),f&&f.m(n,null),$(e,c),b(h,e,null),p=!0},p(d,[g]){const S={};g&1&&(S.question=d[0]),g&2&&(S.progress=d[1]),r.$set(S),(!p||g&9)&&l!==(l=(d[3]?d[0].answer:d[0].quest)+"")&&B(a,l),d[2]?f?f.p(d,g):(f=br(d),f.c(),f.m(n,null)):f&&(f.d(1),f=null);const T={};g&1&&(T.question=d[0]),g&16&&(T.onDelete=d[4]),h.$set(T)},i(d){p||(m(r.$$.fragment,d),m(h.$$.fragment,d),p=!0)},o(d){_(r.$$.fragment,d),_(h.$$.fragment,d),p=!1},d(d){d&&k(e),w(r),f&&f.d(),w(h)}}}function zu(i,e,n){let{question:t}=e,{progress:r=-1}=e,{showAnswer:s=!0}=e,{reverse:o=!1}=e,{onDelete:l=null}=e;return i.$$set=a=>{"question"in a&&n(0,t=a.question),"progress"in a&&n(1,r=a.progress),"showAnswer"in a&&n(2,s=a.showAnswer),"reverse"in a&&n(3,o=a.reverse),"onDelete"in a&&n(4,l=a.onDelete)},[t,r,s,o,l]}class yn extends N{constructor(e){super(),U(this,e,zu,Fu,D,{question:0,progress:1,showAnswer:2,reverse:3,onDelete:4})}}function vr(i,e,n){const t=i.slice();return t[8]=e[n],t}function kr(i){let e,n;function t(){return i[5](i[8])}return e=new yn({props:{question:i[8],onDelete:t}}),{c(){v(e.$$.fragment)},m(r,s){b(e,r,s),n=!0},p(r,s){i=r;const o={};s&8&&(o.question=i[8]),s&24&&(o.onDelete=t),e.$set(o)},i(r){n||(m(e.$$.fragment,r),n=!0)},o(r){_(e.$$.fragment,r),n=!1},d(r){w(e,r)}}}function Hu(i){let e,n,t,r;return e=new z({props:{onClick:i[6],label:"Cancel"}}),t=new z({props:{onClick:i[7],label:"Create"}}),{c(){v(e.$$.fragment),n=E(),v(t.$$.fragment)},m(s,o){b(e,s,o),y(s,n,o),b(t,s,o),r=!0},p(s,o){const l={};o&4&&(l.onClick=s[6]),e.$set(l);const a={};o&1&&(a.onClick=s[7]),t.$set(a)},i(s){r||(m(e.$$.fragment,s),m(t.$$.fragment,s),r=!0)},o(s){_(e.$$.fragment,s),_(t.$$.fragment,s),r=!1},d(s){s&&k(n),w(e,s),w(t,s)}}}function Ju(i){let e,n,t,r,s,o,l,a;e=new oe({props:{header:"List Chapters"}}),t=new kn({props:{book:i[1],chapter:i[2]}});let u=se(i[3]),c=[];for(let p=0;p<u.length;p+=1)c[p]=kr(vr(i,u,p));const h=p=>_(c[p],1,1,()=>{c[p]=null});return l=new Z({props:{$$slots:{default:[Hu]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment),n=E(),v(t.$$.fragment),r=E(),s=O("div");for(let p=0;p<c.length;p+=1)c[p].c();o=E(),v(l.$$.fragment),C(s,"class","flex flex-col gap-5")},m(p,f){b(e,p,f),y(p,n,f),b(t,p,f),y(p,r,f),y(p,s,f);for(let d=0;d<c.length;d+=1)c[d]&&c[d].m(s,null);y(p,o,f),b(l,p,f),a=!0},p(p,f){const d={};if(f&2&&(d.book=p[1]),f&4&&(d.chapter=p[2]),t.$set(d),f&24){u=se(p[3]);let S;for(S=0;S<u.length;S+=1){const T=vr(p,u,S);c[S]?(c[S].p(T,f),m(c[S],1)):(c[S]=kr(T),c[S].c(),m(c[S],1),c[S].m(s,null))}for(K(),S=u.length;S<c.length;S+=1)h(S);G()}const g={};f&2053&&(g.$$scope={dirty:f,ctx:p}),l.$set(g)},i(p){if(!a){m(e.$$.fragment,p),m(t.$$.fragment,p);for(let f=0;f<u.length;f+=1)m(c[f]);m(l.$$.fragment,p),a=!0}},o(p){_(e.$$.fragment,p),_(t.$$.fragment,p),c=c.filter(Boolean);for(let f=0;f<c.length;f+=1)_(c[f]);_(l.$$.fragment,p),a=!1},d(p){p&&(k(n),k(r),k(s),k(o)),w(e,p),w(t,p),Ae(c,p),w(l,p)}}}function Ku(i){let e,n,t,r;return e=new ae({props:{$$slots:{default:[Ju]},$$scope:{ctx:i}}}),t=new bn({props:{title:"Delete Question",deleteEntry:i[4]}}),{c(){v(e.$$.fragment),n=E(),v(t.$$.fragment)},m(s,o){b(e,s,o),y(s,n,o),b(t,s,o),r=!0},p(s,[o]){const l={};o&2079&&(l.$$scope={dirty:o,ctx:s}),e.$set(l);const a={};o&16&&(a.deleteEntry=s[4]),t.$set(a)},i(s){r||(m(e.$$.fragment,s),m(t.$$.fragment,s),r=!0)},o(s){_(e.$$.fragment,s),_(t.$$.fragment,s),r=!1},d(s){s&&k(n),w(e,s),w(t,s)}}}function Gu(i,e,n){let{params:t={id:0}}=e,r,s,o=[];pe(async()=>{n(2,s=await wn(t.id)),s&&(n(3,o=await ht(s.id)),n(1,r=await Pt(s.book_id)))});let l={entry:null,onDelete:h=>{Ja(h.id,h.chapter_id).then(p=>{n(3,o=p)})},getMessage:h=>`Do you wnat to delete the question: '${h.id}'?`};const a=h=>{n(4,l.entry=h,l)},u=()=>H("/chapters/list/"+(s==null?void 0:s.book_id)),c=()=>H("/questions/create/"+t.id);return i.$$set=h=>{"params"in h&&n(0,t=h.params)},[t,r,s,o,l,a,u,c]}class Vu extends N{constructor(e){super(),U(this,e,Gu,Ku,D,{params:0})}}function yr(i){let e,n,t=i[0].id+"",r,s,o,l=ie(i[0].modified)+"",a,u,c,h;return c=new ge({props:{onSubmit:i[6],$$slots:{default:[Qu]},$$scope:{ctx:i}}}),{c(){e=O("div"),n=O("span"),r=R(t),s=E(),o=O("span"),a=R(l),u=E(),v(c.$$.fragment),C(e,"class","mb-4 text-small")},m(p,f){y(p,e,f),$(e,n),$(n,r),$(e,s),$(e,o),$(o,a),y(p,u,f),b(c,p,f),h=!0},p(p,f){(!h||f&1)&&t!==(t=p[0].id+"")&&B(r,t),(!h||f&1)&&l!==(l=ie(p[0].modified)+"")&&B(a,l);const d={};f&4158&&(d.$$scope={dirty:f,ctx:p}),c.$set(d)},i(p){h||(m(c.$$.fragment,p),h=!0)},o(p){_(c.$$.fragment,p),h=!1},d(p){p&&(k(e),k(u)),w(c,p)}}}function Wu(i){let e,n,t,r;return e=new z({props:{onClick:i[11],label:"Back"}}),t=new z({props:{label:"Update"}}),{c(){v(e.$$.fragment),n=E(),v(t.$$.fragment)},m(s,o){b(e,s,o),y(s,n,o),b(t,s,o),r=!0},p:L,i(s){r||(m(e.$$.fragment,s),m(t.$$.fragment,s),r=!0)},o(s){_(e.$$.fragment,s),_(t.$$.fragment,s),r=!1},d(s){s&&k(n),w(e,s),w(t,s)}}}function Qu(i){let e,n,t,r,s,o,l,a,u,c,h;function p(A){i[8](A)}let f={id:"question",label:"Questione",error:i[2]};i[1]!==void 0&&(f.value=i[1]),e=new ke({props:f}),x.push(()=>ne(e,"value",p));function d(A){i[9](A)}let g={id:"answer",label:"Answer",error:i[4]};i[3]!==void 0&&(g.value=i[3]),r=new ke({props:g}),x.push(()=>ne(r,"value",d));function S(A){i[10](A)}let T={id:"details",label:"Details",error:Zu};return i[5]!==void 0&&(T.value=i[5]),l=new ke({props:T}),x.push(()=>ne(l,"value",S)),c=new Z({props:{$$slots:{default:[Wu]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment),t=E(),v(r.$$.fragment),o=E(),v(l.$$.fragment),u=E(),v(c.$$.fragment)},m(A,j){b(e,A,j),y(A,t,j),b(r,A,j),y(A,o,j),b(l,A,j),y(A,u,j),b(c,A,j),h=!0},p(A,j){const P={};j&4&&(P.error=A[2]),!n&&j&2&&(n=!0,P.value=A[1],te(()=>n=!1)),e.$set(P);const I={};j&16&&(I.error=A[4]),!s&&j&8&&(s=!0,I.value=A[3],te(()=>s=!1)),r.$set(I);const q={};!a&&j&32&&(a=!0,q.value=A[5],te(()=>a=!1)),l.$set(q);const J={};j&4096&&(J.$$scope={dirty:j,ctx:A}),c.$set(J)},i(A){h||(m(e.$$.fragment,A),m(r.$$.fragment,A),m(l.$$.fragment,A),m(c.$$.fragment,A),h=!0)},o(A){_(e.$$.fragment,A),_(r.$$.fragment,A),_(l.$$.fragment,A),_(c.$$.fragment,A),h=!1},d(A){A&&(k(t),k(o),k(u)),w(e,A),w(r,A),w(l,A),w(c,A)}}}function Yu(i){let e,n,t,r;e=new oe({props:{header:"Update Book"}});let s=i[0]&&yr(i);return{c(){v(e.$$.fragment),n=E(),s&&s.c(),t=X()},m(o,l){b(e,o,l),y(o,n,l),s&&s.m(o,l),y(o,t,l),r=!0},p(o,l){o[0]?s?(s.p(o,l),l&1&&m(s,1)):(s=yr(o),s.c(),m(s,1),s.m(t.parentNode,t)):s&&(K(),_(s,1,1,()=>{s=null}),G())},i(o){r||(m(e.$$.fragment,o),m(s),r=!0)},o(o){_(e.$$.fragment,o),_(s),r=!1},d(o){o&&(k(n),k(t)),w(e,o),s&&s.d(o)}}}function Xu(i){let e,n;return e=new ae({props:{$$slots:{default:[Yu]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment)},m(t,r){b(e,t,r),n=!0},p(t,[r]){const s={};r&4159&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}let Zu="";function xu(i,e,n){let{params:t={id:""}}=e,r=null,s="",o="",l="",a="",u="";const c=async()=>{const g={quest:s.trim(),answer:l.trim()};if(n(2,o=ue(g.quest)),n(4,a=ue(g.answer)),!(o||a)){if(!r){W.setString("No question!!");return}await Ga(r.id,r.chapter_id,g.quest,g.answer,ss(u)),Ln()}};pe(async()=>{n(0,r=await Ha(parseInt(t.id))),r&&(n(1,s=r.quest),n(3,l=r.answer),n(5,u=r.details?r.details:""))});function h(g){s=g,n(1,s)}function p(g){l=g,n(3,l)}function f(g){u=g,n(5,u)}const d=()=>Ln();return i.$$set=g=>{"params"in g&&n(7,t=g.params)},[r,s,o,l,a,u,c,t,h,p,f,d]}class ec extends N{constructor(e){super(),U(this,e,xu,Xu,D,{params:7})}}function tc(i){let e,n,t,r;return e=new z({props:{onClick:i[10],label:"Cancel"}}),t=new z({props:{label:"Create"}}),{c(){v(e.$$.fragment),n=E(),v(t.$$.fragment)},m(s,o){b(e,s,o),y(s,n,o),b(t,s,o),r=!0},p(s,o){const l={};o&1&&(l.onClick=s[10]),e.$set(l)},i(s){r||(m(e.$$.fragment,s),m(t.$$.fragment,s),r=!0)},o(s){_(e.$$.fragment,s),_(t.$$.fragment,s),r=!1},d(s){s&&k(n),w(e,s),w(t,s)}}}function nc(i){let e,n,t,r,s,o,l,a,u,c,h;function p(A){i[7](A)}let f={id:"question",label:"Question",error:i[2]};i[1]!==void 0&&(f.value=i[1]),e=new ke({props:f}),x.push(()=>ne(e,"value",p));function d(A){i[8](A)}let g={id:"answer",label:"Answer",error:i[4]};i[3]!==void 0&&(g.value=i[3]),r=new ke({props:g}),x.push(()=>ne(r,"value",d));function S(A){i[9](A)}let T={id:"details",label:"Details",error:ic};return i[5]!==void 0&&(T.value=i[5]),l=new ke({props:T}),x.push(()=>ne(l,"value",S)),c=new Z({props:{$$slots:{default:[tc]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment),t=E(),v(r.$$.fragment),o=E(),v(l.$$.fragment),u=E(),v(c.$$.fragment)},m(A,j){b(e,A,j),y(A,t,j),b(r,A,j),y(A,o,j),b(l,A,j),y(A,u,j),b(c,A,j),h=!0},p(A,j){const P={};j&4&&(P.error=A[2]),!n&&j&2&&(n=!0,P.value=A[1],te(()=>n=!1)),e.$set(P);const I={};j&16&&(I.error=A[4]),!s&&j&8&&(s=!0,I.value=A[3],te(()=>s=!1)),r.$set(I);const q={};!a&&j&32&&(a=!0,q.value=A[5],te(()=>a=!1)),l.$set(q);const J={};j&2049&&(J.$$scope={dirty:j,ctx:A}),c.$set(J)},i(A){h||(m(e.$$.fragment,A),m(r.$$.fragment,A),m(l.$$.fragment,A),m(c.$$.fragment,A),h=!0)},o(A){_(e.$$.fragment,A),_(r.$$.fragment,A),_(l.$$.fragment,A),_(c.$$.fragment,A),h=!1},d(A){A&&(k(t),k(o),k(u)),w(e,A),w(r,A),w(l,A),w(c,A)}}}function rc(i){let e,n,t,r;return e=new oe({props:{header:"Create Question"}}),t=new ge({props:{onSubmit:i[6],$$slots:{default:[nc]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment),n=E(),v(t.$$.fragment)},m(s,o){b(e,s,o),y(s,n,o),b(t,s,o),r=!0},p(s,o){const l={};o&2111&&(l.$$scope={dirty:o,ctx:s}),t.$set(l)},i(s){r||(m(e.$$.fragment,s),m(t.$$.fragment,s),r=!0)},o(s){_(e.$$.fragment,s),_(t.$$.fragment,s),r=!1},d(s){s&&k(n),w(e,s),w(t,s)}}}function sc(i){let e,n;return e=new ae({props:{$$slots:{default:[rc]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment)},m(t,r){b(e,t,r),n=!0},p(t,[r]){const s={};r&2111&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}let ic="";function oc(i,e,n){let{params:t={chapter_id:0}}=e,r="",s="",o="",l="",a="";const u=async()=>{const d={question:r.trim(),answer:o.trim()};n(2,s=ue(d.question)),n(4,l=ue(d.answer)),!(s||l)&&(await Ka(t.chapter_id,d.question,d.answer,ss(a)),H("/questions/list/"+t.chapter_id))};function c(d){r=d,n(1,r)}function h(d){o=d,n(3,o)}function p(d){a=d,n(5,a)}const f=()=>H("/questions/list/"+t.chapter_id);return i.$$set=d=>{"params"in d&&n(0,t=d.params)},[t,r,s,o,l,a,u,c,h,p,f]}class ac extends N{constructor(e){super(),U(this,e,oc,sc,D,{params:0})}}function Sr(i,e,n){const t=i.slice();return t[6]=e[n],t}function Cr(i){let e,n=i[6].label+"",t,r,s;return{c(){e=O("option"),t=R(n),e.__value=r=i[6].value,Je(e,e.__value),e.selected=s=i[6].value===i[0]},m(o,l){y(o,e,l),$(e,t)},p(o,l){l&8&&n!==(n=o[6].label+"")&&B(t,n),l&8&&r!==(r=o[6].value)&&(e.__value=r,Je(e,e.__value)),l&9&&s!==(s=o[6].value===o[0])&&(e.selected=s)},d(o){o&&k(e)}}}function lc(i){let e,n,t,r=se(i[3]),s=[];for(let o=0;o<r.length;o+=1)s[o]=Cr(Sr(i,r,o));return{c(){e=O("select");for(let o=0;o<s.length;o+=1)s[o].c();C(e,"id",i[2]),C(e,"name",i[2]),C(e,"class","input"),i[0]===void 0&&kt(()=>i[5].call(e))},m(o,l){y(o,e,l);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(e,null);jn(e,i[0],!0),n||(t=Qe(e,"change",i[5]),n=!0)},p(o,l){if(l&9){r=se(o[3]);let a;for(a=0;a<r.length;a+=1){const u=Sr(o,r,a);s[a]?s[a].p(u,l):(s[a]=Cr(u),s[a].c(),s[a].m(e,null))}for(;a<s.length;a+=1)s[a].d(1);s.length=r.length}l&4&&C(e,"id",o[2]),l&4&&C(e,"name",o[2]),l&9&&jn(e,o[0])},d(o){o&&k(e),Ae(s,o),n=!1,t()}}}function uc(i){let e,n;return e=new _n({props:{id:i[2],label:i[1],error:i[4],$$slots:{default:[lc]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment)},m(t,r){b(e,t,r),n=!0},p(t,[r]){const s={};r&4&&(s.id=t[2]),r&2&&(s.label=t[1]),r&16&&(s.error=t[4]),r&525&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}function cc(i,e,n){let{label:t}=e,{id:r}=e,{value:s}=e,{options:o}=e,{error:l=""}=e;function a(){s=ds(this),n(0,s),n(3,o)}return i.$$set=u=>{"label"in u&&n(1,t=u.label),"id"in u&&n(2,r=u.id),"value"in u&&n(0,s=u.value),"options"in u&&n(3,o=u.options),"error"in u&&n(4,l=u.error)},[s,t,r,o,l,a]}class on extends N{constructor(e){super(),U(this,e,cc,uc,D,{label:1,id:2,value:0,options:3,error:4})}}function Er(i){let e,n,t=i[2].length+"",r;return{c(){e=O("div"),n=R("Length: "),r=R(t)},m(s,o){y(s,e,o),$(e,n),$(e,r)},p(s,o){o&4&&t!==(t=s[2].length+"")&&B(r,t)},d(s){s&&k(e)}}}function Or(i){let e,n;return e=new ge({props:{onSubmit:i[9],$$slots:{default:[hc]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment)},m(t,r){b(e,t,r),n=!0},p(t,r){const s={};r&16410&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}function fc(i){let e,n,t,r;return e=new z({props:{onClick:i[13],label:"Cancel"}}),t=new z({props:{label:"Start"}}),{c(){v(e.$$.fragment),n=E(),v(t.$$.fragment)},m(s,o){b(e,s,o),y(s,n,o),b(t,s,o),r=!0},p(s,o){const l={};o&2&&(l.onClick=s[13]),e.$set(l)},i(s){r||(m(e.$$.fragment,s),m(t.$$.fragment,s),r=!0)},o(s){_(e.$$.fragment,s),_(t.$$.fragment,s),r=!1},d(s){s&&k(n),w(e,s),w(t,s)}}}function hc(i){let e,n,t,r,s,o,l,a,u;function c(d){i[11](d)}let h={id:"correct",label:"Correct Answers",options:i[6],error:i[5]};i[3]!==void 0&&(h.value=i[3]),n=new on({props:h}),x.push(()=>ne(n,"value",c));function p(d){i[12](d)}let f={id:"reverse",label:"Reverse Answers",options:i[8],error:i[7]};return i[4]!==void 0&&(f.value=i[4]),s=new on({props:f}),x.push(()=>ne(s,"value",p)),a=new Z({props:{$$slots:{default:[fc]},$$scope:{ctx:i}}}),{c(){e=O("div"),v(n.$$.fragment),r=E(),v(s.$$.fragment),l=E(),v(a.$$.fragment),C(e,"class","flex flex-row gap-4")},m(d,g){y(d,e,g),b(n,e,null),$(e,r),b(s,e,null),y(d,l,g),b(a,d,g),u=!0},p(d,g){const S={};!t&&g&8&&(t=!0,S.value=d[3],te(()=>t=!1)),n.$set(S);const T={};!o&&g&16&&(o=!0,T.value=d[4],te(()=>o=!1)),s.$set(T);const A={};g&16386&&(A.$$scope={dirty:g,ctx:d}),a.$set(A)},i(d){u||(m(n.$$.fragment,d),m(s.$$.fragment,d),m(a.$$.fragment,d),u=!0)},o(d){_(n.$$.fragment,d),_(s.$$.fragment,d),_(a.$$.fragment,d),u=!1},d(d){d&&(k(e),k(l)),w(n),w(s),w(a,d)}}}function dc(i){let e,n,t,r,s,o,l;e=new oe({props:{header:"List Chapters"}}),t=new kn({props:{book:i[0],chapter:i[1]}});let a=i[1]&&Er(i),u=i[2].length!==0&&Or(i);return{c(){v(e.$$.fragment),n=E(),v(t.$$.fragment),r=E(),a&&a.c(),s=E(),u&&u.c(),o=X()},m(c,h){b(e,c,h),y(c,n,h),b(t,c,h),y(c,r,h),a&&a.m(c,h),y(c,s,h),u&&u.m(c,h),y(c,o,h),l=!0},p(c,h){const p={};h&1&&(p.book=c[0]),h&2&&(p.chapter=c[1]),t.$set(p),c[1]?a?a.p(c,h):(a=Er(c),a.c(),a.m(s.parentNode,s)):a&&(a.d(1),a=null),c[2].length!==0?u?(u.p(c,h),h&4&&m(u,1)):(u=Or(c),u.c(),m(u,1),u.m(o.parentNode,o)):u&&(K(),_(u,1,1,()=>{u=null}),G())},i(c){l||(m(e.$$.fragment,c),m(t.$$.fragment,c),m(u),l=!0)},o(c){_(e.$$.fragment,c),_(t.$$.fragment,c),_(u),l=!1},d(c){c&&(k(n),k(r),k(s),k(o)),w(e,c),w(t,c),a&&a.d(c),u&&u.d(c)}}}function pc(i){let e,n;return e=new ae({props:{$$slots:{default:[dc]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment)},m(t,r){b(e,t,r),n=!0},p(t,[r]){const s={};r&16415&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}function mc(i,e,n){let{params:t={id:0}}=e,r,s,o=[],l="1",a,u=[{label:"0",value:"0"},{label:"1",value:"1"},{label:"2",value:"2"},{label:"3",value:"3"}],c="false",h,p=[{label:"True",value:"true"},{label:"False",value:"false"}];pe(async()=>{n(1,s=await wn(t.id)),s&&(n(2,o=await ht(s.id)),n(0,r=await Pt(s.book_id)),o.length===0&&W.setString("No questions found for this chapter!"))});const f=async()=>{Wa(o,parseInt(l),c==="true"),H("/lession/process")};function d(T){l=T,n(3,l)}function g(T){c=T,n(4,c)}const S=()=>H("/chapters/list/"+(s==null?void 0:s.book_id));return i.$$set=T=>{"params"in T&&n(10,t=T.params)},[r,s,o,l,c,a,u,h,p,f,t,d,g,S]}class _c extends N{constructor(e){super(),U(this,e,mc,pc,D,{params:10})}}function Ar(i,e,n){const t=i.slice();return t[2]=e[n],t[4]=n,t}function Tr(i){let e,n,t=i[2]+"",r;return{c(){e=O("dt"),e.textContent=`${i[1][i[4]]}`,n=O("dd"),r=R(t),C(e,"class","col-span-3 px-4 py-1"),C(n,"class","border-l border-gray-300 px-4 py-1 text-right")},m(s,o){y(s,e,o),y(s,n,o),$(n,r)},p(s,o){o&1&&t!==(t=s[2]+"")&&B(r,t)},d(s){s&&(k(e),k(n))}}}function gc(i){let e,n=se(i[0]),t=[];for(let r=0;r<n.length;r+=1)t[r]=Tr(Ar(i,n,r));return{c(){e=O("dl");for(let r=0;r<t.length;r+=1)t[r].c();C(e,"class","border border-gray-300 shadow-sm rounded grid grid-cols-4 w-64 py-2")},m(r,s){y(r,e,s);for(let o=0;o<t.length;o+=1)t[o]&&t[o].m(e,null)},p(r,[s]){if(s&3){n=se(r[0]);let o;for(o=0;o<n.length;o+=1){const l=Ar(r,n,o);t[o]?t[o].p(l,s):(t[o]=Tr(l),t[o].c(),t[o].m(e,null))}for(;o<t.length;o+=1)t[o].d(1);t.length=n.length}},i:L,o:L,d(r){r&&k(e),Ae(t,r)}}}function $c(i,e,n){let{progress:t}=e,r=["No correct answers","One correct answer","Two correct answers","Learned"];return i.$$set=s=>{"progress"in s&&n(0,t=s.progress)},[t,r]}class bc extends N{constructor(e){super(),U(this,e,$c,gc,D,{progress:0})}}function wc(i){let e,n;return e=new yn({props:{question:i[2].question,showAnswer:i[4],progress:i[2].progress,reverse:i[0].reverse}}),{c(){v(e.$$.fragment)},m(t,r){b(e,t,r),n=!0},p(t,r){const s={};r&4&&(s.question=t[2].question),r&16&&(s.showAnswer=t[4]),r&4&&(s.progress=t[2].progress),r&1&&(s.reverse=t[0].reverse),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}function vc(i){let e;return{c(){e=O("p"),e.textContent="End"},m(n,t){y(n,e,t)},p:L,i:L,o:L,d(n){n&&k(e)}}}function jr(i){let e,n,t=i[2]&&Pr(i);return{c(){t&&t.c(),e=X()},m(r,s){t&&t.m(r,s),y(r,e,s),n=!0},p(r,s){r[2]?t?(t.p(r,s),s&4&&m(t,1)):(t=Pr(r),t.c(),m(t,1),t.m(e.parentNode,e)):t&&(K(),_(t,1,1,()=>{t=null}),G())},i(r){n||(m(t),n=!0)},o(r){_(t),n=!1},d(r){r&&k(e),t&&t.d(r)}}}function Pr(i){let e,n,t,r;const s=[yc,kc],o=[];function l(a,u){return a[4]?1:0}return e=l(i),n=o[e]=s[e](i),{c(){n.c(),t=X()},m(a,u){o[e].m(a,u),y(a,t,u),r=!0},p(a,u){let c=e;e=l(a),e===c?o[e].p(a,u):(K(),_(o[c],1,1,()=>{o[c]=null}),G(),n=o[e],n?n.p(a,u):(n=o[e]=s[e](a),n.c()),m(n,1),n.m(t.parentNode,t))},i(a){r||(m(n),r=!0)},o(a){_(n),r=!1},d(a){a&&k(t),o[e].d(a)}}}function kc(i){let e,n,t,r,s,o,l,a;return e=new z({props:{label:"Correct",onClick:i[6]}}),t=new z({props:{label:"Wrong",onClick:i[7]}}),s=new z({props:{label:"Learned",onClick:i[8]}}),l=new z({props:{label:"Skip",onClick:i[9]}}),{c(){v(e.$$.fragment),n=E(),v(t.$$.fragment),r=E(),v(s.$$.fragment),o=E(),v(l.$$.fragment)},m(u,c){b(e,u,c),y(u,n,c),b(t,u,c),y(u,r,c),b(s,u,c),y(u,o,c),b(l,u,c),a=!0},p:L,i(u){a||(m(e.$$.fragment,u),m(t.$$.fragment,u),m(s.$$.fragment,u),m(l.$$.fragment,u),a=!0)},o(u){_(e.$$.fragment,u),_(t.$$.fragment,u),_(s.$$.fragment,u),_(l.$$.fragment,u),a=!1},d(u){u&&(k(n),k(r),k(o)),w(e,u),w(t,u),w(s,u),w(l,u)}}}function yc(i){let e,n;return e=new z({props:{label:"Show",onClick:i[5]}}),{c(){v(e.$$.fragment)},m(t,r){b(e,t,r),n=!0},p:L,i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}function Sc(i){let e,n,t,r;e=new z({props:{label:"Stop",onClick:i[10]}});let s=!i[3]&&jr(i);return{c(){v(e.$$.fragment),n=E(),s&&s.c(),t=X()},m(o,l){b(e,o,l),y(o,n,l),s&&s.m(o,l),y(o,t,l),r=!0},p(o,l){o[3]?s&&(K(),_(s,1,1,()=>{s=null}),G()):s?(s.p(o,l),l&8&&m(s,1)):(s=jr(o),s.c(),m(s,1),s.m(t.parentNode,t))},i(o){r||(m(e.$$.fragment,o),m(s),r=!0)},o(o){_(e.$$.fragment,o),_(s),r=!1},d(o){o&&(k(n),k(t)),w(e,o),s&&s.d(o)}}}function Cc(i){let e,n,t,r,s,o,l,a,u;e=new oe({props:{header:"Lession"}}),t=new bc({props:{progress:i[1]}});const c=[vc,wc],h=[];function p(f,d){return f[3]?0:f[2]?1:-1}return~(s=p(i))&&(o=h[s]=c[s](i)),a=new Z({props:{$$slots:{default:[Sc]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment),n=E(),v(t.$$.fragment),r=E(),o&&o.c(),l=E(),v(a.$$.fragment)},m(f,d){b(e,f,d),y(f,n,d),b(t,f,d),y(f,r,d),~s&&h[s].m(f,d),y(f,l,d),b(a,f,d),u=!0},p(f,d){const g={};d&2&&(g.progress=f[1]),t.$set(g);let S=s;s=p(f),s===S?~s&&h[s].p(f,d):(o&&(K(),_(h[S],1,1,()=>{h[S]=null}),G()),~s?(o=h[s],o?o.p(f,d):(o=h[s]=c[s](f),o.c()),m(o,1),o.m(l.parentNode,l)):o=null);const T={};d&8220&&(T.$$scope={dirty:d,ctx:f}),a.$set(T)},i(f){u||(m(e.$$.fragment,f),m(t.$$.fragment,f),m(o),m(a.$$.fragment,f),u=!0)},o(f){_(e.$$.fragment,f),_(t.$$.fragment,f),_(o),_(a.$$.fragment,f),u=!1},d(f){f&&(k(n),k(r),k(l)),w(e,f),w(t,f),~s&&h[s].d(f),w(a,f)}}}function Ec(i){let e,n;return e=new ae({props:{$$slots:{default:[Cc]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment)},m(t,r){b(e,t,r),n=!0},p(t,[r]){const s={};r&8223&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}function Oc(i,e,n){let t,r=[0,0,0,0],s,o=!1,l=!1;const a=()=>{n(4,l=!0)},u=S=>{if(n(2,s.progress=S,s),s.progress<3?t.learning.push(s):t.learned.push(s),n(1,r=rr(t)),!Qa(t)){n(3,o=!0);return}g()},c=()=>{u(s.progress+1)},h=()=>{u(0)},p=()=>{u(3)},f=()=>{u(s.progress)},d=()=>{H("/")},g=()=>{const S=t.learning.shift();S?(n(2,s=S),n(4,l=!1)):n(3,o=!0)};return pe(async()=>{const S=os();if(!S){W.setString("No lession found!");return}n(0,t=await Za(S)),n(1,r=rr(t)),g()}),[t,r,s,o,l,a,c,h,p,f,d]}class Ac extends N{constructor(e){super(),U(this,e,Oc,Ec,D,{})}}function Ir(i,e,n){const t=i.slice();return t[8]=e[n],t}function Tc(i){let e,n;return e=new z({props:{disabled:i[4],label:"Search"}}),{c(){v(e.$$.fragment)},m(t,r){b(e,t,r),n=!0},p(t,r){const s={};r&16&&(s.disabled=t[4]),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}function jc(i){let e,n,t,r,s,o,l,a;function u(f){i[6](f)}let c={id:"search",label:"Search Text"};i[0]!==void 0&&(c.value=i[0]),e=new ye({props:c}),x.push(()=>ne(e,"value",u));function h(f){i[7](f)}let p={id:"where",label:"Where",options:[{label:"Question",value:"quest"},{label:"Answer",value:"answer"},{label:"Details",value:"details"}]};return i[2]!==void 0&&(p.value=i[2]),r=new on({props:p}),x.push(()=>ne(r,"value",h)),l=new Z({props:{$$slots:{default:[Tc]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment),t=E(),v(r.$$.fragment),o=E(),v(l.$$.fragment)},m(f,d){b(e,f,d),y(f,t,d),b(r,f,d),y(f,o,d),b(l,f,d),a=!0},p(f,d){const g={};!n&&d&1&&(n=!0,g.value=f[0],te(()=>n=!1)),e.$set(g);const S={};!s&&d&4&&(s=!0,S.value=f[2],te(()=>s=!1)),r.$set(S);const T={};d&2064&&(T.$$scope={dirty:d,ctx:f}),l.$set(T)},i(f){a||(m(e.$$.fragment,f),m(r.$$.fragment,f),m(l.$$.fragment,f),a=!0)},o(f){_(e.$$.fragment,f),_(r.$$.fragment,f),_(l.$$.fragment,f),a=!1},d(f){f&&(k(t),k(o)),w(e,f),w(r,f),w(l,f)}}}function Pc(i){let e;return{c(){e=O("p"),e.textContent="Nothing found ..."},m(n,t){y(n,e,t)},p:L,i:L,o:L,d(n){n&&k(e)}}}function Ic(i){let e,n,t,r=i[3].hasMore&&Rr(),s=se(i[3].questions),o=[];for(let a=0;a<s.length;a+=1)o[a]=Lr(Ir(i,s,a));const l=a=>_(o[a],1,1,()=>{o[a]=null});return{c(){r&&r.c(),e=E(),n=O("div");for(let a=0;a<o.length;a+=1)o[a].c();C(n,"class","flex flex-col gap-5")},m(a,u){r&&r.m(a,u),y(a,e,u),y(a,n,u);for(let c=0;c<o.length;c+=1)o[c]&&o[c].m(n,null);t=!0},p(a,u){if(a[3].hasMore?r||(r=Rr(),r.c(),r.m(e.parentNode,e)):r&&(r.d(1),r=null),u&8){s=se(a[3].questions);let c;for(c=0;c<s.length;c+=1){const h=Ir(a,s,c);o[c]?(o[c].p(h,u),m(o[c],1)):(o[c]=Lr(h),o[c].c(),m(o[c],1),o[c].m(n,null))}for(K(),c=s.length;c<o.length;c+=1)l(c);G()}},i(a){if(!t){for(let u=0;u<s.length;u+=1)m(o[u]);t=!0}},o(a){o=o.filter(Boolean);for(let u=0;u<o.length;u+=1)_(o[u]);t=!1},d(a){a&&(k(e),k(n)),r&&r.d(a),Ae(o,a)}}}function Rr(i){let e;return{c(){e=O("div"),e.textContent="has more ...",C(e,"class","text-red-700")},m(n,t){y(n,e,t)},d(n){n&&k(e)}}}function Lr(i){let e,n;return e=new yn({props:{question:i[8]}}),{c(){v(e.$$.fragment)},m(t,r){b(e,t,r),n=!0},p(t,r){const s={};r&8&&(s.question=t[8]),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}function Rc(i){let e,n,t,r,s,o,l,a;e=new oe({props:{header:"Search Questions"}}),t=new ge({props:{onSubmit:i[5],$$slots:{default:[jc]},$$scope:{ctx:i}}});const u=[Ic,Pc],c=[];function h(p,f){return p[3]&&p[3].questions.length>0?0:p[1]!==""?1:-1}return~(s=h(i))&&(o=c[s]=u[s](i)),{c(){v(e.$$.fragment),n=E(),v(t.$$.fragment),r=E(),o&&o.c(),l=X()},m(p,f){b(e,p,f),y(p,n,f),b(t,p,f),y(p,r,f),~s&&c[s].m(p,f),y(p,l,f),a=!0},p(p,f){const d={};f&2069&&(d.$$scope={dirty:f,ctx:p}),t.$set(d);let g=s;s=h(p),s===g?~s&&c[s].p(p,f):(o&&(K(),_(c[g],1,1,()=>{c[g]=null}),G()),~s?(o=c[s],o?o.p(p,f):(o=c[s]=u[s](p),o.c()),m(o,1),o.m(l.parentNode,l)):o=null)},i(p){a||(m(e.$$.fragment,p),m(t.$$.fragment,p),m(o),a=!0)},o(p){_(e.$$.fragment,p),_(t.$$.fragment,p),_(o),a=!1},d(p){p&&(k(n),k(r),k(l)),w(e,p),w(t,p),~s&&c[s].d(p)}}}function Lc(i){let e,n;return e=new ae({props:{$$slots:{default:[Rc]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment)},m(t,r){b(e,t,r),n=!0},p(t,[r]){const s={};r&2079&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}function Dc(i,e,n){let t,r="",s="",o="quest",l;const a=async()=>{n(3,l=await Va(r,o)),n(1,s=r)};function u(h){r=h,n(0,r)}function c(h){o=h,n(2,o)}return i.$$.update=()=>{i.$$.dirty&3&&n(4,t=r.length<3||r===s)},[r,s,o,l,t,a,u,c]}class qc extends N{constructor(e){super(),U(this,e,Dc,Lc,D,{})}}function Uc(i){let e;return{c(){e=O("p"),e.textContent="User is not logged in"},m(n,t){y(n,e,t)},p:L,d(n){n&&k(e)}}}function Nc(i){let e,n,t,r,s,o,l,a,u=i[0].id+"",c,h,p,f,d,g,S=i[0].email+"",T,A,j,P,I,q,J=i[0].created_at+"",Q,fe,Xe,Rt,Sn,Lt,dt=i[0].aud+"",Dt,Cn,Ze,qt,En,Ut,pt=JSON.stringify(i[0].user_metadata)+"",Nt,On,xe,Bt,An,Mt,mt=JSON.stringify(i[0].app_metadata)+"",Ft;return{c(){e=O("table"),n=O("thead"),n.innerHTML="<tr><th>Key</th> <th>Value</th></tr>",t=E(),r=O("tbody"),s=O("tr"),o=O("td"),o.textContent="Id",l=E(),a=O("td"),c=R(u),h=E(),p=O("tr"),f=O("td"),f.textContent="Email",d=E(),g=O("td"),T=R(S),A=E(),j=O("tr"),P=O("td"),P.textContent="Created",I=E(),q=O("td"),Q=R(J),fe=E(),Xe=O("tr"),Rt=O("td"),Rt.textContent="Aud",Sn=E(),Lt=O("td"),Dt=R(dt),Cn=E(),Ze=O("tr"),qt=O("td"),qt.textContent="User Metadata",En=E(),Ut=O("td"),Nt=R(pt),On=E(),xe=O("tr"),Bt=O("td"),Bt.textContent="App Metatata",An=E(),Mt=O("td"),Ft=R(mt),C(e,"class","w-full")},m(me,$e){y(me,e,$e),$(e,n),$(e,t),$(e,r),$(r,s),$(s,o),$(s,l),$(s,a),$(a,c),$(r,h),$(r,p),$(p,f),$(p,d),$(p,g),$(g,T),$(r,A),$(r,j),$(j,P),$(j,I),$(j,q),$(q,Q),$(r,fe),$(r,Xe),$(Xe,Rt),$(Xe,Sn),$(Xe,Lt),$(Lt,Dt),$(r,Cn),$(r,Ze),$(Ze,qt),$(Ze,En),$(Ze,Ut),$(Ut,Nt),$(r,On),$(r,xe),$(xe,Bt),$(xe,An),$(xe,Mt),$(Mt,Ft)},p(me,$e){$e&1&&u!==(u=me[0].id+"")&&B(c,u),$e&1&&S!==(S=me[0].email+"")&&B(T,S),$e&1&&J!==(J=me[0].created_at+"")&&B(Q,J),$e&1&&dt!==(dt=me[0].aud+"")&&B(Dt,dt),$e&1&&pt!==(pt=JSON.stringify(me[0].user_metadata)+"")&&B(Nt,pt),$e&1&&mt!==(mt=JSON.stringify(me[0].app_metadata)+"")&&B(Ft,mt)},d(me){me&&k(e)}}}function Bc(i){let e,n;return e=new z({props:{onClick:i[1],label:"Cancel"}}),{c(){v(e.$$.fragment)},m(t,r){b(e,t,r),n=!0},p:L,i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}function Mc(i){let e,n,t,r,s;e=new oe({props:{header:"User"}});function o(u,c){return u[0]?Nc:Uc}let l=o(i),a=l(i);return r=new Z({props:{$$slots:{default:[Bc]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment),n=E(),a.c(),t=E(),v(r.$$.fragment)},m(u,c){b(e,u,c),y(u,n,c),a.m(u,c),y(u,t,c),b(r,u,c),s=!0},p(u,c){l===(l=o(u))&&a?a.p(u,c):(a.d(1),a=l(u),a&&(a.c(),a.m(t.parentNode,t)));const h={};c&4&&(h.$$scope={dirty:c,ctx:u}),r.$set(h)},i(u){s||(m(e.$$.fragment,u),m(r.$$.fragment,u),s=!0)},o(u){_(e.$$.fragment,u),_(r.$$.fragment,u),s=!1},d(u){u&&(k(n),k(t)),w(e,u),a.d(u),w(r,u)}}}function Fc(i){let e,n;return e=new ae({props:{$$slots:{default:[Mc]},$$scope:{ctx:i}}}),{c(){v(e.$$.fragment)},m(t,r){b(e,t,r),n=!0},p(t,[r]){const s={};r&5&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}function zc(i,e,n){let t;return an(i,wt,s=>n(0,t=s)),[t,()=>H("/")]}class Hc extends N{constructor(e){super(),U(this,e,zc,Fc,D,{})}}function Jc(i){let e,n;return e=new As({props:{routes:i[0]}}),{c(){v(e.$$.fragment)},m(t,r){b(e,t,r),n=!0},p:L,i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){w(e,t)}}}function Kc(i){let e,n,t,r,s,o,l;return n=new zs({}),r=new Ua({props:{$$slots:{default:[Jc]},$$scope:{ctx:i}}}),{c(){e=O("main"),v(n.$$.fragment),t=E(),v(r.$$.fragment),s=E(),o=O("footer"),o.textContent="by Volker Senkel 2024",C(o,"class","text-sm text-end my-4 pt-2 border-t"),C(e,"class","text-gray-600 max-w-screen-lg m-auto mt-4")},m(a,u){y(a,e,u),b(n,e,null),$(e,t),b(r,e,null),$(e,s),$(e,o),l=!0},p(a,[u]){const c={};u&2&&(c.$$scope={dirty:u,ctx:a}),r.$set(c)},i(a){l||(m(n.$$.fragment,a),m(r.$$.fragment,a),l=!0)},o(a){_(n.$$.fragment,a),_(r.$$.fragment,a),l=!1},d(a){a&&k(e),w(n),w(r)}}}function Gc(i){return[{"/":il,"/books/list":Ul,"/books/create":Gl,"/books/update/:id":Zl,"/chapters/list/:id":$u,"/chapters/create/:book_id":Su,"/chapters/update/:id":ju,"/questions/list/:id":Vu,"/questions/create/:chapter_id":ac,"/questions/update/:id":ec,"/lession/prepare/:id":_c,"/lession/process":Ac,"/cache":_l,"/search":qc,"/User":Hc,"*":bl}]}class Vc extends N{constructor(e){super(),U(this,e,Gc,Kc,D,{})}}new Vc({target:document.getElementById("app")});
