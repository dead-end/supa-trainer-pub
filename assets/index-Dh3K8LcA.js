var Ps=Object.defineProperty;var Rs=(i,e,n)=>e in i?Ps(i,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):i[e]=n;var Yt=(i,e,n)=>(Rs(i,typeof e!="symbol"?e+"":e,n),n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))t(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&t(o)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function t(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}})();function q(){}function lt(i,e){for(const n in e)i[n]=e[n];return i}function es(i){return i()}function Bn(){return Object.create(null)}function Xe(i){i.forEach(es)}function Ye(i){return typeof i=="function"}function L(i,e){return i!=i?e==e:i!==e||i&&typeof i=="object"||typeof i=="function"}function Ls(i){return Object.keys(i).length===0}function ts(i,...e){if(i==null){for(const t of e)t(void 0);return q}const n=i.subscribe(...e);return n.unsubscribe?()=>n.unsubscribe():n}function gn(i,e,n){i.$$.on_destroy.push(ts(e,n))}function we(i,e,n,t){if(i){const r=ns(i,e,n,t);return i[0](r)}}function ns(i,e,n,t){return i[1]&&t?lt(n.ctx.slice(),i[1](t(e))):n.ctx}function ve(i,e,n,t){if(i[2]&&t){const r=i[2](t(n));if(e.dirty===void 0)return r;if(typeof r=="object"){const s=[],o=Math.max(e.dirty.length,r.length);for(let a=0;a<o;a+=1)s[a]=e.dirty[a]|r[a];return s}return e.dirty|r}return e.dirty}function ke(i,e,n,t,r,s){if(r){const o=ns(e,n,t,s);i.p(o,r)}}function ye(i){if(i.ctx.length>32){const e=[],n=i.ctx.length/32;for(let t=0;t<n;t++)e[t]=-1;return e}return-1}function S(i,e){i.appendChild(e)}function C(i,e,n){i.insertBefore(e,n||null)}function y(i){i.parentNode&&i.parentNode.removeChild(i)}function Ce(i,e){for(let n=0;n<i.length;n+=1)i[n]&&i[n].d(e)}function T(i){return document.createElement(i)}function W(i){return document.createElementNS("http://www.w3.org/2000/svg",i)}function R(i){return document.createTextNode(i)}function A(){return R(" ")}function x(){return R("")}function De(i,e,n,t){return i.addEventListener(e,n,t),()=>i.removeEventListener(e,n,t)}function qs(i){return function(e){return e.preventDefault(),i.call(this,e)}}function k(i,e,n){n==null?i.removeAttribute(e):i.getAttribute(e)!==n&&i.setAttribute(e,n)}function Ds(i){return Array.from(i.childNodes)}function B(i,e){e=""+e,i.data!==e&&(i.data=e)}function Oe(i,e){i.value=e??""}function Mn(i,e,n){for(let t=0;t<i.options.length;t+=1){const r=i.options[t];if(r.__value===e){r.selected=!0;return}}(!n||e!==void 0)&&(i.selectedIndex=-1)}function Us(i){const e=i.querySelector(":checked");return e&&e.__value}function Ns(i,e,{bubbles:n=!1,cancelable:t=!1}={}){return new CustomEvent(i,{detail:e,bubbles:n,cancelable:t})}function St(i,e){return new i(e)}let ut;function it(i){ut=i}function Ot(){if(!ut)throw new Error("Function called outside component initialization");return ut}function ae(i){Ot().$$.on_mount.push(i)}function Bs(i){Ot().$$.after_update.push(i)}function Ms(i){Ot().$$.on_destroy.push(i)}function Fs(){const i=Ot();return(e,n,{cancelable:t=!1}={})=>{const r=i.$$.callbacks[e];if(r){const s=Ns(e,n,{cancelable:t});return r.slice().forEach(o=>{o.call(i,s)}),!s.defaultPrevented}return!0}}function Fn(i,e){const n=i.$$.callbacks[e.type];n&&n.slice().forEach(t=>t.call(this,e))}const He=[],Z=[];let Ge=[];const ln=[],rs=Promise.resolve();let un=!1;function ss(){un||(un=!0,rs.then(is))}function bn(){return ss(),rs}function Et(i){Ge.push(i)}function te(i){ln.push(i)}const Zt=new Set;let Ne=0;function is(){if(Ne!==0)return;const i=ut;do{try{for(;Ne<He.length;){const e=He[Ne];Ne++,it(e),zs(e.$$)}}catch(e){throw He.length=0,Ne=0,e}for(it(null),He.length=0,Ne=0;Z.length;)Z.pop()();for(let e=0;e<Ge.length;e+=1){const n=Ge[e];Zt.has(n)||(Zt.add(n),n())}Ge.length=0}while(He.length);for(;ln.length;)ln.pop()();un=!1,Zt.clear(),it(i)}function zs(i){if(i.fragment!==null){i.update(),Xe(i.before_update);const e=i.dirty;i.dirty=[-1],i.fragment&&i.fragment.p(i.ctx,e),i.after_update.forEach(Et)}}function Hs(i){const e=[],n=[];Ge.forEach(t=>i.indexOf(t)===-1?e.push(t):n.push(t)),n.forEach(t=>t()),Ge=e}const yt=new Set;let qe;function K(){qe={r:0,c:[],p:qe}}function V(){qe.r||Xe(qe.c),qe=qe.p}function m(i,e){i&&i.i&&(yt.delete(i),i.i(e))}function $(i,e,n,t){if(i&&i.o){if(yt.has(i))return;yt.add(i),qe.c.push(()=>{yt.delete(i),t&&(n&&i.d(1),t())}),i.o(e)}else t&&t()}function ie(i){return(i==null?void 0:i.length)!==void 0?i:Array.from(i)}function At(i,e){const n={},t={},r={$$scope:1};let s=i.length;for(;s--;){const o=i[s],a=e[s];if(a){for(const l in o)l in a||(t[l]=1);for(const l in a)r[l]||(n[l]=a[l],r[l]=1);i[s]=a}else for(const l in o)r[l]=1}for(const o in t)o in n||(n[o]=void 0);return n}function Tt(i){return typeof i=="object"&&i!==null?i:{}}function ne(i,e,n){const t=i.$$.props[e];t!==void 0&&(i.$$.bound[t]=n,n(i.$$.ctx[t]))}function w(i){i&&i.c()}function g(i,e,n){const{fragment:t,after_update:r}=i.$$;t&&t.m(e,n),Et(()=>{const s=i.$$.on_mount.map(es).filter(Ye);i.$$.on_destroy?i.$$.on_destroy.push(...s):Xe(s),i.$$.on_mount=[]}),r.forEach(Et)}function b(i,e){const n=i.$$;n.fragment!==null&&(Hs(n.after_update),Xe(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function Js(i,e){i.$$.dirty[0]===-1&&(He.push(i),ss(),i.$$.dirty.fill(0)),i.$$.dirty[e/31|0]|=1<<e%31}function D(i,e,n,t,r,s,o=null,a=[-1]){const l=ut;it(i);const u=i.$$={fragment:null,ctx:[],props:s,update:q,not_equal:r,bound:Bn(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(l?l.$$.context:[])),callbacks:Bn(),dirty:a,skip_bound:!1,root:e.target||l.$$.root};o&&o(u.root);let c=!1;if(u.ctx=n?n(i,e.props||{},(d,h,...f)=>{const p=f.length?f[0]:h;return u.ctx&&r(u.ctx[d],u.ctx[d]=p)&&(!u.skip_bound&&u.bound[d]&&u.bound[d](p),c&&Js(i,d)),h}):[],u.update(),c=!0,Xe(u.before_update),u.fragment=t?t(u.ctx):!1,e.target){if(e.hydrate){const d=Ds(e.target);u.fragment&&u.fragment.l(d),d.forEach(y)}else u.fragment&&u.fragment.c();e.intro&&m(i.$$.fragment),g(i,e.target,e.anchor),is()}it(l)}class U{constructor(){Yt(this,"$$");Yt(this,"$$set")}$destroy(){b(this,1),this.$destroy=q}$on(e,n){if(!Ye(n))return q;const t=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return t.push(n),()=>{const r=t.indexOf(n);r!==-1&&t.splice(r,1)}}$set(e){this.$$set&&!Ls(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const Gs="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(Gs);const Be=[];function os(i,e){return{subscribe:jt(i,e).subscribe}}function jt(i,e=q){let n;const t=new Set;function r(a){if(L(i,a)&&(i=a,n)){const l=!Be.length;for(const u of t)u[1](),Be.push(u,i);if(l){for(let u=0;u<Be.length;u+=2)Be[u][0](Be[u+1]);Be.length=0}}}function s(a){r(a(i))}function o(a,l=q){const u=[a,l];return t.add(u),t.size===1&&(n=e(r,s)||q),a(i),()=>{t.delete(u),t.size===0&&n&&(n(),n=null)}}return{set:r,update:s,subscribe:o}}function as(i,e,n){const t=!Array.isArray(i),r=t?[i]:i;if(!r.every(Boolean))throw new Error("derived() expects stores as input, got a falsy value");const s=e.length<2;return os(n,(o,a)=>{let l=!1;const u=[];let c=0,d=q;const h=()=>{if(c)return;d();const p=e(t?u[0]:u,o,a);s?o(p):d=Ye(p)?p:q},f=r.map((p,_)=>ts(p,v=>{u[_]=v,c&=~(1<<_),l&&h()},()=>{c|=1<<_}));return l=!0,h(),function(){Xe(f),d(),l=!1}})}function Ks(i,e){if(i instanceof RegExp)return{keys:!1,pattern:i};var n,t,r,s,o=[],a="",l=i.split("/");for(l[0]||l.shift();r=l.shift();)n=r[0],n==="*"?(o.push("wild"),a+="/(.*)"):n===":"?(t=r.indexOf("?",1),s=r.indexOf(".",1),o.push(r.substring(1,~t?t:~s?s:r.length)),a+=~t&&!~s?"(?:/([^/]+?))?":"/([^/]+?)",~s&&(a+=(~t?"?":"")+"\\"+r.substring(s))):a+="/"+r;return{keys:o,pattern:new RegExp("^"+a+"/?$","i")}}function Vs(i){let e,n,t;const r=[i[2]];var s=i[0];function o(a,l){let u={};for(let c=0;c<r.length;c+=1)u=lt(u,r[c]);return l!==void 0&&l&4&&(u=lt(u,At(r,[Tt(a[2])]))),{props:u}}return s&&(e=St(s,o(i)),e.$on("routeEvent",i[7])),{c(){e&&w(e.$$.fragment),n=x()},m(a,l){e&&g(e,a,l),C(a,n,l),t=!0},p(a,l){if(l&1&&s!==(s=a[0])){if(e){K();const u=e;$(u.$$.fragment,1,0,()=>{b(u,1)}),V()}s?(e=St(s,o(a,l)),e.$on("routeEvent",a[7]),w(e.$$.fragment),m(e.$$.fragment,1),g(e,n.parentNode,n)):e=null}else if(s){const u=l&4?At(r,[Tt(a[2])]):{};e.$set(u)}},i(a){t||(e&&m(e.$$.fragment,a),t=!0)},o(a){e&&$(e.$$.fragment,a),t=!1},d(a){a&&y(n),e&&b(e,a)}}}function Ws(i){let e,n,t;const r=[{params:i[1]},i[2]];var s=i[0];function o(a,l){let u={};for(let c=0;c<r.length;c+=1)u=lt(u,r[c]);return l!==void 0&&l&6&&(u=lt(u,At(r,[l&2&&{params:a[1]},l&4&&Tt(a[2])]))),{props:u}}return s&&(e=St(s,o(i)),e.$on("routeEvent",i[6])),{c(){e&&w(e.$$.fragment),n=x()},m(a,l){e&&g(e,a,l),C(a,n,l),t=!0},p(a,l){if(l&1&&s!==(s=a[0])){if(e){K();const u=e;$(u.$$.fragment,1,0,()=>{b(u,1)}),V()}s?(e=St(s,o(a,l)),e.$on("routeEvent",a[6]),w(e.$$.fragment),m(e.$$.fragment,1),g(e,n.parentNode,n)):e=null}else if(s){const u=l&6?At(r,[l&2&&{params:a[1]},l&4&&Tt(a[2])]):{};e.$set(u)}},i(a){t||(e&&m(e.$$.fragment,a),t=!0)},o(a){e&&$(e.$$.fragment,a),t=!1},d(a){a&&y(n),e&&b(e,a)}}}function Qs(i){let e,n,t,r;const s=[Ws,Vs],o=[];function a(l,u){return l[1]?0:1}return e=a(i),n=o[e]=s[e](i),{c(){n.c(),t=x()},m(l,u){o[e].m(l,u),C(l,t,u),r=!0},p(l,[u]){let c=e;e=a(l),e===c?o[e].p(l,u):(K(),$(o[c],1,1,()=>{o[c]=null}),V(),n=o[e],n?n.p(l,u):(n=o[e]=s[e](l),n.c()),m(n,1),n.m(t.parentNode,t))},i(l){r||(m(n),r=!0)},o(l){$(n),r=!1},d(l){l&&y(t),o[e].d(l)}}}function zn(){const i=window.location.href.indexOf("#/");let e=i>-1?window.location.href.substr(i+1):"/";const n=e.indexOf("?");let t="";return n>-1&&(t=e.substr(n+1),e=e.substr(0,n)),{location:e,querystring:t}}const wn=os(null,function(e){e(zn());const n=()=>{e(zn())};return window.addEventListener("hashchange",n,!1),function(){window.removeEventListener("hashchange",n,!1)}});as(wn,i=>i.location);as(wn,i=>i.querystring);const Hn=jt(void 0);async function F(i){if(!i||i.length<1||i.charAt(0)!="/"&&i.indexOf("#/")!==0)throw Error("Invalid parameter location");await bn(),history.replaceState({...history.state,__svelte_spa_router_scrollX:window.scrollX,__svelte_spa_router_scrollY:window.scrollY},void 0),window.location.hash=(i.charAt(0)=="#"?"":"#")+i}async function ct(){await bn(),window.history.back()}function Xs(i){i?window.scrollTo(i.__svelte_spa_router_scrollX,i.__svelte_spa_router_scrollY):window.scrollTo(0,0)}function Ys(i,e,n){let{routes:t={}}=e,{prefix:r=""}=e,{restoreScrollState:s=!1}=e;class o{constructor(P,N){if(!N||typeof N!="function"&&(typeof N!="object"||N._sveltesparouter!==!0))throw Error("Invalid component object");if(!P||typeof P=="string"&&(P.length<1||P.charAt(0)!="/"&&P.charAt(0)!="*")||typeof P=="object"&&!(P instanceof RegExp))throw Error('Invalid value for "path" argument - strings must start with / or *');const{pattern:J,keys:ee}=Ks(P);this.path=P,typeof N=="object"&&N._sveltesparouter===!0?(this.component=N.component,this.conditions=N.conditions||[],this.userData=N.userData,this.props=N.props||{}):(this.component=()=>Promise.resolve(N),this.conditions=[],this.props={}),this._pattern=J,this._keys=ee}match(P){if(r){if(typeof r=="string")if(P.startsWith(r))P=P.substr(r.length)||"/";else return null;else if(r instanceof RegExp){const pe=P.match(r);if(pe&&pe[0])P=P.substr(pe[0].length)||"/";else return null}}const N=this._pattern.exec(P);if(N===null)return null;if(this._keys===!1)return N;const J={};let ee=0;for(;ee<this._keys.length;){try{J[this._keys[ee]]=decodeURIComponent(N[ee+1]||"")||null}catch{J[this._keys[ee]]=null}ee++}return J}async checkConditions(P){for(let N=0;N<this.conditions.length;N++)if(!await this.conditions[N](P))return!1;return!0}}const a=[];t instanceof Map?t.forEach((I,P)=>{a.push(new o(P,I))}):Object.keys(t).forEach(I=>{a.push(new o(I,t[I]))});let l=null,u=null,c={};const d=Fs();async function h(I,P){await bn(),d(I,P)}let f=null,p=null;s&&(p=I=>{I.state&&(I.state.__svelte_spa_router_scrollY||I.state.__svelte_spa_router_scrollX)?f=I.state:f=null},window.addEventListener("popstate",p),Bs(()=>{Xs(f)}));let _=null,v=null;const j=wn.subscribe(async I=>{_=I;let P=0;for(;P<a.length;){const N=a[P].match(I.location);if(!N){P++;continue}const J={route:a[P].path,location:I.location,querystring:I.querystring,userData:a[P].userData,params:N&&typeof N=="object"&&Object.keys(N).length?N:null};if(!await a[P].checkConditions(J)){n(0,l=null),v=null,h("conditionsFailed",J);return}h("routeLoading",Object.assign({},J));const ee=a[P].component;if(v!=ee){ee.loading?(n(0,l=ee.loading),v=ee,n(1,u=ee.loadingParams),n(2,c={}),h("routeLoaded",Object.assign({},J,{component:l,name:l.name,params:u}))):(n(0,l=null),v=null);const pe=await ee();if(I!=_)return;n(0,l=pe&&pe.default||pe),v=ee}N&&typeof N=="object"&&Object.keys(N).length?n(1,u=N):n(1,u=null),n(2,c=a[P].props),h("routeLoaded",Object.assign({},J,{component:l,name:l.name,params:u})).then(()=>{Hn.set(u)});return}n(0,l=null),v=null,Hn.set(void 0)});Ms(()=>{j(),p&&window.removeEventListener("popstate",p)});function E(I){Fn.call(this,i,I)}function O(I){Fn.call(this,i,I)}return i.$$set=I=>{"routes"in I&&n(3,t=I.routes),"prefix"in I&&n(4,r=I.prefix),"restoreScrollState"in I&&n(5,s=I.restoreScrollState)},i.$$.update=()=>{i.$$.dirty&32&&(history.scrollRestoration=s?"manual":"auto")},[l,u,c,t,r,s,E,O]}class Zs extends U{constructor(e){super(),D(this,e,Ys,Qs,L,{routes:3,prefix:4,restoreScrollState:5})}}function xs(){const{subscribe:i,set:e,update:n}=jt(null);return{subscribe:i,setDBError:t=>e({msg:t.message,details:t.details}),setAuthError:t=>{e({msg:t.message})},setString:(t,r)=>e({msg:t,details:r}),reset:()=>e(null)}}const G=xs();function ei(i){let e,n,t,r;return{c(){e=T("button"),n=R(i[0]),k(e,"class","btn-base "+i[3]()),e.disabled=i[2],k(e,"type","button")},m(s,o){C(s,e,o),S(e,n),t||(r=De(e,"click",function(){Ye(i[1])&&i[1].apply(this,arguments)}),t=!0)},p(s,o){i=s,o&1&&B(n,i[0]),o&4&&(e.disabled=i[2])},d(s){s&&y(e),t=!1,r()}}}function ti(i){let e,n;return{c(){e=T("button"),n=R(i[0]),k(e,"class","btn-base "+i[3]()),e.disabled=i[2],k(e,"type","submit")},m(t,r){C(t,e,r),S(e,n)},p(t,r){r&1&&B(n,t[0]),r&4&&(e.disabled=t[2])},d(t){t&&y(e)}}}function ni(i){let e;function n(s,o){return s[1]==null?ti:ei}let t=n(i),r=t(i);return{c(){r.c(),e=x()},m(s,o){r.m(s,o),C(s,e,o)},p(s,[o]){t===(t=n(s))&&r?r.p(s,o):(r.d(1),r=t(s),r&&(r.c(),r.m(e.parentNode,e)))},i:q,o:q,d(s){s&&y(e),r.d(s)}}}function ri(i,e,n){let{label:t}=e,{onClick:r=null}=e,{disabled:s=!1}=e,{type:o=void 0}=e;const a=()=>o===void 0?"bg-blue-600 hover:bg-blue-700":o==="ok"?"bg-green-600 hover:bg-green-700":o==="error"?"bg-red-600 hover:bg-red-700":o==="warn"?"bg-yellow-600 hover:bg-yellow-700":"";return i.$$set=l=>{"label"in l&&n(0,t=l.label),"onClick"in l&&n(1,r=l.onClick),"disabled"in l&&n(2,s=l.disabled),"type"in l&&n(4,o=l.type)},[t,r,s,a,o]}class M extends U{constructor(e){super(),D(this,e,ri,ni,L,{label:0,onClick:1,disabled:2,type:4})}}function si(i){let e,n;const t=i[1].default,r=we(t,i,i[0],null);return{c(){e=T("div"),r&&r.c(),k(e,"class","flex gap-4")},m(s,o){C(s,e,o),r&&r.m(e,null),n=!0},p(s,[o]){r&&r.p&&(!n||o&1)&&ke(r,t,s,s[0],n?ve(t,s[0],o,null):ye(s[0]),null)},i(s){n||(m(r,s),n=!0)},o(s){$(r,s),n=!1},d(s){s&&y(e),r&&r.d(s)}}}function ii(i,e,n){let{$$slots:t={},$$scope:r}=e;return i.$$set=s=>{"$$scope"in s&&n(0,r=s.$$scope)},[r,t]}class Q extends U{constructor(e){super(),D(this,e,ii,si,L,{})}}function Jn(i,e,n){const t=i.slice();return t[5]=e[n],t}function Gn(i){let e,n;return e=new M({props:{label:i[5].label,onClick:i[5].onclick}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,r){const s={};r&2&&(s.label=t[5].label),r&2&&(s.onClick=t[5].onclick),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){$(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function oi(i){let e,n,t=ie(i[1]),r=[];for(let o=0;o<t.length;o+=1)r[o]=Gn(Jn(i,t,o));const s=o=>$(r[o],1,1,()=>{r[o]=null});return{c(){for(let o=0;o<r.length;o+=1)r[o].c();e=x()},m(o,a){for(let l=0;l<r.length;l+=1)r[l]&&r[l].m(o,a);C(o,e,a),n=!0},p(o,a){if(a&2){t=ie(o[1]);let l;for(l=0;l<t.length;l+=1){const u=Jn(o,t,l);r[l]?(r[l].p(u,a),m(r[l],1)):(r[l]=Gn(u),r[l].c(),m(r[l],1),r[l].m(e.parentNode,e))}for(K(),l=t.length;l<r.length;l+=1)s(l);V()}},i(o){if(!n){for(let a=0;a<t.length;a+=1)m(r[a]);n=!0}},o(o){r=r.filter(Boolean);for(let a=0;a<r.length;a+=1)$(r[a]);n=!1},d(o){o&&y(e),Ce(r,o)}}}function ai(i){let e,n,t,r,s,o,a,l,u,c,d;const h=i[3].default,f=we(h,i,i[4],null);return c=new Q({props:{$$slots:{default:[oi]},$$scope:{ctx:i}}}),{c(){e=T("div"),n=T("div"),t=T("div"),r=R(i[0]),o=A(),a=T("div"),f&&f.c(),l=A(),u=T("div"),w(c.$$.fragment),k(t,"class",s="text-lg pb-2 border-b "+(i[2]==="error"?"text-red-900":"")),k(a,"class","my-6"),k(n,"class","relative top-1/3 mx-auto max-w-md bg-white rounded shadow p-6"),k(e,"class","fixed z-50 inset-0 bg-black bg-opacity-50 overflow-y-auto h-full w-full")},m(p,_){C(p,e,_),S(e,n),S(n,t),S(t,r),S(n,o),S(n,a),f&&f.m(a,null),S(n,l),S(n,u),g(c,u,null),d=!0},p(p,[_]){(!d||_&1)&&B(r,p[0]),(!d||_&4&&s!==(s="text-lg pb-2 border-b "+(p[2]==="error"?"text-red-900":"")))&&k(t,"class",s),f&&f.p&&(!d||_&16)&&ke(f,h,p,p[4],d?ve(h,p[4],_,null):ye(p[4]),null);const v={};_&18&&(v.$$scope={dirty:_,ctx:p}),c.$set(v)},i(p){d||(m(f,p),m(c.$$.fragment,p),d=!0)},o(p){$(f,p),$(c.$$.fragment,p),d=!1},d(p){p&&y(e),f&&f.d(p),b(c)}}}function li(i,e,n){let{$$slots:t={},$$scope:r}=e,{title:s}=e,{buttons:o}=e,{type:a="ok"}=e;return i.$$set=l=>{"title"in l&&n(0,s=l.title),"buttons"in l&&n(1,o=l.buttons),"type"in l&&n(2,a=l.type),"$$scope"in l&&n(4,r=l.$$scope)},[s,o,a,t,r]}class ls extends U{constructor(e){super(),D(this,e,li,ai,L,{title:0,buttons:1,type:2})}}function Kn(i){let e,n;return e=new ls({props:{title:"Errors",buttons:i[1],type:"error",$$slots:{default:[ui]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,r){const s={};r&5&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){$(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function Vn(i){let e,n=i[0].details+"",t;return{c(){e=T("p"),t=R(n),k(e,"class","text-sm pt-3")},m(r,s){C(r,e,s),S(e,t)},p(r,s){s&1&&n!==(n=r[0].details+"")&&B(t,n)},d(r){r&&y(e)}}}function ui(i){let e=i[0].msg+"",n,t,r,s=i[0].details&&Vn(i);return{c(){n=R(e),t=A(),s&&s.c(),r=x()},m(o,a){C(o,n,a),C(o,t,a),s&&s.m(o,a),C(o,r,a)},p(o,a){a&1&&e!==(e=o[0].msg+"")&&B(n,e),o[0].details?s?s.p(o,a):(s=Vn(o),s.c(),s.m(r.parentNode,r)):s&&(s.d(1),s=null)},d(o){o&&(y(n),y(t),y(r)),s&&s.d(o)}}}function ci(i){let e,n,t=i[0]!==null&&Kn(i);return{c(){t&&t.c(),e=x()},m(r,s){t&&t.m(r,s),C(r,e,s),n=!0},p(r,[s]){r[0]!==null?t?(t.p(r,s),s&1&&m(t,1)):(t=Kn(r),t.c(),m(t,1),t.m(e.parentNode,e)):t&&(K(),$(t,1,1,()=>{t=null}),V())},i(r){n||(m(t),n=!0)},o(r){$(t),n=!1},d(r){r&&y(e),t&&t.d(r)}}}function fi(i,e,n){let t;return gn(i,G,s=>n(0,t=s)),[t,[{label:"OK",onclick:()=>{G.reset()}}]]}class di extends U{constructor(e){super(),D(this,e,fi,ci,L,{})}}const hi="modulepreload",pi=function(i,e){return new URL(i,e).href},Wn={},We=function(e,n,t){let r=Promise.resolve();if(n&&n.length>0){const s=document.getElementsByTagName("link"),o=document.querySelector("meta[property=csp-nonce]"),a=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));r=Promise.all(n.map(l=>{if(l=pi(l,t),l in Wn)return;Wn[l]=!0;const u=l.endsWith(".css"),c=u?'[rel="stylesheet"]':"";if(!!t)for(let f=s.length-1;f>=0;f--){const p=s[f];if(p.href===l&&(!u||p.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${l}"]${c}`))return;const h=document.createElement("link");if(h.rel=u?"stylesheet":hi,u||(h.as="script",h.crossOrigin=""),h.href=l,a&&h.setAttribute("nonce",a),document.head.appendChild(h),u)return new Promise((f,p)=>{h.addEventListener("load",f),h.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${l}`)))})}))}return r.then(()=>e()).catch(s=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=s,window.dispatchEvent(o),!o.defaultPrevented)throw s})},mi=i=>{let e;return i?e=i:typeof fetch>"u"?e=(...n)=>We(()=>Promise.resolve().then(()=>pt),void 0,import.meta.url).then(({default:t})=>t(...n)):e=fetch,(...n)=>e(...n)};class vn extends Error{constructor(e,n="FunctionsError",t){super(e),this.name=n,this.context=t}}class $i extends vn{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class _i extends vn{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class gi extends vn{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var cn;(function(i){i.Any="any",i.ApNortheast1="ap-northeast-1",i.ApNortheast2="ap-northeast-2",i.ApSouth1="ap-south-1",i.ApSoutheast1="ap-southeast-1",i.ApSoutheast2="ap-southeast-2",i.CaCentral1="ca-central-1",i.EuCentral1="eu-central-1",i.EuWest1="eu-west-1",i.EuWest2="eu-west-2",i.EuWest3="eu-west-3",i.SaEast1="sa-east-1",i.UsEast1="us-east-1",i.UsWest1="us-west-1",i.UsWest2="us-west-2"})(cn||(cn={}));var bi=function(i,e,n,t){function r(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function a(c){try{u(t.next(c))}catch(d){o(d)}}function l(c){try{u(t.throw(c))}catch(d){o(d)}}function u(c){c.done?s(c.value):r(c.value).then(a,l)}u((t=t.apply(i,e||[])).next())})};class wi{constructor(e,{headers:n={},customFetch:t,region:r=cn.Any}={}){this.url=e,this.headers=n,this.region=r,this.fetch=mi(t)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,n={}){var t;return bi(this,void 0,void 0,function*(){try{const{headers:r,method:s,body:o}=n;let a={},{region:l}=n;l||(l=this.region),l&&l!=="any"&&(a["x-region"]=l);let u;o&&(r&&!Object.prototype.hasOwnProperty.call(r,"Content-Type")||!r)&&(typeof Blob<"u"&&o instanceof Blob||o instanceof ArrayBuffer?(a["Content-Type"]="application/octet-stream",u=o):typeof o=="string"?(a["Content-Type"]="text/plain",u=o):typeof FormData<"u"&&o instanceof FormData?u=o:(a["Content-Type"]="application/json",u=JSON.stringify(o)));const c=yield this.fetch(`${this.url}/${e}`,{method:s||"POST",headers:Object.assign(Object.assign(Object.assign({},a),this.headers),r),body:u}).catch(p=>{throw new $i(p)}),d=c.headers.get("x-relay-error");if(d&&d==="true")throw new _i(c);if(!c.ok)throw new gi(c);let h=((t=c.headers.get("Content-Type"))!==null&&t!==void 0?t:"text/plain").split(";")[0].trim(),f;return h==="application/json"?f=yield c.json():h==="application/octet-stream"?f=yield c.blob():h==="text/event-stream"?f=c:h==="multipart/form-data"?f=yield c.formData():f=yield c.text(),{data:f,error:null}}catch(r){return{data:null,error:r}}})}}var vi=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Qe=vi();const ki=Qe.fetch,kn=Qe.fetch.bind(Qe),us=Qe.Headers,yi=Qe.Request,Ci=Qe.Response,pt=Object.freeze(Object.defineProperty({__proto__:null,Headers:us,Request:yi,Response:Ci,default:kn,fetch:ki},Symbol.toStringTag,{value:"Module"}));class Si extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}}class Ei{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=kn:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}then(e,n){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const t=this.fetch;let r=t(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async s=>{var o,a,l;let u=null,c=null,d=null,h=s.status,f=s.statusText;if(s.ok){if(this.method!=="HEAD"){const j=await s.text();j===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?c=j:c=JSON.parse(j))}const _=(o=this.headers.Prefer)===null||o===void 0?void 0:o.match(/count=(exact|planned|estimated)/),v=(a=s.headers.get("content-range"))===null||a===void 0?void 0:a.split("/");_&&v&&v.length>1&&(d=parseInt(v[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(c)&&(c.length>1?(u={code:"PGRST116",details:`Results contain ${c.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},c=null,d=null,h=406,f="Not Acceptable"):c.length===1?c=c[0]:c=null)}else{const _=await s.text();try{u=JSON.parse(_),Array.isArray(u)&&s.status===404&&(c=[],u=null,h=200,f="OK")}catch{s.status===404&&_===""?(h=204,f="No Content"):u={message:_}}if(u&&this.isMaybeSingle&&(!((l=u==null?void 0:u.details)===null||l===void 0)&&l.includes("0 rows"))&&(u=null,h=200,f="OK"),u&&this.shouldThrowOnError)throw new Si(u)}return{error:u,data:c,count:d,status:h,statusText:f}});return this.shouldThrowOnError||(r=r.catch(s=>{var o,a,l;return{error:{message:`${(o=s==null?void 0:s.name)!==null&&o!==void 0?o:"FetchError"}: ${s==null?void 0:s.message}`,details:`${(a=s==null?void 0:s.stack)!==null&&a!==void 0?a:""}`,hint:"",code:`${(l=s==null?void 0:s.code)!==null&&l!==void 0?l:""}`},data:null,count:null,status:0,statusText:""}})),r.then(e,n)}}class Ai extends Ei{select(e){let n=!1;const t=(e??"*").split("").map(r=>/\s/.test(r)&&!n?"":(r==='"'&&(n=!n),r)).join("");return this.url.searchParams.set("select",t),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e,{ascending:n=!0,nullsFirst:t,foreignTable:r,referencedTable:s=r}={}){const o=s?`${s}.order`:"order",a=this.url.searchParams.get(o);return this.url.searchParams.set(o,`${a?`${a},`:""}${e}.${n?"asc":"desc"}${t===void 0?"":t?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:n,referencedTable:t=n}={}){const r=typeof t>"u"?"limit":`${t}.limit`;return this.url.searchParams.set(r,`${e}`),this}range(e,n,{foreignTable:t,referencedTable:r=t}={}){const s=typeof r>"u"?"offset":`${r}.offset`,o=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(s,`${e}`),this.url.searchParams.set(o,`${n-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:e=!1,verbose:n=!1,settings:t=!1,buffers:r=!1,wal:s=!1,format:o="text"}={}){var a;const l=[e?"analyze":null,n?"verbose":null,t?"settings":null,r?"buffers":null,s?"wal":null].filter(Boolean).join("|"),u=(a=this.headers.Accept)!==null&&a!==void 0?a:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${o}; for="${u}"; options=${l};`,o==="json"?this:this}rollback(){var e;return((e=this.headers.Prefer)!==null&&e!==void 0?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}class Je extends Ai{eq(e,n){return this.url.searchParams.append(e,`eq.${n}`),this}neq(e,n){return this.url.searchParams.append(e,`neq.${n}`),this}gt(e,n){return this.url.searchParams.append(e,`gt.${n}`),this}gte(e,n){return this.url.searchParams.append(e,`gte.${n}`),this}lt(e,n){return this.url.searchParams.append(e,`lt.${n}`),this}lte(e,n){return this.url.searchParams.append(e,`lte.${n}`),this}like(e,n){return this.url.searchParams.append(e,`like.${n}`),this}likeAllOf(e,n){return this.url.searchParams.append(e,`like(all).{${n.join(",")}}`),this}likeAnyOf(e,n){return this.url.searchParams.append(e,`like(any).{${n.join(",")}}`),this}ilike(e,n){return this.url.searchParams.append(e,`ilike.${n}`),this}ilikeAllOf(e,n){return this.url.searchParams.append(e,`ilike(all).{${n.join(",")}}`),this}ilikeAnyOf(e,n){return this.url.searchParams.append(e,`ilike(any).{${n.join(",")}}`),this}is(e,n){return this.url.searchParams.append(e,`is.${n}`),this}in(e,n){const t=Array.from(new Set(n)).map(r=>typeof r=="string"&&new RegExp("[,()]").test(r)?`"${r}"`:`${r}`).join(",");return this.url.searchParams.append(e,`in.(${t})`),this}contains(e,n){return typeof n=="string"?this.url.searchParams.append(e,`cs.${n}`):Array.isArray(n)?this.url.searchParams.append(e,`cs.{${n.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(n)}`),this}containedBy(e,n){return typeof n=="string"?this.url.searchParams.append(e,`cd.${n}`):Array.isArray(n)?this.url.searchParams.append(e,`cd.{${n.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(n)}`),this}rangeGt(e,n){return this.url.searchParams.append(e,`sr.${n}`),this}rangeGte(e,n){return this.url.searchParams.append(e,`nxl.${n}`),this}rangeLt(e,n){return this.url.searchParams.append(e,`sl.${n}`),this}rangeLte(e,n){return this.url.searchParams.append(e,`nxr.${n}`),this}rangeAdjacent(e,n){return this.url.searchParams.append(e,`adj.${n}`),this}overlaps(e,n){return typeof n=="string"?this.url.searchParams.append(e,`ov.${n}`):this.url.searchParams.append(e,`ov.{${n.join(",")}}`),this}textSearch(e,n,{config:t,type:r}={}){let s="";r==="plain"?s="pl":r==="phrase"?s="ph":r==="websearch"&&(s="w");const o=t===void 0?"":`(${t})`;return this.url.searchParams.append(e,`${s}fts${o}.${n}`),this}match(e){return Object.entries(e).forEach(([n,t])=>{this.url.searchParams.append(n,`eq.${t}`)}),this}not(e,n,t){return this.url.searchParams.append(e,`not.${n}.${t}`),this}or(e,{foreignTable:n,referencedTable:t=n}={}){const r=t?`${t}.or`:"or";return this.url.searchParams.append(r,`(${e})`),this}filter(e,n,t){return this.url.searchParams.append(e,`${n}.${t}`),this}}class Ti{constructor(e,{headers:n={},schema:t,fetch:r}){this.url=e,this.headers=n,this.schema=t,this.fetch=r}select(e,{head:n=!1,count:t}={}){const r=n?"HEAD":"GET";let s=!1;const o=(e??"*").split("").map(a=>/\s/.test(a)&&!s?"":(a==='"'&&(s=!s),a)).join("");return this.url.searchParams.set("select",o),t&&(this.headers.Prefer=`count=${t}`),new Je({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e,{count:n,defaultToNull:t=!0}={}){const r="POST",s=[];if(this.headers.Prefer&&s.push(this.headers.Prefer),n&&s.push(`count=${n}`),t||s.push("missing=default"),this.headers.Prefer=s.join(","),Array.isArray(e)){const o=e.reduce((a,l)=>a.concat(Object.keys(l)),[]);if(o.length>0){const a=[...new Set(o)].map(l=>`"${l}"`);this.url.searchParams.set("columns",a.join(","))}}return new Je({method:r,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e,{onConflict:n,ignoreDuplicates:t=!1,count:r,defaultToNull:s=!0}={}){const o="POST",a=[`resolution=${t?"ignore":"merge"}-duplicates`];if(n!==void 0&&this.url.searchParams.set("on_conflict",n),this.headers.Prefer&&a.push(this.headers.Prefer),r&&a.push(`count=${r}`),s||a.push("missing=default"),this.headers.Prefer=a.join(","),Array.isArray(e)){const l=e.reduce((u,c)=>u.concat(Object.keys(c)),[]);if(l.length>0){const u=[...new Set(l)].map(c=>`"${c}"`);this.url.searchParams.set("columns",u.join(","))}}return new Je({method:o,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e,{count:n}={}){const t="PATCH",r=[];return this.headers.Prefer&&r.push(this.headers.Prefer),n&&r.push(`count=${n}`),this.headers.Prefer=r.join(","),new Je({method:t,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete({count:e}={}){const n="DELETE",t=[];return e&&t.push(`count=${e}`),this.headers.Prefer&&t.unshift(this.headers.Prefer),this.headers.Prefer=t.join(","),new Je({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}const Oi="1.15.2",ji={"X-Client-Info":`postgrest-js/${Oi}`};class yn{constructor(e,{headers:n={},schema:t,fetch:r}={}){this.url=e,this.headers=Object.assign(Object.assign({},ji),n),this.schemaName=t,this.fetch=r}from(e){const n=new URL(`${this.url}/${e}`);return new Ti(n,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new yn(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,n={},{head:t=!1,get:r=!1,count:s}={}){let o;const a=new URL(`${this.url}/rpc/${e}`);let l;t||r?(o=t?"HEAD":"GET",Object.entries(n).filter(([c,d])=>d!==void 0).map(([c,d])=>[c,Array.isArray(d)?`{${d.join(",")}}`:`${d}`]).forEach(([c,d])=>{a.searchParams.append(c,d)})):(o="POST",l=n);const u=Object.assign({},this.headers);return s&&(u.Prefer=`count=${s}`),new Je({method:o,url:a,headers:u,schema:this.schemaName,body:l,fetch:this.fetch,allowEmpty:!1})}}const Ii="2.9.5",Pi={"X-Client-Info":`realtime-js/${Ii}`},Ri="1.0.0",cs=1e4,Li=1e3;var Ke;(function(i){i[i.connecting=0]="connecting",i[i.open=1]="open",i[i.closing=2]="closing",i[i.closed=3]="closed"})(Ke||(Ke={}));var fe;(function(i){i.closed="closed",i.errored="errored",i.joined="joined",i.joining="joining",i.leaving="leaving"})(fe||(fe={}));var $e;(function(i){i.close="phx_close",i.error="phx_error",i.join="phx_join",i.reply="phx_reply",i.leave="phx_leave",i.access_token="access_token"})($e||($e={}));var fn;(function(i){i.websocket="websocket"})(fn||(fn={}));var Le;(function(i){i.Connecting="connecting",i.Open="open",i.Closing="closing",i.Closed="closed"})(Le||(Le={}));class fs{constructor(e,n){this.callback=e,this.timerCalc=n,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=n}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}class qi{constructor(){this.HEADER_LENGTH=1}decode(e,n){return e.constructor===ArrayBuffer?n(this._binaryDecode(e)):n(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const n=new DataView(e),t=new TextDecoder;return this._decodeBroadcast(e,n,t)}_decodeBroadcast(e,n,t){const r=n.getUint8(1),s=n.getUint8(2);let o=this.HEADER_LENGTH+2;const a=t.decode(e.slice(o,o+r));o=o+r;const l=t.decode(e.slice(o,o+s));o=o+s;const u=JSON.parse(t.decode(e.slice(o,e.byteLength)));return{ref:null,topic:a,event:l,payload:u}}}class xt{constructor(e,n,t={},r=cs){this.channel=e,this.event=n,this.payload=t,this.timeout=r,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,n){var t;return this._hasReceived(e)&&n((t=this.receivedResp)===null||t===void 0?void 0:t.response),this.recHooks.push({status:e,callback:n}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=n=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=n,this._matchReceive(n)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,n){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:n})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:n}){this.recHooks.filter(t=>t.status===e).forEach(t=>t.callback(n))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Qn;(function(i){i.SYNC="sync",i.JOIN="join",i.LEAVE="leave"})(Qn||(Qn={}));class ot{constructor(e,n){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const t=(n==null?void 0:n.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(t.state,{},r=>{const{onJoin:s,onLeave:o,onSync:a}=this.caller;this.joinRef=this.channel._joinRef(),this.state=ot.syncState(this.state,r,s,o),this.pendingDiffs.forEach(l=>{this.state=ot.syncDiff(this.state,l,s,o)}),this.pendingDiffs=[],a()}),this.channel._on(t.diff,{},r=>{const{onJoin:s,onLeave:o,onSync:a}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(r):(this.state=ot.syncDiff(this.state,r,s,o),a())}),this.onJoin((r,s,o)=>{this.channel._trigger("presence",{event:"join",key:r,currentPresences:s,newPresences:o})}),this.onLeave((r,s,o)=>{this.channel._trigger("presence",{event:"leave",key:r,currentPresences:s,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,n,t,r){const s=this.cloneDeep(e),o=this.transformState(n),a={},l={};return this.map(s,(u,c)=>{o[u]||(l[u]=c)}),this.map(o,(u,c)=>{const d=s[u];if(d){const h=c.map(v=>v.presence_ref),f=d.map(v=>v.presence_ref),p=c.filter(v=>f.indexOf(v.presence_ref)<0),_=d.filter(v=>h.indexOf(v.presence_ref)<0);p.length>0&&(a[u]=p),_.length>0&&(l[u]=_)}else a[u]=c}),this.syncDiff(s,{joins:a,leaves:l},t,r)}static syncDiff(e,n,t,r){const{joins:s,leaves:o}={joins:this.transformState(n.joins),leaves:this.transformState(n.leaves)};return t||(t=()=>{}),r||(r=()=>{}),this.map(s,(a,l)=>{var u;const c=(u=e[a])!==null&&u!==void 0?u:[];if(e[a]=this.cloneDeep(l),c.length>0){const d=e[a].map(f=>f.presence_ref),h=c.filter(f=>d.indexOf(f.presence_ref)<0);e[a].unshift(...h)}t(a,c,l)}),this.map(o,(a,l)=>{let u=e[a];if(!u)return;const c=l.map(d=>d.presence_ref);u=u.filter(d=>c.indexOf(d.presence_ref)<0),e[a]=u,r(a,u,l),u.length===0&&delete e[a]}),e}static map(e,n){return Object.getOwnPropertyNames(e).map(t=>n(t,e[t]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((n,t)=>{const r=e[t];return"metas"in r?n[t]=r.metas.map(s=>(s.presence_ref=s.phx_ref,delete s.phx_ref,delete s.phx_ref_prev,s)):n[t]=r,n},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var X;(function(i){i.abstime="abstime",i.bool="bool",i.date="date",i.daterange="daterange",i.float4="float4",i.float8="float8",i.int2="int2",i.int4="int4",i.int4range="int4range",i.int8="int8",i.int8range="int8range",i.json="json",i.jsonb="jsonb",i.money="money",i.numeric="numeric",i.oid="oid",i.reltime="reltime",i.text="text",i.time="time",i.timestamp="timestamp",i.timestamptz="timestamptz",i.timetz="timetz",i.tsrange="tsrange",i.tstzrange="tstzrange"})(X||(X={}));const Xn=(i,e,n={})=>{var t;const r=(t=n.skipTypes)!==null&&t!==void 0?t:[];return Object.keys(e).reduce((s,o)=>(s[o]=Di(o,i,e,r),s),{})},Di=(i,e,n,t)=>{const r=e.find(a=>a.name===i),s=r==null?void 0:r.type,o=n[i];return s&&!t.includes(s)?ds(s,o):dn(o)},ds=(i,e)=>{if(i.charAt(0)==="_"){const n=i.slice(1,i.length);return Mi(e,n)}switch(i){case X.bool:return Ui(e);case X.float4:case X.float8:case X.int2:case X.int4:case X.int8:case X.numeric:case X.oid:return Ni(e);case X.json:case X.jsonb:return Bi(e);case X.timestamp:return Fi(e);case X.abstime:case X.date:case X.daterange:case X.int4range:case X.int8range:case X.money:case X.reltime:case X.text:case X.time:case X.timestamptz:case X.timetz:case X.tsrange:case X.tstzrange:return dn(e);default:return dn(e)}},dn=i=>i,Ui=i=>{switch(i){case"t":return!0;case"f":return!1;default:return i}},Ni=i=>{if(typeof i=="string"){const e=parseFloat(i);if(!Number.isNaN(e))return e}return i},Bi=i=>{if(typeof i=="string")try{return JSON.parse(i)}catch(e){return console.log(`JSON parse error: ${e}`),i}return i},Mi=(i,e)=>{if(typeof i!="string")return i;const n=i.length-1,t=i[n];if(i[0]==="{"&&t==="}"){let s;const o=i.slice(1,n);try{s=JSON.parse("["+o+"]")}catch{s=o?o.split(","):[]}return s.map(a=>ds(e,a))}return i},Fi=i=>typeof i=="string"?i.replace(" ","T"):i;var Yn;(function(i){i.ALL="*",i.INSERT="INSERT",i.UPDATE="UPDATE",i.DELETE="DELETE"})(Yn||(Yn={}));var Zn;(function(i){i.BROADCAST="broadcast",i.PRESENCE="presence",i.POSTGRES_CHANGES="postgres_changes"})(Zn||(Zn={}));var xn;(function(i){i.SUBSCRIBED="SUBSCRIBED",i.TIMED_OUT="TIMED_OUT",i.CLOSED="CLOSED",i.CHANNEL_ERROR="CHANNEL_ERROR"})(xn||(xn={}));class Cn{constructor(e,n={config:{}},t){this.topic=e,this.params=n,this.socket=t,this.bindings={},this.state=fe.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""}},n.config),this.timeout=this.socket.timeout,this.joinPush=new xt(this,$e.join,this.params,this.timeout),this.rejoinTimer=new fs(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=fe.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(r=>r.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=fe.closed,this.socket._remove(this)}),this._onError(r=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,r),this.state=fe.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=fe.errored,this.rejoinTimer.scheduleTimeout())}),this._on($e.reply,{},(r,s)=>{this._trigger(this._replyEventName(s),r)}),this.presence=new ot(this),this.broadcastEndpointURL=this._broadcastEndpointURL()}subscribe(e,n=this.timeout){var t,r;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:s,presence:o}}=this.params;this._onError(u=>e&&e("CHANNEL_ERROR",u)),this._onClose(()=>e&&e("CLOSED"));const a={},l={broadcast:s,presence:o,postgres_changes:(r=(t=this.bindings.postgres_changes)===null||t===void 0?void 0:t.map(u=>u.filter))!==null&&r!==void 0?r:[]};this.socket.accessToken&&(a.access_token=this.socket.accessToken),this.updateJoinPayload(Object.assign({config:l},a)),this.joinedOnce=!0,this._rejoin(n),this.joinPush.receive("ok",({postgres_changes:u})=>{var c;if(this.socket.accessToken&&this.socket.setAuth(this.socket.accessToken),u===void 0){e&&e("SUBSCRIBED");return}else{const d=this.bindings.postgres_changes,h=(c=d==null?void 0:d.length)!==null&&c!==void 0?c:0,f=[];for(let p=0;p<h;p++){const _=d[p],{filter:{event:v,schema:j,table:E,filter:O}}=_,I=u&&u[p];if(I&&I.event===v&&I.schema===j&&I.table===E&&I.filter===O)f.push(Object.assign(Object.assign({},_),{id:I.id}));else{this.unsubscribe(),e&&e("CHANNEL_ERROR",new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=f,e&&e("SUBSCRIBED");return}}).receive("error",u=>{e&&e("CHANNEL_ERROR",new Error(JSON.stringify(Object.values(u).join(", ")||"error")))}).receive("timeout",()=>{e&&e("TIMED_OUT")})}return this}presenceState(){return this.presence.state}async track(e,n={}){return await this.send({type:"presence",event:"track",payload:e},n.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,n,t){return this._on(e,n,t)}async send(e,n={}){var t,r;if(!this._canPush()&&e.type==="broadcast"){const{event:s,payload:o}=e,a={method:"POST",headers:{apikey:(t=this.socket.apiKey)!==null&&t!==void 0?t:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:o}]})};try{return(await this._fetchWithTimeout(this.broadcastEndpointURL,a,(r=n.timeout)!==null&&r!==void 0?r:this.timeout)).ok?"ok":"error"}catch(l){return l.name==="AbortError"?"timed out":"error"}}else return new Promise(s=>{var o,a,l;const u=this._push(e.type,e,n.timeout||this.timeout);e.type==="broadcast"&&!(!((l=(a=(o=this.params)===null||o===void 0?void 0:o.config)===null||a===void 0?void 0:a.broadcast)===null||l===void 0)&&l.ack)&&s("ok"),u.receive("ok",()=>s("ok")),u.receive("error",()=>s("error")),u.receive("timeout",()=>s("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=fe.leaving;const n=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger($e.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(t=>{const r=new xt(this,$e.leave,{},e);r.receive("ok",()=>{n(),t("ok")}).receive("timeout",()=>{n(),t("timed out")}).receive("error",()=>{t("error")}),r.send(),this._canPush()||r.trigger("ok",{})})}_broadcastEndpointURL(){let e=this.socket.endPoint;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")+"/api/broadcast"}async _fetchWithTimeout(e,n,t){const r=new AbortController,s=setTimeout(()=>r.abort(),t),o=await this.socket.fetch(e,Object.assign(Object.assign({},n),{signal:r.signal}));return clearTimeout(s),o}_push(e,n,t=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let r=new xt(this,e,n,t);return this._canPush()?r.send():(r.startTimeout(),this.pushBuffer.push(r)),r}_onMessage(e,n,t){return n}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,n,t){var r,s;const o=e.toLocaleLowerCase(),{close:a,error:l,leave:u,join:c}=$e;if(t&&[a,l,u,c].indexOf(o)>=0&&t!==this._joinRef())return;let h=this._onMessage(o,n,t);if(n&&!h)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(r=this.bindings.postgres_changes)===null||r===void 0||r.filter(f=>{var p,_,v;return((p=f.filter)===null||p===void 0?void 0:p.event)==="*"||((v=(_=f.filter)===null||_===void 0?void 0:_.event)===null||v===void 0?void 0:v.toLocaleLowerCase())===o}).map(f=>f.callback(h,t)):(s=this.bindings[o])===null||s===void 0||s.filter(f=>{var p,_,v,j,E,O;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in f){const I=f.id,P=(p=f.filter)===null||p===void 0?void 0:p.event;return I&&((_=n.ids)===null||_===void 0?void 0:_.includes(I))&&(P==="*"||(P==null?void 0:P.toLocaleLowerCase())===((v=n.data)===null||v===void 0?void 0:v.type.toLocaleLowerCase()))}else{const I=(E=(j=f==null?void 0:f.filter)===null||j===void 0?void 0:j.event)===null||E===void 0?void 0:E.toLocaleLowerCase();return I==="*"||I===((O=n==null?void 0:n.event)===null||O===void 0?void 0:O.toLocaleLowerCase())}else return f.type.toLocaleLowerCase()===o}).map(f=>{if(typeof h=="object"&&"ids"in h){const p=h.data,{schema:_,table:v,commit_timestamp:j,type:E,errors:O}=p;h=Object.assign(Object.assign({},{schema:_,table:v,commit_timestamp:j,eventType:E,new:{},old:{},errors:O}),this._getPayloadRecords(p))}f.callback(h,t)})}_isClosed(){return this.state===fe.closed}_isJoined(){return this.state===fe.joined}_isJoining(){return this.state===fe.joining}_isLeaving(){return this.state===fe.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,n,t){const r=e.toLocaleLowerCase(),s={type:r,filter:n,callback:t};return this.bindings[r]?this.bindings[r].push(s):this.bindings[r]=[s],this}_off(e,n){const t=e.toLocaleLowerCase();return this.bindings[t]=this.bindings[t].filter(r=>{var s;return!(((s=r.type)===null||s===void 0?void 0:s.toLocaleLowerCase())===t&&Cn.isEqual(r.filter,n))}),this}static isEqual(e,n){if(Object.keys(e).length!==Object.keys(n).length)return!1;for(const t in e)if(e[t]!==n[t])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on($e.close,{},e)}_onError(e){this._on($e.error,{},n=>e(n))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=fe.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const n={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(n.new=Xn(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(n.old=Xn(e.columns,e.old_record)),n}}const zi=()=>{},Hi=typeof WebSocket<"u";class Ji{constructor(e,n){var t;this.accessToken=null,this.apiKey=null,this.channels=[],this.endPoint="",this.headers=Pi,this.params={},this.timeout=cs,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=zi,this.conn=null,this.sendBuffer=[],this.serializer=new qi,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this._resolveFetch=s=>{let o;return s?o=s:typeof fetch>"u"?o=(...a)=>We(()=>Promise.resolve().then(()=>pt),void 0,import.meta.url).then(({default:l})=>l(...a)):o=fetch,(...a)=>o(...a)},this.endPoint=`${e}/${fn.websocket}`,n!=null&&n.transport?this.transport=n.transport:this.transport=null,n!=null&&n.params&&(this.params=n.params),n!=null&&n.headers&&(this.headers=Object.assign(Object.assign({},this.headers),n.headers)),n!=null&&n.timeout&&(this.timeout=n.timeout),n!=null&&n.logger&&(this.logger=n.logger),n!=null&&n.heartbeatIntervalMs&&(this.heartbeatIntervalMs=n.heartbeatIntervalMs);const r=(t=n==null?void 0:n.params)===null||t===void 0?void 0:t.apikey;r&&(this.accessToken=r,this.apiKey=r),this.reconnectAfterMs=n!=null&&n.reconnectAfterMs?n.reconnectAfterMs:s=>[1e3,2e3,5e3,1e4][s-1]||1e4,this.encode=n!=null&&n.encode?n.encode:(s,o)=>o(JSON.stringify(s)),this.decode=n!=null&&n.decode?n.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new fs(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(n==null?void 0:n.fetch)}connect(){if(!this.conn){if(this.transport){this.conn=new this.transport(this._endPointURL(),void 0,{headers:this.headers});return}if(Hi){this.conn=new WebSocket(this._endPointURL()),this.setupConnection();return}this.conn=new Gi(this._endPointURL(),void 0,{close:()=>{this.conn=null}}),We(()=>import("./browser-BImCA5dO.js").then(e=>e.b),[],import.meta.url).then(({default:e})=>{this.conn=new e(this._endPointURL(),void 0,{headers:this.headers}),this.setupConnection()})}}disconnect(e,n){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,n??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(e){const n=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),n}async removeAllChannels(){const e=await Promise.all(this.channels.map(n=>n.unsubscribe()));return this.disconnect(),e}log(e,n,t){this.logger(e,n,t)}connectionState(){switch(this.conn&&this.conn.readyState){case Ke.connecting:return Le.Connecting;case Ke.open:return Le.Open;case Ke.closing:return Le.Closing;default:return Le.Closed}}isConnected(){return this.connectionState()===Le.Open}channel(e,n={config:{}}){const t=new Cn(`realtime:${e}`,n,this);return this.channels.push(t),t}push(e){const{topic:n,event:t,payload:r,ref:s}=e,o=()=>{this.encode(e,a=>{var l;(l=this.conn)===null||l===void 0||l.send(a)})};this.log("push",`${n} ${t} (${s})`,r),this.isConnected()?o():this.sendBuffer.push(o)}setAuth(e){this.accessToken=e,this.channels.forEach(n=>{e&&n.updateJoinPayload({access_token:e}),n.joinedOnce&&n._isJoined()&&n._push($e.access_token,{access_token:e})})}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let n=this.channels.find(t=>t.topic===e&&(t._isJoined()||t._isJoining()));n&&(this.log("transport",`leaving duplicate topic "${e}"`),n.unsubscribe())}_remove(e){this.channels=this.channels.filter(n=>n._joinRef()!==e._joinRef())}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_endPointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:Ri}))}_onConnMessage(e){this.decode(e.data,n=>{let{topic:t,event:r,payload:s,ref:o}=n;(o&&o===this.pendingHeartbeatRef||r===(s==null?void 0:s.type))&&(this.pendingHeartbeatRef=null),this.log("receive",`${s.status||""} ${t} ${r} ${o&&"("+o+")"||""}`,s),this.channels.filter(a=>a._isMember(t)).forEach(a=>a._trigger(r,s,o)),this.stateChangeCallbacks.message.forEach(a=>a(n))})}_onConnOpen(){this.log("transport",`connected to ${this._endPointURL()}`),this._flushSendBuffer(),this.reconnectTimer.reset(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this._sendHeartbeat(),this.heartbeatIntervalMs),this.stateChangeCallbacks.open.forEach(e=>e())}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(n=>n(e))}_onConnError(e){this.log("transport",e.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(n=>n(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger($e.error))}_appendParams(e,n){if(Object.keys(n).length===0)return e;const t=e.match(/\?/)?"&":"?",r=new URLSearchParams(n);return`${e}${t}${r}`}_flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(e=this.conn)===null||e===void 0||e.close(Li,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth(this.accessToken)}}}class Gi{constructor(e,n,t){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=Ke.connecting,this.send=()=>{},this.url=null,this.url=e,this.close=t.close}}class Sn extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function oe(i){return typeof i=="object"&&i!==null&&"__isStorageError"in i}class Ki extends Sn{constructor(e,n){super(e),this.name="StorageApiError",this.status=n}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class er extends Sn{constructor(e,n){super(e),this.name="StorageUnknownError",this.originalError=n}}var Vi=function(i,e,n,t){function r(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function a(c){try{u(t.next(c))}catch(d){o(d)}}function l(c){try{u(t.throw(c))}catch(d){o(d)}}function u(c){c.done?s(c.value):r(c.value).then(a,l)}u((t=t.apply(i,e||[])).next())})};const hs=i=>{let e;return i?e=i:typeof fetch>"u"?e=(...n)=>We(()=>Promise.resolve().then(()=>pt),void 0,import.meta.url).then(({default:t})=>t(...n)):e=fetch,(...n)=>e(...n)},Wi=()=>Vi(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield We(()=>Promise.resolve().then(()=>pt),void 0,import.meta.url)).Response:Response});var Ze=function(i,e,n,t){function r(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function a(c){try{u(t.next(c))}catch(d){o(d)}}function l(c){try{u(t.throw(c))}catch(d){o(d)}}function u(c){c.done?s(c.value):r(c.value).then(a,l)}u((t=t.apply(i,e||[])).next())})};const en=i=>i.msg||i.message||i.error_description||i.error||JSON.stringify(i),Qi=(i,e)=>Ze(void 0,void 0,void 0,function*(){const n=yield Wi();i instanceof n?i.json().then(t=>{e(new Ki(en(t),i.status||500))}).catch(t=>{e(new er(en(t),t))}):e(new er(en(i),i))}),Xi=(i,e,n,t)=>{const r={method:i,headers:(e==null?void 0:e.headers)||{}};return i==="GET"?r:(r.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),r.body=JSON.stringify(t),Object.assign(Object.assign({},r),n))};function It(i,e,n,t,r,s){return Ze(this,void 0,void 0,function*(){return new Promise((o,a)=>{i(n,Xi(e,t,r,s)).then(l=>{if(!l.ok)throw l;return t!=null&&t.noResolveJson?l:l.json()}).then(l=>o(l)).catch(l=>Qi(l,a))})})}function hn(i,e,n,t){return Ze(this,void 0,void 0,function*(){return It(i,"GET",e,n,t)})}function Ae(i,e,n,t,r){return Ze(this,void 0,void 0,function*(){return It(i,"POST",e,t,r,n)})}function Yi(i,e,n,t,r){return Ze(this,void 0,void 0,function*(){return It(i,"PUT",e,t,r,n)})}function ps(i,e,n,t,r){return Ze(this,void 0,void 0,function*(){return It(i,"DELETE",e,t,r,n)})}var de=function(i,e,n,t){function r(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function a(c){try{u(t.next(c))}catch(d){o(d)}}function l(c){try{u(t.throw(c))}catch(d){o(d)}}function u(c){c.done?s(c.value):r(c.value).then(a,l)}u((t=t.apply(i,e||[])).next())})};const Zi={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},tr={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class xi{constructor(e,n={},t,r){this.url=e,this.headers=n,this.bucketId=t,this.fetch=hs(r)}uploadOrUpdate(e,n,t,r){return de(this,void 0,void 0,function*(){try{let s;const o=Object.assign(Object.assign({},tr),r),a=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(o.upsert)});typeof Blob<"u"&&t instanceof Blob?(s=new FormData,s.append("cacheControl",o.cacheControl),s.append("",t)):typeof FormData<"u"&&t instanceof FormData?(s=t,s.append("cacheControl",o.cacheControl)):(s=t,a["cache-control"]=`max-age=${o.cacheControl}`,a["content-type"]=o.contentType);const l=this._removeEmptyFolders(n),u=this._getFinalPath(l),c=yield this.fetch(`${this.url}/object/${u}`,Object.assign({method:e,body:s,headers:a},o!=null&&o.duplex?{duplex:o.duplex}:{})),d=yield c.json();return c.ok?{data:{path:l,id:d.Id,fullPath:d.Key},error:null}:{data:null,error:d}}catch(s){if(oe(s))return{data:null,error:s};throw s}})}upload(e,n,t){return de(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,n,t)})}uploadToSignedUrl(e,n,t,r){return de(this,void 0,void 0,function*(){const s=this._removeEmptyFolders(e),o=this._getFinalPath(s),a=new URL(this.url+`/object/upload/sign/${o}`);a.searchParams.set("token",n);try{let l;const u=Object.assign({upsert:tr.upsert},r),c=Object.assign(Object.assign({},this.headers),{"x-upsert":String(u.upsert)});typeof Blob<"u"&&t instanceof Blob?(l=new FormData,l.append("cacheControl",u.cacheControl),l.append("",t)):typeof FormData<"u"&&t instanceof FormData?(l=t,l.append("cacheControl",u.cacheControl)):(l=t,c["cache-control"]=`max-age=${u.cacheControl}`,c["content-type"]=u.contentType);const d=yield this.fetch(a.toString(),{method:"PUT",body:l,headers:c}),h=yield d.json();return d.ok?{data:{path:s,fullPath:h.Key},error:null}:{data:null,error:h}}catch(l){if(oe(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(e){return de(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e);const t=yield Ae(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:this.headers}),r=new URL(this.url+t.url),s=r.searchParams.get("token");if(!s)throw new Sn("No token returned by API");return{data:{signedUrl:r.toString(),path:e,token:s},error:null}}catch(n){if(oe(n))return{data:null,error:n};throw n}})}update(e,n,t){return de(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,n,t)})}move(e,n){return de(this,void 0,void 0,function*(){try{return{data:yield Ae(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n},{headers:this.headers}),error:null}}catch(t){if(oe(t))return{data:null,error:t};throw t}})}copy(e,n){return de(this,void 0,void 0,function*(){try{return{data:{path:(yield Ae(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n},{headers:this.headers})).Key},error:null}}catch(t){if(oe(t))return{data:null,error:t};throw t}})}createSignedUrl(e,n,t){return de(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e),s=yield Ae(this.fetch,`${this.url}/object/sign/${r}`,Object.assign({expiresIn:n},t!=null&&t.transform?{transform:t.transform}:{}),{headers:this.headers});const o=t!=null&&t.download?`&download=${t.download===!0?"":t.download}`:"";return s={signedUrl:encodeURI(`${this.url}${s.signedURL}${o}`)},{data:s,error:null}}catch(r){if(oe(r))return{data:null,error:r};throw r}})}createSignedUrls(e,n,t){return de(this,void 0,void 0,function*(){try{const r=yield Ae(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:n,paths:e},{headers:this.headers}),s=t!=null&&t.download?`&download=${t.download===!0?"":t.download}`:"";return{data:r.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${s}`):null})),error:null}}catch(r){if(oe(r))return{data:null,error:r};throw r}})}download(e,n){return de(this,void 0,void 0,function*(){const r=typeof(n==null?void 0:n.transform)<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString((n==null?void 0:n.transform)||{}),o=s?`?${s}`:"";try{const a=this._getFinalPath(e);return{data:yield(yield hn(this.fetch,`${this.url}/${r}/${a}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(a){if(oe(a))return{data:null,error:a};throw a}})}getPublicUrl(e,n){const t=this._getFinalPath(e),r=[],s=n!=null&&n.download?`download=${n.download===!0?"":n.download}`:"";s!==""&&r.push(s);const a=typeof(n==null?void 0:n.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((n==null?void 0:n.transform)||{});l!==""&&r.push(l);let u=r.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${a}/public/${t}${u}`)}}}remove(e){return de(this,void 0,void 0,function*(){try{return{data:yield ps(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(n){if(oe(n))return{data:null,error:n};throw n}})}list(e,n,t){return de(this,void 0,void 0,function*(){try{const r=Object.assign(Object.assign(Object.assign({},Zi),n),{prefix:e||""});return{data:yield Ae(this.fetch,`${this.url}/object/list/${this.bucketId}`,r,{headers:this.headers},t),error:null}}catch(r){if(oe(r))return{data:null,error:r};throw r}})}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const n=[];return e.width&&n.push(`width=${e.width}`),e.height&&n.push(`height=${e.height}`),e.resize&&n.push(`resize=${e.resize}`),e.format&&n.push(`format=${e.format}`),e.quality&&n.push(`quality=${e.quality}`),n.join("&")}}const eo="2.5.5",to={"X-Client-Info":`storage-js/${eo}`};var Me=function(i,e,n,t){function r(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function a(c){try{u(t.next(c))}catch(d){o(d)}}function l(c){try{u(t.throw(c))}catch(d){o(d)}}function u(c){c.done?s(c.value):r(c.value).then(a,l)}u((t=t.apply(i,e||[])).next())})};class no{constructor(e,n={},t){this.url=e,this.headers=Object.assign(Object.assign({},to),n),this.fetch=hs(t)}listBuckets(){return Me(this,void 0,void 0,function*(){try{return{data:yield hn(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(oe(e))return{data:null,error:e};throw e}})}getBucket(e){return Me(this,void 0,void 0,function*(){try{return{data:yield hn(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(n){if(oe(n))return{data:null,error:n};throw n}})}createBucket(e,n={public:!1}){return Me(this,void 0,void 0,function*(){try{return{data:yield Ae(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(t){if(oe(t))return{data:null,error:t};throw t}})}updateBucket(e,n){return Me(this,void 0,void 0,function*(){try{return{data:yield Yi(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(t){if(oe(t))return{data:null,error:t};throw t}})}emptyBucket(e){return Me(this,void 0,void 0,function*(){try{return{data:yield Ae(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(n){if(oe(n))return{data:null,error:n};throw n}})}deleteBucket(e){return Me(this,void 0,void 0,function*(){try{return{data:yield ps(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(n){if(oe(n))return{data:null,error:n};throw n}})}}class ro extends no{constructor(e,n={},t){super(e,n,t)}from(e){return new xi(this.url,this.headers,e,this.fetch)}}const so="2.43.4";let st="";typeof Deno<"u"?st="deno":typeof document<"u"?st="web":typeof navigator<"u"&&navigator.product==="ReactNative"?st="react-native":st="node";const io={"X-Client-Info":`supabase-js-${st}/${so}`},oo={headers:io},ao={schema:"public"},lo={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},uo={};var co=function(i,e,n,t){function r(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function a(c){try{u(t.next(c))}catch(d){o(d)}}function l(c){try{u(t.throw(c))}catch(d){o(d)}}function u(c){c.done?s(c.value):r(c.value).then(a,l)}u((t=t.apply(i,e||[])).next())})};const fo=i=>{let e;return i?e=i:typeof fetch>"u"?e=kn:e=fetch,(...n)=>e(...n)},ho=()=>typeof Headers>"u"?us:Headers,po=(i,e,n)=>{const t=fo(n),r=ho();return(s,o)=>co(void 0,void 0,void 0,function*(){var a;const l=(a=yield e())!==null&&a!==void 0?a:i;let u=new r(o==null?void 0:o.headers);return u.has("apikey")||u.set("apikey",i),u.has("Authorization")||u.set("Authorization",`Bearer ${l}`),t(s,Object.assign(Object.assign({},o),{headers:u}))})};function mo(i){return i.replace(/\/$/,"")}function $o(i,e){const{db:n,auth:t,realtime:r,global:s}=i,{db:o,auth:a,realtime:l,global:u}=e;return{db:Object.assign(Object.assign({},o),n),auth:Object.assign(Object.assign({},a),t),realtime:Object.assign(Object.assign({},l),r),global:Object.assign(Object.assign({},u),s)}}const ms="2.64.2",_o="http://localhost:9999",go="supabase.auth.token",bo={"X-Client-Info":`gotrue-js/${ms}`},nr=10,pn="X-Supabase-Api-Version",$s={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}};function wo(i){return Math.round(Date.now()/1e3)+i}function vo(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(i){const e=Math.random()*16|0;return(i=="x"?e:e&3|8).toString(16)})}const me=()=>typeof document<"u",Ie={tested:!1,writable:!1},at=()=>{if(!me())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Ie.tested)return Ie.writable;const i=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(i,i),globalThis.localStorage.removeItem(i),Ie.tested=!0,Ie.writable=!0}catch{Ie.tested=!0,Ie.writable=!1}return Ie.writable};function tn(i){const e={},n=new URL(i);if(n.hash&&n.hash[0]==="#")try{new URLSearchParams(n.hash.substring(1)).forEach((r,s)=>{e[s]=r})}catch{}return n.searchParams.forEach((t,r)=>{e[r]=t}),e}const _s=i=>{let e;return i?e=i:typeof fetch>"u"?e=(...n)=>We(()=>Promise.resolve().then(()=>pt),void 0,import.meta.url).then(({default:t})=>t(...n)):e=fetch,(...n)=>e(...n)},ko=i=>typeof i=="object"&&i!==null&&"status"in i&&"ok"in i&&"json"in i&&typeof i.json=="function",gs=async(i,e,n)=>{await i.setItem(e,JSON.stringify(n))},wt=async(i,e)=>{const n=await i.getItem(e);if(!n)return null;try{return JSON.parse(n)}catch{return n}},nn=async(i,e)=>{await i.removeItem(e)};function yo(i){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let n="",t,r,s,o,a,l,u,c=0;for(i=i.replace("-","+").replace("_","/");c<i.length;)o=e.indexOf(i.charAt(c++)),a=e.indexOf(i.charAt(c++)),l=e.indexOf(i.charAt(c++)),u=e.indexOf(i.charAt(c++)),t=o<<2|a>>4,r=(a&15)<<4|l>>2,s=(l&3)<<6|u,n=n+String.fromCharCode(t),l!=64&&r!=0&&(n=n+String.fromCharCode(r)),u!=64&&s!=0&&(n=n+String.fromCharCode(s));return n}class Pt{constructor(){this.promise=new Pt.promiseConstructor((e,n)=>{this.resolve=e,this.reject=n})}}Pt.promiseConstructor=Promise;function rr(i){const e=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}=?$|[a-z0-9_-]{2}(==)?$)$/i,n=i.split(".");if(n.length!==3)throw new Error("JWT is not valid: not a JWT structure");if(!e.test(n[1]))throw new Error("JWT is not valid: payload is not in base64url format");const t=n[1];return JSON.parse(yo(t))}async function Co(i){return await new Promise(e=>{setTimeout(()=>e(null),i)})}function So(i,e){return new Promise((t,r)=>{(async()=>{for(let s=0;s<1/0;s++)try{const o=await i(s);if(!e(s,null,o)){t(o);return}}catch(o){if(!e(s,o)){r(o);return}}})()})}function Eo(i){return("0"+i.toString(16)).substr(-2)}function Ao(){const e=new Uint32Array(56);if(typeof crypto>"u"){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",t=n.length;let r="";for(let s=0;s<56;s++)r+=n.charAt(Math.floor(Math.random()*t));return r}return crypto.getRandomValues(e),Array.from(e,Eo).join("")}async function To(i){const n=new TextEncoder().encode(i),t=await crypto.subtle.digest("SHA-256",n),r=new Uint8Array(t);return Array.from(r).map(s=>String.fromCharCode(s)).join("")}function Oo(i){return btoa(i).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function jo(i){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),i;const n=await To(i);return Oo(n)}async function Fe(i,e,n=!1){const t=Ao();let r=t;n&&(r+="/PASSWORD_RECOVERY"),await gs(i,`${e}-code-verifier`,r);const s=await jo(t);return[s,t===s?"plain":"s256"]}const Io=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Po(i){const e=i.headers.get(pn);if(!e||!e.match(Io))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}class En extends Error{constructor(e,n,t){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=n,this.code=t}}function z(i){return typeof i=="object"&&i!==null&&"__isAuthError"in i}class Ro extends En{constructor(e,n,t){super(e,n,t),this.name="AuthApiError",this.status=n,this.code=t}}function Lo(i){return z(i)&&i.name==="AuthApiError"}class bs extends En{constructor(e,n){super(e),this.name="AuthUnknownError",this.originalError=n}}class Ue extends En{constructor(e,n,t,r){super(e,t,r),this.name=n,this.status=t}}class Pe extends Ue{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}class rn extends Ue{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class vt extends Ue{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class kt extends Ue{constructor(e,n=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class sr extends Ue{constructor(e,n=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class mn extends Ue{constructor(e,n){super(e,"AuthRetryableFetchError",n,void 0)}}function sn(i){return z(i)&&i.name==="AuthRetryableFetchError"}class ir extends Ue{constructor(e,n,t){super(e,"AuthWeakPasswordError",n,"weak_password"),this.reasons=t}}var qo=function(i,e){var n={};for(var t in i)Object.prototype.hasOwnProperty.call(i,t)&&e.indexOf(t)<0&&(n[t]=i[t]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,t=Object.getOwnPropertySymbols(i);r<t.length;r++)e.indexOf(t[r])<0&&Object.prototype.propertyIsEnumerable.call(i,t[r])&&(n[t[r]]=i[t[r]]);return n};const Re=i=>i.msg||i.message||i.error_description||i.error||JSON.stringify(i),Do=[502,503,504];async function or(i){var e;if(!ko(i))throw new mn(Re(i),0);if(Do.includes(i.status))throw new mn(Re(i),i.status);let n;try{n=await i.json()}catch(s){throw new bs(Re(s),s)}let t;const r=Po(i);if(r&&r.getTime()>=$s["2024-01-01"].timestamp&&typeof n=="object"&&n&&typeof n.code=="string"?t=n.code:typeof n=="object"&&n&&typeof n.error_code=="string"&&(t=n.error_code),t){if(t==="weak_password")throw new ir(Re(n),i.status,((e=n.weak_password)===null||e===void 0?void 0:e.reasons)||[])}else if(typeof n=="object"&&n&&typeof n.weak_password=="object"&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((s,o)=>s&&typeof o=="string",!0))throw new ir(Re(n),i.status,n.weak_password.reasons);throw new Ro(Re(n),i.status||500,t)}const Uo=(i,e,n,t)=>{const r={method:i,headers:(e==null?void 0:e.headers)||{}};return i==="GET"?r:(r.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),r.body=JSON.stringify(t),Object.assign(Object.assign({},r),n))};async function H(i,e,n,t){var r;const s=Object.assign({},t==null?void 0:t.headers);s[pn]||(s[pn]=$s["2024-01-01"].name),t!=null&&t.jwt&&(s.Authorization=`Bearer ${t.jwt}`);const o=(r=t==null?void 0:t.query)!==null&&r!==void 0?r:{};t!=null&&t.redirectTo&&(o.redirect_to=t.redirectTo);const a=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",l=await No(i,e,n+a,{headers:s,noResolveJson:t==null?void 0:t.noResolveJson},{},t==null?void 0:t.body);return t!=null&&t.xform?t==null?void 0:t.xform(l):{data:Object.assign({},l),error:null}}async function No(i,e,n,t,r,s){const o=Uo(e,t,r,s);let a;try{a=await i(n,Object.assign({},o))}catch(l){throw console.error(l),new mn(Re(l),0)}if(a.ok||await or(a),t!=null&&t.noResolveJson)return a;try{return await a.json()}catch(l){await or(l)}}function Ee(i){var e;let n=null;zo(i)&&(n=Object.assign({},i),i.expires_at||(n.expires_at=wo(i.expires_in)));const t=(e=i.user)!==null&&e!==void 0?e:i;return{data:{session:n,user:t},error:null}}function ar(i){const e=Ee(i);return!e.error&&i.weak_password&&typeof i.weak_password=="object"&&Array.isArray(i.weak_password.reasons)&&i.weak_password.reasons.length&&i.weak_password.message&&typeof i.weak_password.message=="string"&&i.weak_password.reasons.reduce((n,t)=>n&&typeof t=="string",!0)&&(e.data.weak_password=i.weak_password),e}function Te(i){var e;return{data:{user:(e=i.user)!==null&&e!==void 0?e:i},error:null}}function Bo(i){return{data:i,error:null}}function Mo(i){const{action_link:e,email_otp:n,hashed_token:t,redirect_to:r,verification_type:s}=i,o=qo(i,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),a={action_link:e,email_otp:n,hashed_token:t,redirect_to:r,verification_type:s},l=Object.assign({},o);return{data:{properties:a,user:l},error:null}}function Fo(i){return i}function zo(i){return i.access_token&&i.refresh_token&&i.expires_in}var Ho=function(i,e){var n={};for(var t in i)Object.prototype.hasOwnProperty.call(i,t)&&e.indexOf(t)<0&&(n[t]=i[t]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,t=Object.getOwnPropertySymbols(i);r<t.length;r++)e.indexOf(t[r])<0&&Object.prototype.propertyIsEnumerable.call(i,t[r])&&(n[t[r]]=i[t[r]]);return n};class Jo{constructor({url:e="",headers:n={},fetch:t}){this.url=e,this.headers=n,this.fetch=_s(t),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,n="global"){try{return await H(this.fetch,"POST",`${this.url}/logout?scope=${n}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(t){if(z(t))return{data:null,error:t};throw t}}async inviteUserByEmail(e,n={}){try{return await H(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:n.data},headers:this.headers,redirectTo:n.redirectTo,xform:Te})}catch(t){if(z(t))return{data:{user:null},error:t};throw t}}async generateLink(e){try{const{options:n}=e,t=Ho(e,["options"]),r=Object.assign(Object.assign({},t),n);return"newEmail"in t&&(r.new_email=t==null?void 0:t.newEmail,delete r.newEmail),await H(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:r,headers:this.headers,xform:Mo,redirectTo:n==null?void 0:n.redirectTo})}catch(n){if(z(n))return{data:{properties:null,user:null},error:n};throw n}}async createUser(e){try{return await H(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Te})}catch(n){if(z(n))return{data:{user:null},error:n};throw n}}async listUsers(e){var n,t,r,s,o,a,l;try{const u={nextPage:null,lastPage:0,total:0},c=await H(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(t=(n=e==null?void 0:e.page)===null||n===void 0?void 0:n.toString())!==null&&t!==void 0?t:"",per_page:(s=(r=e==null?void 0:e.perPage)===null||r===void 0?void 0:r.toString())!==null&&s!==void 0?s:""},xform:Fo});if(c.error)throw c.error;const d=await c.json(),h=(o=c.headers.get("x-total-count"))!==null&&o!==void 0?o:0,f=(l=(a=c.headers.get("link"))===null||a===void 0?void 0:a.split(","))!==null&&l!==void 0?l:[];return f.length>0&&(f.forEach(p=>{const _=parseInt(p.split(";")[0].split("=")[1].substring(0,1)),v=JSON.parse(p.split(";")[1].split("=")[1]);u[`${v}Page`]=_}),u.total=parseInt(h)),{data:Object.assign(Object.assign({},d),u),error:null}}catch(u){if(z(u))return{data:{users:[]},error:u};throw u}}async getUserById(e){try{return await H(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Te})}catch(n){if(z(n))return{data:{user:null},error:n};throw n}}async updateUserById(e,n){try{return await H(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:n,headers:this.headers,xform:Te})}catch(t){if(z(t))return{data:{user:null},error:t};throw t}}async deleteUser(e,n=!1){try{return await H(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:n},xform:Te})}catch(t){if(z(t))return{data:{user:null},error:t};throw t}}async _listFactors(e){try{const{data:n,error:t}=await H(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:r=>({data:{factors:r},error:null})});return{data:n,error:t}}catch(n){if(z(n))return{data:null,error:n};throw n}}async _deleteFactor(e){try{return{data:await H(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(n){if(z(n))return{data:null,error:n};throw n}}}const Go={getItem:i=>at()?globalThis.localStorage.getItem(i):null,setItem:(i,e)=>{at()&&globalThis.localStorage.setItem(i,e)},removeItem:i=>{at()&&globalThis.localStorage.removeItem(i)}};function lr(i={}){return{getItem:e=>i[e]||null,setItem:(e,n)=>{i[e]=n},removeItem:e=>{delete i[e]}}}function Ko(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const ze={debug:!!(globalThis&&at()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class ws extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class Vo extends ws{}async function Wo(i,e,n){ze.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",i,e);const t=new globalThis.AbortController;return e>0&&setTimeout(()=>{t.abort(),ze.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",i)},e),await globalThis.navigator.locks.request(i,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:t.signal},async r=>{if(r){ze.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",i,r.name);try{return await n()}finally{ze.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",i,r.name)}}else{if(e===0)throw ze.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",i),new Vo(`Acquiring an exclusive Navigator LockManager lock "${i}" immediately failed`);if(ze.debug)try{const s=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(s,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}})}Ko();const Qo={url:_o,storageKey:go,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:bo,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1},rt=30*1e3,ur=3;async function cr(i,e,n){return await n()}class ft{constructor(e){var n,t;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=ft.nextInstanceID,ft.nextInstanceID+=1,this.instanceID>0&&me()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const r=Object.assign(Object.assign({},Qo),e);if(this.logDebugMessages=!!r.debug,typeof r.debug=="function"&&(this.logger=r.debug),this.persistSession=r.persistSession,this.storageKey=r.storageKey,this.autoRefreshToken=r.autoRefreshToken,this.admin=new Jo({url:r.url,headers:r.headers,fetch:r.fetch}),this.url=r.url,this.headers=r.headers,this.fetch=_s(r.fetch),this.lock=r.lock||cr,this.detectSessionInUrl=r.detectSessionInUrl,this.flowType=r.flowType,this.hasCustomAuthorizationHeader=r.hasCustomAuthorizationHeader,r.lock?this.lock=r.lock:me()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=Wo:this.lock=cr,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?r.storage?this.storage=r.storage:at()?this.storage=Go:(this.memoryStorage={},this.storage=lr(this.memoryStorage)):(this.memoryStorage={},this.storage=lr(this.memoryStorage)),me()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(s){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",s)}(t=this.broadcastChannel)===null||t===void 0||t.addEventListener("message",async s=>{this._debug("received broadcast notification from other tab or client",s),await this._notifyAllSubscribers(s.data.event,s.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${ms}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){try{const e=me()?await this._isPKCEFlow():!1;if(this._debug("#_initialize()","begin","is PKCE flow",e),e||this.detectSessionInUrl&&this._isImplicitGrantFlow()){const{data:n,error:t}=await this._getSessionFromURL(e);if(t)return this._debug("#_initialize()","error detecting session from URL",t),(t==null?void 0:t.message)==="Identity is already linked"||(t==null?void 0:t.message)==="Identity is already linked to another user"?{error:t}:(await this._removeSession(),{error:t});const{session:r,redirectType:s}=n;return this._debug("#_initialize()","detected session in URL",r,"redirect type",s),await this._saveSession(r),setTimeout(async()=>{s==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",r):await this._notifyAllSubscribers("SIGNED_IN",r)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(e){return z(e)?{error:e}:{error:new bs("Unexpected error during initialization",e)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var n,t,r;try{await this._removeSession();const s=await H(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(t=(n=e==null?void 0:e.options)===null||n===void 0?void 0:n.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:(r=e==null?void 0:e.options)===null||r===void 0?void 0:r.captchaToken}},xform:Ee}),{data:o,error:a}=s;if(a||!o)return{data:{user:null,session:null},error:a};const l=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:u,session:l},error:null}}catch(s){if(z(s))return{data:{user:null,session:null},error:s};throw s}}async signUp(e){var n,t,r;try{await this._removeSession();let s;if("email"in e){const{email:c,password:d,options:h}=e;let f=null,p=null;this.flowType==="pkce"&&([f,p]=await Fe(this.storage,this.storageKey)),s=await H(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:h==null?void 0:h.emailRedirectTo,body:{email:c,password:d,data:(n=h==null?void 0:h.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken},code_challenge:f,code_challenge_method:p},xform:Ee})}else if("phone"in e){const{phone:c,password:d,options:h}=e;s=await H(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:c,password:d,data:(t=h==null?void 0:h.data)!==null&&t!==void 0?t:{},channel:(r=h==null?void 0:h.channel)!==null&&r!==void 0?r:"sms",gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken}},xform:Ee})}else throw new vt("You must provide either an email or phone number and a password");const{data:o,error:a}=s;if(a||!o)return{data:{user:null,session:null},error:a};const l=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:u,session:l},error:null}}catch(s){if(z(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithPassword(e){try{await this._removeSession();let n;if("email"in e){const{email:s,password:o,options:a}=e;n=await H(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:o,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:ar})}else if("phone"in e){const{phone:s,password:o,options:a}=e;n=await H(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:o,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:ar})}else throw new vt("You must provide either an email or phone number and a password");const{data:t,error:r}=n;return r?{data:{user:null,session:null},error:r}:!t||!t.session||!t.user?{data:{user:null,session:null},error:new rn}:(t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),{data:Object.assign({user:t.user,session:t.session},t.weak_password?{weakPassword:t.weak_password}:null),error:r})}catch(n){if(z(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOAuth(e){var n,t,r,s;return await this._removeSession(),await this._handleProviderSignIn(e.provider,{redirectTo:(n=e.options)===null||n===void 0?void 0:n.redirectTo,scopes:(t=e.options)===null||t===void 0?void 0:t.scopes,queryParams:(r=e.options)===null||r===void 0?void 0:r.queryParams,skipBrowserRedirect:(s=e.options)===null||s===void 0?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async _exchangeCodeForSession(e){const n=await wt(this.storage,`${this.storageKey}-code-verifier`),[t,r]=(n??"").split("/"),{data:s,error:o}=await H(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:t},xform:Ee});return await nn(this.storage,`${this.storageKey}-code-verifier`),o?{data:{user:null,session:null,redirectType:null},error:o}:!s||!s.session||!s.user?{data:{user:null,session:null,redirectType:null},error:new rn}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign(Object.assign({},s),{redirectType:r??null}),error:o})}async signInWithIdToken(e){await this._removeSession();try{const{options:n,provider:t,token:r,access_token:s,nonce:o}=e,a=await H(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:t,id_token:r,access_token:s,nonce:o,gotrue_meta_security:{captcha_token:n==null?void 0:n.captchaToken}},xform:Ee}),{data:l,error:u}=a;return u?{data:{user:null,session:null},error:u}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new rn}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:u})}catch(n){if(z(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOtp(e){var n,t,r,s,o;try{if(await this._removeSession(),"email"in e){const{email:a,options:l}=e;let u=null,c=null;this.flowType==="pkce"&&([u,c]=await Fe(this.storage,this.storageKey));const{error:d}=await H(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:a,data:(n=l==null?void 0:l.data)!==null&&n!==void 0?n:{},create_user:(t=l==null?void 0:l.shouldCreateUser)!==null&&t!==void 0?t:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:u,code_challenge_method:c},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:d}}if("phone"in e){const{phone:a,options:l}=e,{data:u,error:c}=await H(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:a,data:(r=l==null?void 0:l.data)!==null&&r!==void 0?r:{},create_user:(s=l==null?void 0:l.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(o=l==null?void 0:l.channel)!==null&&o!==void 0?o:"sms"}});return{data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:c}}throw new vt("You must provide either an email or phone number.")}catch(a){if(z(a))return{data:{user:null,session:null},error:a};throw a}}async verifyOtp(e){var n,t;try{e.type!=="email_change"&&e.type!=="phone_change"&&await this._removeSession();let r,s;"options"in e&&(r=(n=e.options)===null||n===void 0?void 0:n.redirectTo,s=(t=e.options)===null||t===void 0?void 0:t.captchaToken);const{data:o,error:a}=await H(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:s}}),redirectTo:r,xform:Ee});if(a)throw a;if(!o)throw new Error("An error occurred on token verification.");const l=o.session,u=o.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:u,session:l},error:null}}catch(r){if(z(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithSSO(e){var n,t,r;try{await this._removeSession();let s=null,o=null;return this.flowType==="pkce"&&([s,o]=await Fe(this.storage,this.storageKey)),await H(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(t=(n=e.options)===null||n===void 0?void 0:n.redirectTo)!==null&&t!==void 0?t:void 0}),!((r=e==null?void 0:e.options)===null||r===void 0)&&r.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:s,code_challenge_method:o}),headers:this.headers,xform:Bo})}catch(s){if(z(s))return{data:null,error:s};throw s}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:n},error:t}=e;if(t)throw t;if(!n)throw new Pe;const{error:r}=await H(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:n.access_token});return{data:{user:null,session:null},error:r}})}catch(e){if(z(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{e.type!="email_change"&&e.type!="phone_change"&&await this._removeSession();const n=`${this.url}/resend`;if("email"in e){const{email:t,type:r,options:s}=e,{error:o}=await H(this.fetch,"POST",n,{headers:this.headers,body:{email:t,type:r,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},redirectTo:s==null?void 0:s.emailRedirectTo});return{data:{user:null,session:null},error:o}}else if("phone"in e){const{phone:t,type:r,options:s}=e,{data:o,error:a}=await H(this.fetch,"POST",n,{headers:this.headers,body:{phone:t,type:r,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}}});return{data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:a}}throw new vt("You must provide either an email or phone number and a type")}catch(n){if(z(n))return{data:{user:null,session:null},error:n};throw n}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async n=>n))}async _acquireLock(e,n){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const t=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),r=(async()=>(await t,await n()))();return this.pendingInLock.push((async()=>{try{await r}catch{}})()),r}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const t=n();for(this.pendingInLock.push((async()=>{try{await t}catch{}})()),await t;this.pendingInLock.length;){const r=[...this.pendingInLock];await Promise.all(r),this.pendingInLock.splice(0,r.length)}return await t}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const n=await this.__loadSession();return await e(n)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const n=await wt(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",n),n!==null&&(this._isValidSession(n)?e=n:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const t=e.expires_at?e.expires_at<=Date.now()/1e3:!1;if(this._debug("#__loadSession()",`session has${t?"":" not"} expired`,"expires_at",e.expires_at),!t){if(this.storage.isServer){const o=this.suppressGetSessionWarning;e=new Proxy(e,{get(l,u,c){return!o&&u==="user"&&console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and many not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),Reflect.get(l,u,c)}})}return{data:{session:e},error:null}}const{session:r,error:s}=await this._callRefreshToken(e.refresh_token);return s?{data:{session:null},error:s}:{data:{session:r},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await H(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Te}):await this._useSession(async n=>{var t,r,s;const{data:o,error:a}=n;if(a)throw a;return!(!((t=o.session)===null||t===void 0)&&t.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Pe}:await H(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(s=(r=o.session)===null||r===void 0?void 0:r.access_token)!==null&&s!==void 0?s:void 0,xform:Te})})}catch(n){if(z(n))return{data:{user:null},error:n};throw n}}async updateUser(e,n={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,n))}async _updateUser(e,n={}){try{return await this._useSession(async t=>{const{data:r,error:s}=t;if(s)throw s;if(!r.session)throw new Pe;const o=r.session;let a=null,l=null;this.flowType==="pkce"&&e.email!=null&&([a,l]=await Fe(this.storage,this.storageKey));const{data:u,error:c}=await H(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:n==null?void 0:n.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:a,code_challenge_method:l}),jwt:o.access_token,xform:Te});if(c)throw c;return o.user=u.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}})}catch(t){if(z(t))return{data:{user:null},error:t};throw t}}_decodeJWT(e){return rr(e)}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Pe;const n=Date.now()/1e3;let t=n,r=!0,s=null;const o=rr(e.access_token);if(o.exp&&(t=o.exp,r=t<=n),r){const{session:a,error:l}=await this._callRefreshToken(e.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!a)return{data:{user:null,session:null},error:null};s=a}else{const{data:a,error:l}=await this._getUser(e.access_token);if(l)throw l;s={access_token:e.access_token,refresh_token:e.refresh_token,user:a.user,token_type:"bearer",expires_in:t-n,expires_at:t},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return{data:{user:s.user,session:s},error:null}}catch(n){if(z(n))return{data:{session:null,user:null},error:n};throw n}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async n=>{var t;if(!e){const{data:o,error:a}=n;if(a)throw a;e=(t=o.session)!==null&&t!==void 0?t:void 0}if(!(e!=null&&e.refresh_token))throw new Pe;const{session:r,error:s}=await this._callRefreshToken(e.refresh_token);return s?{data:{user:null,session:null},error:s}:r?{data:{user:r.user,session:r},error:null}:{data:{user:null,session:null},error:null}})}catch(n){if(z(n))return{data:{user:null,session:null},error:n};throw n}}async _getSessionFromURL(e){try{if(!me())throw new kt("No browser detected.");if(this.flowType==="implicit"&&!this._isImplicitGrantFlow())throw new kt("Not a valid implicit grant flow url.");if(this.flowType=="pkce"&&!e)throw new sr("Not a valid PKCE flow url.");const n=tn(window.location.href);if(e){if(!n.code)throw new sr("No code detected.");const{data:E,error:O}=await this._exchangeCodeForSession(n.code);if(O)throw O;const I=new URL(window.location.href);return I.searchParams.delete("code"),window.history.replaceState(window.history.state,"",I.toString()),{data:{session:E.session,redirectType:null},error:null}}if(n.error||n.error_description||n.error_code)throw new kt(n.error_description||"Error in URL with unspecified error_description",{error:n.error||"unspecified_error",code:n.error_code||"unspecified_code"});const{provider_token:t,provider_refresh_token:r,access_token:s,refresh_token:o,expires_in:a,expires_at:l,token_type:u}=n;if(!s||!a||!o||!u)throw new kt("No session defined in URL");const c=Math.round(Date.now()/1e3),d=parseInt(a);let h=c+d;l&&(h=parseInt(l));const f=h-c;f*1e3<=rt&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${f}s, should have been closer to ${d}s`);const p=h-d;c-p>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",p,h,c):c-p<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clok for skew",p,h,c);const{data:_,error:v}=await this._getUser(s);if(v)throw v;const j={provider_token:t,provider_refresh_token:r,access_token:s,expires_in:d,expires_at:h,refresh_token:o,token_type:u,user:_.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:j,redirectType:n.type},error:null}}catch(n){if(z(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantFlow(){const e=tn(window.location.href);return!!(me()&&(e.access_token||e.error_description))}async _isPKCEFlow(){const e=tn(window.location.href),n=await wt(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&n)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async n=>{var t;const{data:r,error:s}=n;if(s)return{error:s};const o=(t=r.session)===null||t===void 0?void 0:t.access_token;if(o){const{error:a}=await this.admin.signOut(o,e);if(a&&!(Lo(a)&&(a.status===404||a.status===401||a.status===403)))return{error:a}}return e!=="others"&&(await this._removeSession(),await nn(this.storage,`${this.storageKey}-code-verifier`),await this._notifyAllSubscribers("SIGNED_OUT",null)),{error:null}})}onAuthStateChange(e){const n=vo(),t={id:n,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",n),this.stateChangeEmitters.delete(n)}};return this._debug("#onAuthStateChange()","registered callback with id",n),this.stateChangeEmitters.set(n,t),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(n)})))(),{data:{subscription:t}}}async _emitInitialSession(e){return await this._useSession(async n=>{var t,r;try{const{data:{session:s},error:o}=n;if(o)throw o;await((t=this.stateChangeEmitters.get(e))===null||t===void 0?void 0:t.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",e,"session",s)}catch(s){await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",s),console.error(s)}})}async resetPasswordForEmail(e,n={}){let t=null,r=null;this.flowType==="pkce"&&([t,r]=await Fe(this.storage,this.storageKey,!0));try{return await H(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:t,code_challenge_method:r,gotrue_meta_security:{captcha_token:n.captchaToken}},headers:this.headers,redirectTo:n.redirectTo})}catch(s){if(z(s))return{data:null,error:s};throw s}}async getUserIdentities(){var e;try{const{data:n,error:t}=await this.getUser();if(t)throw t;return{data:{identities:(e=n.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(n){if(z(n))return{data:null,error:n};throw n}}async linkIdentity(e){var n;try{const{data:t,error:r}=await this._useSession(async s=>{var o,a,l,u,c;const{data:d,error:h}=s;if(h)throw h;const f=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(a=e.options)===null||a===void 0?void 0:a.scopes,queryParams:(l=e.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await H(this.fetch,"GET",f,{headers:this.headers,jwt:(c=(u=d.session)===null||u===void 0?void 0:u.access_token)!==null&&c!==void 0?c:void 0})});if(r)throw r;return me()&&!(!((n=e.options)===null||n===void 0)&&n.skipBrowserRedirect)&&window.location.assign(t==null?void 0:t.url),{data:{provider:e.provider,url:t==null?void 0:t.url},error:null}}catch(t){if(z(t))return{data:{provider:e.provider,url:null},error:t};throw t}}async unlinkIdentity(e){try{return await this._useSession(async n=>{var t,r;const{data:s,error:o}=n;if(o)throw o;return await H(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(r=(t=s.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:void 0})})}catch(n){if(z(n))return{data:null,error:n};throw n}}async _refreshAccessToken(e){const n=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{const t=Date.now();return await So(async r=>(r>0&&await Co(200*Math.pow(2,r-1)),this._debug(n,"refreshing attempt",r),await H(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Ee})),(r,s)=>{const o=200*Math.pow(2,r);return s&&sn(s)&&Date.now()+o-t<rt})}catch(t){if(this._debug(n,"error",t),z(t))return{data:{session:null,user:null},error:t};throw t}finally{this._debug(n,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,n){const t=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:n.redirectTo,scopes:n.scopes,queryParams:n.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",n,"url",t),me()&&!n.skipBrowserRedirect&&window.location.assign(t),{data:{provider:e,url:t},error:null}}async _recoverAndRefresh(){var e;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const t=await wt(this.storage,this.storageKey);if(this._debug(n,"session from storage",t),!this._isValidSession(t)){this._debug(n,"session is not valid"),t!==null&&await this._removeSession();return}const r=Math.round(Date.now()/1e3),s=((e=t.expires_at)!==null&&e!==void 0?e:1/0)<r+nr;if(this._debug(n,`session has${s?"":" not"} expired with margin of ${nr}s`),s){if(this.autoRefreshToken&&t.refresh_token){const{error:o}=await this._callRefreshToken(t.refresh_token);o&&(console.error(o),sn(o)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",t)}catch(t){this._debug(n,"error",t),console.error(t);return}finally{this._debug(n,"end")}}async _callRefreshToken(e){var n,t;if(!e)throw new Pe;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const r=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{this.refreshingDeferred=new Pt;const{data:s,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!s.session)throw new Pe;await this._saveSession(s.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",s.session);const a={session:s.session,error:null};return this.refreshingDeferred.resolve(a),a}catch(s){if(this._debug(r,"error",s),z(s)){const o={session:null,error:s};return sn(s)||(await this._removeSession(),await this._notifyAllSubscribers("SIGNED_OUT",null)),(n=this.refreshingDeferred)===null||n===void 0||n.resolve(o),o}throw(t=this.refreshingDeferred)===null||t===void 0||t.reject(s),s}finally{this.refreshingDeferred=null,this._debug(r,"end")}}async _notifyAllSubscribers(e,n,t=!0){const r=`#_notifyAllSubscribers(${e})`;this._debug(r,"begin",n,`broadcast = ${t}`);try{this.broadcastChannel&&t&&this.broadcastChannel.postMessage({event:e,session:n});const s=[],o=Array.from(this.stateChangeEmitters.values()).map(async a=>{try{await a.callback(e,n)}catch(l){s.push(l)}});if(await Promise.all(o),s.length>0){for(let a=0;a<s.length;a+=1)console.error(s[a]);throw s[0]}}finally{this._debug(r,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await gs(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await nn(this.storage,this.storageKey)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&me()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(n){console.error("removing visibilitychange callback failed",n)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),rt);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async n=>{const{data:{session:t}}=n;if(!t||!t.refresh_token||!t.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const r=Math.floor((t.expires_at*1e3-e)/rt);this._debug("#_autoRefreshTokenTick()",`access token expires in ${r} ticks, a tick lasts ${rt}ms, refresh threshold is ${ur} ticks`),r<=ur&&await this._callRefreshToken(t.refresh_token)})}catch(n){console.error("Auto refresh tick failed with error. This is likely a transient error.",n)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof ws)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!me()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const n=`#_onVisibilityChanged(${e})`;this._debug(n,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(n,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,n,t){const r=[`provider=${encodeURIComponent(n)}`];if(t!=null&&t.redirectTo&&r.push(`redirect_to=${encodeURIComponent(t.redirectTo)}`),t!=null&&t.scopes&&r.push(`scopes=${encodeURIComponent(t.scopes)}`),this.flowType==="pkce"){const[s,o]=await Fe(this.storage,this.storageKey),a=new URLSearchParams({code_challenge:`${encodeURIComponent(s)}`,code_challenge_method:`${encodeURIComponent(o)}`});r.push(a.toString())}if(t!=null&&t.queryParams){const s=new URLSearchParams(t.queryParams);r.push(s.toString())}return t!=null&&t.skipBrowserRedirect&&r.push(`skip_http_redirect=${t.skipBrowserRedirect}`),`${e}?${r.join("&")}`}async _unenroll(e){try{return await this._useSession(async n=>{var t;const{data:r,error:s}=n;return s?{data:null,error:s}:await H(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(t=r==null?void 0:r.session)===null||t===void 0?void 0:t.access_token})})}catch(n){if(z(n))return{data:null,error:n};throw n}}async _enroll(e){try{return await this._useSession(async n=>{var t,r;const{data:s,error:o}=n;if(o)return{data:null,error:o};const{data:a,error:l}=await H(this.fetch,"POST",`${this.url}/factors`,{body:{friendly_name:e.friendlyName,factor_type:e.factorType,issuer:e.issuer},headers:this.headers,jwt:(t=s==null?void 0:s.session)===null||t===void 0?void 0:t.access_token});return l?{data:null,error:l}:(!((r=a==null?void 0:a.totp)===null||r===void 0)&&r.qr_code&&(a.totp.qr_code=`data:image/svg+xml;utf-8,${a.totp.qr_code}`),{data:a,error:null})})}catch(n){if(z(n))return{data:null,error:n};throw n}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var t;const{data:r,error:s}=n;if(s)return{data:null,error:s};const{data:o,error:a}=await H(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(t=r==null?void 0:r.session)===null||t===void 0?void 0:t.access_token});return a?{data:null,error:a}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:a})})}catch(n){if(z(n))return{data:null,error:n};throw n}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var t;const{data:r,error:s}=n;return s?{data:null,error:s}:await H(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{headers:this.headers,jwt:(t=r==null?void 0:r.session)===null||t===void 0?void 0:t.access_token})})}catch(n){if(z(n))return{data:null,error:n};throw n}})}async _challengeAndVerify(e){const{data:n,error:t}=await this._challenge({factorId:e.factorId});return t?{data:null,error:t}:await this._verify({factorId:e.factorId,challengeId:n.id,code:e.code})}async _listFactors(){const{data:{user:e},error:n}=await this.getUser();if(n)return{data:null,error:n};const t=(e==null?void 0:e.factors)||[],r=t.filter(s=>s.factor_type==="totp"&&s.status==="verified");return{data:{all:t,totp:r},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var n,t;const{data:{session:r},error:s}=e;if(s)return{data:null,error:s};if(!r)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const o=this._decodeJWT(r.access_token);let a=null;o.aal&&(a=o.aal);let l=a;((t=(n=r.user.factors)===null||n===void 0?void 0:n.filter(d=>d.status==="verified"))!==null&&t!==void 0?t:[]).length>0&&(l="aal2");const c=o.amr||[];return{data:{currentLevel:a,nextLevel:l,currentAuthenticationMethods:c},error:null}}))}}ft.nextInstanceID=0;const Xo=ft;class Yo extends Xo{constructor(e){super(e)}}var Zo=function(i,e,n,t){function r(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function a(c){try{u(t.next(c))}catch(d){o(d)}}function l(c){try{u(t.throw(c))}catch(d){o(d)}}function u(c){c.done?s(c.value):r(c.value).then(a,l)}u((t=t.apply(i,e||[])).next())})};class xo{constructor(e,n,t){var r,s,o;if(this.supabaseUrl=e,this.supabaseKey=n,!e)throw new Error("supabaseUrl is required.");if(!n)throw new Error("supabaseKey is required.");const a=mo(e);this.realtimeUrl=`${a}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${a}/auth/v1`,this.storageUrl=`${a}/storage/v1`,this.functionsUrl=`${a}/functions/v1`;const l=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,u={db:ao,realtime:uo,auth:Object.assign(Object.assign({},lo),{storageKey:l}),global:oo},c=$o(t??{},u);this.storageKey=(r=c.auth.storageKey)!==null&&r!==void 0?r:"",this.headers=(s=c.global.headers)!==null&&s!==void 0?s:{},this.auth=this._initSupabaseAuthClient((o=c.auth)!==null&&o!==void 0?o:{},this.headers,c.global.fetch),this.fetch=po(n,this._getAccessToken.bind(this),c.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers},c.realtime)),this.rest=new yn(`${a}/rest/v1`,{headers:this.headers,schema:c.db.schema,fetch:this.fetch}),this._listenForAuthEvents()}get functions(){return new wi(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new ro(this.storageUrl,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,n={},t={}){return this.rest.rpc(e,n,t)}channel(e,n={config:{}}){return this.realtime.channel(e,n)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,n;return Zo(this,void 0,void 0,function*(){const{data:t}=yield this.auth.getSession();return(n=(e=t.session)===null||e===void 0?void 0:e.access_token)!==null&&n!==void 0?n:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:n,detectSessionInUrl:t,storage:r,storageKey:s,flowType:o,debug:a},l,u){var c;const d={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Yo({url:this.authUrl,headers:Object.assign(Object.assign({},d),l),storageKey:s,autoRefreshToken:e,persistSession:n,detectSessionInUrl:t,storage:r,flowType:o,debug:a,fetch:u,hasCustomAuthorizationHeader:(c="Authorization"in this.headers)!==null&&c!==void 0?c:!1})}_initRealtimeClient(e){return new Ji(this.realtimeUrl,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((n,t)=>{this._handleTokenChanged(n,"CLIENT",t==null?void 0:t.access_token)})}_handleTokenChanged(e,n,t){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==t?(this.realtime.setAuth(t??null),this.changedAccessToken=t):e==="SIGNED_OUT"&&(this.realtime.setAuth(this.supabaseKey),n=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const vs=(i,e,n)=>new xo(i,e,n),ks="supabase-config",ea=()=>{const i=localStorage.getItem(ks);if(!i)return null;const e=JSON.parse(i);return vs(e.supabaseUrl,e.supabaseKey)};let Y=ea();const ta=i=>{Y=vs(i.supabaseUrl,i.supabaseKey),localStorage.setItem(ks,JSON.stringify(i))},Ct=jt(null);function na(i){let e,n,t,r;const s=i[2].default,o=we(s,i,i[1],null);return{c(){e=T("button"),o&&o.c(),k(e,"class","text-blue-600 hover:text-blue-700")},m(a,l){C(a,e,l),o&&o.m(e,null),n=!0,t||(r=De(e,"click",function(){Ye(i[0])&&i[0].apply(this,arguments)}),t=!0)},p(a,[l]){i=a,o&&o.p&&(!n||l&2)&&ke(o,s,i,i[1],n?ve(s,i[1],l,null):ye(i[1]),null)},i(a){n||(m(o,a),n=!0)},o(a){$(o,a),n=!1},d(a){a&&y(e),o&&o.d(a),t=!1,r()}}}function ra(i,e,n){let{$$slots:t={},$$scope:r}=e,{onClick:s}=e;return i.$$set=o=>{"onClick"in o&&n(0,s=o.onClick),"$$scope"in o&&n(1,r=o.$$scope)},[s,r,t]}class ce extends U{constructor(e){super(),D(this,e,ra,na,L,{onClick:0})}}function sa(i){let e,n;return{c(){e=W("svg"),n=W("path"),k(n,"stroke-linecap","round"),k(n,"stroke-linejoin","round"),k(n,"d","m2.25 12 8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25"),k(e,"xmlns","http://www.w3.org/2000/svg"),k(e,"fill","none"),k(e,"viewBox","0 0 24 24"),k(e,"stroke-width","1.5"),k(e,"stroke","currentColor"),k(e,"class","size-6 hover:stroke-2")},m(t,r){C(t,e,r),S(e,n)},p:q,d(t){t&&y(e)}}}function ia(i){let e,n;return e=new ce({props:{onClick:i[0],$$slots:{default:[sa]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,[r]){const s={};r&1&&(s.onClick=t[0]),r&2&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){$(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function oa(i,e,n){let{onClick:t}=e;return i.$$set=r=>{"onClick"in r&&n(0,t=r.onClick)},[t]}class aa extends U{constructor(e){super(),D(this,e,oa,ia,L,{onClick:0})}}function la(i){let e,n;return{c(){e=W("svg"),n=W("path"),k(n,"stroke-linecap","round"),k(n,"stroke-linejoin","round"),k(n,"d","m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"),k(e,"xmlns","http://www.w3.org/2000/svg"),k(e,"fill","none"),k(e,"viewBox","0 0 24 24"),k(e,"stroke-width","1.5"),k(e,"stroke","currentColor"),k(e,"class","size-6 hover:stroke-2")},m(t,r){C(t,e,r),S(e,n)},p:q,d(t){t&&y(e)}}}function ua(i){let e,n;return e=new ce({props:{onClick:i[0],$$slots:{default:[la]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,[r]){const s={};r&1&&(s.onClick=t[0]),r&2&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){$(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function ca(i,e,n){let{onClick:t}=e;return i.$$set=r=>{"onClick"in r&&n(0,t=r.onClick)},[t]}class fa extends U{constructor(e){super(),D(this,e,ca,ua,L,{onClick:0})}}function da(i){let e,n;return{c(){e=W("svg"),n=W("path"),k(n,"stroke-linecap","round"),k(n,"stroke-linejoin","round"),k(n,"d","M12 6.042A8.967 8.967 0 0 0 6 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 0 1 6 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 0 1 6-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0 0 18 18a8.967 8.967 0 0 0-6 2.292m0-14.25v14.25"),k(e,"xmlns","http://www.w3.org/2000/svg"),k(e,"fill","none"),k(e,"viewBox","0 0 24 24"),k(e,"stroke-width","1.5"),k(e,"stroke","currentColor"),k(e,"class","size-6 hover:stroke-2")},m(t,r){C(t,e,r),S(e,n)},p:q,d(t){t&&y(e)}}}function ha(i){let e,n;return e=new ce({props:{onClick:i[0],$$slots:{default:[da]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,[r]){const s={};r&1&&(s.onClick=t[0]),r&2&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){$(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function pa(i,e,n){let{onClick:t}=e;return i.$$set=r=>{"onClick"in r&&n(0,t=r.onClick)},[t]}class ma extends U{constructor(e){super(),D(this,e,pa,ha,L,{onClick:0})}}function $a(i){let e,n;return{c(){e=W("svg"),n=W("path"),k(n,"stroke-linecap","round"),k(n,"stroke-linejoin","round"),k(n,"d","M6 6.878V6a2.25 2.25 0 0 1 2.25-2.25h7.5A2.25 2.25 0 0 1 18 6v.878m-12 0c.235-.083.487-.128.75-.128h10.5c.263 0 .515.045.75.128m-12 0A2.25 2.25 0 0 0 4.5 9v.878m13.5-3A2.25 2.25 0 0 1 19.5 9v.878m0 0a2.246 2.246 0 0 0-.75-.128H5.25c-.263 0-.515.045-.75.128m15 0A2.25 2.25 0 0 1 21 12v6a2.25 2.25 0 0 1-2.25 2.25H5.25A2.25 2.25 0 0 1 3 18v-6c0-.98.626-1.813 1.5-2.122"),k(e,"xmlns","http://www.w3.org/2000/svg"),k(e,"fill","none"),k(e,"viewBox","0 0 24 24"),k(e,"stroke-width","1.5"),k(e,"stroke","currentColor"),k(e,"class","size-6 hover:stroke-2")},m(t,r){C(t,e,r),S(e,n)},p:q,d(t){t&&y(e)}}}function _a(i){let e,n;return e=new ce({props:{onClick:i[0],$$slots:{default:[$a]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,[r]){const s={};r&1&&(s.onClick=t[0]),r&2&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){$(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function ga(i,e,n){let{onClick:t}=e;return i.$$set=r=>{"onClick"in r&&n(0,t=r.onClick)},[t]}class ba extends U{constructor(e){super(),D(this,e,ga,_a,L,{onClick:0})}}function wa(i){let e,n;return{c(){e=W("svg"),n=W("path"),k(n,"stroke-linecap","round"),k(n,"stroke-linejoin","round"),k(n,"d","M15.75 9V5.25A2.25 2.25 0 0 0 13.5 3h-6a2.25 2.25 0 0 0-2.25 2.25v13.5A2.25 2.25 0 0 0 7.5 21h6a2.25 2.25 0 0 0 2.25-2.25V15m3 0 3-3m0 0-3-3m3 3H9"),k(e,"xmlns","http://www.w3.org/2000/svg"),k(e,"fill","none"),k(e,"viewBox","0 0 24 24"),k(e,"stroke-width","1.5"),k(e,"stroke","currentColor"),k(e,"class","size-6 hover:stroke-2")},m(t,r){C(t,e,r),S(e,n)},p:q,d(t){t&&y(e)}}}function va(i){let e,n;return e=new ce({props:{onClick:i[0],$$slots:{default:[wa]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,[r]){const s={};r&1&&(s.onClick=t[0]),r&2&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){$(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function ka(i,e,n){let{onClick:t}=e;return i.$$set=r=>{"onClick"in r&&n(0,t=r.onClick)},[t]}class ya extends U{constructor(e){super(),D(this,e,ka,va,L,{onClick:0})}}function Ca(i){let e,n;return{c(){e=W("svg"),n=W("path"),k(n,"stroke-linecap","round"),k(n,"stroke-linejoin","round"),k(n,"d","M15.75 6a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0ZM4.501 20.118a7.5 7.5 0 0 1 14.998 0A17.933 17.933 0 0 1 12 21.75c-2.676 0-5.216-.584-7.499-1.632Z"),k(e,"xmlns","http://www.w3.org/2000/svg"),k(e,"fill","none"),k(e,"viewBox","0 0 24 24"),k(e,"stroke-width","1.5"),k(e,"stroke","currentColor"),k(e,"class","size-6 hover:stroke-2")},m(t,r){C(t,e,r),S(e,n)},p:q,d(t){t&&y(e)}}}function Sa(i){let e,n;return e=new ce({props:{onClick:i[0],$$slots:{default:[Ca]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,[r]){const s={};r&1&&(s.onClick=t[0]),r&2&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){$(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function Ea(i,e,n){let{onClick:t}=e;return i.$$set=r=>{"onClick"in r&&n(0,t=r.onClick)},[t]}class Aa extends U{constructor(e){super(),D(this,e,Ea,Sa,L,{onClick:0})}}function Ta(i){let e,n;return{c(){e=W("svg"),n=W("path"),k(n,"stroke-linecap","round"),k(n,"stroke-linejoin","round"),k(n,"d","m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"),k(e,"xmlns","http://www.w3.org/2000/svg"),k(e,"fill","none"),k(e,"viewBox","0 0 24 24"),k(e,"stroke-width","1.5"),k(e,"stroke","currentColor"),k(e,"class","size-6 hover:stroke-2")},m(t,r){C(t,e,r),S(e,n)},p:q,d(t){t&&y(e)}}}function Oa(i){let e,n;return e=new ce({props:{onClick:i[0],$$slots:{default:[Ta]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,[r]){const s={};r&1&&(s.onClick=t[0]),r&2&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){$(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function ja(i,e,n){let{onClick:t}=e;return i.$$set=r=>{"onClick"in r&&n(0,t=r.onClick)},[t]}class ys extends U{constructor(e){super(),D(this,e,ja,Oa,L,{onClick:0})}}function Ia(i){let e,n;return{c(){e=W("svg"),n=W("path"),k(n,"stroke-linecap","round"),k(n,"stroke-linejoin","round"),k(n,"d","M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m5.231 13.481L15 17.25m-4.5-15H5.625c-.621 0-1.125.504-1.125 1.125v16.5c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Zm3.75 11.625a2.625 2.625 0 1 1-5.25 0 2.625 2.625 0 0 1 5.25 0Z"),k(e,"xmlns","http://www.w3.org/2000/svg"),k(e,"fill","none"),k(e,"viewBox","0 0 24 24"),k(e,"stroke-width","1.5"),k(e,"stroke","currentColor"),k(e,"class","size-6 hover:stroke-2")},m(t,r){C(t,e,r),S(e,n)},p:q,d(t){t&&y(e)}}}function Pa(i){let e,n;return e=new ce({props:{onClick:i[0],$$slots:{default:[Ia]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,[r]){const s={};r&1&&(s.onClick=t[0]),r&2&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){$(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function Ra(i,e,n){let{onClick:t}=e;return i.$$set=r=>{"onClick"in r&&n(0,t=r.onClick)},[t]}class La extends U{constructor(e){super(),D(this,e,Ra,Pa,L,{onClick:0})}}function qa(i){let e,n,t,r,s,o,a,l,u,c,d,h,f,p,_,v,j;return n=new aa({props:{onClick:i[1]}}),r=new ma({props:{onClick:i[2]}}),o=new ys({props:{onClick:i[3]}}),l=new ba({props:{onClick:i[4]}}),c=new La({props:{onClick:i[5]}}),h=new fa({props:{onClick:i[6]}}),p=new Aa({props:{onClick:i[7]}}),v=new ya({props:{onClick:i[0]}}),{c(){e=T("nav"),w(n.$$.fragment),t=A(),w(r.$$.fragment),s=A(),w(o.$$.fragment),a=A(),w(l.$$.fragment),u=A(),w(c.$$.fragment),d=A(),w(h.$$.fragment),f=A(),w(p.$$.fragment),_=A(),w(v.$$.fragment),k(e,"class","flex justify-end items-center gap-2 mb-4")},m(E,O){C(E,e,O),g(n,e,null),S(e,t),g(r,e,null),S(e,s),g(o,e,null),S(e,a),g(l,e,null),S(e,u),g(c,e,null),S(e,d),g(h,e,null),S(e,f),g(p,e,null),S(e,_),g(v,e,null),j=!0},p(E,[O]){const I={};O&1&&(I.onClick=E[0]),v.$set(I)},i(E){j||(m(n.$$.fragment,E),m(r.$$.fragment,E),m(o.$$.fragment,E),m(l.$$.fragment,E),m(c.$$.fragment,E),m(h.$$.fragment,E),m(p.$$.fragment,E),m(v.$$.fragment,E),j=!0)},o(E){$(n.$$.fragment,E),$(r.$$.fragment,E),$(o.$$.fragment,E),$(l.$$.fragment,E),$(c.$$.fragment,E),$(h.$$.fragment,E),$(p.$$.fragment,E),$(v.$$.fragment,E),j=!1},d(E){E&&y(e),b(n),b(r),b(o),b(l),b(c),b(h),b(p),b(v)}}}function Da(i,e,n){let{onLogout:t}=e;const r=()=>F("/"),s=()=>F("/books/list"),o=()=>F("/info"),a=()=>F("/cache/list"),l=()=>F("/questions/index"),u=()=>F("/questions/search"),c=()=>F("/user");return i.$$set=d=>{"onLogout"in d&&n(0,t=d.onLogout)},[t,r,s,o,a,l,u,c]}class Ua extends U{constructor(e){super(),D(this,e,Da,qa,L,{onLogout:0})}}const Na=(i,e)=>Math.floor(Math.random()*(e-i+1)+i),Ba=i=>{for(let e=0;e<i.length;e++){const n=Na(0,i.length-1);if(e===n)continue;const t=i[e];i[e]=i[n],i[n]=t}},le=i=>new Date(i).toLocaleString(),fr=i=>new Date(i).toLocaleDateString(),ue=i=>i?"":"Please enter a value!",Cs=(i,e)=>(i=i.trim(),i||e);function Ma(i){let e,n,t,r;const s=i[2].default,o=we(s,i,i[1],null);return{c(){e=T("form"),o&&o.c(),k(e,"class","flex flex-col gap-5 lg:w-2/3")},m(a,l){C(a,e,l),o&&o.m(e,null),n=!0,t||(r=De(e,"submit",qs(function(){Ye(i[0])&&i[0].apply(this,arguments)})),t=!0)},p(a,[l]){i=a,o&&o.p&&(!n||l&2)&&ke(o,s,i,i[1],n?ve(s,i[1],l,null):ye(i[1]),null)},i(a){n||(m(o,a),n=!0)},o(a){$(o,a),n=!1},d(a){a&&y(e),o&&o.d(a),t=!1,r()}}}function Fa(i,e,n){let{$$slots:t={},$$scope:r}=e,{onSubmit:s}=e;return i.$$set=o=>{"onSubmit"in o&&n(0,s=o.onSubmit),"$$scope"in o&&n(1,r=o.$$scope)},[s,r,t]}class he extends U{constructor(e){super(),D(this,e,Fa,Ma,L,{onSubmit:0})}}function dr(i){let e,n;return{c(){e=T("p"),n=R(i[2]),k(e,"class","text-red-600 text-sm mt-1")},m(t,r){C(t,e,r),S(e,n)},p(t,r){r&4&&B(n,t[2])},d(t){t&&y(e)}}}function za(i){let e,n,t,r,s,o;const a=i[4].default,l=we(a,i,i[3],null);let u=i[2]&&dr(i);return{c(){e=T("div"),n=T("label"),t=R(i[1]),r=A(),l&&l.c(),s=A(),u&&u.c(),k(n,"class","block text-gray-700 text-sm font-bold mb-2"),k(n,"for",i[0])},m(c,d){C(c,e,d),S(e,n),S(n,t),S(e,r),l&&l.m(e,null),S(e,s),u&&u.m(e,null),o=!0},p(c,[d]){(!o||d&2)&&B(t,c[1]),(!o||d&1)&&k(n,"for",c[0]),l&&l.p&&(!o||d&8)&&ke(l,a,c,c[3],o?ve(a,c[3],d,null):ye(c[3]),null),c[2]?u?u.p(c,d):(u=dr(c),u.c(),u.m(e,null)):u&&(u.d(1),u=null)},i(c){o||(m(l,c),o=!0)},o(c){$(l,c),o=!1},d(c){c&&y(e),l&&l.d(c),u&&u.d()}}}function Ha(i,e,n){let{$$slots:t={},$$scope:r}=e,{id:s}=e,{label:o}=e,{error:a=""}=e;return i.$$set=l=>{"id"in l&&n(0,s=l.id),"label"in l&&n(1,o=l.label),"error"in l&&n(2,a=l.error),"$$scope"in l&&n(3,r=l.$$scope)},[s,o,a,r,t]}class Rt extends U{constructor(e){super(),D(this,e,Ha,za,L,{id:0,label:1,error:2})}}function Ja(i){let e,n,t;return{c(){e=T("input"),k(e,"class","input"),k(e,"id",i[2])},m(r,s){C(r,e,s),Oe(e,i[0]),n||(t=De(e,"input",i[4]),n=!0)},p(r,s){s&4&&k(e,"id",r[2]),s&1&&e.value!==r[0]&&Oe(e,r[0])},d(r){r&&y(e),n=!1,t()}}}function Ga(i){let e,n;return e=new Rt({props:{id:i[2],label:i[1],error:i[3],$$slots:{default:[Ja]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,[r]){const s={};r&4&&(s.id=t[2]),r&2&&(s.label=t[1]),r&8&&(s.error=t[3]),r&37&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){$(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function Ka(i,e,n){let{label:t}=e,{id:r}=e,{value:s}=e,{error:o=""}=e;function a(){s=this.value,n(0,s)}return i.$$set=l=>{"label"in l&&n(1,t=l.label),"id"in l&&n(2,r=l.id),"value"in l&&n(0,s=l.value),"error"in l&&n(3,o=l.error)},[s,t,r,o,a]}class _e extends U{constructor(e){super(),D(this,e,Ka,Ga,L,{label:1,id:2,value:0,error:3})}}function Va(i){let e,n;return e=new M({props:{label:"Save"}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p:q,i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){$(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function Wa(i){let e,n,t,r,s,o,a,l;function u(f){i[6](f)}let c={id:"url",label:"Supabase URL",error:i[1]};i[0]!==void 0&&(c.value=i[0]),e=new _e({props:c}),Z.push(()=>ne(e,"value",u));function d(f){i[7](f)}let h={id:"key",label:"Supabase key",error:i[3]};return i[2]!==void 0&&(h.value=i[2]),r=new _e({props:h}),Z.push(()=>ne(r,"value",d)),a=new Q({props:{$$slots:{default:[Va]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment),t=A(),w(r.$$.fragment),o=A(),w(a.$$.fragment)},m(f,p){g(e,f,p),C(f,t,p),g(r,f,p),C(f,o,p),g(a,f,p),l=!0},p(f,p){const _={};p&2&&(_.error=f[1]),!n&&p&1&&(n=!0,_.value=f[0],te(()=>n=!1)),e.$set(_);const v={};p&8&&(v.error=f[3]),!s&&p&4&&(s=!0,v.value=f[2],te(()=>s=!1)),r.$set(v);const j={};p&256&&(j.$$scope={dirty:p,ctx:f}),a.$set(j)},i(f){l||(m(e.$$.fragment,f),m(r.$$.fragment,f),m(a.$$.fragment,f),l=!0)},o(f){$(e.$$.fragment,f),$(r.$$.fragment,f),$(a.$$.fragment,f),l=!1},d(f){f&&(y(t),y(o)),b(e,f),b(r,f),b(a,f)}}}function Qa(i){let e,n;return e=new he({props:{onSubmit:i[4],$$slots:{default:[Wa]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,[r]){const s={};r&271&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){$(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function Xa(i,e,n){let{onConfig:t}=e,r="",s="",o="",a="";const l=()=>{n(1,s=ue(r)),n(3,a=ue(o)),!(s||a)&&t({supabaseUrl:r,supabaseKey:o})};function u(d){r=d,n(0,r)}function c(d){o=d,n(2,o)}return i.$$set=d=>{"onConfig"in d&&n(5,t=d.onConfig)},[r,s,o,a,l,t,u,c]}class Ya extends U{constructor(e){super(),D(this,e,Xa,Qa,L,{onConfig:5})}}function Za(i){let e,n;return e=new he({props:{onSubmit:i[4],$$slots:{default:[tl]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,r){const s={};r&71&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){$(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function xa(i){let e,n,t;return{c(){e=T("div"),e.textContent="Magic link was successfully send!",n=A(),t=T("div"),t.textContent="Please check your E-Mail"},m(r,s){C(r,e,s),C(r,n,s),C(r,t,s)},p:q,i:q,o:q,d(r){r&&(y(e),y(n),y(t))}}}function el(i){let e,n;return e=new M({props:{disabled:i[2],label:"Magic Link"}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,r){const s={};r&4&&(s.disabled=t[2]),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){$(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function tl(i){let e,n,t,r,s;function o(l){i[5](l)}let a={id:"email",label:"E-Mail",error:i[1]};return i[0]!==void 0&&(a.value=i[0]),e=new _e({props:a}),Z.push(()=>ne(e,"value",o)),r=new Q({props:{$$slots:{default:[el]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment),t=A(),w(r.$$.fragment)},m(l,u){g(e,l,u),C(l,t,u),g(r,l,u),s=!0},p(l,u){const c={};u&2&&(c.error=l[1]),!n&&u&1&&(n=!0,c.value=l[0],te(()=>n=!1)),e.$set(c);const d={};u&68&&(d.$$scope={dirty:u,ctx:l}),r.$set(d)},i(l){s||(m(e.$$.fragment,l),m(r.$$.fragment,l),s=!0)},o(l){$(e.$$.fragment,l),$(r.$$.fragment,l),s=!1},d(l){l&&y(t),b(e,l),b(r,l)}}}function nl(i){let e,n,t,r;const s=[xa,Za],o=[];function a(l,u){return l[3]?0:1}return e=a(i),n=o[e]=s[e](i),{c(){n.c(),t=x()},m(l,u){o[e].m(l,u),C(l,t,u),r=!0},p(l,[u]){let c=e;e=a(l),e===c?o[e].p(l,u):(K(),$(o[c],1,1,()=>{o[c]=null}),V(),n=o[e],n?n.p(l,u):(n=o[e]=s[e](l),n.c()),m(n,1),n.m(t.parentNode,t))},i(l){r||(m(n),r=!0)},o(l){$(n),r=!1},d(l){l&&y(t),o[e].d(l)}}}function rl(i,e,n){let t="",r="",s=!1,o=!1;const a=async()=>{if(n(1,r=ue(t)),r)return;n(2,s=!0);const{data:u,error:c}=await Y.auth.signInWithOtp({email:t});if(n(2,s=!1),c){G.setAuthError(c);return}u&&(console.log("data",u),n(3,o=!0))};function l(u){t=u,n(0,t)}return[t,r,s,o,a,l]}class sl extends U{constructor(e){super(),D(this,e,rl,nl,L,{})}}function il(i){let e;return{c(){e=T("div"),e.innerHTML='<svg class="h-8 w-8 animate-spin text-blue-600" viewBox="0 0 100 100"><circle fill="none" stroke-width="10" class="stroke-current opacity-40" cx="50" cy="50" r="40"></circle><circle fill="none" stroke-width="10" class="stroke-current" stroke-dasharray="250" stroke-dashoffset="210" cx="50" cy="50" r="40"></circle></svg>',k(e,"class","flex justify-center")},m(n,t){C(n,e,t)},p:q,i:q,o:q,d(n){n&&y(e)}}}class ol extends U{constructor(e){super(),D(this,e,null,il,L,{})}}function al(i){let e,n,t;e=new Ua({props:{onLogout:i[4]}});const r=i[6].default,s=we(r,i,i[5],null);return{c(){w(e.$$.fragment),n=A(),s&&s.c()},m(o,a){g(e,o,a),C(o,n,a),s&&s.m(o,a),t=!0},p(o,a){s&&s.p&&(!t||a&32)&&ke(s,r,o,o[5],t?ve(r,o[5],a,null):ye(o[5]),null)},i(o){t||(m(e.$$.fragment,o),m(s,o),t=!0)},o(o){$(e.$$.fragment,o),$(s,o),t=!1},d(o){o&&y(n),b(e,o),s&&s.d(o)}}}function ll(i){let e,n,t,r;const s=[fl,cl],o=[];function a(l,u){return l[1]?0:1}return e=a(i),n=o[e]=s[e](i),{c(){n.c(),t=x()},m(l,u){o[e].m(l,u),C(l,t,u),r=!0},p(l,u){let c=e;e=a(l),e!==c&&(K(),$(o[c],1,1,()=>{o[c]=null}),V(),n=o[e],n||(n=o[e]=s[e](l),n.c()),m(n,1),n.m(t.parentNode,t))},i(l){r||(m(n),r=!0)},o(l){$(n),r=!1},d(l){l&&y(t),o[e].d(l)}}}function ul(i){let e,n;return e=new Ya({props:{onConfig:i[3]}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p:q,i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){$(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function cl(i){let e,n;return e=new ol({}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){$(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function fl(i){let e,n;return e=new sl({}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){$(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function dl(i){let e,n,t,r;const s=[ul,ll,al],o=[];function a(l,u){return l[0]?l[2]?2:1:0}return e=a(i),n=o[e]=s[e](i),{c(){n.c(),t=x()},m(l,u){o[e].m(l,u),C(l,t,u),r=!0},p(l,[u]){let c=e;e=a(l),e===c?o[e].p(l,u):(K(),$(o[c],1,1,()=>{o[c]=null}),V(),n=o[e],n?n.p(l,u):(n=o[e]=s[e](l),n.c()),m(n,1),n.m(t.parentNode,t))},i(l){r||(m(n),r=!0)},o(l){$(n),r=!1},d(l){l&&y(t),o[e].d(l)}}}function hl(i,e,n){let t;gn(i,Ct,d=>n(2,t=d));let{$$slots:r={},$$scope:s}=e,o=!1,a=!1;const l=()=>Y?(Y.auth.onAuthStateChange((d,h)=>{console.log("auth changed:",h==null?void 0:h.user),h!=null&&h.user?Ct.set(h.user):Ct.set(null),n(1,a=!0)}),!0):(console.log("supabase is not initialized!"),!1),u=d=>{ta(d),n(0,o=l())},c=()=>{Y&&t&&Y.auth.signOut()};return ae(()=>{n(0,o=l())}),i.$$set=d=>{"$$scope"in d&&n(5,s=d.$$scope)},[o,a,t,u,c,s,r]}class pl extends U{constructor(e){super(),D(this,e,hl,dl,L,{})}}function ml(i){let e,n;return{c(){e=T("h2"),n=R(i[0]),k(e,"class","text-2xl font-extrabold")},m(t,r){C(t,e,r),S(e,n)},p(t,[r]){r&1&&B(n,t[0])},i:q,o:q,d(t){t&&y(e)}}}function $l(i,e,n){let{header:t}=e;return i.$$set=r=>{"header"in r&&n(0,t=r.header)},[t]}class re extends U{constructor(e){super(),D(this,e,$l,ml,L,{header:0})}}const mt="cache-",Ss=()=>{const i=[];for(let e in localStorage)e.startsWith(mt)&&i.push(e);return i.sort()},_l=()=>{const i=[];for(let e in localStorage)e.startsWith(mt)&&localStorage.removeItem(e);return i},gl=i=>(localStorage.removeItem(i),Ss());function Lt(i){const e=localStorage.getItem(i);return e===null?null:JSON.parse(e)}function An(i,e){const n={created:new Date().getTime(),data:e},t=JSON.stringify(n);return localStorage.setItem(i,t),n}const je=i=>{localStorage.removeItem(i)},Tn=i=>`${mt}questions#${i}`,qt=i=>{je(Tn(i))},bl=new RegExp(/[.,;!?()'"/&+-]/,"g"),wl=new RegExp(/[\*#=~]/,"g"),vl=new Set(["der","die","das","ein","sich","etwas","etw","hier","instr","nom","она","оно","они"]),$t=(i,e,n)=>{let t=i+" "+e;n&&(t=t+" "+n),t=t.replaceAll(bl," "),t=t.replaceAll(wl,"");let r=t.split(/\s+/);const s=new Set;return r.forEach(o=>{o.length>2&&!vl.has(o)&&s.add(o.toLowerCase())}),Array.from(s).sort().join(" ")},kl=async i=>{let{data:e,error:n}=await Y.from("questions").select("*").eq("id",i).single();return n&&G.setDBError(n),e||null},xe=async i=>{const e=Tn(i),n=Lt(e);if(n!==null)return n.data;let{data:t,error:r}=await Y.from("questions").select("*").eq("chapter_id",i).order("id");return r&&G.setDBError(r),t?An(e,t).data:[]},yl=async(i,e)=>{const{error:n}=await Y.from("questions").delete().eq("id",i);return n?(G.setDBError(n),[]):(qt(e),xe(e))},Cl=async(i,e,n,t)=>{const{error:r}=await Y.from("questions").insert([{chapter_id:i,quest:e,answer:n,details:t,search:$t(e,n,t)}]);if(r)return G.setDBError(r),[];qt(i)},Sl=async(i,e,n,t,r)=>{const{error:s}=await Y.from("questions").update({quest:n,answer:t,details:r||null,search:$t(n,t,r)}).eq("id",i);return s?(G.setDBError(s),[]):(qt(e),xe(e))},on=10,El=async i=>{const{data:e,error:n}=await Y.from("questions").select().like("search",`%${i.toLocaleLowerCase()}%`).limit(on+1);return n?(G.setDBError(n),{questions:[],hasMore:!1}):(console.log("search-like:",i,"data:",e),{questions:e.slice(0,on),hasMore:e.length==on+1})},hr=async()=>{const{count:i,error:e}=await Y.from("questions").select("*",{count:"exact",head:!0}).is("search",null);return e?(G.setDBError(e),-2):i===null?-1:i},Al=async i=>{const{data:e,error:n}=await Y.from("questions").select("*").is("search",null).limit(i);return n?(G.setDBError(n),[]):e===null?[]:e},Tl=async i=>{const e=[];i.forEach(r=>{r.search=$t(r.quest,r.answer,r.details),e.includes(r.chapter_id)||e.push(r.chapter_id)});const{data:n,error:t}=await Y.from("questions").upsert(i);if(t){G.setDBError(t);return}e.forEach(r=>{qt(r)}),console.log("clear cache chapters",e)},dt="session",Ol=(i,e,n)=>{if(i.length==0)return;const t=i.map(s=>({question:s,progress:e}));Ba(t);const r={learning:t,learned:[],reverse:n};localStorage.setItem(dt,JSON.stringify(r))},Es=()=>{const i=localStorage.getItem(dt);return i?JSON.parse(i):null},jl=i=>i.learning.length>0?(localStorage.setItem(dt,JSON.stringify(i)),!0):(localStorage.removeItem(dt),!1),Il=()=>{localStorage.removeItem(dt)},pr=i=>{const e=[0,0,0,i.learned.length];return i.learning.forEach(n=>{if(n.progress>2)throw Error(`Invalid progress ${n.progress}`);e[n.progress]++}),e},Pl=i=>{let e=0;return e+=i[0]*3,e+=i[1]*2,e+=i[2]*1,e},Rl=()=>{let i=-1,e=[];return async n=>{n.chapter_id!==i&&(i=n.chapter_id,e=await xe(i),console.log("loaded chapter for refresh:",i));const t=e.find(r=>r.id===n.id);return t===void 0?(G.setString("Unable to refresh lession!",`Question not found: ${n.id}`),n):t}},Ll=async i=>{let e=Rl();for(let n of i.learned)n.question=await e(n.question);for(let n of i.learning)n.question=await e(n.question);return i};function ql(i){let e,n;const t=i[1].default,r=we(t,i,i[0],null);return{c(){e=T("div"),r&&r.c(),k(e,"class","flex flex-col gap-5")},m(s,o){C(s,e,o),r&&r.m(e,null),n=!0},p(s,[o]){r&&r.p&&(!n||o&1)&&ke(r,t,s,s[0],n?ve(t,s[0],o,null):ye(s[0]),null)},i(s){n||(m(r,s),n=!0)},o(s){$(r,s),n=!1},d(s){s&&y(e),r&&r.d(s)}}}function Dl(i,e,n){let{$$slots:t={},$$scope:r}=e;return i.$$set=s=>{"$$scope"in s&&n(0,r=s.$$scope)},[r,t]}class se extends U{constructor(e){super(),D(this,e,Dl,ql,L,{})}}function mr(i){let e,n;return e=new Q({props:{$$slots:{default:[Ul]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,r){const s={};r&8&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){$(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function Ul(i){let e,n,t,r;return e=new M({props:{label:"Continue",onClick:i[1]}}),t=new M({props:{label:"End",onClick:i[2]}}),{c(){w(e.$$.fragment),n=A(),w(t.$$.fragment)},m(s,o){g(e,s,o),C(s,n,o),g(t,s,o),r=!0},p:q,i(s){r||(m(e.$$.fragment,s),m(t.$$.fragment,s),r=!0)},o(s){$(e.$$.fragment,s),$(t.$$.fragment,s),r=!1},d(s){s&&y(n),b(e,s),b(t,s)}}}function Nl(i){let e,n,t,r;e=new re({props:{header:"Home"}});let s=i[0]&&mr(i);return{c(){w(e.$$.fragment),n=A(),s&&s.c(),t=x()},m(o,a){g(e,o,a),C(o,n,a),s&&s.m(o,a),C(o,t,a),r=!0},p(o,a){o[0]?s?(s.p(o,a),a&1&&m(s,1)):(s=mr(o),s.c(),m(s,1),s.m(t.parentNode,t)):s&&(K(),$(s,1,1,()=>{s=null}),V())},i(o){r||(m(e.$$.fragment,o),m(s),r=!0)},o(o){$(e.$$.fragment,o),$(s),r=!1},d(o){o&&(y(n),y(t)),b(e,o),s&&s.d(o)}}}function Bl(i){let e,n;return e=new se({props:{$$slots:{default:[Nl]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,[r]){const s={};r&9&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){$(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function Ml(i,e,n){let t=!1;const r=()=>{F("/lession/process")},s=()=>{Il(),n(0,t=!1)};return ae(()=>{Es()&&n(0,t=!0)}),[t,r,s]}class Fl extends U{constructor(e){super(),D(this,e,Ml,Bl,L,{})}}function zl(i){let e,n,t,r;return e=new re({props:{header:"Not Found"}}),{c(){w(e.$$.fragment),n=A(),t=T("div"),t.textContent="Not Found"},m(s,o){g(e,s,o),C(s,n,o),C(s,t,o),r=!0},p:q,i(s){r||(m(e.$$.fragment,s),r=!0)},o(s){$(e.$$.fragment,s),r=!1},d(s){s&&(y(n),y(t)),b(e,s)}}}function Hl(i){let e,n;return e=new se({props:{$$slots:{default:[zl]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,[r]){const s={};r&1&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){$(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}class Jl extends U{constructor(e){super(),D(this,e,null,Hl,L,{})}}const ht=mt+"books",Dt=async i=>{let{data:e,error:n}=await Y.from("books").select("*").eq("id",i).single();return n&&G.setDBError(n),e||null},Gl=async i=>(await Ut()).find(n=>n.id===i),Ut=async()=>{const i=Lt(ht);if(i!==null)return i.data;let{data:e,error:n}=await Y.from("books").select("*");return n&&G.setDBError(n),e?An(ht,e).data:[]},Kl=async i=>{const{error:e}=await Y.from("books").delete().eq("id",i);return e?(G.setDBError(e),[]):(je(ht),Ut())},Vl=async(i,e)=>{const{error:n}=await Y.from("books").insert([{name:i,description:e}]);if(n)return G.setDBError(n),[];je(ht)},Wl=async(i,e,n)=>{const{error:t}=await Y.from("books").update({name:e,description:n}).eq("id",i);return t?(G.setDBError(t),[]):(je(ht),Ut())};function Ql(i){let e,n;return{c(){e=W("svg"),n=W("path"),k(n,"stroke-linecap","round"),k(n,"stroke-linejoin","round"),k(n,"d","m9.75 9.75 4.5 4.5m0-4.5-4.5 4.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"),k(e,"xmlns","http://www.w3.org/2000/svg"),k(e,"fill","none"),k(e,"viewBox","0 0 24 24"),k(e,"stroke-width","1.5"),k(e,"stroke","currentColor"),k(e,"class","size-6 hover:stroke-2")},m(t,r){C(t,e,r),S(e,n)},p:q,d(t){t&&y(e)}}}function Xl(i){let e,n;return e=new ce({props:{onClick:i[0],$$slots:{default:[Ql]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,[r]){const s={};r&1&&(s.onClick=t[0]),r&2&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){$(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function Yl(i,e,n){let{onClick:t}=e;return i.$$set=r=>{"onClick"in r&&n(0,t=r.onClick)},[t]}class Nt extends U{constructor(e){super(),D(this,e,Yl,Xl,L,{onClick:0})}}function Zl(i){let e,n;return{c(){e=W("svg"),n=W("path"),k(n,"stroke-linecap","round"),k(n,"stroke-linejoin","round"),k(n,"d","M3.75 12h16.5m-16.5 3.75h16.5M3.75 19.5h16.5M5.625 4.5h12.75a1.875 1.875 0 0 1 0 3.75H5.625a1.875 1.875 0 0 1 0-3.75Z"),k(e,"xmlns","http://www.w3.org/2000/svg"),k(e,"fill","none"),k(e,"viewBox","0 0 24 24"),k(e,"stroke-width","1.5"),k(e,"stroke","currentColor"),k(e,"class","size-6 hover:stroke-2")},m(t,r){C(t,e,r),S(e,n)},p:q,d(t){t&&y(e)}}}function xl(i){let e,n;return e=new ce({props:{onClick:i[0],$$slots:{default:[Zl]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,[r]){const s={};r&1&&(s.onClick=t[0]),r&2&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){$(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function eu(i,e,n){let{onClick:t}=e;return i.$$set=r=>{"onClick"in r&&n(0,t=r.onClick)},[t]}class As extends U{constructor(e){super(),D(this,e,eu,xl,L,{onClick:0})}}function tu(i){let e,n;return{c(){e=W("svg"),n=W("path"),k(n,"stroke-linecap","round"),k(n,"stroke-linejoin","round"),k(n,"d","m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"),k(e,"xmlns","http://www.w3.org/2000/svg"),k(e,"fill","none"),k(e,"viewBox","0 0 24 24"),k(e,"stroke-width","1.5"),k(e,"stroke","currentColor"),k(e,"class","size-6 hover:stroke-2")},m(t,r){C(t,e,r),S(e,n)},p:q,d(t){t&&y(e)}}}function nu(i){let e,n;return e=new ce({props:{onClick:i[0],$$slots:{default:[tu]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,[r]){const s={};r&1&&(s.onClick=t[0]),r&2&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){$(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function ru(i,e,n){let{onClick:t}=e;return i.$$set=r=>{"onClick"in r&&n(0,t=r.onClick)},[t]}class On extends U{constructor(e){super(),D(this,e,ru,nu,L,{onClick:0})}}function $r(i){let e,n;return e=new ls({props:{title:i[1],buttons:i[2],$$slots:{default:[su]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,r){const s={};r&2&&(s.title=t[1]),r&9&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){$(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function su(i){let e=i[0].getMessage(i[0])+"",n;return{c(){n=R(e)},m(t,r){C(t,n,r)},p(t,r){r&1&&e!==(e=t[0].getMessage(t[0])+"")&&B(n,e)},d(t){t&&y(n)}}}function iu(i){let e,n,t=i[0].entry&&$r(i);return{c(){t&&t.c(),e=x()},m(r,s){t&&t.m(r,s),C(r,e,s),n=!0},p(r,[s]){r[0].entry?t?(t.p(r,s),s&1&&m(t,1)):(t=$r(r),t.c(),m(t,1),t.m(e.parentNode,e)):t&&(K(),$(t,1,1,()=>{t=null}),V())},i(r){n||(m(t),n=!0)},o(r){$(t),n=!1},d(r){r&&y(e),t&&t.d(r)}}}function ou(i,e,n){let{title:t}=e,{deleteEntry:r}=e;const s=[{label:"Close",onclick:()=>{n(0,r.entry=null,r)}},{label:"Delete",onclick:()=>{r.entry&&(r.onDelete(r.entry),n(0,r.entry=null,r))}}];return i.$$set=o=>{"title"in o&&n(1,t=o.title),"deleteEntry"in o&&n(0,r=o.deleteEntry)},[r,t,s]}class jn extends U{constructor(e){super(),D(this,e,ou,iu,L,{title:1,deleteEntry:0})}}function au(i){let e,n;return{c(){e=W("svg"),n=W("path"),k(n,"stroke-linecap","round"),k(n,"stroke-linejoin","round"),k(n,"d","M20.25 6.375c0 2.278-3.694 4.125-8.25 4.125S3.75 8.653 3.75 6.375m16.5 0c0-2.278-3.694-4.125-8.25-4.125S3.75 4.097 3.75 6.375m16.5 0v11.25c0 2.278-3.694 4.125-8.25 4.125s-8.25-1.847-8.25-4.125V6.375m16.5 0v3.75m-16.5-3.75v3.75m16.5 0v3.75C20.25 16.153 16.556 18 12 18s-8.25-1.847-8.25-4.125v-3.75m16.5 0c0 2.278-3.694 4.125-8.25 4.125s-8.25-1.847-8.25-4.125"),k(e,"xmlns","http://www.w3.org/2000/svg"),k(e,"fill","none"),k(e,"viewBox","0 0 24 24"),k(e,"stroke-width","1.5"),k(e,"stroke","currentColor"),k(e,"class","size-6 hover:stroke-2")},m(t,r){C(t,e,r),S(e,n)},p:q,d(t){t&&y(e)}}}function lu(i){let e,n;return e=new ce({props:{onClick:i[0],$$slots:{default:[au]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,[r]){const s={};r&1&&(s.onClick=t[0]),r&2&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){$(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function uu(i,e,n){let{onClick:t}=e;return i.$$set=r=>{"onClick"in r&&n(0,t=r.onClick)},[t]}class cu extends U{constructor(e){super(),D(this,e,uu,lu,L,{onClick:0})}}function fu(i){let e,n;return{c(){e=W("svg"),n=W("path"),k(n,"stroke-linecap","round"),k(n,"stroke-linejoin","round"),k(n,"d","M6.429 9.75 2.25 12l4.179 2.25m0-4.5 5.571 3 5.571-3m-11.142 0L2.25 7.5 12 2.25l9.75 5.25-4.179 2.25m0 0L21.75 12l-4.179 2.25m0 0 4.179 2.25L12 21.75 2.25 16.5l4.179-2.25m11.142 0-5.571 3-5.571-3"),k(e,"xmlns","http://www.w3.org/2000/svg"),k(e,"fill","none"),k(e,"viewBox","0 0 24 24"),k(e,"stroke-width","1.5"),k(e,"stroke","currentColor"),k(e,"class","size-6 hover:stroke-2")},m(t,r){C(t,e,r),S(e,n)},p:q,d(t){t&&y(e)}}}function du(i){let e,n;return e=new ce({props:{onClick:i[0],$$slots:{default:[fu]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,[r]){const s={};r&1&&(s.onClick=t[0]),r&2&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){$(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function hu(i,e,n){let{onClick:t}=e;return i.$$set=r=>{"onClick"in r&&n(0,t=r.onClick)},[t]}class pu extends U{constructor(e){super(),D(this,e,hu,du,L,{onClick:0})}}function _r(i,e,n){const t=i.slice();return t[9]=e[n],t}function mu(i){let e,n,t,r,s,o,a,l,u,c;function d(){return i[2](i[9])}e=new Nt({props:{onClick:d}});function h(){return i[3](i[9])}t=new pu({props:{onClick:h}});function f(){return i[4](i[9])}s=new cu({props:{onClick:f}});function p(){return i[5](i[9])}a=new On({props:{onClick:p}});function _(){return i[6](i[9])}return u=new As({props:{onClick:_}}),{c(){w(e.$$.fragment),n=A(),w(t.$$.fragment),r=A(),w(s.$$.fragment),o=A(),w(a.$$.fragment),l=A(),w(u.$$.fragment)},m(v,j){g(e,v,j),C(v,n,j),g(t,v,j),C(v,r,j),g(s,v,j),C(v,o,j),g(a,v,j),C(v,l,j),g(u,v,j),c=!0},p(v,j){i=v;const E={};j&3&&(E.onClick=d),e.$set(E);const O={};j&1&&(O.onClick=h),t.$set(O);const I={};j&1&&(I.onClick=f),s.$set(I);const P={};j&1&&(P.onClick=p),a.$set(P);const N={};j&1&&(N.onClick=_),u.$set(N)},i(v){c||(m(e.$$.fragment,v),m(t.$$.fragment,v),m(s.$$.fragment,v),m(a.$$.fragment,v),m(u.$$.fragment,v),c=!0)},o(v){$(e.$$.fragment,v),$(t.$$.fragment,v),$(s.$$.fragment,v),$(a.$$.fragment,v),$(u.$$.fragment,v),c=!1},d(v){v&&(y(n),y(r),y(o),y(l)),b(e,v),b(t,v),b(s,v),b(a,v),b(u,v)}}}function gr(i){let e,n,t=i[9].id+"",r,s,o,a=i[9].name+"",l,u,c,d=i[9].description+"",h,f,p,_=le(i[9].modified)+"",v,j,E,O,I,P;return O=new Q({props:{$$slots:{default:[mu]},$$scope:{ctx:i}}}),{c(){e=T("tr"),n=T("td"),r=R(t),s=A(),o=T("td"),l=R(a),u=A(),c=T("td"),h=R(d),f=A(),p=T("td"),v=R(_),j=A(),E=T("td"),w(O.$$.fragment),I=A()},m(N,J){C(N,e,J),S(e,n),S(n,r),S(e,s),S(e,o),S(o,l),S(e,u),S(e,c),S(c,h),S(e,f),S(e,p),S(p,v),S(e,j),S(e,E),g(O,E,null),S(e,I),P=!0},p(N,J){(!P||J&1)&&t!==(t=N[9].id+"")&&B(r,t),(!P||J&1)&&a!==(a=N[9].name+"")&&B(l,a),(!P||J&1)&&d!==(d=N[9].description+"")&&B(h,d),(!P||J&1)&&_!==(_=le(N[9].modified)+"")&&B(v,_);const ee={};J&4099&&(ee.$$scope={dirty:J,ctx:N}),O.$set(ee)},i(N){P||(m(O.$$.fragment,N),P=!0)},o(N){$(O.$$.fragment,N),P=!1},d(N){N&&y(e),b(O)}}}function $u(i){let e,n,t,r;return e=new M({props:{onClick:i[7],label:"Cancel"}}),t=new M({props:{onClick:i[8],label:"Create"}}),{c(){w(e.$$.fragment),n=A(),w(t.$$.fragment)},m(s,o){g(e,s,o),C(s,n,o),g(t,s,o),r=!0},p:q,i(s){r||(m(e.$$.fragment,s),m(t.$$.fragment,s),r=!0)},o(s){$(e.$$.fragment,s),$(t.$$.fragment,s),r=!1},d(s){s&&y(n),b(e,s),b(t,s)}}}function _u(i){let e,n,t,r,s,o,a,l,u;e=new re({props:{header:"List Books"}});let c=ie(i[0]),d=[];for(let f=0;f<c.length;f+=1)d[f]=gr(_r(i,c,f));const h=f=>$(d[f],1,1,()=>{d[f]=null});return l=new Q({props:{$$slots:{default:[$u]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment),n=A(),t=T("table"),r=T("thead"),r.innerHTML="<tr><th>ID</th> <th>Name</th> <th>Description</th> <th>Modified</th> <th>Actions</th></tr>",s=A(),o=T("tbody");for(let f=0;f<d.length;f+=1)d[f].c();a=A(),w(l.$$.fragment),k(t,"class","w-full")},m(f,p){g(e,f,p),C(f,n,p),C(f,t,p),S(t,r),S(t,s),S(t,o);for(let _=0;_<d.length;_+=1)d[_]&&d[_].m(o,null);C(f,a,p),g(l,f,p),u=!0},p(f,p){if(p&3){c=ie(f[0]);let v;for(v=0;v<c.length;v+=1){const j=_r(f,c,v);d[v]?(d[v].p(j,p),m(d[v],1)):(d[v]=gr(j),d[v].c(),m(d[v],1),d[v].m(o,null))}for(K(),v=c.length;v<d.length;v+=1)h(v);V()}const _={};p&4096&&(_.$$scope={dirty:p,ctx:f}),l.$set(_)},i(f){if(!u){m(e.$$.fragment,f);for(let p=0;p<c.length;p+=1)m(d[p]);m(l.$$.fragment,f),u=!0}},o(f){$(e.$$.fragment,f),d=d.filter(Boolean);for(let p=0;p<d.length;p+=1)$(d[p]);$(l.$$.fragment,f),u=!1},d(f){f&&(y(n),y(t),y(a)),b(e,f),Ce(d,f),b(l,f)}}}function gu(i){let e,n,t,r;return e=new se({props:{$$slots:{default:[_u]},$$scope:{ctx:i}}}),t=new jn({props:{title:"Delete Book",deleteEntry:i[1]}}),{c(){w(e.$$.fragment),n=A(),w(t.$$.fragment)},m(s,o){g(e,s,o),C(s,n,o),g(t,s,o),r=!0},p(s,[o]){const a={};o&4099&&(a.$$scope={dirty:o,ctx:s}),e.$set(a);const l={};o&2&&(l.deleteEntry=s[1]),t.$set(l)},i(s){r||(m(e.$$.fragment,s),m(t.$$.fragment,s),r=!0)},o(s){$(e.$$.fragment,s),$(t.$$.fragment,s),r=!1},d(s){s&&y(n),b(e,s),b(t,s)}}}function bu(i,e,n){let t=[],r={entry:null,onDelete:h=>{Kl(h.id).then(f=>{n(0,t=f)})},getMessage:h=>`Do you wnat to delete the book: '${h.id}'?`};return ae(async()=>{n(0,t=await Ut())}),[t,r,async h=>{n(1,r.entry=h,r)},h=>{F("/backup/json/"+h.id)},h=>{F("/backup/sql/"+h.id)},h=>{F("/books/update/"+h.id)},h=>{F("/chapters/list/"+h.id)},()=>F("/books/list"),()=>F("/books/create")]}class wu extends U{constructor(e){super(),D(this,e,bu,gu,L,{})}}function vu(i){let e,n,t;return{c(){e=T("textarea"),k(e,"class","input"),k(e,"id",i[2])},m(r,s){C(r,e,s),Oe(e,i[0]),n||(t=De(e,"input",i[4]),n=!0)},p(r,s){s&4&&k(e,"id",r[2]),s&1&&Oe(e,r[0])},d(r){r&&y(e),n=!1,t()}}}function ku(i){let e,n;return e=new Rt({props:{id:i[2],label:i[1],error:i[3],$$slots:{default:[vu]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,[r]){const s={};r&4&&(s.id=t[2]),r&2&&(s.label=t[1]),r&8&&(s.error=t[3]),r&37&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){$(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function yu(i,e,n){let{label:t}=e,{id:r}=e,{value:s}=e,{error:o}=e;function a(){s=this.value,n(0,s)}return i.$$set=l=>{"label"in l&&n(1,t=l.label),"id"in l&&n(2,r=l.id),"value"in l&&n(0,s=l.value),"error"in l&&n(3,o=l.error)},[s,t,r,o,a]}class Ts extends U{constructor(e){super(),D(this,e,yu,ku,L,{label:1,id:2,value:0,error:3})}}function Cu(i){let e,n,t,r;return e=new M({props:{onClick:i[7],label:"Cancel"}}),t=new M({props:{label:"Create"}}),{c(){w(e.$$.fragment),n=A(),w(t.$$.fragment)},m(s,o){g(e,s,o),C(s,n,o),g(t,s,o),r=!0},p:q,i(s){r||(m(e.$$.fragment,s),m(t.$$.fragment,s),r=!0)},o(s){$(e.$$.fragment,s),$(t.$$.fragment,s),r=!1},d(s){s&&y(n),b(e,s),b(t,s)}}}function Su(i){let e,n,t,r,s,o,a,l;function u(f){i[5](f)}let c={id:"name",label:"Book name",error:i[1]};i[0]!==void 0&&(c.value=i[0]),e=new _e({props:c}),Z.push(()=>ne(e,"value",u));function d(f){i[6](f)}let h={id:"description",label:"Book description",error:i[3]};return i[2]!==void 0&&(h.value=i[2]),r=new Ts({props:h}),Z.push(()=>ne(r,"value",d)),a=new Q({props:{$$slots:{default:[Cu]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment),t=A(),w(r.$$.fragment),o=A(),w(a.$$.fragment)},m(f,p){g(e,f,p),C(f,t,p),g(r,f,p),C(f,o,p),g(a,f,p),l=!0},p(f,p){const _={};p&2&&(_.error=f[1]),!n&&p&1&&(n=!0,_.value=f[0],te(()=>n=!1)),e.$set(_);const v={};p&8&&(v.error=f[3]),!s&&p&4&&(s=!0,v.value=f[2],te(()=>s=!1)),r.$set(v);const j={};p&256&&(j.$$scope={dirty:p,ctx:f}),a.$set(j)},i(f){l||(m(e.$$.fragment,f),m(r.$$.fragment,f),m(a.$$.fragment,f),l=!0)},o(f){$(e.$$.fragment,f),$(r.$$.fragment,f),$(a.$$.fragment,f),l=!1},d(f){f&&(y(t),y(o)),b(e,f),b(r,f),b(a,f)}}}function Eu(i){let e,n,t,r;return e=new re({props:{header:"Create Book"}}),t=new he({props:{onSubmit:i[4],$$slots:{default:[Su]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment),n=A(),w(t.$$.fragment)},m(s,o){g(e,s,o),C(s,n,o),g(t,s,o),r=!0},p(s,o){const a={};o&271&&(a.$$scope={dirty:o,ctx:s}),t.$set(a)},i(s){r||(m(e.$$.fragment,s),m(t.$$.fragment,s),r=!0)},o(s){$(e.$$.fragment,s),$(t.$$.fragment,s),r=!1},d(s){s&&y(n),b(e,s),b(t,s)}}}function Au(i){let e,n;return e=new se({props:{$$slots:{default:[Eu]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,[r]){const s={};r&271&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){$(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function Tu(i,e,n){let t="",r="",s="",o="";const a=async()=>{n(1,r=ue(t)),n(3,o=ue(s)),!(r||o)&&(await Vl(t,s),F("/books/list"))};function l(d){t=d,n(0,t)}function u(d){s=d,n(2,s)}return[t,r,s,o,a,l,u,()=>F("/books/list")]}class Ou extends U{constructor(e){super(),D(this,e,Tu,Au,L,{})}}function br(i){let e,n,t=i[0].id+"",r,s,o,a=le(i[0].modified)+"",l,u,c,d;return c=new he({props:{onSubmit:i[5],$$slots:{default:[Iu]},$$scope:{ctx:i}}}),{c(){e=T("div"),n=T("span"),r=R(t),s=A(),o=T("span"),l=R(a),u=A(),w(c.$$.fragment),k(e,"class","mb-4 text-small")},m(h,f){C(h,e,f),S(e,n),S(n,r),S(e,s),S(e,o),S(o,l),C(h,u,f),g(c,h,f),d=!0},p(h,f){(!d||f&1)&&t!==(t=h[0].id+"")&&B(r,t),(!d||f&1)&&a!==(a=le(h[0].modified)+"")&&B(l,a);const p={};f&1054&&(p.$$scope={dirty:f,ctx:h}),c.$set(p)},i(h){d||(m(c.$$.fragment,h),d=!0)},o(h){$(c.$$.fragment,h),d=!1},d(h){h&&(y(e),y(u)),b(c,h)}}}function ju(i){let e,n,t,r;return e=new M({props:{onClick:i[9],label:"Cancel"}}),t=new M({props:{label:"Update"}}),{c(){w(e.$$.fragment),n=A(),w(t.$$.fragment)},m(s,o){g(e,s,o),C(s,n,o),g(t,s,o),r=!0},p:q,i(s){r||(m(e.$$.fragment,s),m(t.$$.fragment,s),r=!0)},o(s){$(e.$$.fragment,s),$(t.$$.fragment,s),r=!1},d(s){s&&y(n),b(e,s),b(t,s)}}}function Iu(i){let e,n,t,r,s,o,a,l;function u(f){i[7](f)}let c={id:"name",label:"Book name",error:i[2]};i[1]!==void 0&&(c.value=i[1]),e=new _e({props:c}),Z.push(()=>ne(e,"value",u));function d(f){i[8](f)}let h={id:"description",label:"Book description",error:i[4]};return i[3]!==void 0&&(h.value=i[3]),r=new Ts({props:h}),Z.push(()=>ne(r,"value",d)),a=new Q({props:{$$slots:{default:[ju]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment),t=A(),w(r.$$.fragment),o=A(),w(a.$$.fragment)},m(f,p){g(e,f,p),C(f,t,p),g(r,f,p),C(f,o,p),g(a,f,p),l=!0},p(f,p){const _={};p&4&&(_.error=f[2]),!n&&p&2&&(n=!0,_.value=f[1],te(()=>n=!1)),e.$set(_);const v={};p&16&&(v.error=f[4]),!s&&p&8&&(s=!0,v.value=f[3],te(()=>s=!1)),r.$set(v);const j={};p&1024&&(j.$$scope={dirty:p,ctx:f}),a.$set(j)},i(f){l||(m(e.$$.fragment,f),m(r.$$.fragment,f),m(a.$$.fragment,f),l=!0)},o(f){$(e.$$.fragment,f),$(r.$$.fragment,f),$(a.$$.fragment,f),l=!1},d(f){f&&(y(t),y(o)),b(e,f),b(r,f),b(a,f)}}}function Pu(i){let e,n,t,r;e=new re({props:{header:"Update Book"}});let s=i[0]&&br(i);return{c(){w(e.$$.fragment),n=A(),s&&s.c(),t=x()},m(o,a){g(e,o,a),C(o,n,a),s&&s.m(o,a),C(o,t,a),r=!0},p(o,a){o[0]?s?(s.p(o,a),a&1&&m(s,1)):(s=br(o),s.c(),m(s,1),s.m(t.parentNode,t)):s&&(K(),$(s,1,1,()=>{s=null}),V())},i(o){r||(m(e.$$.fragment,o),m(s),r=!0)},o(o){$(e.$$.fragment,o),$(s),r=!1},d(o){o&&(y(n),y(t)),b(e,o),s&&s.d(o)}}}function Ru(i){let e,n;return e=new se({props:{$$slots:{default:[Pu]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,[r]){const s={};r&1055&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){$(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function Lu(i,e,n){let{params:t={id:""}}=e,r=null,s="",o="",a="",l="";const u=async()=>{if(n(2,o=ue(s)),n(4,l=ue(a)),!(o||l)){if(!r){G.setString("No book!!");return}await Wl(r.id,s,a),F("/books/list")}};ae(async()=>{n(0,r=await Dt(parseInt(t.id))),r&&(n(1,s=r.name),n(3,a=r.description))});function c(f){s=f,n(1,s)}function d(f){a=f,n(3,a)}const h=()=>F("/books/list");return i.$$set=f=>{"params"in f&&n(6,t=f.params)},[r,s,o,a,l,u,t,c,d,h]}class qu extends U{constructor(e){super(),D(this,e,Lu,Ru,L,{params:6})}}const Bt=i=>`${mt}chapters#${i}`,In=async i=>{let{data:e,error:n}=await Y.from("chapters").select("*").eq("id",i).single();return n&&G.setDBError(n),e||null},Mt=async i=>{const e=Bt(i),n=Lt(e);if(n!==null)return n.data;let{data:t,error:r}=await Y.from("chapters").select("*").eq("book_id",i).order("id");return r&&G.setDBError(r),t?An(e,t).data:[]},Du=async(i,e)=>{const{error:n}=await Y.from("chapters").delete().eq("id",i);return n?(G.setDBError(n),[]):(je(Bt(e)),Mt(e))},Uu=async(i,e,n)=>{const{error:t}=await Y.from("chapters").update({name:n}).eq("id",i);return t?(G.setDBError(t),[]):(je(Bt(e)),Mt(e))},Nu=async(i,e)=>{const{error:n}=await Y.from("chapters").insert([{book_id:i,name:e}]);if(n)return G.setDBError(n),[];je(Bt(i))};function Bu(i){let e,n;const t=i[1].default,r=we(t,i,i[0],null);return{c(){e=T("div"),r&&r.c(),k(e,"class","border rounded shadow px-4 py-4")},m(s,o){C(s,e,o),r&&r.m(e,null),n=!0},p(s,[o]){r&&r.p&&(!n||o&1)&&ke(r,t,s,s[0],n?ve(t,s[0],o,null):ye(s[0]),null)},i(s){n||(m(r,s),n=!0)},o(s){$(r,s),n=!1},d(s){s&&y(e),r&&r.d(s)}}}function Mu(i,e,n){let{$$slots:t={},$$scope:r}=e;return i.$$set=s=>{"$$scope"in s&&n(0,r=s.$$scope)},[r,t]}class Fu extends U{constructor(e){super(),D(this,e,Mu,Bu,L,{})}}function wr(i){let e,n,t,r=i[0].name+"",s,o,a,l,u=i[0].id+"",c,d,h=le(i[0].modified)+"",f,p,_=i[0].description&&vr(i);return{c(){e=T("div"),n=T("div"),t=T("div"),s=R(r),o=A(),a=T("div"),l=R("Book-Id: "),c=R(u),d=R(" - Modified: "),f=R(h),p=A(),_&&_.c(),k(t,"class","text-lg font-semibold"),k(a,"class","text-sm"),k(n,"class","flex justify-between mb-2")},m(v,j){C(v,e,j),S(e,n),S(n,t),S(t,s),S(n,o),S(n,a),S(a,l),S(a,c),S(a,d),S(a,f),S(e,p),_&&_.m(e,null)},p(v,j){j&1&&r!==(r=v[0].name+"")&&B(s,r),j&1&&u!==(u=v[0].id+"")&&B(c,u),j&1&&h!==(h=le(v[0].modified)+"")&&B(f,h),v[0].description?_?_.p(v,j):(_=vr(v),_.c(),_.m(e,null)):_&&(_.d(1),_=null)},d(v){v&&y(e),_&&_.d()}}}function vr(i){let e,n=i[0].description+"",t;return{c(){e=T("p"),t=R(n),k(e,"class","mt-2 pt-2 border-t text-sm")},m(r,s){C(r,e,s),S(e,t)},p(r,s){s&1&&n!==(n=r[0].description+"")&&B(t,n)},d(r){r&&y(e)}}}function kr(i){let e,n,t=i[1].name+"",r,s,o,a,l=i[1].id+"",u,c,d=le(i[1].modified)+"",h;return{c(){e=T("div"),n=T("div"),r=R(t),s=A(),o=T("div"),a=R("Chapter-Id: "),u=R(l),c=R(" - Modified: "),h=R(d),k(n,"class","text font-medium"),k(o,"class","text-sm"),k(e,"class","flex justify-between mb-2")},m(f,p){C(f,e,p),S(e,n),S(n,r),S(e,s),S(e,o),S(o,a),S(o,u),S(o,c),S(o,h)},p(f,p){p&2&&t!==(t=f[1].name+"")&&B(r,t),p&2&&l!==(l=f[1].id+"")&&B(u,l),p&2&&d!==(d=le(f[1].modified)+"")&&B(h,d)},d(f){f&&y(e)}}}function zu(i){let e,n,t=i[0]&&wr(i),r=i[1]&&kr(i);return{c(){e=T("div"),t&&t.c(),n=A(),r&&r.c(),k(e,"class","flex flex-col gap-5")},m(s,o){C(s,e,o),t&&t.m(e,null),S(e,n),r&&r.m(e,null)},p(s,o){s[0]?t?t.p(s,o):(t=wr(s),t.c(),t.m(e,n)):t&&(t.d(1),t=null),s[1]?r?r.p(s,o):(r=kr(s),r.c(),r.m(e,null)):r&&(r.d(1),r=null)},d(s){s&&y(e),t&&t.d(),r&&r.d()}}}function Hu(i){let e,n;return e=new Fu({props:{$$slots:{default:[zu]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,[r]){const s={};r&7&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){$(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function Ju(i,e,n){let{book:t=null}=e,{chapter:r=null}=e;return i.$$set=s=>{"book"in s&&n(0,t=s.book),"chapter"in s&&n(1,r=s.chapter)},[t,r]}class Pn extends U{constructor(e){super(),D(this,e,Ju,Hu,L,{book:0,chapter:1})}}function Gu(i){let e,n;return{c(){e=W("svg"),n=W("path"),k(n,"stroke-linecap","round"),k(n,"stroke-linejoin","round"),k(n,"d","m12.75 15 3-3m0 0-3-3m3 3h-7.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"),k(e,"xmlns","http://www.w3.org/2000/svg"),k(e,"fill","none"),k(e,"viewBox","0 0 24 24"),k(e,"stroke-width","1.5"),k(e,"stroke","currentColor"),k(e,"class","size-6 hover:stroke-2")},m(t,r){C(t,e,r),S(e,n)},p:q,d(t){t&&y(e)}}}function Ku(i){let e,n;return e=new ce({props:{onClick:i[0],$$slots:{default:[Gu]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,[r]){const s={};r&1&&(s.onClick=t[0]),r&2&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){$(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function Vu(i,e,n){let{onClick:t}=e;return i.$$set=r=>{"onClick"in r&&n(0,t=r.onClick)},[t]}class Wu extends U{constructor(e){super(),D(this,e,Vu,Ku,L,{onClick:0})}}function yr(i,e,n){const t=i.slice();return t[10]=e[n],t}function Qu(i){let e,n,t,r,s,o,a,l;function u(){return i[4](i[10])}e=new Nt({props:{onClick:u}});function c(){return i[5](i[10])}t=new On({props:{onClick:c}});function d(){return i[6](i[10])}s=new As({props:{onClick:d}});function h(){return i[7](i[10])}return a=new Wu({props:{onClick:h}}),{c(){w(e.$$.fragment),n=A(),w(t.$$.fragment),r=A(),w(s.$$.fragment),o=A(),w(a.$$.fragment)},m(f,p){g(e,f,p),C(f,n,p),g(t,f,p),C(f,r,p),g(s,f,p),C(f,o,p),g(a,f,p),l=!0},p(f,p){i=f;const _={};p&12&&(_.onClick=u),e.$set(_);const v={};p&4&&(v.onClick=c),t.$set(v);const j={};p&4&&(j.onClick=d),s.$set(j);const E={};p&4&&(E.onClick=h),a.$set(E)},i(f){l||(m(e.$$.fragment,f),m(t.$$.fragment,f),m(s.$$.fragment,f),m(a.$$.fragment,f),l=!0)},o(f){$(e.$$.fragment,f),$(t.$$.fragment,f),$(s.$$.fragment,f),$(a.$$.fragment,f),l=!1},d(f){f&&(y(n),y(r),y(o)),b(e,f),b(t,f),b(s,f),b(a,f)}}}function Cr(i){let e,n,t=i[10].id+"",r,s,o,a=i[10].name+"",l,u,c,d=le(i[10].modified)+"",h,f,p,_,v,j;return _=new Q({props:{$$slots:{default:[Qu]},$$scope:{ctx:i}}}),{c(){e=T("tr"),n=T("td"),r=R(t),s=A(),o=T("td"),l=R(a),u=A(),c=T("td"),h=R(d),f=A(),p=T("td"),w(_.$$.fragment),v=A()},m(E,O){C(E,e,O),S(e,n),S(n,r),S(e,s),S(e,o),S(o,l),S(e,u),S(e,c),S(c,h),S(e,f),S(e,p),g(_,p,null),S(e,v),j=!0},p(E,O){(!j||O&4)&&t!==(t=E[10].id+"")&&B(r,t),(!j||O&4)&&a!==(a=E[10].name+"")&&B(l,a),(!j||O&4)&&d!==(d=le(E[10].modified)+"")&&B(h,d);const I={};O&8204&&(I.$$scope={dirty:O,ctx:E}),_.$set(I)},i(E){j||(m(_.$$.fragment,E),j=!0)},o(E){$(_.$$.fragment,E),j=!1},d(E){E&&y(e),b(_)}}}function Xu(i){let e,n,t,r;return e=new M({props:{onClick:i[8],label:"Cancel"}}),t=new M({props:{onClick:i[9],label:"Create"}}),{c(){w(e.$$.fragment),n=A(),w(t.$$.fragment)},m(s,o){g(e,s,o),C(s,n,o),g(t,s,o),r=!0},p(s,o){const a={};o&1&&(a.onClick=s[9]),t.$set(a)},i(s){r||(m(e.$$.fragment,s),m(t.$$.fragment,s),r=!0)},o(s){$(e.$$.fragment,s),$(t.$$.fragment,s),r=!1},d(s){s&&y(n),b(e,s),b(t,s)}}}function Yu(i){let e,n,t,r,s,o,a,l,u,c,d;e=new re({props:{header:"List Chapters"}}),t=new Pn({props:{book:i[1]}});let h=ie(i[2]),f=[];for(let _=0;_<h.length;_+=1)f[_]=Cr(yr(i,h,_));const p=_=>$(f[_],1,1,()=>{f[_]=null});return c=new Q({props:{$$slots:{default:[Xu]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment),n=A(),w(t.$$.fragment),r=A(),s=T("table"),o=T("thead"),o.innerHTML="<tr><th>ID</th> <th>Name</th> <th>Modified</th> <th>Actions</th></tr>",a=A(),l=T("tbody");for(let _=0;_<f.length;_+=1)f[_].c();u=A(),w(c.$$.fragment),k(s,"class","w-full")},m(_,v){g(e,_,v),C(_,n,v),g(t,_,v),C(_,r,v),C(_,s,v),S(s,o),S(s,a),S(s,l);for(let j=0;j<f.length;j+=1)f[j]&&f[j].m(l,null);C(_,u,v),g(c,_,v),d=!0},p(_,v){const j={};if(v&2&&(j.book=_[1]),t.$set(j),v&12){h=ie(_[2]);let O;for(O=0;O<h.length;O+=1){const I=yr(_,h,O);f[O]?(f[O].p(I,v),m(f[O],1)):(f[O]=Cr(I),f[O].c(),m(f[O],1),f[O].m(l,null))}for(K(),O=h.length;O<f.length;O+=1)p(O);V()}const E={};v&8193&&(E.$$scope={dirty:v,ctx:_}),c.$set(E)},i(_){if(!d){m(e.$$.fragment,_),m(t.$$.fragment,_);for(let v=0;v<h.length;v+=1)m(f[v]);m(c.$$.fragment,_),d=!0}},o(_){$(e.$$.fragment,_),$(t.$$.fragment,_),f=f.filter(Boolean);for(let v=0;v<f.length;v+=1)$(f[v]);$(c.$$.fragment,_),d=!1},d(_){_&&(y(n),y(r),y(s),y(u)),b(e,_),b(t,_),Ce(f,_),b(c,_)}}}function Zu(i){let e,n,t,r;return e=new se({props:{$$slots:{default:[Yu]},$$scope:{ctx:i}}}),t=new jn({props:{title:"Delete Chapter",deleteEntry:i[3]}}),{c(){w(e.$$.fragment),n=A(),w(t.$$.fragment)},m(s,o){g(e,s,o),C(s,n,o),g(t,s,o),r=!0},p(s,[o]){const a={};o&8207&&(a.$$scope={dirty:o,ctx:s}),e.$set(a);const l={};o&8&&(l.deleteEntry=s[3]),t.$set(l)},i(s){r||(m(e.$$.fragment,s),m(t.$$.fragment,s),r=!0)},o(s){$(e.$$.fragment,s),$(t.$$.fragment,s),r=!1},d(s){s&&y(n),b(e,s),b(t,s)}}}function xu(i,e,n){let{params:t={id:""}}=e,r,s=[],o={entry:null,onDelete:f=>{Du(f.id,f.book_id).then(p=>n(2,s=p))},getMessage:f=>`Do you wnat to delete the chapter: '${f.id}'?`};ae(async()=>{n(1,r=await Gl(parseInt(t.id))),r?n(2,s=await Mt(r.id)):G.setString(`Book not found: ${t.id}`)});const a=async f=>{n(3,o.entry=f,o)},l=f=>{F("/chapters/update/"+f.id)},u=f=>{F("/questions/list/"+f.id)},c=f=>{F("/lession/prepare/"+f.id)},d=()=>F("/books/list"),h=()=>F("/chapters/create/"+t.id);return i.$$set=f=>{"params"in f&&n(0,t=f.params)},[t,r,s,o,a,l,u,c,d,h]}class ec extends U{constructor(e){super(),D(this,e,xu,Zu,L,{params:0})}}function tc(i){let e,n,t,r;return e=new M({props:{onClick:i[5],label:"Cancel"}}),t=new M({props:{label:"Create"}}),{c(){w(e.$$.fragment),n=A(),w(t.$$.fragment)},m(s,o){g(e,s,o),C(s,n,o),g(t,s,o),r=!0},p(s,o){const a={};o&1&&(a.onClick=s[5]),e.$set(a)},i(s){r||(m(e.$$.fragment,s),m(t.$$.fragment,s),r=!0)},o(s){$(e.$$.fragment,s),$(t.$$.fragment,s),r=!1},d(s){s&&y(n),b(e,s),b(t,s)}}}function nc(i){let e,n,t,r,s;function o(l){i[4](l)}let a={id:"name",label:"Chapter name",error:i[2]};return i[1]!==void 0&&(a.value=i[1]),e=new _e({props:a}),Z.push(()=>ne(e,"value",o)),r=new Q({props:{$$slots:{default:[tc]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment),t=A(),w(r.$$.fragment)},m(l,u){g(e,l,u),C(l,t,u),g(r,l,u),s=!0},p(l,u){const c={};u&4&&(c.error=l[2]),!n&&u&2&&(n=!0,c.value=l[1],te(()=>n=!1)),e.$set(c);const d={};u&65&&(d.$$scope={dirty:u,ctx:l}),r.$set(d)},i(l){s||(m(e.$$.fragment,l),m(r.$$.fragment,l),s=!0)},o(l){$(e.$$.fragment,l),$(r.$$.fragment,l),s=!1},d(l){l&&y(t),b(e,l),b(r,l)}}}function rc(i){let e,n,t,r;return e=new re({props:{header:"Create Book"}}),t=new he({props:{onSubmit:i[3],$$slots:{default:[nc]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment),n=A(),w(t.$$.fragment)},m(s,o){g(e,s,o),C(s,n,o),g(t,s,o),r=!0},p(s,o){const a={};o&71&&(a.$$scope={dirty:o,ctx:s}),t.$set(a)},i(s){r||(m(e.$$.fragment,s),m(t.$$.fragment,s),r=!0)},o(s){$(e.$$.fragment,s),$(t.$$.fragment,s),r=!1},d(s){s&&y(n),b(e,s),b(t,s)}}}function sc(i){let e,n;return e=new se({props:{$$slots:{default:[rc]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,[r]){const s={};r&71&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){$(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function ic(i,e,n){let{params:t={book_id:""}}=e,r="",s="";const o=async()=>{n(2,s=ue(r)),!s&&(await Nu(parseInt(t.book_id),r),F("/chapters/list/"+t.book_id))};function a(u){r=u,n(1,r)}const l=()=>F("/chapters/list/"+t.book_id);return i.$$set=u=>{"params"in u&&n(0,t=u.params)},[t,r,s,o,a,l]}class oc extends U{constructor(e){super(),D(this,e,ic,sc,L,{params:0})}}function Sr(i){let e,n,t=i[0].id+"",r,s,o,a=le(i[0].modified)+"",l,u,c,d;return c=new he({props:{onSubmit:i[3],$$slots:{default:[lc]},$$scope:{ctx:i}}}),{c(){e=T("div"),n=T("span"),r=R(t),s=A(),o=T("span"),l=R(a),u=A(),w(c.$$.fragment),k(e,"class","mb-4 text-small")},m(h,f){C(h,e,f),S(e,n),S(n,r),S(e,s),S(e,o),S(o,l),C(h,u,f),g(c,h,f),d=!0},p(h,f){(!d||f&1)&&t!==(t=h[0].id+"")&&B(r,t),(!d||f&1)&&a!==(a=le(h[0].modified)+"")&&B(l,a);const p={};f&135&&(p.$$scope={dirty:f,ctx:h}),c.$set(p)},i(h){d||(m(c.$$.fragment,h),d=!0)},o(h){$(c.$$.fragment,h),d=!1},d(h){h&&(y(e),y(u)),b(c,h)}}}function ac(i){let e,n,t,r;return e=new M({props:{onClick:i[6],label:"Cancel"}}),t=new M({props:{label:"Create"}}),{c(){w(e.$$.fragment),n=A(),w(t.$$.fragment)},m(s,o){g(e,s,o),C(s,n,o),g(t,s,o),r=!0},p(s,o){const a={};o&1&&(a.onClick=s[6]),e.$set(a)},i(s){r||(m(e.$$.fragment,s),m(t.$$.fragment,s),r=!0)},o(s){$(e.$$.fragment,s),$(t.$$.fragment,s),r=!1},d(s){s&&y(n),b(e,s),b(t,s)}}}function lc(i){let e,n,t,r,s;function o(l){i[5](l)}let a={id:"name",label:"Chapter name",error:i[2]};return i[1]!==void 0&&(a.value=i[1]),e=new _e({props:a}),Z.push(()=>ne(e,"value",o)),r=new Q({props:{$$slots:{default:[ac]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment),t=A(),w(r.$$.fragment)},m(l,u){g(e,l,u),C(l,t,u),g(r,l,u),s=!0},p(l,u){const c={};u&4&&(c.error=l[2]),!n&&u&2&&(n=!0,c.value=l[1],te(()=>n=!1)),e.$set(c);const d={};u&129&&(d.$$scope={dirty:u,ctx:l}),r.$set(d)},i(l){s||(m(e.$$.fragment,l),m(r.$$.fragment,l),s=!0)},o(l){$(e.$$.fragment,l),$(r.$$.fragment,l),s=!1},d(l){l&&y(t),b(e,l),b(r,l)}}}function uc(i){let e,n,t,r;e=new re({props:{header:"Update Book"}});let s=i[0]&&Sr(i);return{c(){w(e.$$.fragment),n=A(),s&&s.c(),t=x()},m(o,a){g(e,o,a),C(o,n,a),s&&s.m(o,a),C(o,t,a),r=!0},p(o,a){o[0]?s?(s.p(o,a),a&1&&m(s,1)):(s=Sr(o),s.c(),m(s,1),s.m(t.parentNode,t)):s&&(K(),$(s,1,1,()=>{s=null}),V())},i(o){r||(m(e.$$.fragment,o),m(s),r=!0)},o(o){$(e.$$.fragment,o),$(s),r=!1},d(o){o&&(y(n),y(t)),b(e,o),s&&s.d(o)}}}function cc(i){let e,n;return e=new se({props:{$$slots:{default:[uc]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,[r]){const s={};r&135&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){$(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function fc(i,e,n){let{params:t={id:""}}=e,r=null,s="",o="";const a=async()=>{if(n(2,o=ue(s)),!o){if(!r){G.setString("No chapter!!");return}await Uu(r.id,r.book_id,s),F("/chapters/list/"+r.book_id)}};ae(async()=>{n(0,r=await In(parseInt(t.id))),r&&n(1,s=r.name)});function l(c){s=c,n(1,s)}const u=()=>F("/chapters/list/"+(r==null?void 0:r.book_id));return i.$$set=c=>{"params"in c&&n(4,t=c.params)},[r,s,o,a,t,l,u]}class dc extends U{constructor(e){super(),D(this,e,fc,cc,L,{params:4})}}function Er(i,e,n){const t=i.slice();return t[7]=e[n],t}function Ar(i){let e,n=i[7].label+"",t,r,s;return{c(){e=T("option"),t=R(n),e.__value=r=i[7].value,Oe(e,e.__value),e.selected=s=i[7].value===i[0]},m(o,a){C(o,e,a),S(e,t)},p(o,a){a&8&&n!==(n=o[7].label+"")&&B(t,n),a&8&&r!==(r=o[7].value)&&(e.__value=r,Oe(e,e.__value)),a&9&&s!==(s=o[7].value===o[0])&&(e.selected=s)},d(o){o&&y(e)}}}function hc(i){let e,n,t,r=ie(i[3]),s=[];for(let o=0;o<r.length;o+=1)s[o]=Ar(Er(i,r,o));return{c(){e=T("select");for(let o=0;o<s.length;o+=1)s[o].c();k(e,"id",i[2]),e.disabled=i[4],k(e,"name",i[2]),k(e,"class","input"),i[0]===void 0&&Et(()=>i[6].call(e))},m(o,a){C(o,e,a);for(let l=0;l<s.length;l+=1)s[l]&&s[l].m(e,null);Mn(e,i[0],!0),n||(t=De(e,"change",i[6]),n=!0)},p(o,a){if(a&9){r=ie(o[3]);let l;for(l=0;l<r.length;l+=1){const u=Er(o,r,l);s[l]?s[l].p(u,a):(s[l]=Ar(u),s[l].c(),s[l].m(e,null))}for(;l<s.length;l+=1)s[l].d(1);s.length=r.length}a&4&&k(e,"id",o[2]),a&16&&(e.disabled=o[4]),a&4&&k(e,"name",o[2]),a&9&&Mn(e,o[0])},d(o){o&&y(e),Ce(s,o),n=!1,t()}}}function pc(i){let e,n;return e=new Rt({props:{id:i[2],label:i[1],error:i[5],$$slots:{default:[hc]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,[r]){const s={};r&4&&(s.id=t[2]),r&2&&(s.label=t[1]),r&32&&(s.error=t[5]),r&1053&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){$(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function mc(i,e,n){let{label:t}=e,{id:r}=e,{value:s}=e,{options:o}=e,{disabled:a=!1}=e,{error:l=""}=e;function u(){s=Us(this),n(0,s),n(3,o)}return i.$$set=c=>{"label"in c&&n(1,t=c.label),"id"in c&&n(2,r=c.id),"value"in c&&n(0,s=c.value),"options"in c&&n(3,o=c.options),"disabled"in c&&n(4,a=c.disabled),"error"in c&&n(5,l=c.error)},[s,t,r,o,a,l,u]}class $n extends U{constructor(e){super(),D(this,e,mc,pc,L,{label:1,id:2,value:0,options:3,disabled:4,error:5})}}function Tr(i){let e,n,t=i[2].length+"",r;return{c(){e=T("div"),n=R("Length: "),r=R(t)},m(s,o){C(s,e,o),S(e,n),S(e,r)},p(s,o){o&4&&t!==(t=s[2].length+"")&&B(r,t)},d(s){s&&y(e)}}}function Or(i){let e,n;return e=new he({props:{onSubmit:i[9],$$slots:{default:[_c]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,r){const s={};r&16410&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){$(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function $c(i){let e,n,t,r;return e=new M({props:{onClick:i[13],label:"Cancel"}}),t=new M({props:{label:"Start"}}),{c(){w(e.$$.fragment),n=A(),w(t.$$.fragment)},m(s,o){g(e,s,o),C(s,n,o),g(t,s,o),r=!0},p(s,o){const a={};o&2&&(a.onClick=s[13]),e.$set(a)},i(s){r||(m(e.$$.fragment,s),m(t.$$.fragment,s),r=!0)},o(s){$(e.$$.fragment,s),$(t.$$.fragment,s),r=!1},d(s){s&&y(n),b(e,s),b(t,s)}}}function _c(i){let e,n,t,r,s,o,a,l,u;function c(p){i[11](p)}let d={id:"correct",label:"Correct Answers",options:i[6],error:i[5]};i[3]!==void 0&&(d.value=i[3]),n=new $n({props:d}),Z.push(()=>ne(n,"value",c));function h(p){i[12](p)}let f={id:"reverse",label:"Reverse Answers",options:i[8],error:i[7]};return i[4]!==void 0&&(f.value=i[4]),s=new $n({props:f}),Z.push(()=>ne(s,"value",h)),l=new Q({props:{$$slots:{default:[$c]},$$scope:{ctx:i}}}),{c(){e=T("div"),w(n.$$.fragment),r=A(),w(s.$$.fragment),a=A(),w(l.$$.fragment),k(e,"class","flex flex-row gap-4")},m(p,_){C(p,e,_),g(n,e,null),S(e,r),g(s,e,null),C(p,a,_),g(l,p,_),u=!0},p(p,_){const v={};!t&&_&8&&(t=!0,v.value=p[3],te(()=>t=!1)),n.$set(v);const j={};!o&&_&16&&(o=!0,j.value=p[4],te(()=>o=!1)),s.$set(j);const E={};_&16386&&(E.$$scope={dirty:_,ctx:p}),l.$set(E)},i(p){u||(m(n.$$.fragment,p),m(s.$$.fragment,p),m(l.$$.fragment,p),u=!0)},o(p){$(n.$$.fragment,p),$(s.$$.fragment,p),$(l.$$.fragment,p),u=!1},d(p){p&&(y(e),y(a)),b(n),b(s),b(l,p)}}}function gc(i){let e,n,t,r,s,o,a;e=new re({props:{header:"List Chapters"}}),t=new Pn({props:{book:i[0],chapter:i[1]}});let l=i[1]&&Tr(i),u=i[2].length!==0&&Or(i);return{c(){w(e.$$.fragment),n=A(),w(t.$$.fragment),r=A(),l&&l.c(),s=A(),u&&u.c(),o=x()},m(c,d){g(e,c,d),C(c,n,d),g(t,c,d),C(c,r,d),l&&l.m(c,d),C(c,s,d),u&&u.m(c,d),C(c,o,d),a=!0},p(c,d){const h={};d&1&&(h.book=c[0]),d&2&&(h.chapter=c[1]),t.$set(h),c[1]?l?l.p(c,d):(l=Tr(c),l.c(),l.m(s.parentNode,s)):l&&(l.d(1),l=null),c[2].length!==0?u?(u.p(c,d),d&4&&m(u,1)):(u=Or(c),u.c(),m(u,1),u.m(o.parentNode,o)):u&&(K(),$(u,1,1,()=>{u=null}),V())},i(c){a||(m(e.$$.fragment,c),m(t.$$.fragment,c),m(u),a=!0)},o(c){$(e.$$.fragment,c),$(t.$$.fragment,c),$(u),a=!1},d(c){c&&(y(n),y(r),y(s),y(o)),b(e,c),b(t,c),l&&l.d(c),u&&u.d(c)}}}function bc(i){let e,n;return e=new se({props:{$$slots:{default:[gc]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,[r]){const s={};r&16415&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){$(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function wc(i,e,n){let{params:t={id:""}}=e,r,s,o=[],a="1",l,u=[{label:"0",value:"0"},{label:"1",value:"1"},{label:"2",value:"2"},{label:"3",value:"3"}],c="false",d,h=[{label:"True",value:"true"},{label:"False",value:"false"}];ae(async()=>{n(1,s=await In(parseInt(t.id))),s&&(n(2,o=await xe(s.id)),n(0,r=await Dt(s.book_id)),o.length===0&&G.setString("No questions found for this chapter!"))});const f=async()=>{Ol(o,parseInt(a),c==="true"),F("/lession/process")};function p(j){a=j,n(3,a)}function _(j){c=j,n(4,c)}const v=()=>F("/chapters/list/"+(s==null?void 0:s.book_id));return i.$$set=j=>{"params"in j&&n(10,t=j.params)},[r,s,o,a,c,l,u,d,h,f,t,p,_,v]}class vc extends U{constructor(e){super(),D(this,e,wc,bc,L,{params:10})}}function kc(i){let e,n;return{c(){e=T("div"),n=R(i[0]),k(e,"class","text-sm font-bold")},m(t,r){C(t,e,r),S(e,n)},p(t,r){r&1&&B(n,t[0])},d(t){t&&y(e)}}}function yc(i){let e,n,t,r,s,o,a,l;return{c(){e=T("div"),n=T("div"),t=R(i[0]),r=A(),s=T("div"),o=R("Progress: "),a=R(i[1]),l=R(" / 3"),k(n,"class","text-sm font-bold"),k(s,"class","text-green-800 text-sm font-medium"),k(e,"class","flex justify-between")},m(u,c){C(u,e,c),S(e,n),S(n,t),S(e,r),S(e,s),S(s,o),S(s,a),S(s,l)},p(u,c){c&1&&B(t,u[0]),c&2&&B(a,u[1])},d(u){u&&y(e)}}}function Cc(i){let e;function n(s,o){return s[1]>=0?yc:kc}let t=n(i),r=t(i);return{c(){r.c(),e=x()},m(s,o){r.m(s,o),C(s,e,o)},p(s,[o]){t===(t=n(s))&&r?r.p(s,o):(r.d(1),r=t(s),r&&(r.c(),r.m(e.parentNode,e)))},i:q,o:q,d(s){s&&y(e),r.d(s)}}}function Sc(i,e,n){let{text:t}=e,{progress:r=-1}=e;return i.$$set=s=>{"text"in s&&n(0,t=s.text),"progress"in s&&n(1,r=s.progress)},[t,r]}class Ft extends U{constructor(e){super(),D(this,e,Sc,Cc,L,{text:0,progress:1})}}function jr(i){let e,n;return e=new Nt({props:{onClick:i[1]}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,r){const s={};r&2&&(s.onClick=t[1]),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){$(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function Ec(i){let e,n,t,r=i[1]&&jr(i);return n=new On({props:{onClick:i[2]}}),{c(){r&&r.c(),e=A(),w(n.$$.fragment)},m(s,o){r&&r.m(s,o),C(s,e,o),g(n,s,o),t=!0},p(s,o){s[1]?r?(r.p(s,o),o&2&&m(r,1)):(r=jr(s),r.c(),m(r,1),r.m(e.parentNode,e)):r&&(K(),$(r,1,1,()=>{r=null}),V());const a={};o&1&&(a.onClick=s[2]),n.$set(a)},i(s){t||(m(r),m(n.$$.fragment,s),t=!0)},o(s){$(r),$(n.$$.fragment,s),t=!1},d(s){s&&y(e),r&&r.d(s),b(n,s)}}}function Ac(i){let e,n,t,r=fr(i[0].modified)+"",s,o,a,l;return a=new Q({props:{$$slots:{default:[Ec]},$$scope:{ctx:i}}}),{c(){e=T("div"),n=T("div"),t=R("Modified: "),s=R(r),o=A(),w(a.$$.fragment),k(n,"class","text-sm"),k(e,"class","mt-2 flex justify-between")},m(u,c){C(u,e,c),S(e,n),S(n,t),S(n,s),S(e,o),g(a,e,null),l=!0},p(u,[c]){(!l||c&1)&&r!==(r=fr(u[0].modified)+"")&&B(s,r);const d={};c&11&&(d.$$scope={dirty:c,ctx:u}),a.$set(d)},i(u){l||(m(a.$$.fragment,u),l=!0)},o(u){$(a.$$.fragment,u),l=!1},d(u){u&&y(e),b(a)}}}function Tc(i,e,n){let{question:t}=e,{onDelete:r=null}=e;const s=()=>F("/questions/update/"+t.id);return i.$$set=o=>{"question"in o&&n(0,t=o.question),"onDelete"in o&&n(1,r=o.onDelete)},[t,r,s]}class Oc extends U{constructor(e){super(),D(this,e,Tc,Ac,L,{question:0,onDelete:1})}}const jc=new RegExp(/[<>]/,"g"),Ic=[{pattern:new RegExp(/^- (.+)=#/,"g"),replace:'<span class="md-right">&bull;</span><span class="md-it">$1</span>'},{pattern:new RegExp(/^(.+)=#/,"g"),replace:'<span class="md-it">$1</span>'},{pattern:new RegExp(/#=(.+)$/,"g"),replace:'<span class="md-it">$1</span>'},{pattern:new RegExp(/^- /,"g"),replace:'<span class="md-right">&bull;</span>'}],Pc=[{pattern:new RegExp(/#([^#]+)#/,"g"),replace:'<span class="md-it">$1</span>'},{pattern:new RegExp(/\*\*(.)/,"g"),replace:'<span class="md-em">$1</span>'},{pattern:new RegExp(/\*([^*]+)\*/,"g"),replace:'<span class="md-em">$1</span>'}],Ir=(i,e)=>(i.forEach(n=>{e=e.replaceAll(n.pattern,n.replace)}),e),_n=i=>{const e=i.replace(jc,"").split(`
`);let n=[];for(const t of e)n.push(Ir(Ic,t.trim()));return Ir(Pc,n.join(`
`))},Rc=/^~([^~]+)~/,Lc=/~([^~]+)~$/,qc=/_(.)_/g,Pr=i=>i.map(e=>e.replace(Rc,"$1=#").replace(Lc,"#=$1").replaceAll("~","#").replaceAll(qc,"**$1").replaceAll("_","*")).join(`
`);function Dc(i){let e,n=_n(i[0])+"";return{c(){e=T("div"),k(e,"class","px-4 py-3 border border-gray-300 rounded shadow-sm whitespace-pre-line bg-gray-50 grow")},m(t,r){C(t,e,r),e.innerHTML=n},p(t,[r]){r&1&&n!==(n=_n(t[0])+"")&&(e.innerHTML=n)},i:q,o:q,d(t){t&&y(e)}}}function Uc(i,e,n){let{text:t}=e;return i.$$set=r=>{"text"in r&&n(0,t=r.text)},[t]}class be extends U{constructor(e){super(),D(this,e,Uc,Dc,L,{text:0})}}function Rr(i){let e,n,t,r,s,o,a,l;n=new Ft({props:{text:"Answer"}}),r=new be({props:{text:i[3]?i[0].quest:i[0].answer}});let u=i[0].details&&Lr(i);return{c(){e=T("div"),w(n.$$.fragment),t=A(),w(r.$$.fragment),o=A(),u&&u.c(),a=x(),k(e,"class",s="flex flex-col gap-2 "+(i[0].details?"col-span-2":"col-span-3"))},m(c,d){C(c,e,d),g(n,e,null),S(e,t),g(r,e,null),C(c,o,d),u&&u.m(c,d),C(c,a,d),l=!0},p(c,d){const h={};d&9&&(h.text=c[3]?c[0].quest:c[0].answer),r.$set(h),(!l||d&1&&s!==(s="flex flex-col gap-2 "+(c[0].details?"col-span-2":"col-span-3")))&&k(e,"class",s),c[0].details?u?(u.p(c,d),d&1&&m(u,1)):(u=Lr(c),u.c(),m(u,1),u.m(a.parentNode,a)):u&&(K(),$(u,1,1,()=>{u=null}),V())},i(c){l||(m(n.$$.fragment,c),m(r.$$.fragment,c),m(u),l=!0)},o(c){$(n.$$.fragment,c),$(r.$$.fragment,c),$(u),l=!1},d(c){c&&(y(e),y(o),y(a)),b(n),b(r),u&&u.d(c)}}}function Lr(i){let e,n,t,r,s;return n=new Ft({props:{text:"details"}}),r=new be({props:{text:i[0].details}}),{c(){e=T("div"),w(n.$$.fragment),t=A(),w(r.$$.fragment),k(e,"class","flex flex-col gap-2 col-span-2")},m(o,a){C(o,e,a),g(n,e,null),S(e,t),g(r,e,null),s=!0},p(o,a){const l={};a&1&&(l.text=o[0].details),r.$set(l)},i(o){s||(m(n.$$.fragment,o),m(r.$$.fragment,o),s=!0)},o(o){$(n.$$.fragment,o),$(r.$$.fragment,o),s=!1},d(o){o&&y(e),b(n),b(r)}}}function qr(i){let e,n,t,r,s,o;return t=new Ft({props:{text:"Search Index"}}),s=new be({props:{text:i[0].search?i[0].search:"#No search index!#"}}),{c(){e=T("div"),n=T("div"),w(t.$$.fragment),r=A(),w(s.$$.fragment),k(n,"class","flex flex-col gap-2"),k(e,"class","col-span-6")},m(a,l){C(a,e,l),S(e,n),g(t,n,null),S(n,r),g(s,n,null),o=!0},p(a,l){const u={};l&1&&(u.text=a[0].search?a[0].search:"#No search index!#"),s.$set(u)},i(a){o||(m(t.$$.fragment,a),m(s.$$.fragment,a),o=!0)},o(a){$(t.$$.fragment,a),$(s.$$.fragment,a),o=!1},d(a){a&&y(e),b(t),b(s)}}}function Nc(i){let e,n,t,r,s,o,a,l,u,c,d,h;r=new Ft({props:{text:i[6],progress:i[1]}}),o=new be({props:{text:i[3]?i[0].answer:i[0].quest}});let f=i[2]&&Rr(i),p=i[5]&&qr(i);return d=new Oc({props:{question:i[0],onDelete:i[4]}}),{c(){e=T("div"),n=T("div"),t=T("div"),w(r.$$.fragment),s=A(),w(o.$$.fragment),l=A(),f&&f.c(),u=A(),p&&p.c(),c=A(),w(d.$$.fragment),k(t,"class",a="flex flex-col gap-2 "+(i[0].details?"col-span-2":"col-span-3")),k(n,"class","grid md:grid-cols-6 grid-cols-1 gap-3")},m(_,v){C(_,e,v),S(e,n),S(n,t),g(r,t,null),S(t,s),g(o,t,null),S(n,l),f&&f.m(n,null),S(n,u),p&&p.m(n,null),S(e,c),g(d,e,null),h=!0},p(_,[v]){const j={};v&64&&(j.text=_[6]),v&2&&(j.progress=_[1]),r.$set(j);const E={};v&9&&(E.text=_[3]?_[0].answer:_[0].quest),o.$set(E),(!h||v&1&&a!==(a="flex flex-col gap-2 "+(_[0].details?"col-span-2":"col-span-3")))&&k(t,"class",a),_[2]?f?(f.p(_,v),v&4&&m(f,1)):(f=Rr(_),f.c(),m(f,1),f.m(n,u)):f&&(K(),$(f,1,1,()=>{f=null}),V()),_[5]?p?(p.p(_,v),v&32&&m(p,1)):(p=qr(_),p.c(),m(p,1),p.m(n,null)):p&&(K(),$(p,1,1,()=>{p=null}),V());const O={};v&1&&(O.question=_[0]),v&16&&(O.onDelete=_[4]),d.$set(O)},i(_){h||(m(r.$$.fragment,_),m(o.$$.fragment,_),m(f),m(p),m(d.$$.fragment,_),h=!0)},o(_){$(r.$$.fragment,_),$(o.$$.fragment,_),$(f),$(p),$(d.$$.fragment,_),h=!1},d(_){_&&y(e),b(r),b(o),f&&f.d(),p&&p.d(),b(d)}}}function Bc(i,e,n){let t,{question:r}=e,{index:s=-1}=e,{progress:o=-1}=e,{showAnswer:a=!0}=e,{reverse:l=!1}=e,{onDelete:u=null}=e,{debug:c=!1}=e;return i.$$set=d=>{"question"in d&&n(0,r=d.question),"index"in d&&n(7,s=d.index),"progress"in d&&n(1,o=d.progress),"showAnswer"in d&&n(2,a=d.showAnswer),"reverse"in d&&n(3,l=d.reverse),"onDelete"in d&&n(4,u=d.onDelete),"debug"in d&&n(5,c=d.debug)},i.$$.update=()=>{i.$$.dirty&129&&n(6,t=s<0?`Question id: ${r.id}`:`Question: ${s+1} (id: ${r.id})`)},[r,o,a,l,u,c,t,s]}class Rn extends U{constructor(e){super(),D(this,e,Bc,Nc,L,{question:0,index:7,progress:1,showAnswer:2,reverse:3,onDelete:4,debug:5})}}function Dr(i,e,n){const t=i.slice();return t[3]=e[n],t[5]=n,t}function Ur(i){let e,n,t=i[3]+"",r;return{c(){e=T("dt"),e.textContent=`${i[2][i[5]]}`,n=T("dd"),r=R(t),k(e,"class","col-span-3 px-4 py-1"),k(n,"class","border-l border-gray-300 px-4 py-1 text-right")},m(s,o){C(s,e,o),C(s,n,o),S(n,r)},p(s,o){o&1&&t!==(t=s[3]+"")&&B(r,t)},d(s){s&&(y(e),y(n))}}}function Mc(i){let e,n,t,r,s=ie(i[0]),o=[];for(let a=0;a<s.length;a+=1)o[a]=Ur(Dr(i,s,a));return{c(){e=T("dl");for(let a=0;a<o.length;a+=1)o[a].c();n=T("dt"),n.textContent=`Total to learn
  `,t=T("dd"),r=R(i[1]),k(n,"class","col-span-3 px-4 py-1 font-semibold border-t pt-2"),k(t,"class","border-l border-gray-300 px-4 py-1 text-right font-semibold border-t pt-2"),k(e,"class","border border-gray-300 shadow-sm rounded grid grid-cols-4 w-64 py-2")},m(a,l){C(a,e,l);for(let u=0;u<o.length;u+=1)o[u]&&o[u].m(e,null);S(e,n),S(e,t),S(t,r)},p(a,[l]){if(l&5){s=ie(a[0]);let u;for(u=0;u<s.length;u+=1){const c=Dr(a,s,u);o[u]?o[u].p(c,l):(o[u]=Ur(c),o[u].c(),o[u].m(e,n))}for(;u<o.length;u+=1)o[u].d(1);o.length=s.length}l&2&&B(r,a[1])},i:q,o:q,d(a){a&&y(e),Ce(o,a)}}}function Fc(i,e,n){let{progress:t}=e,r=["No correct answers","One correct answer","Two correct answers","Learned"],s=-1;return i.$$set=o=>{"progress"in o&&n(0,t=o.progress)},i.$$.update=()=>{i.$$.dirty&1&&n(1,s=Pl(t))},[t,s,r]}class zc extends U{constructor(e){super(),D(this,e,Fc,Mc,L,{progress:0})}}function Hc(i){let e,n;return e=new Rn({props:{question:i[2].question,showAnswer:i[4],progress:i[2].progress,reverse:i[0].reverse}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,r){const s={};r&4&&(s.question=t[2].question),r&16&&(s.showAnswer=t[4]),r&4&&(s.progress=t[2].progress),r&1&&(s.reverse=t[0].reverse),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){$(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function Jc(i){let e;return{c(){e=T("p"),e.textContent="End"},m(n,t){C(n,e,t)},p:q,i:q,o:q,d(n){n&&y(e)}}}function Nr(i){let e,n,t=i[2]&&Br(i);return{c(){t&&t.c(),e=x()},m(r,s){t&&t.m(r,s),C(r,e,s),n=!0},p(r,s){r[2]?t?(t.p(r,s),s&4&&m(t,1)):(t=Br(r),t.c(),m(t,1),t.m(e.parentNode,e)):t&&(K(),$(t,1,1,()=>{t=null}),V())},i(r){n||(m(t),n=!0)},o(r){$(t),n=!1},d(r){r&&y(e),t&&t.d(r)}}}function Br(i){let e,n,t,r;const s=[Kc,Gc],o=[];function a(l,u){return l[4]?1:0}return e=a(i),n=o[e]=s[e](i),{c(){n.c(),t=x()},m(l,u){o[e].m(l,u),C(l,t,u),r=!0},p(l,u){let c=e;e=a(l),e===c?o[e].p(l,u):(K(),$(o[c],1,1,()=>{o[c]=null}),V(),n=o[e],n?n.p(l,u):(n=o[e]=s[e](l),n.c()),m(n,1),n.m(t.parentNode,t))},i(l){r||(m(n),r=!0)},o(l){$(n),r=!1},d(l){l&&y(t),o[e].d(l)}}}function Gc(i){let e,n,t,r,s,o,a,l;return e=new M({props:{label:"Correct",type:"ok",onClick:i[6]}}),t=new M({props:{label:"Wrong",type:"error",onClick:i[7]}}),s=new M({props:{label:"Skip",type:"warn",onClick:i[9]}}),a=new M({props:{label:"Learned",type:"ok",onClick:i[8]}}),{c(){w(e.$$.fragment),n=A(),w(t.$$.fragment),r=A(),w(s.$$.fragment),o=A(),w(a.$$.fragment)},m(u,c){g(e,u,c),C(u,n,c),g(t,u,c),C(u,r,c),g(s,u,c),C(u,o,c),g(a,u,c),l=!0},p:q,i(u){l||(m(e.$$.fragment,u),m(t.$$.fragment,u),m(s.$$.fragment,u),m(a.$$.fragment,u),l=!0)},o(u){$(e.$$.fragment,u),$(t.$$.fragment,u),$(s.$$.fragment,u),$(a.$$.fragment,u),l=!1},d(u){u&&(y(n),y(r),y(o)),b(e,u),b(t,u),b(s,u),b(a,u)}}}function Kc(i){let e,n;return e=new M({props:{label:"Show",onClick:i[5]}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p:q,i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){$(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function Vc(i){let e,n,t,r=!i[3]&&Nr(i);return n=new M({props:{label:"Stop",onClick:i[10]}}),{c(){r&&r.c(),e=A(),w(n.$$.fragment)},m(s,o){r&&r.m(s,o),C(s,e,o),g(n,s,o),t=!0},p(s,o){s[3]?r&&(K(),$(r,1,1,()=>{r=null}),V()):r?(r.p(s,o),o&8&&m(r,1)):(r=Nr(s),r.c(),m(r,1),r.m(e.parentNode,e))},i(s){t||(m(r),m(n.$$.fragment,s),t=!0)},o(s){$(r),$(n.$$.fragment,s),t=!1},d(s){s&&y(e),r&&r.d(s),b(n,s)}}}function Wc(i){let e,n,t,r,s,o,a,l,u;e=new re({props:{header:"Lession"}}),t=new zc({props:{progress:i[1]}});const c=[Jc,Hc],d=[];function h(f,p){return f[3]?0:f[2]?1:-1}return~(s=h(i))&&(o=d[s]=c[s](i)),l=new Q({props:{$$slots:{default:[Vc]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment),n=A(),w(t.$$.fragment),r=A(),o&&o.c(),a=A(),w(l.$$.fragment)},m(f,p){g(e,f,p),C(f,n,p),g(t,f,p),C(f,r,p),~s&&d[s].m(f,p),C(f,a,p),g(l,f,p),u=!0},p(f,p){const _={};p&2&&(_.progress=f[1]),t.$set(_);let v=s;s=h(f),s===v?~s&&d[s].p(f,p):(o&&(K(),$(d[v],1,1,()=>{d[v]=null}),V()),~s?(o=d[s],o?o.p(f,p):(o=d[s]=c[s](f),o.c()),m(o,1),o.m(a.parentNode,a)):o=null);const j={};p&8220&&(j.$$scope={dirty:p,ctx:f}),l.$set(j)},i(f){u||(m(e.$$.fragment,f),m(t.$$.fragment,f),m(o),m(l.$$.fragment,f),u=!0)},o(f){$(e.$$.fragment,f),$(t.$$.fragment,f),$(o),$(l.$$.fragment,f),u=!1},d(f){f&&(y(n),y(r),y(a)),b(e,f),b(t,f),~s&&d[s].d(f),b(l,f)}}}function Qc(i){let e,n;return e=new se({props:{$$slots:{default:[Wc]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,[r]){const s={};r&8223&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){$(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function Xc(i,e,n){let t,r=[0,0,0,0],s,o=!1,a=!1;const l=()=>{n(4,a=!0)},u=v=>{if(n(2,s.progress=v,s),s.progress<3?t.learning.push(s):t.learned.push(s),n(1,r=pr(t)),!jl(t)){n(3,o=!0);return}_()},c=()=>{u(s.progress+1)},d=()=>{u(0)},h=()=>{u(3)},f=()=>{u(s.progress)},p=()=>{F("/")},_=()=>{const v=t.learning.shift();v?(n(2,s=v),n(4,a=!1)):n(3,o=!0)};return ae(async()=>{const v=Es();if(!v){G.setString("No lession found!");return}n(0,t=await Ll(v)),n(1,r=pr(t)),_()}),[t,r,s,o,a,l,c,d,h,f,p]}class Yc extends U{constructor(e){super(),D(this,e,Xc,Qc,L,{})}}function Mr(i,e,n){const t=i.slice();return t[11]=e[n],t[13]=n,t}function Fr(i){let e,n;function t(){return i[7](i[11])}return e=new Rn({props:{index:i[13],debug:i[4],question:i[11],onDelete:t}}),{c(){w(e.$$.fragment)},m(r,s){g(e,r,s),n=!0},p(r,s){i=r;const o={};s&16&&(o.debug=i[4]),s&8&&(o.question=i[11]),s&40&&(o.onDelete=t),e.$set(o)},i(r){n||(m(e.$$.fragment,r),n=!0)},o(r){$(e.$$.fragment,r),n=!1},d(r){b(e,r)}}}function Zc(i){let e,n,t,r,s,o,a,l;return e=new M({props:{onClick:i[8],label:"Cancel"}}),t=new M({props:{onClick:i[9],label:"Create"}}),s=new M({props:{onClick:i[10],label:i[4]?"Simple":"Debug"}}),a=new M({props:{onClick:i[6],label:"Cache"}}),{c(){w(e.$$.fragment),n=A(),w(t.$$.fragment),r=A(),w(s.$$.fragment),o=A(),w(a.$$.fragment)},m(u,c){g(e,u,c),C(u,n,c),g(t,u,c),C(u,r,c),g(s,u,c),C(u,o,c),g(a,u,c),l=!0},p(u,c){const d={};c&4&&(d.onClick=u[8]),e.$set(d);const h={};c&1&&(h.onClick=u[9]),t.$set(h);const f={};c&16&&(f.onClick=u[10]),c&16&&(f.label=u[4]?"Simple":"Debug"),s.$set(f)},i(u){l||(m(e.$$.fragment,u),m(t.$$.fragment,u),m(s.$$.fragment,u),m(a.$$.fragment,u),l=!0)},o(u){$(e.$$.fragment,u),$(t.$$.fragment,u),$(s.$$.fragment,u),$(a.$$.fragment,u),l=!1},d(u){u&&(y(n),y(r),y(o)),b(e,u),b(t,u),b(s,u),b(a,u)}}}function xc(i){let e,n,t,r,s,o,a,l;e=new re({props:{header:"List Chapters"}}),t=new Pn({props:{book:i[1],chapter:i[2]}});let u=ie(i[3]),c=[];for(let h=0;h<u.length;h+=1)c[h]=Fr(Mr(i,u,h));const d=h=>$(c[h],1,1,()=>{c[h]=null});return a=new Q({props:{$$slots:{default:[Zc]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment),n=A(),w(t.$$.fragment),r=A(),s=T("div");for(let h=0;h<c.length;h+=1)c[h].c();o=A(),w(a.$$.fragment),k(s,"class","flex flex-col gap-5")},m(h,f){g(e,h,f),C(h,n,f),g(t,h,f),C(h,r,f),C(h,s,f);for(let p=0;p<c.length;p+=1)c[p]&&c[p].m(s,null);C(h,o,f),g(a,h,f),l=!0},p(h,f){const p={};if(f&2&&(p.book=h[1]),f&4&&(p.chapter=h[2]),t.$set(p),f&56){u=ie(h[3]);let v;for(v=0;v<u.length;v+=1){const j=Mr(h,u,v);c[v]?(c[v].p(j,f),m(c[v],1)):(c[v]=Fr(j),c[v].c(),m(c[v],1),c[v].m(s,null))}for(K(),v=u.length;v<c.length;v+=1)d(v);V()}const _={};f&16405&&(_.$$scope={dirty:f,ctx:h}),a.$set(_)},i(h){if(!l){m(e.$$.fragment,h),m(t.$$.fragment,h);for(let f=0;f<u.length;f+=1)m(c[f]);m(a.$$.fragment,h),l=!0}},o(h){$(e.$$.fragment,h),$(t.$$.fragment,h),c=c.filter(Boolean);for(let f=0;f<c.length;f+=1)$(c[f]);$(a.$$.fragment,h),l=!1},d(h){h&&(y(n),y(r),y(s),y(o)),b(e,h),b(t,h),Ce(c,h),b(a,h)}}}function ef(i){let e,n,t,r;return e=new se({props:{$$slots:{default:[xc]},$$scope:{ctx:i}}}),t=new jn({props:{title:"Delete Question",deleteEntry:i[5]}}),{c(){w(e.$$.fragment),n=A(),w(t.$$.fragment)},m(s,o){g(e,s,o),C(s,n,o),g(t,s,o),r=!0},p(s,[o]){const a={};o&16447&&(a.$$scope={dirty:o,ctx:s}),e.$set(a);const l={};o&32&&(l.deleteEntry=s[5]),t.$set(l)},i(s){r||(m(e.$$.fragment,s),m(t.$$.fragment,s),r=!0)},o(s){$(e.$$.fragment,s),$(t.$$.fragment,s),r=!1},d(s){s&&y(n),b(e,s),b(t,s)}}}function tf(i,e,n){let{params:t={id:""}}=e,r,s,o=[],a=!1;ae(async()=>{n(2,s=await In(parseInt(t.id))),s&&(n(3,o=await xe(s.id)),n(1,r=await Dt(s.book_id)))});const l=()=>{s&&F("/cache/details/"+Tn(s.id))};let u={entry:null,onDelete:p=>{yl(p.id,p.chapter_id).then(_=>{n(3,o=_)})},getMessage:p=>`Do you wnat to delete the question: '${p.id}'?`};const c=p=>{n(5,u.entry=p,u)},d=()=>F("/chapters/list/"+(s==null?void 0:s.book_id)),h=()=>F("/questions/create/"+t.id),f=()=>n(4,a=!a);return i.$$set=p=>{"params"in p&&n(0,t=p.params)},[t,r,s,o,a,u,l,c,d,h,f]}class nf extends U{constructor(e){super(),D(this,e,tf,ef,L,{params:0})}}function rf(i){let e,n,t,r,s,o;const a=i[4].default,l=we(a,i,i[6],null);return{c(){e=T("div"),n=T("textarea"),t=A(),l&&l.c(),k(n,"class","input"),k(n,"id",i[2]),k(e,"class","grid md:grid-cols-2 grid-cols-1 gap-4")},m(u,c){C(u,e,c),S(e,n),Oe(n,i[0]),S(e,t),l&&l.m(e,null),r=!0,s||(o=De(n,"input",i[5]),s=!0)},p(u,c){(!r||c&4)&&k(n,"id",u[2]),c&1&&Oe(n,u[0]),l&&l.p&&(!r||c&64)&&ke(l,a,u,u[6],r?ve(a,u[6],c,null):ye(u[6]),null)},i(u){r||(m(l,u),r=!0)},o(u){$(l,u),r=!1},d(u){u&&y(e),l&&l.d(u),s=!1,o()}}}function sf(i){let e,n;return e=new Rt({props:{id:i[2],label:i[1],error:i[3],$$slots:{default:[rf]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,[r]){const s={};r&4&&(s.id=t[2]),r&2&&(s.label=t[1]),r&8&&(s.error=t[3]),r&69&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){$(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function of(i,e,n){let{$$slots:t={},$$scope:r}=e,{label:s}=e,{id:o}=e,{value:a}=e,{error:l}=e;function u(){a=this.value,n(0,a)}return i.$$set=c=>{"label"in c&&n(1,s=c.label),"id"in c&&n(2,o=c.id),"value"in c&&n(0,a=c.value),"error"in c&&n(3,l=c.error),"$$scope"in c&&n(6,r=c.$$scope)},[a,s,o,l,t,u,r]}class Ve extends U{constructor(e){super(),D(this,e,of,sf,L,{label:1,id:2,value:0,error:3})}}function zr(i){let e,n,t=i[0].id+"",r,s,o,a=le(i[0].modified)+"",l,u,c,d;return c=new he({props:{onSubmit:i[6],$$slots:{default:[ff]},$$scope:{ctx:i}}}),{c(){e=T("div"),n=T("span"),r=R(t),s=A(),o=T("span"),l=R(a),u=A(),w(c.$$.fragment),k(e,"class","mb-4 text-small")},m(h,f){C(h,e,f),S(e,n),S(n,r),S(e,s),S(e,o),S(o,l),C(h,u,f),g(c,h,f),d=!0},p(h,f){(!d||f&1)&&t!==(t=h[0].id+"")&&B(r,t),(!d||f&1)&&a!==(a=le(h[0].modified)+"")&&B(l,a);const p={};f&4158&&(p.$$scope={dirty:f,ctx:h}),c.$set(p)},i(h){d||(m(c.$$.fragment,h),d=!0)},o(h){$(c.$$.fragment,h),d=!1},d(h){h&&(y(e),y(u)),b(c,h)}}}function af(i){let e,n;return e=new be({props:{text:i[1]}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,r){const s={};r&2&&(s.text=t[1]),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){$(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function lf(i){let e,n;return e=new be({props:{text:i[3]}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,r){const s={};r&8&&(s.text=t[3]),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){$(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function uf(i){let e,n;return e=new be({props:{text:i[5]}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,r){const s={};r&32&&(s.text=t[5]),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){$(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function cf(i){let e,n,t,r;return e=new M({props:{onClick:i[11],label:"Back"}}),t=new M({props:{label:"Update"}}),{c(){w(e.$$.fragment),n=A(),w(t.$$.fragment)},m(s,o){g(e,s,o),C(s,n,o),g(t,s,o),r=!0},p:q,i(s){r||(m(e.$$.fragment,s),m(t.$$.fragment,s),r=!0)},o(s){$(e.$$.fragment,s),$(t.$$.fragment,s),r=!1},d(s){s&&y(n),b(e,s),b(t,s)}}}function ff(i){let e,n,t,r,s,o,a,l,u,c,d;function h(E){i[8](E)}let f={id:"question",label:"Questione",error:i[2],$$slots:{default:[af]},$$scope:{ctx:i}};i[1]!==void 0&&(f.value=i[1]),e=new Ve({props:f}),Z.push(()=>ne(e,"value",h));function p(E){i[9](E)}let _={id:"answer",label:"Answer",error:i[4],$$slots:{default:[lf]},$$scope:{ctx:i}};i[3]!==void 0&&(_.value=i[3]),r=new Ve({props:_}),Z.push(()=>ne(r,"value",p));function v(E){i[10](E)}let j={id:"details",label:"Details",error:pf,$$slots:{default:[uf]},$$scope:{ctx:i}};return i[5]!==void 0&&(j.value=i[5]),a=new Ve({props:j}),Z.push(()=>ne(a,"value",v)),c=new Q({props:{$$slots:{default:[cf]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment),t=A(),w(r.$$.fragment),o=A(),w(a.$$.fragment),u=A(),w(c.$$.fragment)},m(E,O){g(e,E,O),C(E,t,O),g(r,E,O),C(E,o,O),g(a,E,O),C(E,u,O),g(c,E,O),d=!0},p(E,O){const I={};O&4&&(I.error=E[2]),O&4098&&(I.$$scope={dirty:O,ctx:E}),!n&&O&2&&(n=!0,I.value=E[1],te(()=>n=!1)),e.$set(I);const P={};O&16&&(P.error=E[4]),O&4104&&(P.$$scope={dirty:O,ctx:E}),!s&&O&8&&(s=!0,P.value=E[3],te(()=>s=!1)),r.$set(P);const N={};O&4128&&(N.$$scope={dirty:O,ctx:E}),!l&&O&32&&(l=!0,N.value=E[5],te(()=>l=!1)),a.$set(N);const J={};O&4096&&(J.$$scope={dirty:O,ctx:E}),c.$set(J)},i(E){d||(m(e.$$.fragment,E),m(r.$$.fragment,E),m(a.$$.fragment,E),m(c.$$.fragment,E),d=!0)},o(E){$(e.$$.fragment,E),$(r.$$.fragment,E),$(a.$$.fragment,E),$(c.$$.fragment,E),d=!1},d(E){E&&(y(t),y(o),y(u)),b(e,E),b(r,E),b(a,E),b(c,E)}}}function df(i){let e,n,t,r;e=new re({props:{header:"Update Question"}});let s=i[0]&&zr(i);return{c(){w(e.$$.fragment),n=A(),s&&s.c(),t=x()},m(o,a){g(e,o,a),C(o,n,a),s&&s.m(o,a),C(o,t,a),r=!0},p(o,a){o[0]?s?(s.p(o,a),a&1&&m(s,1)):(s=zr(o),s.c(),m(s,1),s.m(t.parentNode,t)):s&&(K(),$(s,1,1,()=>{s=null}),V())},i(o){r||(m(e.$$.fragment,o),m(s),r=!0)},o(o){$(e.$$.fragment,o),$(s),r=!1},d(o){o&&(y(n),y(t)),b(e,o),s&&s.d(o)}}}function hf(i){let e,n;return e=new se({props:{$$slots:{default:[df]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,[r]){const s={};r&4159&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){$(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}let pf="";function mf(i,e,n){let{params:t={id:""}}=e,r=null,s="",o="",a="",l="",u="";const c=async()=>{const _={quest:s.trim(),answer:a.trim()};if(n(2,o=ue(_.quest)),n(4,l=ue(_.answer)),!(o||l)){if(!r){G.setString("No question!!");return}await Sl(r.id,r.chapter_id,_.quest,_.answer,Cs(u,void 0)),ct()}};ae(async()=>{n(0,r=await kl(parseInt(t.id))),r&&(n(1,s=r.quest),n(3,a=r.answer),n(5,u=r.details?r.details:""))});function d(_){s=_,n(1,s)}function h(_){a=_,n(3,a)}function f(_){u=_,n(5,u)}const p=()=>ct();return i.$$set=_=>{"params"in _&&n(7,t=_.params)},[r,s,o,a,l,u,c,t,d,h,f,p]}class $f extends U{constructor(e){super(),D(this,e,mf,hf,L,{params:7})}}function _f(i){let e,n;return e=new be({props:{text:i[1]}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,r){const s={};r&2&&(s.text=t[1]),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){$(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function gf(i){let e,n;return e=new be({props:{text:i[3]}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,r){const s={};r&8&&(s.text=t[3]),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){$(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function bf(i){let e,n;return e=new be({props:{text:i[5]}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,r){const s={};r&32&&(s.text=t[5]),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){$(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function wf(i){let e,n,t,r;return e=new M({props:{onClick:i[10],label:"Cancel"}}),t=new M({props:{label:"Create"}}),{c(){w(e.$$.fragment),n=A(),w(t.$$.fragment)},m(s,o){g(e,s,o),C(s,n,o),g(t,s,o),r=!0},p(s,o){const a={};o&1&&(a.onClick=s[10]),e.$set(a)},i(s){r||(m(e.$$.fragment,s),m(t.$$.fragment,s),r=!0)},o(s){$(e.$$.fragment,s),$(t.$$.fragment,s),r=!1},d(s){s&&y(n),b(e,s),b(t,s)}}}function vf(i){let e,n,t,r,s,o,a,l,u,c,d;function h(E){i[7](E)}let f={id:"question",label:"Question",error:i[2],$$slots:{default:[_f]},$$scope:{ctx:i}};i[1]!==void 0&&(f.value=i[1]),e=new Ve({props:f}),Z.push(()=>ne(e,"value",h));function p(E){i[8](E)}let _={id:"answer",label:"Answer",error:i[4],$$slots:{default:[gf]},$$scope:{ctx:i}};i[3]!==void 0&&(_.value=i[3]),r=new Ve({props:_}),Z.push(()=>ne(r,"value",p));function v(E){i[9](E)}let j={id:"details",label:"Details",error:Cf,$$slots:{default:[bf]},$$scope:{ctx:i}};return i[5]!==void 0&&(j.value=i[5]),a=new Ve({props:j}),Z.push(()=>ne(a,"value",v)),c=new Q({props:{$$slots:{default:[wf]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment),t=A(),w(r.$$.fragment),o=A(),w(a.$$.fragment),u=A(),w(c.$$.fragment)},m(E,O){g(e,E,O),C(E,t,O),g(r,E,O),C(E,o,O),g(a,E,O),C(E,u,O),g(c,E,O),d=!0},p(E,O){const I={};O&4&&(I.error=E[2]),O&2050&&(I.$$scope={dirty:O,ctx:E}),!n&&O&2&&(n=!0,I.value=E[1],te(()=>n=!1)),e.$set(I);const P={};O&16&&(P.error=E[4]),O&2056&&(P.$$scope={dirty:O,ctx:E}),!s&&O&8&&(s=!0,P.value=E[3],te(()=>s=!1)),r.$set(P);const N={};O&2080&&(N.$$scope={dirty:O,ctx:E}),!l&&O&32&&(l=!0,N.value=E[5],te(()=>l=!1)),a.$set(N);const J={};O&2049&&(J.$$scope={dirty:O,ctx:E}),c.$set(J)},i(E){d||(m(e.$$.fragment,E),m(r.$$.fragment,E),m(a.$$.fragment,E),m(c.$$.fragment,E),d=!0)},o(E){$(e.$$.fragment,E),$(r.$$.fragment,E),$(a.$$.fragment,E),$(c.$$.fragment,E),d=!1},d(E){E&&(y(t),y(o),y(u)),b(e,E),b(r,E),b(a,E),b(c,E)}}}function kf(i){let e,n,t,r;return e=new re({props:{header:"Create Question"}}),t=new he({props:{onSubmit:i[6],$$slots:{default:[vf]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment),n=A(),w(t.$$.fragment)},m(s,o){g(e,s,o),C(s,n,o),g(t,s,o),r=!0},p(s,o){const a={};o&2111&&(a.$$scope={dirty:o,ctx:s}),t.$set(a)},i(s){r||(m(e.$$.fragment,s),m(t.$$.fragment,s),r=!0)},o(s){$(e.$$.fragment,s),$(t.$$.fragment,s),r=!1},d(s){s&&y(n),b(e,s),b(t,s)}}}function yf(i){let e,n;return e=new se({props:{$$slots:{default:[kf]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,[r]){const s={};r&2111&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){$(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}let Cf="";function Sf(i,e,n){let{params:t={chapter_id:""}}=e,r="",s="",o="",a="",l="";const u=async()=>{const p={question:r.trim(),answer:o.trim()};n(2,s=ue(p.question)),n(4,a=ue(p.answer)),!(s||a)&&(await Cl(parseInt(t.chapter_id),p.question,p.answer,Cs(l,void 0)),F("/questions/list/"+t.chapter_id))};function c(p){r=p,n(1,r)}function d(p){o=p,n(3,o)}function h(p){l=p,n(5,l)}const f=()=>F("/questions/list/"+t.chapter_id);return i.$$set=p=>{"params"in p&&n(0,t=p.params)},[t,r,s,o,a,l,u,c,d,h,f]}class Ef extends U{constructor(e){super(),D(this,e,Sf,yf,L,{params:0})}}function Hr(i,e,n){const t=i.slice();return t[8]=e[n],t[10]=n,t}function Af(i){let e,n,t,r;return e=new M({props:{disabled:i[4],label:"Search"}}),t=new M({props:{disabled:!(i[2]&&i[2].questions.length>0),onClick:i[7],label:i[3]?"Simple":"Debug"}}),{c(){w(e.$$.fragment),n=A(),w(t.$$.fragment)},m(s,o){g(e,s,o),C(s,n,o),g(t,s,o),r=!0},p(s,o){const a={};o&16&&(a.disabled=s[4]),e.$set(a);const l={};o&4&&(l.disabled=!(s[2]&&s[2].questions.length>0)),o&8&&(l.onClick=s[7]),o&8&&(l.label=s[3]?"Simple":"Debug"),t.$set(l)},i(s){r||(m(e.$$.fragment,s),m(t.$$.fragment,s),r=!0)},o(s){$(e.$$.fragment,s),$(t.$$.fragment,s),r=!1},d(s){s&&y(n),b(e,s),b(t,s)}}}function Tf(i){let e,n,t,r,s;function o(l){i[6](l)}let a={id:"search",label:"Search Text"};return i[0]!==void 0&&(a.value=i[0]),e=new _e({props:a}),Z.push(()=>ne(e,"value",o)),r=new Q({props:{$$slots:{default:[Af]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment),t=A(),w(r.$$.fragment)},m(l,u){g(e,l,u),C(l,t,u),g(r,l,u),s=!0},p(l,u){const c={};!n&&u&1&&(n=!0,c.value=l[0],te(()=>n=!1)),e.$set(c);const d={};u&2076&&(d.$$scope={dirty:u,ctx:l}),r.$set(d)},i(l){s||(m(e.$$.fragment,l),m(r.$$.fragment,l),s=!0)},o(l){$(e.$$.fragment,l),$(r.$$.fragment,l),s=!1},d(l){l&&y(t),b(e,l),b(r,l)}}}function Of(i){let e;return{c(){e=T("p"),e.textContent="Nothing found ..."},m(n,t){C(n,e,t)},p:q,i:q,o:q,d(n){n&&y(e)}}}function jf(i){let e,n,t,r=i[2].hasMore&&Jr(),s=ie(i[2].questions),o=[];for(let l=0;l<s.length;l+=1)o[l]=Gr(Hr(i,s,l));const a=l=>$(o[l],1,1,()=>{o[l]=null});return{c(){r&&r.c(),e=A(),n=T("div");for(let l=0;l<o.length;l+=1)o[l].c();k(n,"class","flex flex-col gap-5")},m(l,u){r&&r.m(l,u),C(l,e,u),C(l,n,u);for(let c=0;c<o.length;c+=1)o[c]&&o[c].m(n,null);t=!0},p(l,u){if(l[2].hasMore?r||(r=Jr(),r.c(),r.m(e.parentNode,e)):r&&(r.d(1),r=null),u&12){s=ie(l[2].questions);let c;for(c=0;c<s.length;c+=1){const d=Hr(l,s,c);o[c]?(o[c].p(d,u),m(o[c],1)):(o[c]=Gr(d),o[c].c(),m(o[c],1),o[c].m(n,null))}for(K(),c=s.length;c<o.length;c+=1)a(c);V()}},i(l){if(!t){for(let u=0;u<s.length;u+=1)m(o[u]);t=!0}},o(l){o=o.filter(Boolean);for(let u=0;u<o.length;u+=1)$(o[u]);t=!1},d(l){l&&(y(e),y(n)),r&&r.d(l),Ce(o,l)}}}function Jr(i){let e;return{c(){e=T("div"),e.textContent="has more ...",k(e,"class","text-red-700")},m(n,t){C(n,e,t)},d(n){n&&y(e)}}}function Gr(i){let e,n;return e=new Rn({props:{index:i[10],question:i[8],debug:i[3]}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,r){const s={};r&4&&(s.question=t[8]),r&8&&(s.debug=t[3]),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){$(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function If(i){let e,n,t,r,s,o,a,l;e=new re({props:{header:"Search Questions"}}),t=new he({props:{onSubmit:i[5],$$slots:{default:[Tf]},$$scope:{ctx:i}}});const u=[jf,Of],c=[];function d(h,f){return h[2]&&h[2].questions.length>0?0:h[1]!==""?1:-1}return~(s=d(i))&&(o=c[s]=u[s](i)),{c(){w(e.$$.fragment),n=A(),w(t.$$.fragment),r=A(),o&&o.c(),a=x()},m(h,f){g(e,h,f),C(h,n,f),g(t,h,f),C(h,r,f),~s&&c[s].m(h,f),C(h,a,f),l=!0},p(h,f){const p={};f&2077&&(p.$$scope={dirty:f,ctx:h}),t.$set(p);let _=s;s=d(h),s===_?~s&&c[s].p(h,f):(o&&(K(),$(c[_],1,1,()=>{c[_]=null}),V()),~s?(o=c[s],o?o.p(h,f):(o=c[s]=u[s](h),o.c()),m(o,1),o.m(a.parentNode,a)):o=null)},i(h){l||(m(e.$$.fragment,h),m(t.$$.fragment,h),m(o),l=!0)},o(h){$(e.$$.fragment,h),$(t.$$.fragment,h),$(o),l=!1},d(h){h&&(y(n),y(r),y(a)),b(e,h),b(t,h),~s&&c[s].d(h)}}}function Pf(i){let e,n;return e=new se({props:{$$slots:{default:[If]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,[r]){const s={};r&2079&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){$(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function Rf(i,e,n){let t,r="",s="",o,a=!1;const l=async()=>{n(0,r=r.trim()),n(2,o=await El(r)),n(1,s=r)};function u(d){r=d,n(0,r)}const c=()=>n(3,a=!a);return i.$$.update=()=>{i.$$.dirty&3&&n(4,t=r.length<3||r===s)},[r,s,o,a,t,l,u,c]}class Lf extends U{constructor(e){super(),D(this,e,Rf,Pf,L,{})}}function qf(i){let e,n;return e=new M({props:{disabled:i[0]<=0,label:"Update"}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,r){const s={};r&1&&(s.disabled=t[0]<=0),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){$(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function Df(i){let e,n,t,r,s;function o(l){i[4](l)}let a={disabled:i[0]<=0,id:"limit",label:"Limit",options:i[2]};return i[1]!==void 0&&(a.value=i[1]),e=new $n({props:a}),Z.push(()=>ne(e,"value",o)),r=new Q({props:{$$slots:{default:[qf]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment),t=A(),w(r.$$.fragment)},m(l,u){g(e,l,u),C(l,t,u),g(r,l,u),s=!0},p(l,u){const c={};u&1&&(c.disabled=l[0]<=0),!n&&u&2&&(n=!0,c.value=l[1],te(()=>n=!1)),e.$set(c);const d={};u&33&&(d.$$scope={dirty:u,ctx:l}),r.$set(d)},i(l){s||(m(e.$$.fragment,l),m(r.$$.fragment,l),s=!0)},o(l){$(e.$$.fragment,l),$(r.$$.fragment,l),s=!1},d(l){l&&y(t),b(e,l),b(r,l)}}}function Uf(i){let e,n,t,r,s,o,a,l;return e=new re({props:{header:"Search Index of Questions"}}),a=new he({props:{onSubmit:i[3],$$slots:{default:[Df]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment),n=A(),t=T("p"),r=R("Number of questions without search index field: "),s=R(i[0]),o=A(),w(a.$$.fragment)},m(u,c){g(e,u,c),C(u,n,c),C(u,t,c),S(t,r),S(t,s),C(u,o,c),g(a,u,c),l=!0},p(u,c){(!l||c&1)&&B(s,u[0]);const d={};c&35&&(d.$$scope={dirty:c,ctx:u}),a.$set(d)},i(u){l||(m(e.$$.fragment,u),m(a.$$.fragment,u),l=!0)},o(u){$(e.$$.fragment,u),$(a.$$.fragment,u),l=!1},d(u){u&&(y(n),y(t),y(o)),b(e,u),b(a,u)}}}function Nf(i){let e,n;return e=new se({props:{$$slots:{default:[Uf]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,[r]){const s={};r&35&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){$(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function Bf(i,e,n){let t=-2,r="20";const s=[{label:"1",value:"1"},{label:"10",value:"10"},{label:"20",value:"20"},{label:"50",value:"50"},{label:"100",value:"100"}],o=async()=>{const l=await Al(Number.parseInt(r));await Tl(l),n(0,t=await hr())};ae(async()=>{n(0,t=await hr())});function a(l){r=l,n(1,r)}return[t,r,s,o,a]}class Mf extends U{constructor(e){super(),D(this,e,Bf,Nf,L,{})}}function Kr(i,e,n){const t=i.slice();return t[5]=e[n],t}function Ff(i){let e;return{c(){e=R("Cache is empty!")},m(n,t){C(n,e,t)},p:q,i:q,o:q,d(n){n&&y(e)}}}function zf(i){let e,n,t,r,s,o,a,l=ie(i[0]),u=[];for(let d=0;d<l.length;d+=1)u[d]=Vr(Kr(i,l,d));const c=d=>$(u[d],1,1,()=>{u[d]=null});return o=new Q({props:{$$slots:{default:[Jf]},$$scope:{ctx:i}}}),{c(){e=T("table"),n=T("thead"),n.innerHTML="<tr><th>Cache Key</th> <th>Actions</th></tr>",t=A(),r=T("tbody");for(let d=0;d<u.length;d+=1)u[d].c();s=A(),w(o.$$.fragment),k(e,"class","w-full")},m(d,h){C(d,e,h),S(e,n),S(e,t),S(e,r);for(let f=0;f<u.length;f+=1)u[f]&&u[f].m(r,null);C(d,s,h),g(o,d,h),a=!0},p(d,h){if(h&1){l=ie(d[0]);let p;for(p=0;p<l.length;p+=1){const _=Kr(d,l,p);u[p]?(u[p].p(_,h),m(u[p],1)):(u[p]=Vr(_),u[p].c(),m(u[p],1),u[p].m(r,null))}for(K(),p=l.length;p<u.length;p+=1)c(p);V()}const f={};h&257&&(f.$$scope={dirty:h,ctx:d}),o.$set(f)},i(d){if(!a){for(let h=0;h<l.length;h+=1)m(u[h]);m(o.$$.fragment,d),a=!0}},o(d){u=u.filter(Boolean);for(let h=0;h<u.length;h+=1)$(u[h]);$(o.$$.fragment,d),a=!1},d(d){d&&(y(e),y(s)),Ce(u,d),b(o,d)}}}function Hf(i){let e,n,t,r;function s(){return i[1](i[5])}e=new Nt({props:{onClick:s}});function o(){return i[2](i[5])}return t=new ys({props:{onClick:o}}),{c(){w(e.$$.fragment),n=A(),w(t.$$.fragment)},m(a,l){g(e,a,l),C(a,n,l),g(t,a,l),r=!0},p(a,l){i=a;const u={};l&1&&(u.onClick=s),e.$set(u);const c={};l&1&&(c.onClick=o),t.$set(c)},i(a){r||(m(e.$$.fragment,a),m(t.$$.fragment,a),r=!0)},o(a){$(e.$$.fragment,a),$(t.$$.fragment,a),r=!1},d(a){a&&y(n),b(e,a),b(t,a)}}}function Vr(i){let e,n,t=i[5]+"",r,s,o,a,l,u;return a=new Q({props:{$$slots:{default:[Hf]},$$scope:{ctx:i}}}),{c(){e=T("tr"),n=T("td"),r=R(t),s=A(),o=T("td"),w(a.$$.fragment),l=A()},m(c,d){C(c,e,d),S(e,n),S(n,r),S(e,s),S(e,o),g(a,o,null),S(e,l),u=!0},p(c,d){(!u||d&1)&&t!==(t=c[5]+"")&&B(r,t);const h={};d&257&&(h.$$scope={dirty:d,ctx:c}),a.$set(h)},i(c){u||(m(a.$$.fragment,c),u=!0)},o(c){$(a.$$.fragment,c),u=!1},d(c){c&&y(e),b(a)}}}function Jf(i){let e,n,t,r;return e=new M({props:{onClick:i[3],label:"Cancel"}}),t=new M({props:{onClick:i[4],label:"Delete all"}}),{c(){w(e.$$.fragment),n=A(),w(t.$$.fragment)},m(s,o){g(e,s,o),C(s,n,o),g(t,s,o),r=!0},p(s,o){const a={};o&1&&(a.onClick=s[4]),t.$set(a)},i(s){r||(m(e.$$.fragment,s),m(t.$$.fragment,s),r=!0)},o(s){$(e.$$.fragment,s),$(t.$$.fragment,s),r=!1},d(s){s&&y(n),b(e,s),b(t,s)}}}function Gf(i){let e,n,t,r,s,o;e=new re({props:{header:"Cache List"}});const a=[zf,Ff],l=[];function u(c,d){return c[0].length>0?0:1}return t=u(i),r=l[t]=a[t](i),{c(){w(e.$$.fragment),n=A(),r.c(),s=x()},m(c,d){g(e,c,d),C(c,n,d),l[t].m(c,d),C(c,s,d),o=!0},p(c,d){let h=t;t=u(c),t===h?l[t].p(c,d):(K(),$(l[h],1,1,()=>{l[h]=null}),V(),r=l[t],r?r.p(c,d):(r=l[t]=a[t](c),r.c()),m(r,1),r.m(s.parentNode,s))},i(c){o||(m(e.$$.fragment,c),m(r),o=!0)},o(c){$(e.$$.fragment,c),$(r),o=!1},d(c){c&&(y(n),y(s)),b(e,c),l[t].d(c)}}}function Kf(i){let e,n;return e=new se({props:{$$slots:{default:[Gf]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,[r]){const s={};r&257&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){$(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function Vf(i,e,n){let t=[];return ae(()=>{n(0,t=Ss())}),[t,l=>{n(0,t=gl(l))},l=>F("/cache/details/"+l),()=>F("/"),()=>n(0,t=_l())]}class Wf extends U{constructor(e){super(),D(this,e,Vf,Kf,L,{})}}function Wr(i){let e,n,t,r=i[0].id+"",s,o,a,l,u=i[1].created+"",c,d,h,f=JSON.stringify(i[1].data,null,2)+"",p;return{c(){e=T("div"),n=T("div"),t=R("Cache: "),s=R(r),o=A(),a=T("div"),l=R("Created: "),c=R(u),d=A(),h=T("code"),p=R(f),k(n,"class","text-sm font-bold"),k(a,"class","text-sm font-medium"),k(e,"class","flex justify-between"),k(h,"class","px-4 py-3 border border-gray-300 rounded shadow-sm bg-gray-50 whitespace-pre")},m(_,v){C(_,e,v),S(e,n),S(n,t),S(n,s),S(e,o),S(e,a),S(a,l),S(a,c),C(_,d,v),C(_,h,v),S(h,p)},p(_,v){v&1&&r!==(r=_[0].id+"")&&B(s,r),v&2&&u!==(u=_[1].created+"")&&B(c,u),v&2&&f!==(f=JSON.stringify(_[1].data,null,2)+"")&&B(p,f)},d(_){_&&(y(e),y(d),y(h))}}}function Qf(i){let e,n,t,r;return e=new M({props:{label:"Back",onClick:i[3]}}),t=new M({props:{label:"Delete",onClick:i[2]}}),{c(){w(e.$$.fragment),n=A(),w(t.$$.fragment)},m(s,o){g(e,s,o),C(s,n,o),g(t,s,o),r=!0},p:q,i(s){r||(m(e.$$.fragment,s),m(t.$$.fragment,s),r=!0)},o(s){$(e.$$.fragment,s),$(t.$$.fragment,s),r=!1},d(s){s&&y(n),b(e,s),b(t,s)}}}function Xf(i){let e,n,t,r,s;e=new re({props:{header:"Cache Details"}});let o=i[1]&&Wr(i);return r=new Q({props:{$$slots:{default:[Qf]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment),n=A(),o&&o.c(),t=A(),w(r.$$.fragment)},m(a,l){g(e,a,l),C(a,n,l),o&&o.m(a,l),C(a,t,l),g(r,a,l),s=!0},p(a,l){a[1]?o?o.p(a,l):(o=Wr(a),o.c(),o.m(t.parentNode,t)):o&&(o.d(1),o=null);const u={};l&16&&(u.$$scope={dirty:l,ctx:a}),r.$set(u)},i(a){s||(m(e.$$.fragment,a),m(r.$$.fragment,a),s=!0)},o(a){$(e.$$.fragment,a),$(r.$$.fragment,a),s=!1},d(a){a&&(y(n),y(t)),b(e,a),o&&o.d(a),b(r,a)}}}function Yf(i){let e,n;return e=new se({props:{$$slots:{default:[Xf]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,[r]){const s={};r&19&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){$(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function Zf(i,e,n){let{params:t={id:""}}=e,r;ae(()=>{n(1,r=Lt(t.id))});const s=()=>{je(t.id),ct()},o=()=>ct();return i.$$set=a=>{"params"in a&&n(0,t=a.params)},[t,r,s,o]}class xf extends U{constructor(e){super(),D(this,e,Zf,Yf,L,{params:0})}}const an=i=>i?i.indexOf(`
`)<0?`'${i}'`:`E'${i.replaceAll(`
`,"\\n")}'`:null,Os=(i,e,n,t)=>{const r=an(e),s=an(n),o=an(t),a=$t(e,n,t);return`  (${i}, ${r}, ${s}, ${o}, '${a}')`},js=i=>`insert into
  questions (chapter_id, quest, answer, details, search)
values
${i.join(`,
`)};`,ed=i=>`insert into
  chapters (id, book_id, name)
values
${i.join(`,
`)};`,td=i=>`insert into
  books (id, name, description)
values
${i.join(`,
`)};`,Is=async i=>{const e=await Dt(i);if(e===null){G.setString(`No book found for id: ${i}`);return}const n=await Mt(e.id);if(n===null){G.setString(`No chapters found for book: ${e.id}`);return}const t=[];for(const s of n){const o=await xe(s.id);if(o===null){G.setString(`No questions found for id: ${s.id}`);return}const a=[];for(const l of o)a.push({quest:l.quest,answer:l.answer,details:l.details,search:$t(l.quest,l.answer,l.details)});t.push({id:s.id,name:s.name,questions:a})}return{id:e.id,name:e.name,description:e.description,chapters:t}},nd=i=>{const e=[`  (${i.id}, '${i.name}', '${i.description}');`],n=[],t=[];for(const r of i.chapters){n.push(`  (${r.id}, ${i.id}, '${r.name}')`);for(let s of r.questions){const o=Os(r.id,s.quest,s.answer,s.details);t.push(o)}}return`${td(e)}

${ed(n)}

${js(t)}`},rd=(i,e)=>{const n=[];for(const t of e){const r=Pr(t.quest),s=Pr(t.answer),o=Os(i,r,s,void 0);n.push(o)}return js(n)};function Qr(i){let e,n;return{c(){e=T("code"),n=R(i[0]),k(e,"class","px-4 py-3 border border-gray-300 rounded shadow-sm bg-gray-50 whitespace-pre")},m(t,r){C(t,e,r),S(e,n)},p(t,r){r&1&&B(n,t[0])},d(t){t&&y(e)}}}function sd(i){let e,n,t,r;return e=new M({props:{onClick:i[4],label:"Book"}}),t=new M({props:{onClick:i[2],label:"Clipboard",disabled:i[1]}}),{c(){w(e.$$.fragment),n=A(),w(t.$$.fragment)},m(s,o){g(e,s,o),C(s,n,o),g(t,s,o),r=!0},p(s,o){const a={};o&2&&(a.disabled=s[1]),t.$set(a)},i(s){r||(m(e.$$.fragment,s),m(t.$$.fragment,s),r=!0)},o(s){$(e.$$.fragment,s),$(t.$$.fragment,s),r=!1},d(s){s&&y(n),b(e,s),b(t,s)}}}function id(i){let e,n,t,r,s;e=new re({props:{header:"Backup Json"}});let o=i[0]&&Qr(i);return r=new Q({props:{$$slots:{default:[sd]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment),n=A(),o&&o.c(),t=A(),w(r.$$.fragment)},m(a,l){g(e,a,l),C(a,n,l),o&&o.m(a,l),C(a,t,l),g(r,a,l),s=!0},p(a,l){a[0]?o?o.p(a,l):(o=Qr(a),o.c(),o.m(t.parentNode,t)):o&&(o.d(1),o=null);const u={};l&34&&(u.$$scope={dirty:l,ctx:a}),r.$set(u)},i(a){s||(m(e.$$.fragment,a),m(r.$$.fragment,a),s=!0)},o(a){$(e.$$.fragment,a),$(r.$$.fragment,a),s=!1},d(a){a&&(y(n),y(t)),b(e,a),o&&o.d(a),b(r,a)}}}function od(i){let e,n;return e=new se({props:{$$slots:{default:[id]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,[r]){const s={};r&35&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){$(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function ad(i,e,n){let{params:t={id:""}}=e,r,s=!1;ae(async()=>{const l=await Is(parseInt(t.id));l&&n(0,r=JSON.stringify(l,null,2))});const o=()=>{r&&(navigator.clipboard.writeText(r),n(1,s=!0))},a=()=>F("/books/list");return i.$$set=l=>{"params"in l&&n(3,t=l.params)},[r,s,o,t,a]}class ld extends U{constructor(e){super(),D(this,e,ad,od,L,{params:3})}}function Xr(i){let e,n;return{c(){e=T("code"),n=R(i[0]),k(e,"class","px-4 py-3 border border-gray-300 rounded shadow-sm bg-gray-50 whitespace-pre")},m(t,r){C(t,e,r),S(e,n)},p(t,r){r&1&&B(n,t[0])},d(t){t&&y(e)}}}function ud(i){let e,n,t,r;return e=new M({props:{onClick:i[4],label:"Book"}}),t=new M({props:{onClick:i[2],label:"Clipboard",disabled:i[1]}}),{c(){w(e.$$.fragment),n=A(),w(t.$$.fragment)},m(s,o){g(e,s,o),C(s,n,o),g(t,s,o),r=!0},p(s,o){const a={};o&2&&(a.disabled=s[1]),t.$set(a)},i(s){r||(m(e.$$.fragment,s),m(t.$$.fragment,s),r=!0)},o(s){$(e.$$.fragment,s),$(t.$$.fragment,s),r=!1},d(s){s&&y(n),b(e,s),b(t,s)}}}function cd(i){let e,n,t,r,s;e=new re({props:{header:"Backup Sql"}});let o=i[0]&&Xr(i);return r=new Q({props:{$$slots:{default:[ud]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment),n=A(),o&&o.c(),t=A(),w(r.$$.fragment)},m(a,l){g(e,a,l),C(a,n,l),o&&o.m(a,l),C(a,t,l),g(r,a,l),s=!0},p(a,l){a[0]?o?o.p(a,l):(o=Xr(a),o.c(),o.m(t.parentNode,t)):o&&(o.d(1),o=null);const u={};l&34&&(u.$$scope={dirty:l,ctx:a}),r.$set(u)},i(a){s||(m(e.$$.fragment,a),m(r.$$.fragment,a),s=!0)},o(a){$(e.$$.fragment,a),$(r.$$.fragment,a),s=!1},d(a){a&&(y(n),y(t)),b(e,a),o&&o.d(a),b(r,a)}}}function fd(i){let e,n;return e=new se({props:{$$slots:{default:[cd]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,[r]){const s={};r&35&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){$(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function dd(i,e,n){let{params:t={id:""}}=e,r,s=!1;ae(async()=>{const l=await Is(parseInt(t.id));l&&n(0,r=nd(l))});const o=()=>{r&&(navigator.clipboard.writeText(r),n(1,s=!0))},a=()=>F("/books/list");return i.$$set=l=>{"params"in l&&n(3,t=l.params)},[r,s,o,t,a]}class hd extends U{constructor(e){super(),D(this,e,dd,fd,L,{params:3})}}function pd(i){let e;return{c(){e=T("p"),e.textContent="User is not logged in"},m(n,t){C(n,e,t)},p:q,d(n){n&&y(e)}}}function md(i){let e,n,t,r,s,o,a,l,u=i[0].id+"",c,d,h,f,p,_,v=i[0].email+"",j,E,O,I,P,N,J=i[0].created_at+"",ee,pe,et,zt,Ln,Ht,_t=i[0].aud+"",Jt,qn,tt,Gt,Dn,Kt,gt=JSON.stringify(i[0].user_metadata)+"",Vt,Un,nt,Wt,Nn,Qt,bt=JSON.stringify(i[0].app_metadata)+"",Xt;return{c(){e=T("table"),n=T("thead"),n.innerHTML="<tr><th>Key</th> <th>Value</th></tr>",t=A(),r=T("tbody"),s=T("tr"),o=T("td"),o.textContent="Id",a=A(),l=T("td"),c=R(u),d=A(),h=T("tr"),f=T("td"),f.textContent="Email",p=A(),_=T("td"),j=R(v),E=A(),O=T("tr"),I=T("td"),I.textContent="Created",P=A(),N=T("td"),ee=R(J),pe=A(),et=T("tr"),zt=T("td"),zt.textContent="Aud",Ln=A(),Ht=T("td"),Jt=R(_t),qn=A(),tt=T("tr"),Gt=T("td"),Gt.textContent="User Metadata",Dn=A(),Kt=T("td"),Vt=R(gt),Un=A(),nt=T("tr"),Wt=T("td"),Wt.textContent="App Metatata",Nn=A(),Qt=T("td"),Xt=R(bt),k(e,"class","w-full")},m(ge,Se){C(ge,e,Se),S(e,n),S(e,t),S(e,r),S(r,s),S(s,o),S(s,a),S(s,l),S(l,c),S(r,d),S(r,h),S(h,f),S(h,p),S(h,_),S(_,j),S(r,E),S(r,O),S(O,I),S(O,P),S(O,N),S(N,ee),S(r,pe),S(r,et),S(et,zt),S(et,Ln),S(et,Ht),S(Ht,Jt),S(r,qn),S(r,tt),S(tt,Gt),S(tt,Dn),S(tt,Kt),S(Kt,Vt),S(r,Un),S(r,nt),S(nt,Wt),S(nt,Nn),S(nt,Qt),S(Qt,Xt)},p(ge,Se){Se&1&&u!==(u=ge[0].id+"")&&B(c,u),Se&1&&v!==(v=ge[0].email+"")&&B(j,v),Se&1&&J!==(J=ge[0].created_at+"")&&B(ee,J),Se&1&&_t!==(_t=ge[0].aud+"")&&B(Jt,_t),Se&1&&gt!==(gt=JSON.stringify(ge[0].user_metadata)+"")&&B(Vt,gt),Se&1&&bt!==(bt=JSON.stringify(ge[0].app_metadata)+"")&&B(Xt,bt)},d(ge){ge&&y(e)}}}function $d(i){let e,n;return e=new M({props:{onClick:i[1],label:"Cancel"}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p:q,i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){$(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function _d(i){let e,n,t,r,s;e=new re({props:{header:"User"}});function o(u,c){return u[0]?md:pd}let a=o(i),l=a(i);return r=new Q({props:{$$slots:{default:[$d]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment),n=A(),l.c(),t=A(),w(r.$$.fragment)},m(u,c){g(e,u,c),C(u,n,c),l.m(u,c),C(u,t,c),g(r,u,c),s=!0},p(u,c){a===(a=o(u))&&l?l.p(u,c):(l.d(1),l=a(u),l&&(l.c(),l.m(t.parentNode,t)));const d={};c&4&&(d.$$scope={dirty:c,ctx:u}),r.$set(d)},i(u){s||(m(e.$$.fragment,u),m(r.$$.fragment,u),s=!0)},o(u){$(e.$$.fragment,u),$(r.$$.fragment,u),s=!1},d(u){u&&(y(n),y(t)),b(e,u),l.d(u),b(r,u)}}}function gd(i){let e,n;return e=new se({props:{$$slots:{default:[_d]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,[r]){const s={};r&5&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){$(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function bd(i,e,n){let t;return gn(i,Ct,s=>n(0,t=s)),[t,()=>F("/")]}class wd extends U{constructor(e){super(),D(this,e,bd,gd,L,{})}}function Yr(i,e,n){const t=i.slice();return t[2]=e[n],t}function Zr(i){let e,n,t,r,s=_n(i[2])+"",o;return{c(){e=T("tr"),n=T("td"),n.textContent=`${i[2]}`,t=A(),r=T("td"),o=A(),k(n,"class","whitespace-pre-line"),k(r,"class","whitespace-pre-line")},m(a,l){C(a,e,l),S(e,n),S(e,t),S(e,r),r.innerHTML=s,S(e,o)},p:q,d(a){a&&y(e)}}}function vd(i){let e,n;return e=new M({props:{onClick:i[1],label:"Cancel"}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p:q,i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){$(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function kd(i){let e,n,t,r,s,o,a,l,u;e=new re({props:{header:"Markdown Examples"}});let c=ie(i[0]),d=[];for(let h=0;h<c.length;h+=1)d[h]=Zr(Yr(i,c,h));return l=new Q({props:{$$slots:{default:[vd]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment),n=A(),t=T("table"),r=T("thead"),r.innerHTML="<tr><th>Example</th> <th>Replacement</th></tr>",s=A(),o=T("tbody");for(let h=0;h<d.length;h+=1)d[h].c();a=A(),w(l.$$.fragment),k(t,"class","w-full")},m(h,f){g(e,h,f),C(h,n,f),C(h,t,f),S(t,r),S(t,s),S(t,o);for(let p=0;p<d.length;p+=1)d[p]&&d[p].m(o,null);C(h,a,f),g(l,h,f),u=!0},p(h,f){if(f&1){c=ie(h[0]);let _;for(_=0;_<c.length;_+=1){const v=Yr(h,c,_);d[_]?d[_].p(v,f):(d[_]=Zr(v),d[_].c(),d[_].m(o,null))}for(;_<d.length;_+=1)d[_].d(1);d.length=c.length}const p={};f&32&&(p.$$scope={dirty:f,ctx:h}),l.$set(p)},i(h){u||(m(e.$$.fragment,h),m(l.$$.fragment,h),u=!0)},o(h){$(e.$$.fragment,h),$(l.$$.fragment,h),u=!1},d(h){h&&(y(n),y(t),y(a)),b(e,h),Ce(d,h),b(l,h)}}}function yd(i){let e,n;return e=new se({props:{$$slots:{default:[kd]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,[r]){const s={};r&32&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){$(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function Cd(i){return[["This is an e**xample","This is an e*xampl*e","This is #=an example","This is=# an example","This is #an# example",`List
- Item
- Item`,`This is #a
mul#ti lin*e
te*xt`],()=>F("/")]}class Sd extends U{constructor(e){super(),D(this,e,Cd,yd,L,{})}}function Ed(i){let e,n,t,r,s,o;return e=new M({props:{onClick:i[13],label:"Back"}}),t=new M({props:{label:"Import"}}),s=new M({props:{onClick:i[9],label:"Clipboard",disabled:i[5]}}),{c(){w(e.$$.fragment),n=A(),w(t.$$.fragment),r=A(),w(s.$$.fragment)},m(a,l){g(e,a,l),C(a,n,l),g(t,a,l),C(a,r,l),g(s,a,l),o=!0},p(a,l){const u={};l&32&&(u.disabled=a[5]),s.$set(u)},i(a){o||(m(e.$$.fragment,a),m(t.$$.fragment,a),m(s.$$.fragment,a),o=!0)},o(a){$(e.$$.fragment,a),$(t.$$.fragment,a),$(s.$$.fragment,a),o=!1},d(a){a&&(y(n),y(r)),b(e,a),b(t,a),b(s,a)}}}function Ad(i){let e,n,t,r,s,o,a,l,u,c,d;function h(E){i[10](E)}let f={id:"url",label:"Url",error:i[1]};i[0]!==void 0&&(f.value=i[0]),e=new _e({props:f}),Z.push(()=>ne(e,"value",h));function p(E){i[11](E)}let _={id:"book",label:"Book",error:i[6]};i[2]!==void 0&&(_.value=i[2]),r=new _e({props:_}),Z.push(()=>ne(r,"value",p));function v(E){i[12](E)}let j={id:"chapter",label:"Chapter",error:i[7]};return i[3]!==void 0&&(j.value=i[3]),a=new _e({props:j}),Z.push(()=>ne(a,"value",v)),c=new Q({props:{$$slots:{default:[Ed]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment),t=A(),w(r.$$.fragment),o=A(),w(a.$$.fragment),u=A(),w(c.$$.fragment)},m(E,O){g(e,E,O),C(E,t,O),g(r,E,O),C(E,o,O),g(a,E,O),C(E,u,O),g(c,E,O),d=!0},p(E,O){const I={};O&2&&(I.error=E[1]),!n&&O&1&&(n=!0,I.value=E[0],te(()=>n=!1)),e.$set(I);const P={};!s&&O&4&&(s=!0,P.value=E[2],te(()=>s=!1)),r.$set(P);const N={};!l&&O&8&&(l=!0,N.value=E[3],te(()=>l=!1)),a.$set(N);const J={};O&32800&&(J.$$scope={dirty:O,ctx:E}),c.$set(J)},i(E){d||(m(e.$$.fragment,E),m(r.$$.fragment,E),m(a.$$.fragment,E),m(c.$$.fragment,E),d=!0)},o(E){$(e.$$.fragment,E),$(r.$$.fragment,E),$(a.$$.fragment,E),$(c.$$.fragment,E),d=!1},d(E){E&&(y(t),y(o),y(u)),b(e,E),b(r,E),b(a,E),b(c,E)}}}function xr(i){let e,n;return{c(){e=T("code"),n=R(i[4]),k(e,"class","px-4 py-3 border border-gray-300 rounded shadow-sm bg-gray-50 whitespace-pre")},m(t,r){C(t,e,r),S(e,n)},p(t,r){r&16&&B(n,t[4])},d(t){t&&y(e)}}}function Td(i){let e,n,t,r,s,o;e=new re({props:{header:"Import"}}),t=new he({props:{onSubmit:i[8],$$slots:{default:[Ad]},$$scope:{ctx:i}}});let a=i[4]&&xr(i);return{c(){w(e.$$.fragment),n=A(),w(t.$$.fragment),r=A(),a&&a.c(),s=x()},m(l,u){g(e,l,u),C(l,n,u),g(t,l,u),C(l,r,u),a&&a.m(l,u),C(l,s,u),o=!0},p(l,u){const c={};u&32815&&(c.$$scope={dirty:u,ctx:l}),t.$set(c),l[4]?a?a.p(l,u):(a=xr(l),a.c(),a.m(s.parentNode,s)):a&&(a.d(1),a=null)},i(l){o||(m(e.$$.fragment,l),m(t.$$.fragment,l),o=!0)},o(l){$(e.$$.fragment,l),$(t.$$.fragment,l),o=!1},d(l){l&&(y(n),y(r),y(s)),b(e,l),b(t,l),a&&a.d(l)}}}function Od(i){let e,n;return e=new se({props:{$$slots:{default:[Td]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,[r]){const s={};r&32831&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){$(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function jd(i,e,n){let t="https://raw.githubusercontent.com/dead-end/cards-russian/master/data/book/chap-X/chunk-X.json",r,s,o,a,l,u,c,d=!1;ae(async()=>{});const h=async()=>{const E={url:t.trim(),book:parseInt(s.trim()),chapter:parseInt(a.trim())};if(n(1,r=ue(t)),r)return;u=await(await fetch(t)).json(),n(4,c=rd(E.chapter,u)),n(5,d=!1)},f=()=>{c&&(navigator.clipboard.writeText(c),n(5,d=!0))};function p(E){t=E,n(0,t)}function _(E){s=E,n(2,s)}function v(E){a=E,n(3,a)}return[t,r,s,a,c,d,o,l,h,f,p,_,v,()=>ct()]}class Id extends U{constructor(e){super(),D(this,e,jd,Od,L,{})}}function Pd(i){let e,n;return e=new Zs({props:{routes:i[0]}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p:q,i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){$(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function Rd(i){let e,n,t,r,s,o,a;return n=new di({}),r=new pl({props:{$$slots:{default:[Pd]},$$scope:{ctx:i}}}),{c(){e=T("main"),w(n.$$.fragment),t=A(),w(r.$$.fragment),s=A(),o=T("footer"),o.textContent="by Volker Senkel 2024",k(o,"class","text-sm text-end my-4 pt-2 border-t"),k(e,"class","text-gray-600 max-w-screen-lg m-auto mt-4 px-4 lg:px-0")},m(l,u){C(l,e,u),g(n,e,null),S(e,t),g(r,e,null),S(e,s),S(e,o),a=!0},p(l,[u]){const c={};u&2&&(c.$$scope={dirty:u,ctx:l}),r.$set(c)},i(l){a||(m(n.$$.fragment,l),m(r.$$.fragment,l),a=!0)},o(l){$(n.$$.fragment,l),$(r.$$.fragment,l),a=!1},d(l){l&&y(e),b(n),b(r)}}}function Ld(i){return[{"/":Fl,"/books/list":wu,"/books/create":Ou,"/books/update/:id":qu,"/chapters/list/:id":ec,"/chapters/create/:book_id":oc,"/chapters/update/:id":dc,"/lession/prepare/:id":vc,"/lession/process":Yc,"/questions/list/:id":nf,"/questions/create/:chapter_id":Ef,"/questions/update/:id":$f,"/questions/search":Lf,"/questions/index":Mf,"/cache/list":Wf,"/cache/details/:id":xf,"/backup/json/:id":ld,"/backup/sql/:id":hd,"/backup/import":Id,"/user":wd,"/info":Sd,"*":Jl}]}class qd extends U{constructor(e){super(),D(this,e,Ld,Rd,L,{})}}new qd({target:document.getElementById("app")});
