var fs=Object.defineProperty;var hs=(i,e,n)=>e in i?fs(i,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):i[e]=n;var zt=(i,e,n)=>(hs(i,typeof e!="symbol"?e+"":e,n),n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))t(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&t(o)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function t(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}})();function I(){}function ot(i,e){for(const n in e)i[n]=e[n];return i}function Nr(i){return i()}function jn(){return Object.create(null)}function We(i){i.forEach(Nr)}function Qe(i){return typeof i=="function"}function L(i,e){return i!=i?e==e:i!==e||i&&typeof i=="object"||typeof i=="function"}function ds(i){return Object.keys(i).length===0}function Br(i,...e){if(i==null){for(const t of e)t(void 0);return I}const n=i.subscribe(...e);return n.unsubscribe?()=>n.unsubscribe():n}function ln(i,e,n){i.$$.on_destroy.push(Br(e,n))}function Se(i,e,n,t){if(i){const r=Mr(i,e,n,t);return i[0](r)}}function Mr(i,e,n,t){return i[1]&&t?ot(n.ctx.slice(),i[1](t(e))):n.ctx}function Ee(i,e,n,t){if(i[2]&&t){const r=i[2](t(n));if(e.dirty===void 0)return r;if(typeof r=="object"){const s=[],o=Math.max(e.dirty.length,r.length);for(let l=0;l<o;l+=1)s[l]=e.dirty[l]|r[l];return s}return e.dirty|r}return e.dirty}function Oe(i,e,n,t,r,s){if(r){const o=Mr(e,n,t,s);i.p(o,r)}}function Te(i){if(i.ctx.length>32){const e=[],n=i.ctx.length/32;for(let t=0;t<n;t++)e[t]=-1;return e}return-1}function b(i,e){i.appendChild(e)}function C(i,e,n){i.insertBefore(e,n||null)}function y(i){i.parentNode&&i.parentNode.removeChild(i)}function $e(i,e){for(let n=0;n<i.length;n+=1)i[n]&&i[n].d(e)}function O(i){return document.createElement(i)}function Z(i){return document.createElementNS("http://www.w3.org/2000/svg",i)}function N(i){return document.createTextNode(i)}function E(){return N(" ")}function x(){return N("")}function Ye(i,e,n,t){return i.addEventListener(e,n,t),()=>i.removeEventListener(e,n,t)}function ps(i){return function(e){return e.preventDefault(),i.call(this,e)}}function S(i,e,n){n==null?i.removeAttribute(e):i.getAttribute(e)!==n&&i.setAttribute(e,n)}function ms(i){return Array.from(i.childNodes)}function B(i,e){e=""+e,i.data!==e&&(i.data=e)}function Ke(i,e){i.value=e??""}function Pn(i,e,n){for(let t=0;t<i.options.length;t+=1){const r=i.options[t];if(r.__value===e){r.selected=!0;return}}(!n||e!==void 0)&&(i.selectedIndex=-1)}function _s(i){const e=i.querySelector(":checked");return e&&e.__value}function gs(i,e,{bubbles:n=!1,cancelable:t=!1}={}){return new CustomEvent(i,{detail:e,bubbles:n,cancelable:t})}function kt(i,e){return new i(e)}let at;function rt(i){at=i}function Et(){if(!at)throw new Error("Function called outside component initialization");return at}function pe(i){Et().$$.on_mount.push(i)}function $s(i){Et().$$.after_update.push(i)}function bs(i){Et().$$.on_destroy.push(i)}function ws(){const i=Et();return(e,n,{cancelable:t=!1}={})=>{const r=i.$$.callbacks[e];if(r){const s=gs(e,n,{cancelable:t});return r.slice().forEach(o=>{o.call(i,s)}),!s.defaultPrevented}return!0}}function In(i,e){const n=i.$$.callbacks[e.type];n&&n.slice().forEach(t=>t.call(this,e))}const Fe=[],ee=[];let ze=[];const Zt=[],Fr=Promise.resolve();let xt=!1;function Hr(){xt||(xt=!0,Fr.then(zr))}function un(){return Hr(),Fr}function yt(i){ze.push(i)}function te(i){Zt.push(i)}const Jt=new Set;let qe=0;function zr(){if(qe!==0)return;const i=at;do{try{for(;qe<Fe.length;){const e=Fe[qe];qe++,rt(e),vs(e.$$)}}catch(e){throw Fe.length=0,qe=0,e}for(rt(null),Fe.length=0,qe=0;ee.length;)ee.pop()();for(let e=0;e<ze.length;e+=1){const n=ze[e];Jt.has(n)||(Jt.add(n),n())}ze.length=0}while(Fe.length);for(;Zt.length;)Zt.pop()();xt=!1,Jt.clear(),rt(i)}function vs(i){if(i.fragment!==null){i.update(),We(i.before_update);const e=i.dirty;i.dirty=[-1],i.fragment&&i.fragment.p(i.ctx,e),i.after_update.forEach(yt)}}function ks(i){const e=[],n=[];ze.forEach(t=>i.indexOf(t)===-1?e.push(t):n.push(t)),n.forEach(t=>t()),ze=e}const wt=new Set;let Re;function K(){Re={r:0,c:[],p:Re}}function G(){Re.r||We(Re.c),Re=Re.p}function m(i,e){i&&i.i&&(wt.delete(i),i.i(e))}function _(i,e,n,t){if(i&&i.o){if(wt.has(i))return;wt.add(i),Re.c.push(()=>{wt.delete(i),t&&(n&&i.d(1),t())}),i.o(e)}else t&&t()}function re(i){return(i==null?void 0:i.length)!==void 0?i:Array.from(i)}function Ct(i,e){const n={},t={},r={$$scope:1};let s=i.length;for(;s--;){const o=i[s],l=e[s];if(l){for(const a in o)a in l||(t[a]=1);for(const a in l)r[a]||(n[a]=l[a],r[a]=1);i[s]=l}else for(const a in o)r[a]=1}for(const o in t)o in n||(n[o]=void 0);return n}function St(i){return typeof i=="object"&&i!==null?i:{}}function ne(i,e,n){const t=i.$$.props[e];t!==void 0&&(i.$$.bound[t]=n,n(i.$$.ctx[t]))}function k(i){i&&i.c()}function w(i,e,n){const{fragment:t,after_update:r}=i.$$;t&&t.m(e,n),yt(()=>{const s=i.$$.on_mount.map(Nr).filter(Qe);i.$$.on_destroy?i.$$.on_destroy.push(...s):We(s),i.$$.on_mount=[]}),r.forEach(yt)}function v(i,e){const n=i.$$;n.fragment!==null&&(ks(n.after_update),We(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function ys(i,e){i.$$.dirty[0]===-1&&(Fe.push(i),Hr(),i.$$.dirty.fill(0)),i.$$.dirty[e/31|0]|=1<<e%31}function D(i,e,n,t,r,s,o=null,l=[-1]){const a=at;rt(i);const u=i.$$={fragment:null,ctx:[],props:s,update:I,not_equal:r,bound:jn(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(a?a.$$.context:[])),callbacks:jn(),dirty:l,skip_bound:!1,root:e.target||a.$$.root};o&&o(u.root);let c=!1;if(u.ctx=n?n(i,e.props||{},(h,d,...f)=>{const p=f.length?f[0]:d;return u.ctx&&r(u.ctx[h],u.ctx[h]=p)&&(!u.skip_bound&&u.bound[h]&&u.bound[h](p),c&&ys(i,h)),d}):[],u.update(),c=!0,We(u.before_update),u.fragment=t?t(u.ctx):!1,e.target){if(e.hydrate){const h=ms(e.target);u.fragment&&u.fragment.l(h),h.forEach(y)}else u.fragment&&u.fragment.c();e.intro&&m(i.$$.fragment),w(i,e.target,e.anchor),zr()}rt(a)}class q{constructor(){zt(this,"$$");zt(this,"$$set")}$destroy(){v(this,1),this.$destroy=I}$on(e,n){if(!Qe(n))return I;const t=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return t.push(n),()=>{const r=t.indexOf(n);r!==-1&&t.splice(r,1)}}$set(e){this.$$set&&!ds(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const Cs="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(Cs);const Ue=[];function Jr(i,e){return{subscribe:Ot(i,e).subscribe}}function Ot(i,e=I){let n;const t=new Set;function r(l){if(L(i,l)&&(i=l,n)){const a=!Ue.length;for(const u of t)u[1](),Ue.push(u,i);if(a){for(let u=0;u<Ue.length;u+=2)Ue[u][0](Ue[u+1]);Ue.length=0}}}function s(l){r(l(i))}function o(l,a=I){const u=[l,a];return t.add(u),t.size===1&&(n=e(r,s)||I),l(i),()=>{t.delete(u),t.size===0&&n&&(n(),n=null)}}return{set:r,update:s,subscribe:o}}function Kr(i,e,n){const t=!Array.isArray(i),r=t?[i]:i;if(!r.every(Boolean))throw new Error("derived() expects stores as input, got a falsy value");const s=e.length<2;return Jr(n,(o,l)=>{let a=!1;const u=[];let c=0,h=I;const d=()=>{if(c)return;h();const p=e(t?u[0]:u,o,l);s?o(p):h=Qe(p)?p:I},f=r.map((p,g)=>Br(p,$=>{u[g]=$,c&=~(1<<g),a&&d()},()=>{c|=1<<g}));return a=!0,d(),function(){We(f),h(),a=!1}})}function Ss(i,e){if(i instanceof RegExp)return{keys:!1,pattern:i};var n,t,r,s,o=[],l="",a=i.split("/");for(a[0]||a.shift();r=a.shift();)n=r[0],n==="*"?(o.push("wild"),l+="/(.*)"):n===":"?(t=r.indexOf("?",1),s=r.indexOf(".",1),o.push(r.substring(1,~t?t:~s?s:r.length)),l+=~t&&!~s?"(?:/([^/]+?))?":"/([^/]+?)",~s&&(l+=(~t?"?":"")+"\\"+r.substring(s))):l+="/"+r;return{keys:o,pattern:new RegExp("^"+l+"/?$","i")}}function Es(i){let e,n,t;const r=[i[2]];var s=i[0];function o(l,a){let u={};for(let c=0;c<r.length;c+=1)u=ot(u,r[c]);return a!==void 0&&a&4&&(u=ot(u,Ct(r,[St(l[2])]))),{props:u}}return s&&(e=kt(s,o(i)),e.$on("routeEvent",i[7])),{c(){e&&k(e.$$.fragment),n=x()},m(l,a){e&&w(e,l,a),C(l,n,a),t=!0},p(l,a){if(a&1&&s!==(s=l[0])){if(e){K();const u=e;_(u.$$.fragment,1,0,()=>{v(u,1)}),G()}s?(e=kt(s,o(l,a)),e.$on("routeEvent",l[7]),k(e.$$.fragment),m(e.$$.fragment,1),w(e,n.parentNode,n)):e=null}else if(s){const u=a&4?Ct(r,[St(l[2])]):{};e.$set(u)}},i(l){t||(e&&m(e.$$.fragment,l),t=!0)},o(l){e&&_(e.$$.fragment,l),t=!1},d(l){l&&y(n),e&&v(e,l)}}}function Os(i){let e,n,t;const r=[{params:i[1]},i[2]];var s=i[0];function o(l,a){let u={};for(let c=0;c<r.length;c+=1)u=ot(u,r[c]);return a!==void 0&&a&6&&(u=ot(u,Ct(r,[a&2&&{params:l[1]},a&4&&St(l[2])]))),{props:u}}return s&&(e=kt(s,o(i)),e.$on("routeEvent",i[6])),{c(){e&&k(e.$$.fragment),n=x()},m(l,a){e&&w(e,l,a),C(l,n,a),t=!0},p(l,a){if(a&1&&s!==(s=l[0])){if(e){K();const u=e;_(u.$$.fragment,1,0,()=>{v(u,1)}),G()}s?(e=kt(s,o(l,a)),e.$on("routeEvent",l[6]),k(e.$$.fragment),m(e.$$.fragment,1),w(e,n.parentNode,n)):e=null}else if(s){const u=a&6?Ct(r,[a&2&&{params:l[1]},a&4&&St(l[2])]):{};e.$set(u)}},i(l){t||(e&&m(e.$$.fragment,l),t=!0)},o(l){e&&_(e.$$.fragment,l),t=!1},d(l){l&&y(n),e&&v(e,l)}}}function Ts(i){let e,n,t,r;const s=[Os,Es],o=[];function l(a,u){return a[1]?0:1}return e=l(i),n=o[e]=s[e](i),{c(){n.c(),t=x()},m(a,u){o[e].m(a,u),C(a,t,u),r=!0},p(a,[u]){let c=e;e=l(a),e===c?o[e].p(a,u):(K(),_(o[c],1,1,()=>{o[c]=null}),G(),n=o[e],n?n.p(a,u):(n=o[e]=s[e](a),n.c()),m(n,1),n.m(t.parentNode,t))},i(a){r||(m(n),r=!0)},o(a){_(n),r=!1},d(a){a&&y(t),o[e].d(a)}}}function Rn(){const i=window.location.href.indexOf("#/");let e=i>-1?window.location.href.substr(i+1):"/";const n=e.indexOf("?");let t="";return n>-1&&(t=e.substr(n+1),e=e.substr(0,n)),{location:e,querystring:t}}const cn=Jr(null,function(e){e(Rn());const n=()=>{e(Rn())};return window.addEventListener("hashchange",n,!1),function(){window.removeEventListener("hashchange",n,!1)}});Kr(cn,i=>i.location);Kr(cn,i=>i.querystring);const Ln=Ot(void 0);async function z(i){if(!i||i.length<1||i.charAt(0)!="/"&&i.indexOf("#/")!==0)throw Error("Invalid parameter location");await un(),history.replaceState({...history.state,__svelte_spa_router_scrollX:window.scrollX,__svelte_spa_router_scrollY:window.scrollY},void 0),window.location.hash=(i.charAt(0)=="#"?"":"#")+i}async function Dn(){await un(),window.history.back()}function As(i){i?window.scrollTo(i.__svelte_spa_router_scrollX,i.__svelte_spa_router_scrollY):window.scrollTo(0,0)}function js(i,e,n){let{routes:t={}}=e,{prefix:r=""}=e,{restoreScrollState:s=!1}=e;class o{constructor(R,U){if(!U||typeof U!="function"&&(typeof U!="object"||U._sveltesparouter!==!0))throw Error("Invalid component object");if(!R||typeof R=="string"&&(R.length<1||R.charAt(0)!="/"&&R.charAt(0)!="*")||typeof R=="object"&&!(R instanceof RegExp))throw Error('Invalid value for "path" argument - strings must start with / or *');const{pattern:J,keys:Y}=Ss(R);this.path=R,typeof U=="object"&&U._sveltesparouter===!0?(this.component=U.component,this.conditions=U.conditions||[],this.userData=U.userData,this.props=U.props||{}):(this.component=()=>Promise.resolve(U),this.conditions=[],this.props={}),this._pattern=J,this._keys=Y}match(R){if(r){if(typeof r=="string")if(R.startsWith(r))R=R.substr(r.length)||"/";else return null;else if(r instanceof RegExp){const fe=R.match(r);if(fe&&fe[0])R=R.substr(fe[0].length)||"/";else return null}}const U=this._pattern.exec(R);if(U===null)return null;if(this._keys===!1)return U;const J={};let Y=0;for(;Y<this._keys.length;){try{J[this._keys[Y]]=decodeURIComponent(U[Y+1]||"")||null}catch{J[this._keys[Y]]=null}Y++}return J}async checkConditions(R){for(let U=0;U<this.conditions.length;U++)if(!await this.conditions[U](R))return!1;return!0}}const l=[];t instanceof Map?t.forEach((P,R)=>{l.push(new o(R,P))}):Object.keys(t).forEach(P=>{l.push(new o(P,t[P]))});let a=null,u=null,c={};const h=ws();async function d(P,R){await un(),h(P,R)}let f=null,p=null;s&&(p=P=>{P.state&&(P.state.__svelte_spa_router_scrollY||P.state.__svelte_spa_router_scrollX)?f=P.state:f=null},window.addEventListener("popstate",p),$s(()=>{As(f)}));let g=null,$=null;const A=cn.subscribe(async P=>{g=P;let R=0;for(;R<l.length;){const U=l[R].match(P.location);if(!U){R++;continue}const J={route:l[R].path,location:P.location,querystring:P.querystring,userData:l[R].userData,params:U&&typeof U=="object"&&Object.keys(U).length?U:null};if(!await l[R].checkConditions(J)){n(0,a=null),$=null,d("conditionsFailed",J);return}d("routeLoading",Object.assign({},J));const Y=l[R].component;if($!=Y){Y.loading?(n(0,a=Y.loading),$=Y,n(1,u=Y.loadingParams),n(2,c={}),d("routeLoaded",Object.assign({},J,{component:a,name:a.name,params:u}))):(n(0,a=null),$=null);const fe=await Y();if(P!=g)return;n(0,a=fe&&fe.default||fe),$=Y}U&&typeof U=="object"&&Object.keys(U).length?n(1,u=U):n(1,u=null),n(2,c=l[R].props),d("routeLoaded",Object.assign({},J,{component:a,name:a.name,params:u})).then(()=>{Ln.set(u)});return}n(0,a=null),$=null,Ln.set(void 0)});bs(()=>{A(),p&&window.removeEventListener("popstate",p)});function T(P){In.call(this,i,P)}function j(P){In.call(this,i,P)}return i.$$set=P=>{"routes"in P&&n(3,t=P.routes),"prefix"in P&&n(4,r=P.prefix),"restoreScrollState"in P&&n(5,s=P.restoreScrollState)},i.$$.update=()=>{i.$$.dirty&32&&(history.scrollRestoration=s?"manual":"auto")},[a,u,c,t,r,s,T,j]}class Ps extends q{constructor(e){super(),D(this,e,js,Ts,L,{routes:3,prefix:4,restoreScrollState:5})}}function Is(){const{subscribe:i,set:e,update:n}=Ot(null);return{subscribe:i,setDBError:t=>e({msg:t.message,details:t.details}),setAuthError:t=>{e({msg:t.message})},setString:(t,r)=>e({msg:t,details:r}),reset:()=>e(null)}}const W=Is();function Rs(i){let e,n,t,r;return{c(){e=O("button"),n=N(i[0]),S(e,"class","btn"),e.disabled=i[2],S(e,"type","button")},m(s,o){C(s,e,o),b(e,n),t||(r=Ye(e,"click",function(){Qe(i[1])&&i[1].apply(this,arguments)}),t=!0)},p(s,o){i=s,o&1&&B(n,i[0]),o&4&&(e.disabled=i[2])},d(s){s&&y(e),t=!1,r()}}}function Ls(i){let e,n;return{c(){e=O("button"),n=N(i[0]),S(e,"class","btn"),e.disabled=i[2],S(e,"type","submit")},m(t,r){C(t,e,r),b(e,n)},p(t,r){r&1&&B(n,t[0]),r&4&&(e.disabled=t[2])},d(t){t&&y(e)}}}function Ds(i){let e;function n(s,o){return s[1]==null?Ls:Rs}let t=n(i),r=t(i);return{c(){r.c(),e=x()},m(s,o){r.m(s,o),C(s,e,o)},p(s,[o]){t===(t=n(s))&&r?r.p(s,o):(r.d(1),r=t(s),r&&(r.c(),r.m(e.parentNode,e)))},i:I,o:I,d(s){s&&y(e),r.d(s)}}}function qs(i,e,n){let{label:t}=e,{onClick:r=null}=e,{disabled:s=!1}=e;return i.$$set=o=>{"label"in o&&n(0,t=o.label),"onClick"in o&&n(1,r=o.onClick),"disabled"in o&&n(2,s=o.disabled)},[t,r,s]}class F extends q{constructor(e){super(),D(this,e,qs,Ds,L,{label:0,onClick:1,disabled:2})}}function Us(i){let e,n;const t=i[1].default,r=Se(t,i,i[0],null);return{c(){e=O("div"),r&&r.c(),S(e,"class","flex gap-4")},m(s,o){C(s,e,o),r&&r.m(e,null),n=!0},p(s,[o]){r&&r.p&&(!n||o&1)&&Oe(r,t,s,s[0],n?Ee(t,s[0],o,null):Te(s[0]),null)},i(s){n||(m(r,s),n=!0)},o(s){_(r,s),n=!1},d(s){s&&y(e),r&&r.d(s)}}}function Ns(i,e,n){let{$$slots:t={},$$scope:r}=e;return i.$$set=s=>{"$$scope"in s&&n(0,r=s.$$scope)},[r,t]}class Q extends q{constructor(e){super(),D(this,e,Ns,Us,L,{})}}function qn(i,e,n){const t=i.slice();return t[5]=e[n],t}function Un(i){let e,n;return e=new F({props:{label:i[5].label,onClick:i[5].onclick}}),{c(){k(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p(t,r){const s={};r&2&&(s.label=t[5].label),r&2&&(s.onClick=t[5].onclick),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function Bs(i){let e,n,t=re(i[1]),r=[];for(let o=0;o<t.length;o+=1)r[o]=Un(qn(i,t,o));const s=o=>_(r[o],1,1,()=>{r[o]=null});return{c(){for(let o=0;o<r.length;o+=1)r[o].c();e=x()},m(o,l){for(let a=0;a<r.length;a+=1)r[a]&&r[a].m(o,l);C(o,e,l),n=!0},p(o,l){if(l&2){t=re(o[1]);let a;for(a=0;a<t.length;a+=1){const u=qn(o,t,a);r[a]?(r[a].p(u,l),m(r[a],1)):(r[a]=Un(u),r[a].c(),m(r[a],1),r[a].m(e.parentNode,e))}for(K(),a=t.length;a<r.length;a+=1)s(a);G()}},i(o){if(!n){for(let l=0;l<t.length;l+=1)m(r[l]);n=!0}},o(o){r=r.filter(Boolean);for(let l=0;l<r.length;l+=1)_(r[l]);n=!1},d(o){o&&y(e),$e(r,o)}}}function Ms(i){let e,n,t,r,s,o,l,a,u,c,h;const d=i[3].default,f=Se(d,i,i[4],null);return c=new Q({props:{$$slots:{default:[Bs]},$$scope:{ctx:i}}}),{c(){e=O("div"),n=O("div"),t=O("div"),r=N(i[0]),o=E(),l=O("div"),f&&f.c(),a=E(),u=O("div"),k(c.$$.fragment),S(t,"class",s="text-lg pb-2 border-b "+(i[2]==="error"?"text-red-900":"")),S(l,"class","my-6"),S(n,"class","relative top-1/3 mx-auto max-w-md bg-white rounded shadow p-6"),S(e,"class","fixed z-50 inset-0 bg-black bg-opacity-50 overflow-y-auto h-full w-full")},m(p,g){C(p,e,g),b(e,n),b(n,t),b(t,r),b(n,o),b(n,l),f&&f.m(l,null),b(n,a),b(n,u),w(c,u,null),h=!0},p(p,[g]){(!h||g&1)&&B(r,p[0]),(!h||g&4&&s!==(s="text-lg pb-2 border-b "+(p[2]==="error"?"text-red-900":"")))&&S(t,"class",s),f&&f.p&&(!h||g&16)&&Oe(f,d,p,p[4],h?Ee(d,p[4],g,null):Te(p[4]),null);const $={};g&18&&($.$$scope={dirty:g,ctx:p}),c.$set($)},i(p){h||(m(f,p),m(c.$$.fragment,p),h=!0)},o(p){_(f,p),_(c.$$.fragment,p),h=!1},d(p){p&&y(e),f&&f.d(p),v(c)}}}function Fs(i,e,n){let{$$slots:t={},$$scope:r}=e,{title:s}=e,{buttons:o}=e,{type:l="ok"}=e;return i.$$set=a=>{"title"in a&&n(0,s=a.title),"buttons"in a&&n(1,o=a.buttons),"type"in a&&n(2,l=a.type),"$$scope"in a&&n(4,r=a.$$scope)},[s,o,l,t,r]}class Gr extends q{constructor(e){super(),D(this,e,Fs,Ms,L,{title:0,buttons:1,type:2})}}function Nn(i){let e,n;return e=new Gr({props:{title:"Errors",buttons:i[1],type:"error",$$slots:{default:[Hs]},$$scope:{ctx:i}}}),{c(){k(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p(t,r){const s={};r&5&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function Bn(i){let e,n=i[0].details+"",t;return{c(){e=O("p"),t=N(n),S(e,"class","text-sm pt-3")},m(r,s){C(r,e,s),b(e,t)},p(r,s){s&1&&n!==(n=r[0].details+"")&&B(t,n)},d(r){r&&y(e)}}}function Hs(i){let e=i[0].msg+"",n,t,r,s=i[0].details&&Bn(i);return{c(){n=N(e),t=E(),s&&s.c(),r=x()},m(o,l){C(o,n,l),C(o,t,l),s&&s.m(o,l),C(o,r,l)},p(o,l){l&1&&e!==(e=o[0].msg+"")&&B(n,e),o[0].details?s?s.p(o,l):(s=Bn(o),s.c(),s.m(r.parentNode,r)):s&&(s.d(1),s=null)},d(o){o&&(y(n),y(t),y(r)),s&&s.d(o)}}}function zs(i){let e,n,t=i[0]!==null&&Nn(i);return{c(){t&&t.c(),e=x()},m(r,s){t&&t.m(r,s),C(r,e,s),n=!0},p(r,[s]){r[0]!==null?t?(t.p(r,s),s&1&&m(t,1)):(t=Nn(r),t.c(),m(t,1),t.m(e.parentNode,e)):t&&(K(),_(t,1,1,()=>{t=null}),G())},i(r){n||(m(t),n=!0)},o(r){_(t),n=!1},d(r){r&&y(e),t&&t.d(r)}}}function Js(i,e,n){let t;return ln(i,W,s=>n(0,t=s)),[t,[{label:"OK",onclick:()=>{W.reset()}}]]}class Ks extends q{constructor(e){super(),D(this,e,Js,zs,L,{})}}const Gs="modulepreload",Vs=function(i,e){return new URL(i,e).href},Mn={},Ge=function(e,n,t){let r=Promise.resolve();if(n&&n.length>0){const s=document.getElementsByTagName("link"),o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));r=Promise.all(n.map(a=>{if(a=Vs(a,t),a in Mn)return;Mn[a]=!0;const u=a.endsWith(".css"),c=u?'[rel="stylesheet"]':"";if(!!t)for(let f=s.length-1;f>=0;f--){const p=s[f];if(p.href===a&&(!u||p.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${a}"]${c}`))return;const d=document.createElement("link");if(d.rel=u?"stylesheet":Gs,u||(d.as="script",d.crossOrigin=""),d.href=a,l&&d.setAttribute("nonce",l),document.head.appendChild(d),u)return new Promise((f,p)=>{d.addEventListener("load",f),d.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${a}`)))})}))}return r.then(()=>e()).catch(s=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=s,window.dispatchEvent(o),!o.defaultPrevented)throw s})},Ws=i=>{let e;return i?e=i:typeof fetch>"u"?e=(...n)=>Ge(()=>Promise.resolve().then(()=>ft),void 0,import.meta.url).then(({default:t})=>t(...n)):e=fetch,(...n)=>e(...n)};class fn extends Error{constructor(e,n="FunctionsError",t){super(e),this.name=n,this.context=t}}class Qs extends fn{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Ys extends fn{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Xs extends fn{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var en;(function(i){i.Any="any",i.ApNortheast1="ap-northeast-1",i.ApNortheast2="ap-northeast-2",i.ApSouth1="ap-south-1",i.ApSoutheast1="ap-southeast-1",i.ApSoutheast2="ap-southeast-2",i.CaCentral1="ca-central-1",i.EuCentral1="eu-central-1",i.EuWest1="eu-west-1",i.EuWest2="eu-west-2",i.EuWest3="eu-west-3",i.SaEast1="sa-east-1",i.UsEast1="us-east-1",i.UsWest1="us-west-1",i.UsWest2="us-west-2"})(en||(en={}));var Zs=function(i,e,n,t){function r(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function l(c){try{u(t.next(c))}catch(h){o(h)}}function a(c){try{u(t.throw(c))}catch(h){o(h)}}function u(c){c.done?s(c.value):r(c.value).then(l,a)}u((t=t.apply(i,e||[])).next())})};class xs{constructor(e,{headers:n={},customFetch:t,region:r=en.Any}={}){this.url=e,this.headers=n,this.region=r,this.fetch=Ws(t)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,n={}){var t;return Zs(this,void 0,void 0,function*(){try{const{headers:r,method:s,body:o}=n;let l={},{region:a}=n;a||(a=this.region),a&&a!=="any"&&(l["x-region"]=a);let u;o&&(r&&!Object.prototype.hasOwnProperty.call(r,"Content-Type")||!r)&&(typeof Blob<"u"&&o instanceof Blob||o instanceof ArrayBuffer?(l["Content-Type"]="application/octet-stream",u=o):typeof o=="string"?(l["Content-Type"]="text/plain",u=o):typeof FormData<"u"&&o instanceof FormData?u=o:(l["Content-Type"]="application/json",u=JSON.stringify(o)));const c=yield this.fetch(`${this.url}/${e}`,{method:s||"POST",headers:Object.assign(Object.assign(Object.assign({},l),this.headers),r),body:u}).catch(p=>{throw new Qs(p)}),h=c.headers.get("x-relay-error");if(h&&h==="true")throw new Ys(c);if(!c.ok)throw new Xs(c);let d=((t=c.headers.get("Content-Type"))!==null&&t!==void 0?t:"text/plain").split(";")[0].trim(),f;return d==="application/json"?f=yield c.json():d==="application/octet-stream"?f=yield c.blob():d==="text/event-stream"?f=c:d==="multipart/form-data"?f=yield c.formData():f=yield c.text(),{data:f,error:null}}catch(r){return{data:null,error:r}}})}}var ei=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Ve=ei();const ti=Ve.fetch,hn=Ve.fetch.bind(Ve),Vr=Ve.Headers,ni=Ve.Request,ri=Ve.Response,ft=Object.freeze(Object.defineProperty({__proto__:null,Headers:Vr,Request:ni,Response:ri,default:hn,fetch:ti},Symbol.toStringTag,{value:"Module"}));class si extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}}class ii{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=hn:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}then(e,n){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const t=this.fetch;let r=t(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async s=>{var o,l,a;let u=null,c=null,h=null,d=s.status,f=s.statusText;if(s.ok){if(this.method!=="HEAD"){const A=await s.text();A===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?c=A:c=JSON.parse(A))}const g=(o=this.headers.Prefer)===null||o===void 0?void 0:o.match(/count=(exact|planned|estimated)/),$=(l=s.headers.get("content-range"))===null||l===void 0?void 0:l.split("/");g&&$&&$.length>1&&(h=parseInt($[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(c)&&(c.length>1?(u={code:"PGRST116",details:`Results contain ${c.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},c=null,h=null,d=406,f="Not Acceptable"):c.length===1?c=c[0]:c=null)}else{const g=await s.text();try{u=JSON.parse(g),Array.isArray(u)&&s.status===404&&(c=[],u=null,d=200,f="OK")}catch{s.status===404&&g===""?(d=204,f="No Content"):u={message:g}}if(u&&this.isMaybeSingle&&(!((a=u==null?void 0:u.details)===null||a===void 0)&&a.includes("0 rows"))&&(u=null,d=200,f="OK"),u&&this.shouldThrowOnError)throw new si(u)}return{error:u,data:c,count:h,status:d,statusText:f}});return this.shouldThrowOnError||(r=r.catch(s=>{var o,l,a;return{error:{message:`${(o=s==null?void 0:s.name)!==null&&o!==void 0?o:"FetchError"}: ${s==null?void 0:s.message}`,details:`${(l=s==null?void 0:s.stack)!==null&&l!==void 0?l:""}`,hint:"",code:`${(a=s==null?void 0:s.code)!==null&&a!==void 0?a:""}`},data:null,count:null,status:0,statusText:""}})),r.then(e,n)}}class oi extends ii{select(e){let n=!1;const t=(e??"*").split("").map(r=>/\s/.test(r)&&!n?"":(r==='"'&&(n=!n),r)).join("");return this.url.searchParams.set("select",t),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e,{ascending:n=!0,nullsFirst:t,foreignTable:r,referencedTable:s=r}={}){const o=s?`${s}.order`:"order",l=this.url.searchParams.get(o);return this.url.searchParams.set(o,`${l?`${l},`:""}${e}.${n?"asc":"desc"}${t===void 0?"":t?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:n,referencedTable:t=n}={}){const r=typeof t>"u"?"limit":`${t}.limit`;return this.url.searchParams.set(r,`${e}`),this}range(e,n,{foreignTable:t,referencedTable:r=t}={}){const s=typeof r>"u"?"offset":`${r}.offset`,o=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(s,`${e}`),this.url.searchParams.set(o,`${n-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:e=!1,verbose:n=!1,settings:t=!1,buffers:r=!1,wal:s=!1,format:o="text"}={}){var l;const a=[e?"analyze":null,n?"verbose":null,t?"settings":null,r?"buffers":null,s?"wal":null].filter(Boolean).join("|"),u=(l=this.headers.Accept)!==null&&l!==void 0?l:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${o}; for="${u}"; options=${a};`,o==="json"?this:this}rollback(){var e;return((e=this.headers.Prefer)!==null&&e!==void 0?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}class He extends oi{eq(e,n){return this.url.searchParams.append(e,`eq.${n}`),this}neq(e,n){return this.url.searchParams.append(e,`neq.${n}`),this}gt(e,n){return this.url.searchParams.append(e,`gt.${n}`),this}gte(e,n){return this.url.searchParams.append(e,`gte.${n}`),this}lt(e,n){return this.url.searchParams.append(e,`lt.${n}`),this}lte(e,n){return this.url.searchParams.append(e,`lte.${n}`),this}like(e,n){return this.url.searchParams.append(e,`like.${n}`),this}likeAllOf(e,n){return this.url.searchParams.append(e,`like(all).{${n.join(",")}}`),this}likeAnyOf(e,n){return this.url.searchParams.append(e,`like(any).{${n.join(",")}}`),this}ilike(e,n){return this.url.searchParams.append(e,`ilike.${n}`),this}ilikeAllOf(e,n){return this.url.searchParams.append(e,`ilike(all).{${n.join(",")}}`),this}ilikeAnyOf(e,n){return this.url.searchParams.append(e,`ilike(any).{${n.join(",")}}`),this}is(e,n){return this.url.searchParams.append(e,`is.${n}`),this}in(e,n){const t=Array.from(new Set(n)).map(r=>typeof r=="string"&&new RegExp("[,()]").test(r)?`"${r}"`:`${r}`).join(",");return this.url.searchParams.append(e,`in.(${t})`),this}contains(e,n){return typeof n=="string"?this.url.searchParams.append(e,`cs.${n}`):Array.isArray(n)?this.url.searchParams.append(e,`cs.{${n.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(n)}`),this}containedBy(e,n){return typeof n=="string"?this.url.searchParams.append(e,`cd.${n}`):Array.isArray(n)?this.url.searchParams.append(e,`cd.{${n.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(n)}`),this}rangeGt(e,n){return this.url.searchParams.append(e,`sr.${n}`),this}rangeGte(e,n){return this.url.searchParams.append(e,`nxl.${n}`),this}rangeLt(e,n){return this.url.searchParams.append(e,`sl.${n}`),this}rangeLte(e,n){return this.url.searchParams.append(e,`nxr.${n}`),this}rangeAdjacent(e,n){return this.url.searchParams.append(e,`adj.${n}`),this}overlaps(e,n){return typeof n=="string"?this.url.searchParams.append(e,`ov.${n}`):this.url.searchParams.append(e,`ov.{${n.join(",")}}`),this}textSearch(e,n,{config:t,type:r}={}){let s="";r==="plain"?s="pl":r==="phrase"?s="ph":r==="websearch"&&(s="w");const o=t===void 0?"":`(${t})`;return this.url.searchParams.append(e,`${s}fts${o}.${n}`),this}match(e){return Object.entries(e).forEach(([n,t])=>{this.url.searchParams.append(n,`eq.${t}`)}),this}not(e,n,t){return this.url.searchParams.append(e,`not.${n}.${t}`),this}or(e,{foreignTable:n,referencedTable:t=n}={}){const r=t?`${t}.or`:"or";return this.url.searchParams.append(r,`(${e})`),this}filter(e,n,t){return this.url.searchParams.append(e,`${n}.${t}`),this}}class ai{constructor(e,{headers:n={},schema:t,fetch:r}){this.url=e,this.headers=n,this.schema=t,this.fetch=r}select(e,{head:n=!1,count:t}={}){const r=n?"HEAD":"GET";let s=!1;const o=(e??"*").split("").map(l=>/\s/.test(l)&&!s?"":(l==='"'&&(s=!s),l)).join("");return this.url.searchParams.set("select",o),t&&(this.headers.Prefer=`count=${t}`),new He({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e,{count:n,defaultToNull:t=!0}={}){const r="POST",s=[];if(this.headers.Prefer&&s.push(this.headers.Prefer),n&&s.push(`count=${n}`),t||s.push("missing=default"),this.headers.Prefer=s.join(","),Array.isArray(e)){const o=e.reduce((l,a)=>l.concat(Object.keys(a)),[]);if(o.length>0){const l=[...new Set(o)].map(a=>`"${a}"`);this.url.searchParams.set("columns",l.join(","))}}return new He({method:r,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e,{onConflict:n,ignoreDuplicates:t=!1,count:r,defaultToNull:s=!0}={}){const o="POST",l=[`resolution=${t?"ignore":"merge"}-duplicates`];if(n!==void 0&&this.url.searchParams.set("on_conflict",n),this.headers.Prefer&&l.push(this.headers.Prefer),r&&l.push(`count=${r}`),s||l.push("missing=default"),this.headers.Prefer=l.join(","),Array.isArray(e)){const a=e.reduce((u,c)=>u.concat(Object.keys(c)),[]);if(a.length>0){const u=[...new Set(a)].map(c=>`"${c}"`);this.url.searchParams.set("columns",u.join(","))}}return new He({method:o,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e,{count:n}={}){const t="PATCH",r=[];return this.headers.Prefer&&r.push(this.headers.Prefer),n&&r.push(`count=${n}`),this.headers.Prefer=r.join(","),new He({method:t,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete({count:e}={}){const n="DELETE",t=[];return e&&t.push(`count=${e}`),this.headers.Prefer&&t.unshift(this.headers.Prefer),this.headers.Prefer=t.join(","),new He({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}const li="1.15.2",ui={"X-Client-Info":`postgrest-js/${li}`};class dn{constructor(e,{headers:n={},schema:t,fetch:r}={}){this.url=e,this.headers=Object.assign(Object.assign({},ui),n),this.schemaName=t,this.fetch=r}from(e){const n=new URL(`${this.url}/${e}`);return new ai(n,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new dn(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,n={},{head:t=!1,get:r=!1,count:s}={}){let o;const l=new URL(`${this.url}/rpc/${e}`);let a;t||r?(o=t?"HEAD":"GET",Object.entries(n).filter(([c,h])=>h!==void 0).map(([c,h])=>[c,Array.isArray(h)?`{${h.join(",")}}`:`${h}`]).forEach(([c,h])=>{l.searchParams.append(c,h)})):(o="POST",a=n);const u=Object.assign({},this.headers);return s&&(u.Prefer=`count=${s}`),new He({method:o,url:l,headers:u,schema:this.schemaName,body:a,fetch:this.fetch,allowEmpty:!1})}}const ci="2.9.5",fi={"X-Client-Info":`realtime-js/${ci}`},hi="1.0.0",Wr=1e4,di=1e3;var Je;(function(i){i[i.connecting=0]="connecting",i[i.open=1]="open",i[i.closing=2]="closing",i[i.closed=3]="closed"})(Je||(Je={}));var le;(function(i){i.closed="closed",i.errored="errored",i.joined="joined",i.joining="joining",i.leaving="leaving"})(le||(le={}));var de;(function(i){i.close="phx_close",i.error="phx_error",i.join="phx_join",i.reply="phx_reply",i.leave="phx_leave",i.access_token="access_token"})(de||(de={}));var tn;(function(i){i.websocket="websocket"})(tn||(tn={}));var Ie;(function(i){i.Connecting="connecting",i.Open="open",i.Closing="closing",i.Closed="closed"})(Ie||(Ie={}));class Qr{constructor(e,n){this.callback=e,this.timerCalc=n,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=n}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}class pi{constructor(){this.HEADER_LENGTH=1}decode(e,n){return e.constructor===ArrayBuffer?n(this._binaryDecode(e)):n(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const n=new DataView(e),t=new TextDecoder;return this._decodeBroadcast(e,n,t)}_decodeBroadcast(e,n,t){const r=n.getUint8(1),s=n.getUint8(2);let o=this.HEADER_LENGTH+2;const l=t.decode(e.slice(o,o+r));o=o+r;const a=t.decode(e.slice(o,o+s));o=o+s;const u=JSON.parse(t.decode(e.slice(o,e.byteLength)));return{ref:null,topic:l,event:a,payload:u}}}class Kt{constructor(e,n,t={},r=Wr){this.channel=e,this.event=n,this.payload=t,this.timeout=r,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,n){var t;return this._hasReceived(e)&&n((t=this.receivedResp)===null||t===void 0?void 0:t.response),this.recHooks.push({status:e,callback:n}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=n=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=n,this._matchReceive(n)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,n){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:n})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:n}){this.recHooks.filter(t=>t.status===e).forEach(t=>t.callback(n))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Fn;(function(i){i.SYNC="sync",i.JOIN="join",i.LEAVE="leave"})(Fn||(Fn={}));class st{constructor(e,n){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const t=(n==null?void 0:n.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(t.state,{},r=>{const{onJoin:s,onLeave:o,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=st.syncState(this.state,r,s,o),this.pendingDiffs.forEach(a=>{this.state=st.syncDiff(this.state,a,s,o)}),this.pendingDiffs=[],l()}),this.channel._on(t.diff,{},r=>{const{onJoin:s,onLeave:o,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(r):(this.state=st.syncDiff(this.state,r,s,o),l())}),this.onJoin((r,s,o)=>{this.channel._trigger("presence",{event:"join",key:r,currentPresences:s,newPresences:o})}),this.onLeave((r,s,o)=>{this.channel._trigger("presence",{event:"leave",key:r,currentPresences:s,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,n,t,r){const s=this.cloneDeep(e),o=this.transformState(n),l={},a={};return this.map(s,(u,c)=>{o[u]||(a[u]=c)}),this.map(o,(u,c)=>{const h=s[u];if(h){const d=c.map($=>$.presence_ref),f=h.map($=>$.presence_ref),p=c.filter($=>f.indexOf($.presence_ref)<0),g=h.filter($=>d.indexOf($.presence_ref)<0);p.length>0&&(l[u]=p),g.length>0&&(a[u]=g)}else l[u]=c}),this.syncDiff(s,{joins:l,leaves:a},t,r)}static syncDiff(e,n,t,r){const{joins:s,leaves:o}={joins:this.transformState(n.joins),leaves:this.transformState(n.leaves)};return t||(t=()=>{}),r||(r=()=>{}),this.map(s,(l,a)=>{var u;const c=(u=e[l])!==null&&u!==void 0?u:[];if(e[l]=this.cloneDeep(a),c.length>0){const h=e[l].map(f=>f.presence_ref),d=c.filter(f=>h.indexOf(f.presence_ref)<0);e[l].unshift(...d)}t(l,c,a)}),this.map(o,(l,a)=>{let u=e[l];if(!u)return;const c=a.map(h=>h.presence_ref);u=u.filter(h=>c.indexOf(h.presence_ref)<0),e[l]=u,r(l,u,a),u.length===0&&delete e[l]}),e}static map(e,n){return Object.getOwnPropertyNames(e).map(t=>n(t,e[t]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((n,t)=>{const r=e[t];return"metas"in r?n[t]=r.metas.map(s=>(s.presence_ref=s.phx_ref,delete s.phx_ref,delete s.phx_ref_prev,s)):n[t]=r,n},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var V;(function(i){i.abstime="abstime",i.bool="bool",i.date="date",i.daterange="daterange",i.float4="float4",i.float8="float8",i.int2="int2",i.int4="int4",i.int4range="int4range",i.int8="int8",i.int8range="int8range",i.json="json",i.jsonb="jsonb",i.money="money",i.numeric="numeric",i.oid="oid",i.reltime="reltime",i.text="text",i.time="time",i.timestamp="timestamp",i.timestamptz="timestamptz",i.timetz="timetz",i.tsrange="tsrange",i.tstzrange="tstzrange"})(V||(V={}));const Hn=(i,e,n={})=>{var t;const r=(t=n.skipTypes)!==null&&t!==void 0?t:[];return Object.keys(e).reduce((s,o)=>(s[o]=mi(o,i,e,r),s),{})},mi=(i,e,n,t)=>{const r=e.find(l=>l.name===i),s=r==null?void 0:r.type,o=n[i];return s&&!t.includes(s)?Yr(s,o):nn(o)},Yr=(i,e)=>{if(i.charAt(0)==="_"){const n=i.slice(1,i.length);return bi(e,n)}switch(i){case V.bool:return _i(e);case V.float4:case V.float8:case V.int2:case V.int4:case V.int8:case V.numeric:case V.oid:return gi(e);case V.json:case V.jsonb:return $i(e);case V.timestamp:return wi(e);case V.abstime:case V.date:case V.daterange:case V.int4range:case V.int8range:case V.money:case V.reltime:case V.text:case V.time:case V.timestamptz:case V.timetz:case V.tsrange:case V.tstzrange:return nn(e);default:return nn(e)}},nn=i=>i,_i=i=>{switch(i){case"t":return!0;case"f":return!1;default:return i}},gi=i=>{if(typeof i=="string"){const e=parseFloat(i);if(!Number.isNaN(e))return e}return i},$i=i=>{if(typeof i=="string")try{return JSON.parse(i)}catch(e){return console.log(`JSON parse error: ${e}`),i}return i},bi=(i,e)=>{if(typeof i!="string")return i;const n=i.length-1,t=i[n];if(i[0]==="{"&&t==="}"){let s;const o=i.slice(1,n);try{s=JSON.parse("["+o+"]")}catch{s=o?o.split(","):[]}return s.map(l=>Yr(e,l))}return i},wi=i=>typeof i=="string"?i.replace(" ","T"):i;var zn;(function(i){i.ALL="*",i.INSERT="INSERT",i.UPDATE="UPDATE",i.DELETE="DELETE"})(zn||(zn={}));var Jn;(function(i){i.BROADCAST="broadcast",i.PRESENCE="presence",i.POSTGRES_CHANGES="postgres_changes"})(Jn||(Jn={}));var Kn;(function(i){i.SUBSCRIBED="SUBSCRIBED",i.TIMED_OUT="TIMED_OUT",i.CLOSED="CLOSED",i.CHANNEL_ERROR="CHANNEL_ERROR"})(Kn||(Kn={}));class pn{constructor(e,n={config:{}},t){this.topic=e,this.params=n,this.socket=t,this.bindings={},this.state=le.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""}},n.config),this.timeout=this.socket.timeout,this.joinPush=new Kt(this,de.join,this.params,this.timeout),this.rejoinTimer=new Qr(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=le.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(r=>r.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=le.closed,this.socket._remove(this)}),this._onError(r=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,r),this.state=le.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=le.errored,this.rejoinTimer.scheduleTimeout())}),this._on(de.reply,{},(r,s)=>{this._trigger(this._replyEventName(s),r)}),this.presence=new st(this),this.broadcastEndpointURL=this._broadcastEndpointURL()}subscribe(e,n=this.timeout){var t,r;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:s,presence:o}}=this.params;this._onError(u=>e&&e("CHANNEL_ERROR",u)),this._onClose(()=>e&&e("CLOSED"));const l={},a={broadcast:s,presence:o,postgres_changes:(r=(t=this.bindings.postgres_changes)===null||t===void 0?void 0:t.map(u=>u.filter))!==null&&r!==void 0?r:[]};this.socket.accessToken&&(l.access_token=this.socket.accessToken),this.updateJoinPayload(Object.assign({config:a},l)),this.joinedOnce=!0,this._rejoin(n),this.joinPush.receive("ok",({postgres_changes:u})=>{var c;if(this.socket.accessToken&&this.socket.setAuth(this.socket.accessToken),u===void 0){e&&e("SUBSCRIBED");return}else{const h=this.bindings.postgres_changes,d=(c=h==null?void 0:h.length)!==null&&c!==void 0?c:0,f=[];for(let p=0;p<d;p++){const g=h[p],{filter:{event:$,schema:A,table:T,filter:j}}=g,P=u&&u[p];if(P&&P.event===$&&P.schema===A&&P.table===T&&P.filter===j)f.push(Object.assign(Object.assign({},g),{id:P.id}));else{this.unsubscribe(),e&&e("CHANNEL_ERROR",new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=f,e&&e("SUBSCRIBED");return}}).receive("error",u=>{e&&e("CHANNEL_ERROR",new Error(JSON.stringify(Object.values(u).join(", ")||"error")))}).receive("timeout",()=>{e&&e("TIMED_OUT")})}return this}presenceState(){return this.presence.state}async track(e,n={}){return await this.send({type:"presence",event:"track",payload:e},n.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,n,t){return this._on(e,n,t)}async send(e,n={}){var t,r;if(!this._canPush()&&e.type==="broadcast"){const{event:s,payload:o}=e,l={method:"POST",headers:{apikey:(t=this.socket.apiKey)!==null&&t!==void 0?t:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:o}]})};try{return(await this._fetchWithTimeout(this.broadcastEndpointURL,l,(r=n.timeout)!==null&&r!==void 0?r:this.timeout)).ok?"ok":"error"}catch(a){return a.name==="AbortError"?"timed out":"error"}}else return new Promise(s=>{var o,l,a;const u=this._push(e.type,e,n.timeout||this.timeout);e.type==="broadcast"&&!(!((a=(l=(o=this.params)===null||o===void 0?void 0:o.config)===null||l===void 0?void 0:l.broadcast)===null||a===void 0)&&a.ack)&&s("ok"),u.receive("ok",()=>s("ok")),u.receive("error",()=>s("error")),u.receive("timeout",()=>s("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=le.leaving;const n=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(de.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(t=>{const r=new Kt(this,de.leave,{},e);r.receive("ok",()=>{n(),t("ok")}).receive("timeout",()=>{n(),t("timed out")}).receive("error",()=>{t("error")}),r.send(),this._canPush()||r.trigger("ok",{})})}_broadcastEndpointURL(){let e=this.socket.endPoint;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")+"/api/broadcast"}async _fetchWithTimeout(e,n,t){const r=new AbortController,s=setTimeout(()=>r.abort(),t),o=await this.socket.fetch(e,Object.assign(Object.assign({},n),{signal:r.signal}));return clearTimeout(s),o}_push(e,n,t=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let r=new Kt(this,e,n,t);return this._canPush()?r.send():(r.startTimeout(),this.pushBuffer.push(r)),r}_onMessage(e,n,t){return n}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,n,t){var r,s;const o=e.toLocaleLowerCase(),{close:l,error:a,leave:u,join:c}=de;if(t&&[l,a,u,c].indexOf(o)>=0&&t!==this._joinRef())return;let d=this._onMessage(o,n,t);if(n&&!d)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(r=this.bindings.postgres_changes)===null||r===void 0||r.filter(f=>{var p,g,$;return((p=f.filter)===null||p===void 0?void 0:p.event)==="*"||(($=(g=f.filter)===null||g===void 0?void 0:g.event)===null||$===void 0?void 0:$.toLocaleLowerCase())===o}).map(f=>f.callback(d,t)):(s=this.bindings[o])===null||s===void 0||s.filter(f=>{var p,g,$,A,T,j;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in f){const P=f.id,R=(p=f.filter)===null||p===void 0?void 0:p.event;return P&&((g=n.ids)===null||g===void 0?void 0:g.includes(P))&&(R==="*"||(R==null?void 0:R.toLocaleLowerCase())===(($=n.data)===null||$===void 0?void 0:$.type.toLocaleLowerCase()))}else{const P=(T=(A=f==null?void 0:f.filter)===null||A===void 0?void 0:A.event)===null||T===void 0?void 0:T.toLocaleLowerCase();return P==="*"||P===((j=n==null?void 0:n.event)===null||j===void 0?void 0:j.toLocaleLowerCase())}else return f.type.toLocaleLowerCase()===o}).map(f=>{if(typeof d=="object"&&"ids"in d){const p=d.data,{schema:g,table:$,commit_timestamp:A,type:T,errors:j}=p;d=Object.assign(Object.assign({},{schema:g,table:$,commit_timestamp:A,eventType:T,new:{},old:{},errors:j}),this._getPayloadRecords(p))}f.callback(d,t)})}_isClosed(){return this.state===le.closed}_isJoined(){return this.state===le.joined}_isJoining(){return this.state===le.joining}_isLeaving(){return this.state===le.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,n,t){const r=e.toLocaleLowerCase(),s={type:r,filter:n,callback:t};return this.bindings[r]?this.bindings[r].push(s):this.bindings[r]=[s],this}_off(e,n){const t=e.toLocaleLowerCase();return this.bindings[t]=this.bindings[t].filter(r=>{var s;return!(((s=r.type)===null||s===void 0?void 0:s.toLocaleLowerCase())===t&&pn.isEqual(r.filter,n))}),this}static isEqual(e,n){if(Object.keys(e).length!==Object.keys(n).length)return!1;for(const t in e)if(e[t]!==n[t])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(de.close,{},e)}_onError(e){this._on(de.error,{},n=>e(n))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=le.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const n={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(n.new=Hn(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(n.old=Hn(e.columns,e.old_record)),n}}const vi=()=>{},ki=typeof WebSocket<"u";class yi{constructor(e,n){var t;this.accessToken=null,this.apiKey=null,this.channels=[],this.endPoint="",this.headers=fi,this.params={},this.timeout=Wr,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=vi,this.conn=null,this.sendBuffer=[],this.serializer=new pi,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this._resolveFetch=s=>{let o;return s?o=s:typeof fetch>"u"?o=(...l)=>Ge(()=>Promise.resolve().then(()=>ft),void 0,import.meta.url).then(({default:a})=>a(...l)):o=fetch,(...l)=>o(...l)},this.endPoint=`${e}/${tn.websocket}`,n!=null&&n.transport?this.transport=n.transport:this.transport=null,n!=null&&n.params&&(this.params=n.params),n!=null&&n.headers&&(this.headers=Object.assign(Object.assign({},this.headers),n.headers)),n!=null&&n.timeout&&(this.timeout=n.timeout),n!=null&&n.logger&&(this.logger=n.logger),n!=null&&n.heartbeatIntervalMs&&(this.heartbeatIntervalMs=n.heartbeatIntervalMs);const r=(t=n==null?void 0:n.params)===null||t===void 0?void 0:t.apikey;r&&(this.accessToken=r,this.apiKey=r),this.reconnectAfterMs=n!=null&&n.reconnectAfterMs?n.reconnectAfterMs:s=>[1e3,2e3,5e3,1e4][s-1]||1e4,this.encode=n!=null&&n.encode?n.encode:(s,o)=>o(JSON.stringify(s)),this.decode=n!=null&&n.decode?n.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new Qr(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(n==null?void 0:n.fetch)}connect(){if(!this.conn){if(this.transport){this.conn=new this.transport(this._endPointURL(),void 0,{headers:this.headers});return}if(ki){this.conn=new WebSocket(this._endPointURL()),this.setupConnection();return}this.conn=new Ci(this._endPointURL(),void 0,{close:()=>{this.conn=null}}),Ge(()=>import("./browser-BImCA5dO.js").then(e=>e.b),[],import.meta.url).then(({default:e})=>{this.conn=new e(this._endPointURL(),void 0,{headers:this.headers}),this.setupConnection()})}}disconnect(e,n){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,n??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(e){const n=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),n}async removeAllChannels(){const e=await Promise.all(this.channels.map(n=>n.unsubscribe()));return this.disconnect(),e}log(e,n,t){this.logger(e,n,t)}connectionState(){switch(this.conn&&this.conn.readyState){case Je.connecting:return Ie.Connecting;case Je.open:return Ie.Open;case Je.closing:return Ie.Closing;default:return Ie.Closed}}isConnected(){return this.connectionState()===Ie.Open}channel(e,n={config:{}}){const t=new pn(`realtime:${e}`,n,this);return this.channels.push(t),t}push(e){const{topic:n,event:t,payload:r,ref:s}=e,o=()=>{this.encode(e,l=>{var a;(a=this.conn)===null||a===void 0||a.send(l)})};this.log("push",`${n} ${t} (${s})`,r),this.isConnected()?o():this.sendBuffer.push(o)}setAuth(e){this.accessToken=e,this.channels.forEach(n=>{e&&n.updateJoinPayload({access_token:e}),n.joinedOnce&&n._isJoined()&&n._push(de.access_token,{access_token:e})})}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let n=this.channels.find(t=>t.topic===e&&(t._isJoined()||t._isJoining()));n&&(this.log("transport",`leaving duplicate topic "${e}"`),n.unsubscribe())}_remove(e){this.channels=this.channels.filter(n=>n._joinRef()!==e._joinRef())}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_endPointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:hi}))}_onConnMessage(e){this.decode(e.data,n=>{let{topic:t,event:r,payload:s,ref:o}=n;(o&&o===this.pendingHeartbeatRef||r===(s==null?void 0:s.type))&&(this.pendingHeartbeatRef=null),this.log("receive",`${s.status||""} ${t} ${r} ${o&&"("+o+")"||""}`,s),this.channels.filter(l=>l._isMember(t)).forEach(l=>l._trigger(r,s,o)),this.stateChangeCallbacks.message.forEach(l=>l(n))})}_onConnOpen(){this.log("transport",`connected to ${this._endPointURL()}`),this._flushSendBuffer(),this.reconnectTimer.reset(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this._sendHeartbeat(),this.heartbeatIntervalMs),this.stateChangeCallbacks.open.forEach(e=>e())}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(n=>n(e))}_onConnError(e){this.log("transport",e.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(n=>n(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(de.error))}_appendParams(e,n){if(Object.keys(n).length===0)return e;const t=e.match(/\?/)?"&":"?",r=new URLSearchParams(n);return`${e}${t}${r}`}_flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(e=this.conn)===null||e===void 0||e.close(di,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth(this.accessToken)}}}class Ci{constructor(e,n,t){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=Je.connecting,this.send=()=>{},this.url=null,this.url=e,this.close=t.close}}class mn extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function oe(i){return typeof i=="object"&&i!==null&&"__isStorageError"in i}class Si extends mn{constructor(e,n){super(e),this.name="StorageApiError",this.status=n}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class Gn extends mn{constructor(e,n){super(e),this.name="StorageUnknownError",this.originalError=n}}var Ei=function(i,e,n,t){function r(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function l(c){try{u(t.next(c))}catch(h){o(h)}}function a(c){try{u(t.throw(c))}catch(h){o(h)}}function u(c){c.done?s(c.value):r(c.value).then(l,a)}u((t=t.apply(i,e||[])).next())})};const Xr=i=>{let e;return i?e=i:typeof fetch>"u"?e=(...n)=>Ge(()=>Promise.resolve().then(()=>ft),void 0,import.meta.url).then(({default:t})=>t(...n)):e=fetch,(...n)=>e(...n)},Oi=()=>Ei(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Ge(()=>Promise.resolve().then(()=>ft),void 0,import.meta.url)).Response:Response});var Xe=function(i,e,n,t){function r(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function l(c){try{u(t.next(c))}catch(h){o(h)}}function a(c){try{u(t.throw(c))}catch(h){o(h)}}function u(c){c.done?s(c.value):r(c.value).then(l,a)}u((t=t.apply(i,e||[])).next())})};const Gt=i=>i.msg||i.message||i.error_description||i.error||JSON.stringify(i),Ti=(i,e)=>Xe(void 0,void 0,void 0,function*(){const n=yield Oi();i instanceof n?i.json().then(t=>{e(new Si(Gt(t),i.status||500))}).catch(t=>{e(new Gn(Gt(t),t))}):e(new Gn(Gt(i),i))}),Ai=(i,e,n,t)=>{const r={method:i,headers:(e==null?void 0:e.headers)||{}};return i==="GET"?r:(r.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),r.body=JSON.stringify(t),Object.assign(Object.assign({},r),n))};function Tt(i,e,n,t,r,s){return Xe(this,void 0,void 0,function*(){return new Promise((o,l)=>{i(n,Ai(e,t,r,s)).then(a=>{if(!a.ok)throw a;return t!=null&&t.noResolveJson?a:a.json()}).then(a=>o(a)).catch(a=>Ti(a,l))})})}function rn(i,e,n,t){return Xe(this,void 0,void 0,function*(){return Tt(i,"GET",e,n,t)})}function ve(i,e,n,t,r){return Xe(this,void 0,void 0,function*(){return Tt(i,"POST",e,t,r,n)})}function ji(i,e,n,t,r){return Xe(this,void 0,void 0,function*(){return Tt(i,"PUT",e,t,r,n)})}function Zr(i,e,n,t,r){return Xe(this,void 0,void 0,function*(){return Tt(i,"DELETE",e,t,r,n)})}var ce=function(i,e,n,t){function r(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function l(c){try{u(t.next(c))}catch(h){o(h)}}function a(c){try{u(t.throw(c))}catch(h){o(h)}}function u(c){c.done?s(c.value):r(c.value).then(l,a)}u((t=t.apply(i,e||[])).next())})};const Pi={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Vn={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Ii{constructor(e,n={},t,r){this.url=e,this.headers=n,this.bucketId=t,this.fetch=Xr(r)}uploadOrUpdate(e,n,t,r){return ce(this,void 0,void 0,function*(){try{let s;const o=Object.assign(Object.assign({},Vn),r),l=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(o.upsert)});typeof Blob<"u"&&t instanceof Blob?(s=new FormData,s.append("cacheControl",o.cacheControl),s.append("",t)):typeof FormData<"u"&&t instanceof FormData?(s=t,s.append("cacheControl",o.cacheControl)):(s=t,l["cache-control"]=`max-age=${o.cacheControl}`,l["content-type"]=o.contentType);const a=this._removeEmptyFolders(n),u=this._getFinalPath(a),c=yield this.fetch(`${this.url}/object/${u}`,Object.assign({method:e,body:s,headers:l},o!=null&&o.duplex?{duplex:o.duplex}:{})),h=yield c.json();return c.ok?{data:{path:a,id:h.Id,fullPath:h.Key},error:null}:{data:null,error:h}}catch(s){if(oe(s))return{data:null,error:s};throw s}})}upload(e,n,t){return ce(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,n,t)})}uploadToSignedUrl(e,n,t,r){return ce(this,void 0,void 0,function*(){const s=this._removeEmptyFolders(e),o=this._getFinalPath(s),l=new URL(this.url+`/object/upload/sign/${o}`);l.searchParams.set("token",n);try{let a;const u=Object.assign({upsert:Vn.upsert},r),c=Object.assign(Object.assign({},this.headers),{"x-upsert":String(u.upsert)});typeof Blob<"u"&&t instanceof Blob?(a=new FormData,a.append("cacheControl",u.cacheControl),a.append("",t)):typeof FormData<"u"&&t instanceof FormData?(a=t,a.append("cacheControl",u.cacheControl)):(a=t,c["cache-control"]=`max-age=${u.cacheControl}`,c["content-type"]=u.contentType);const h=yield this.fetch(l.toString(),{method:"PUT",body:a,headers:c}),d=yield h.json();return h.ok?{data:{path:s,fullPath:d.Key},error:null}:{data:null,error:d}}catch(a){if(oe(a))return{data:null,error:a};throw a}})}createSignedUploadUrl(e){return ce(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e);const t=yield ve(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:this.headers}),r=new URL(this.url+t.url),s=r.searchParams.get("token");if(!s)throw new mn("No token returned by API");return{data:{signedUrl:r.toString(),path:e,token:s},error:null}}catch(n){if(oe(n))return{data:null,error:n};throw n}})}update(e,n,t){return ce(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,n,t)})}move(e,n){return ce(this,void 0,void 0,function*(){try{return{data:yield ve(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n},{headers:this.headers}),error:null}}catch(t){if(oe(t))return{data:null,error:t};throw t}})}copy(e,n){return ce(this,void 0,void 0,function*(){try{return{data:{path:(yield ve(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n},{headers:this.headers})).Key},error:null}}catch(t){if(oe(t))return{data:null,error:t};throw t}})}createSignedUrl(e,n,t){return ce(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e),s=yield ve(this.fetch,`${this.url}/object/sign/${r}`,Object.assign({expiresIn:n},t!=null&&t.transform?{transform:t.transform}:{}),{headers:this.headers});const o=t!=null&&t.download?`&download=${t.download===!0?"":t.download}`:"";return s={signedUrl:encodeURI(`${this.url}${s.signedURL}${o}`)},{data:s,error:null}}catch(r){if(oe(r))return{data:null,error:r};throw r}})}createSignedUrls(e,n,t){return ce(this,void 0,void 0,function*(){try{const r=yield ve(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:n,paths:e},{headers:this.headers}),s=t!=null&&t.download?`&download=${t.download===!0?"":t.download}`:"";return{data:r.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${s}`):null})),error:null}}catch(r){if(oe(r))return{data:null,error:r};throw r}})}download(e,n){return ce(this,void 0,void 0,function*(){const r=typeof(n==null?void 0:n.transform)<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString((n==null?void 0:n.transform)||{}),o=s?`?${s}`:"";try{const l=this._getFinalPath(e);return{data:yield(yield rn(this.fetch,`${this.url}/${r}/${l}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(l){if(oe(l))return{data:null,error:l};throw l}})}getPublicUrl(e,n){const t=this._getFinalPath(e),r=[],s=n!=null&&n.download?`download=${n.download===!0?"":n.download}`:"";s!==""&&r.push(s);const l=typeof(n==null?void 0:n.transform)<"u"?"render/image":"object",a=this.transformOptsToQueryString((n==null?void 0:n.transform)||{});a!==""&&r.push(a);let u=r.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${t}${u}`)}}}remove(e){return ce(this,void 0,void 0,function*(){try{return{data:yield Zr(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(n){if(oe(n))return{data:null,error:n};throw n}})}list(e,n,t){return ce(this,void 0,void 0,function*(){try{const r=Object.assign(Object.assign(Object.assign({},Pi),n),{prefix:e||""});return{data:yield ve(this.fetch,`${this.url}/object/list/${this.bucketId}`,r,{headers:this.headers},t),error:null}}catch(r){if(oe(r))return{data:null,error:r};throw r}})}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const n=[];return e.width&&n.push(`width=${e.width}`),e.height&&n.push(`height=${e.height}`),e.resize&&n.push(`resize=${e.resize}`),e.format&&n.push(`format=${e.format}`),e.quality&&n.push(`quality=${e.quality}`),n.join("&")}}const Ri="2.5.5",Li={"X-Client-Info":`storage-js/${Ri}`};var Ne=function(i,e,n,t){function r(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function l(c){try{u(t.next(c))}catch(h){o(h)}}function a(c){try{u(t.throw(c))}catch(h){o(h)}}function u(c){c.done?s(c.value):r(c.value).then(l,a)}u((t=t.apply(i,e||[])).next())})};class Di{constructor(e,n={},t){this.url=e,this.headers=Object.assign(Object.assign({},Li),n),this.fetch=Xr(t)}listBuckets(){return Ne(this,void 0,void 0,function*(){try{return{data:yield rn(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(oe(e))return{data:null,error:e};throw e}})}getBucket(e){return Ne(this,void 0,void 0,function*(){try{return{data:yield rn(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(n){if(oe(n))return{data:null,error:n};throw n}})}createBucket(e,n={public:!1}){return Ne(this,void 0,void 0,function*(){try{return{data:yield ve(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(t){if(oe(t))return{data:null,error:t};throw t}})}updateBucket(e,n){return Ne(this,void 0,void 0,function*(){try{return{data:yield ji(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(t){if(oe(t))return{data:null,error:t};throw t}})}emptyBucket(e){return Ne(this,void 0,void 0,function*(){try{return{data:yield ve(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(n){if(oe(n))return{data:null,error:n};throw n}})}deleteBucket(e){return Ne(this,void 0,void 0,function*(){try{return{data:yield Zr(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(n){if(oe(n))return{data:null,error:n};throw n}})}}class qi extends Di{constructor(e,n={},t){super(e,n,t)}from(e){return new Ii(this.url,this.headers,e,this.fetch)}}const Ui="2.43.4";let nt="";typeof Deno<"u"?nt="deno":typeof document<"u"?nt="web":typeof navigator<"u"&&navigator.product==="ReactNative"?nt="react-native":nt="node";const Ni={"X-Client-Info":`supabase-js-${nt}/${Ui}`},Bi={headers:Ni},Mi={schema:"public"},Fi={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Hi={};var zi=function(i,e,n,t){function r(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function l(c){try{u(t.next(c))}catch(h){o(h)}}function a(c){try{u(t.throw(c))}catch(h){o(h)}}function u(c){c.done?s(c.value):r(c.value).then(l,a)}u((t=t.apply(i,e||[])).next())})};const Ji=i=>{let e;return i?e=i:typeof fetch>"u"?e=hn:e=fetch,(...n)=>e(...n)},Ki=()=>typeof Headers>"u"?Vr:Headers,Gi=(i,e,n)=>{const t=Ji(n),r=Ki();return(s,o)=>zi(void 0,void 0,void 0,function*(){var l;const a=(l=yield e())!==null&&l!==void 0?l:i;let u=new r(o==null?void 0:o.headers);return u.has("apikey")||u.set("apikey",i),u.has("Authorization")||u.set("Authorization",`Bearer ${a}`),t(s,Object.assign(Object.assign({},o),{headers:u}))})};function Vi(i){return i.replace(/\/$/,"")}function Wi(i,e){const{db:n,auth:t,realtime:r,global:s}=i,{db:o,auth:l,realtime:a,global:u}=e;return{db:Object.assign(Object.assign({},o),n),auth:Object.assign(Object.assign({},l),t),realtime:Object.assign(Object.assign({},a),r),global:Object.assign(Object.assign({},u),s)}}const xr="2.64.2",Qi="http://localhost:9999",Yi="supabase.auth.token",Xi={"X-Client-Info":`gotrue-js/${xr}`},Wn=10,sn="X-Supabase-Api-Version",es={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}};function Zi(i){return Math.round(Date.now()/1e3)+i}function xi(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(i){const e=Math.random()*16|0;return(i=="x"?e:e&3|8).toString(16)})}const he=()=>typeof document<"u",Ae={tested:!1,writable:!1},it=()=>{if(!he())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Ae.tested)return Ae.writable;const i=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(i,i),globalThis.localStorage.removeItem(i),Ae.tested=!0,Ae.writable=!0}catch{Ae.tested=!0,Ae.writable=!1}return Ae.writable};function Vt(i){const e={},n=new URL(i);if(n.hash&&n.hash[0]==="#")try{new URLSearchParams(n.hash.substring(1)).forEach((r,s)=>{e[s]=r})}catch{}return n.searchParams.forEach((t,r)=>{e[r]=t}),e}const ts=i=>{let e;return i?e=i:typeof fetch>"u"?e=(...n)=>Ge(()=>Promise.resolve().then(()=>ft),void 0,import.meta.url).then(({default:t})=>t(...n)):e=fetch,(...n)=>e(...n)},eo=i=>typeof i=="object"&&i!==null&&"status"in i&&"ok"in i&&"json"in i&&typeof i.json=="function",ns=async(i,e,n)=>{await i.setItem(e,JSON.stringify(n))},gt=async(i,e)=>{const n=await i.getItem(e);if(!n)return null;try{return JSON.parse(n)}catch{return n}},Wt=async(i,e)=>{await i.removeItem(e)};function to(i){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let n="",t,r,s,o,l,a,u,c=0;for(i=i.replace("-","+").replace("_","/");c<i.length;)o=e.indexOf(i.charAt(c++)),l=e.indexOf(i.charAt(c++)),a=e.indexOf(i.charAt(c++)),u=e.indexOf(i.charAt(c++)),t=o<<2|l>>4,r=(l&15)<<4|a>>2,s=(a&3)<<6|u,n=n+String.fromCharCode(t),a!=64&&r!=0&&(n=n+String.fromCharCode(r)),u!=64&&s!=0&&(n=n+String.fromCharCode(s));return n}class At{constructor(){this.promise=new At.promiseConstructor((e,n)=>{this.resolve=e,this.reject=n})}}At.promiseConstructor=Promise;function Qn(i){const e=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}=?$|[a-z0-9_-]{2}(==)?$)$/i,n=i.split(".");if(n.length!==3)throw new Error("JWT is not valid: not a JWT structure");if(!e.test(n[1]))throw new Error("JWT is not valid: payload is not in base64url format");const t=n[1];return JSON.parse(to(t))}async function no(i){return await new Promise(e=>{setTimeout(()=>e(null),i)})}function ro(i,e){return new Promise((t,r)=>{(async()=>{for(let s=0;s<1/0;s++)try{const o=await i(s);if(!e(s,null,o)){t(o);return}}catch(o){if(!e(s,o)){r(o);return}}})()})}function so(i){return("0"+i.toString(16)).substr(-2)}function io(){const e=new Uint32Array(56);if(typeof crypto>"u"){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",t=n.length;let r="";for(let s=0;s<56;s++)r+=n.charAt(Math.floor(Math.random()*t));return r}return crypto.getRandomValues(e),Array.from(e,so).join("")}async function oo(i){const n=new TextEncoder().encode(i),t=await crypto.subtle.digest("SHA-256",n),r=new Uint8Array(t);return Array.from(r).map(s=>String.fromCharCode(s)).join("")}function ao(i){return btoa(i).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function lo(i){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),i;const n=await oo(i);return ao(n)}async function Be(i,e,n=!1){const t=io();let r=t;n&&(r+="/PASSWORD_RECOVERY"),await ns(i,`${e}-code-verifier`,r);const s=await lo(t);return[s,t===s?"plain":"s256"]}const uo=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function co(i){const e=i.headers.get(sn);if(!e||!e.match(uo))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}class _n extends Error{constructor(e,n,t){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=n,this.code=t}}function M(i){return typeof i=="object"&&i!==null&&"__isAuthError"in i}class fo extends _n{constructor(e,n,t){super(e,n,t),this.name="AuthApiError",this.status=n,this.code=t}}function ho(i){return M(i)&&i.name==="AuthApiError"}class rs extends _n{constructor(e,n){super(e),this.name="AuthUnknownError",this.originalError=n}}class De extends _n{constructor(e,n,t,r){super(e,t,r),this.name=n,this.status=t}}class je extends De{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}class Qt extends De{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class $t extends De{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class bt extends De{constructor(e,n=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Yn extends De{constructor(e,n=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class on extends De{constructor(e,n){super(e,"AuthRetryableFetchError",n,void 0)}}function Yt(i){return M(i)&&i.name==="AuthRetryableFetchError"}class Xn extends De{constructor(e,n,t){super(e,"AuthWeakPasswordError",n,"weak_password"),this.reasons=t}}var po=function(i,e){var n={};for(var t in i)Object.prototype.hasOwnProperty.call(i,t)&&e.indexOf(t)<0&&(n[t]=i[t]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,t=Object.getOwnPropertySymbols(i);r<t.length;r++)e.indexOf(t[r])<0&&Object.prototype.propertyIsEnumerable.call(i,t[r])&&(n[t[r]]=i[t[r]]);return n};const Pe=i=>i.msg||i.message||i.error_description||i.error||JSON.stringify(i),mo=[502,503,504];async function Zn(i){var e;if(!eo(i))throw new on(Pe(i),0);if(mo.includes(i.status))throw new on(Pe(i),i.status);let n;try{n=await i.json()}catch(s){throw new rs(Pe(s),s)}let t;const r=co(i);if(r&&r.getTime()>=es["2024-01-01"].timestamp&&typeof n=="object"&&n&&typeof n.code=="string"?t=n.code:typeof n=="object"&&n&&typeof n.error_code=="string"&&(t=n.error_code),t){if(t==="weak_password")throw new Xn(Pe(n),i.status,((e=n.weak_password)===null||e===void 0?void 0:e.reasons)||[])}else if(typeof n=="object"&&n&&typeof n.weak_password=="object"&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((s,o)=>s&&typeof o=="string",!0))throw new Xn(Pe(n),i.status,n.weak_password.reasons);throw new fo(Pe(n),i.status||500,t)}const _o=(i,e,n,t)=>{const r={method:i,headers:(e==null?void 0:e.headers)||{}};return i==="GET"?r:(r.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),r.body=JSON.stringify(t),Object.assign(Object.assign({},r),n))};async function H(i,e,n,t){var r;const s=Object.assign({},t==null?void 0:t.headers);s[sn]||(s[sn]=es["2024-01-01"].name),t!=null&&t.jwt&&(s.Authorization=`Bearer ${t.jwt}`);const o=(r=t==null?void 0:t.query)!==null&&r!==void 0?r:{};t!=null&&t.redirectTo&&(o.redirect_to=t.redirectTo);const l=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",a=await go(i,e,n+l,{headers:s,noResolveJson:t==null?void 0:t.noResolveJson},{},t==null?void 0:t.body);return t!=null&&t.xform?t==null?void 0:t.xform(a):{data:Object.assign({},a),error:null}}async function go(i,e,n,t,r,s){const o=_o(e,t,r,s);let l;try{l=await i(n,Object.assign({},o))}catch(a){throw console.error(a),new on(Pe(a),0)}if(l.ok||await Zn(l),t!=null&&t.noResolveJson)return l;try{return await l.json()}catch(a){await Zn(a)}}function we(i){var e;let n=null;vo(i)&&(n=Object.assign({},i),i.expires_at||(n.expires_at=Zi(i.expires_in)));const t=(e=i.user)!==null&&e!==void 0?e:i;return{data:{session:n,user:t},error:null}}function xn(i){const e=we(i);return!e.error&&i.weak_password&&typeof i.weak_password=="object"&&Array.isArray(i.weak_password.reasons)&&i.weak_password.reasons.length&&i.weak_password.message&&typeof i.weak_password.message=="string"&&i.weak_password.reasons.reduce((n,t)=>n&&typeof t=="string",!0)&&(e.data.weak_password=i.weak_password),e}function ke(i){var e;return{data:{user:(e=i.user)!==null&&e!==void 0?e:i},error:null}}function $o(i){return{data:i,error:null}}function bo(i){const{action_link:e,email_otp:n,hashed_token:t,redirect_to:r,verification_type:s}=i,o=po(i,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:e,email_otp:n,hashed_token:t,redirect_to:r,verification_type:s},a=Object.assign({},o);return{data:{properties:l,user:a},error:null}}function wo(i){return i}function vo(i){return i.access_token&&i.refresh_token&&i.expires_in}var ko=function(i,e){var n={};for(var t in i)Object.prototype.hasOwnProperty.call(i,t)&&e.indexOf(t)<0&&(n[t]=i[t]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,t=Object.getOwnPropertySymbols(i);r<t.length;r++)e.indexOf(t[r])<0&&Object.prototype.propertyIsEnumerable.call(i,t[r])&&(n[t[r]]=i[t[r]]);return n};class yo{constructor({url:e="",headers:n={},fetch:t}){this.url=e,this.headers=n,this.fetch=ts(t),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,n="global"){try{return await H(this.fetch,"POST",`${this.url}/logout?scope=${n}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(t){if(M(t))return{data:null,error:t};throw t}}async inviteUserByEmail(e,n={}){try{return await H(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:n.data},headers:this.headers,redirectTo:n.redirectTo,xform:ke})}catch(t){if(M(t))return{data:{user:null},error:t};throw t}}async generateLink(e){try{const{options:n}=e,t=ko(e,["options"]),r=Object.assign(Object.assign({},t),n);return"newEmail"in t&&(r.new_email=t==null?void 0:t.newEmail,delete r.newEmail),await H(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:r,headers:this.headers,xform:bo,redirectTo:n==null?void 0:n.redirectTo})}catch(n){if(M(n))return{data:{properties:null,user:null},error:n};throw n}}async createUser(e){try{return await H(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:ke})}catch(n){if(M(n))return{data:{user:null},error:n};throw n}}async listUsers(e){var n,t,r,s,o,l,a;try{const u={nextPage:null,lastPage:0,total:0},c=await H(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(t=(n=e==null?void 0:e.page)===null||n===void 0?void 0:n.toString())!==null&&t!==void 0?t:"",per_page:(s=(r=e==null?void 0:e.perPage)===null||r===void 0?void 0:r.toString())!==null&&s!==void 0?s:""},xform:wo});if(c.error)throw c.error;const h=await c.json(),d=(o=c.headers.get("x-total-count"))!==null&&o!==void 0?o:0,f=(a=(l=c.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&a!==void 0?a:[];return f.length>0&&(f.forEach(p=>{const g=parseInt(p.split(";")[0].split("=")[1].substring(0,1)),$=JSON.parse(p.split(";")[1].split("=")[1]);u[`${$}Page`]=g}),u.total=parseInt(d)),{data:Object.assign(Object.assign({},h),u),error:null}}catch(u){if(M(u))return{data:{users:[]},error:u};throw u}}async getUserById(e){try{return await H(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:ke})}catch(n){if(M(n))return{data:{user:null},error:n};throw n}}async updateUserById(e,n){try{return await H(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:n,headers:this.headers,xform:ke})}catch(t){if(M(t))return{data:{user:null},error:t};throw t}}async deleteUser(e,n=!1){try{return await H(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:n},xform:ke})}catch(t){if(M(t))return{data:{user:null},error:t};throw t}}async _listFactors(e){try{const{data:n,error:t}=await H(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:r=>({data:{factors:r},error:null})});return{data:n,error:t}}catch(n){if(M(n))return{data:null,error:n};throw n}}async _deleteFactor(e){try{return{data:await H(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(n){if(M(n))return{data:null,error:n};throw n}}}const Co={getItem:i=>it()?globalThis.localStorage.getItem(i):null,setItem:(i,e)=>{it()&&globalThis.localStorage.setItem(i,e)},removeItem:i=>{it()&&globalThis.localStorage.removeItem(i)}};function er(i={}){return{getItem:e=>i[e]||null,setItem:(e,n)=>{i[e]=n},removeItem:e=>{delete i[e]}}}function So(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Me={debug:!!(globalThis&&it()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class ss extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class Eo extends ss{}async function Oo(i,e,n){Me.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",i,e);const t=new globalThis.AbortController;return e>0&&setTimeout(()=>{t.abort(),Me.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",i)},e),await globalThis.navigator.locks.request(i,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:t.signal},async r=>{if(r){Me.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",i,r.name);try{return await n()}finally{Me.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",i,r.name)}}else{if(e===0)throw Me.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",i),new Eo(`Acquiring an exclusive Navigator LockManager lock "${i}" immediately failed`);if(Me.debug)try{const s=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(s,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}})}So();const To={url:Qi,storageKey:Yi,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Xi,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1},tt=30*1e3,tr=3;async function nr(i,e,n){return await n()}class lt{constructor(e){var n,t;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=lt.nextInstanceID,lt.nextInstanceID+=1,this.instanceID>0&&he()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const r=Object.assign(Object.assign({},To),e);if(this.logDebugMessages=!!r.debug,typeof r.debug=="function"&&(this.logger=r.debug),this.persistSession=r.persistSession,this.storageKey=r.storageKey,this.autoRefreshToken=r.autoRefreshToken,this.admin=new yo({url:r.url,headers:r.headers,fetch:r.fetch}),this.url=r.url,this.headers=r.headers,this.fetch=ts(r.fetch),this.lock=r.lock||nr,this.detectSessionInUrl=r.detectSessionInUrl,this.flowType=r.flowType,this.hasCustomAuthorizationHeader=r.hasCustomAuthorizationHeader,r.lock?this.lock=r.lock:he()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=Oo:this.lock=nr,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?r.storage?this.storage=r.storage:it()?this.storage=Co:(this.memoryStorage={},this.storage=er(this.memoryStorage)):(this.memoryStorage={},this.storage=er(this.memoryStorage)),he()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(s){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",s)}(t=this.broadcastChannel)===null||t===void 0||t.addEventListener("message",async s=>{this._debug("received broadcast notification from other tab or client",s),await this._notifyAllSubscribers(s.data.event,s.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${xr}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){try{const e=he()?await this._isPKCEFlow():!1;if(this._debug("#_initialize()","begin","is PKCE flow",e),e||this.detectSessionInUrl&&this._isImplicitGrantFlow()){const{data:n,error:t}=await this._getSessionFromURL(e);if(t)return this._debug("#_initialize()","error detecting session from URL",t),(t==null?void 0:t.message)==="Identity is already linked"||(t==null?void 0:t.message)==="Identity is already linked to another user"?{error:t}:(await this._removeSession(),{error:t});const{session:r,redirectType:s}=n;return this._debug("#_initialize()","detected session in URL",r,"redirect type",s),await this._saveSession(r),setTimeout(async()=>{s==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",r):await this._notifyAllSubscribers("SIGNED_IN",r)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(e){return M(e)?{error:e}:{error:new rs("Unexpected error during initialization",e)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var n,t,r;try{await this._removeSession();const s=await H(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(t=(n=e==null?void 0:e.options)===null||n===void 0?void 0:n.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:(r=e==null?void 0:e.options)===null||r===void 0?void 0:r.captchaToken}},xform:we}),{data:o,error:l}=s;if(l||!o)return{data:{user:null,session:null},error:l};const a=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",a)),{data:{user:u,session:a},error:null}}catch(s){if(M(s))return{data:{user:null,session:null},error:s};throw s}}async signUp(e){var n,t,r;try{await this._removeSession();let s;if("email"in e){const{email:c,password:h,options:d}=e;let f=null,p=null;this.flowType==="pkce"&&([f,p]=await Be(this.storage,this.storageKey)),s=await H(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:d==null?void 0:d.emailRedirectTo,body:{email:c,password:h,data:(n=d==null?void 0:d.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken},code_challenge:f,code_challenge_method:p},xform:we})}else if("phone"in e){const{phone:c,password:h,options:d}=e;s=await H(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:c,password:h,data:(t=d==null?void 0:d.data)!==null&&t!==void 0?t:{},channel:(r=d==null?void 0:d.channel)!==null&&r!==void 0?r:"sms",gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken}},xform:we})}else throw new $t("You must provide either an email or phone number and a password");const{data:o,error:l}=s;if(l||!o)return{data:{user:null,session:null},error:l};const a=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",a)),{data:{user:u,session:a},error:null}}catch(s){if(M(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithPassword(e){try{await this._removeSession();let n;if("email"in e){const{email:s,password:o,options:l}=e;n=await H(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:xn})}else if("phone"in e){const{phone:s,password:o,options:l}=e;n=await H(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:xn})}else throw new $t("You must provide either an email or phone number and a password");const{data:t,error:r}=n;return r?{data:{user:null,session:null},error:r}:!t||!t.session||!t.user?{data:{user:null,session:null},error:new Qt}:(t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),{data:Object.assign({user:t.user,session:t.session},t.weak_password?{weakPassword:t.weak_password}:null),error:r})}catch(n){if(M(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOAuth(e){var n,t,r,s;return await this._removeSession(),await this._handleProviderSignIn(e.provider,{redirectTo:(n=e.options)===null||n===void 0?void 0:n.redirectTo,scopes:(t=e.options)===null||t===void 0?void 0:t.scopes,queryParams:(r=e.options)===null||r===void 0?void 0:r.queryParams,skipBrowserRedirect:(s=e.options)===null||s===void 0?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async _exchangeCodeForSession(e){const n=await gt(this.storage,`${this.storageKey}-code-verifier`),[t,r]=(n??"").split("/"),{data:s,error:o}=await H(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:t},xform:we});return await Wt(this.storage,`${this.storageKey}-code-verifier`),o?{data:{user:null,session:null,redirectType:null},error:o}:!s||!s.session||!s.user?{data:{user:null,session:null,redirectType:null},error:new Qt}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign(Object.assign({},s),{redirectType:r??null}),error:o})}async signInWithIdToken(e){await this._removeSession();try{const{options:n,provider:t,token:r,access_token:s,nonce:o}=e,l=await H(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:t,id_token:r,access_token:s,nonce:o,gotrue_meta_security:{captcha_token:n==null?void 0:n.captchaToken}},xform:we}),{data:a,error:u}=l;return u?{data:{user:null,session:null},error:u}:!a||!a.session||!a.user?{data:{user:null,session:null},error:new Qt}:(a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),{data:a,error:u})}catch(n){if(M(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOtp(e){var n,t,r,s,o;try{if(await this._removeSession(),"email"in e){const{email:l,options:a}=e;let u=null,c=null;this.flowType==="pkce"&&([u,c]=await Be(this.storage,this.storageKey));const{error:h}=await H(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(n=a==null?void 0:a.data)!==null&&n!==void 0?n:{},create_user:(t=a==null?void 0:a.shouldCreateUser)!==null&&t!==void 0?t:!0,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken},code_challenge:u,code_challenge_method:c},redirectTo:a==null?void 0:a.emailRedirectTo});return{data:{user:null,session:null},error:h}}if("phone"in e){const{phone:l,options:a}=e,{data:u,error:c}=await H(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(r=a==null?void 0:a.data)!==null&&r!==void 0?r:{},create_user:(s=a==null?void 0:a.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken},channel:(o=a==null?void 0:a.channel)!==null&&o!==void 0?o:"sms"}});return{data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:c}}throw new $t("You must provide either an email or phone number.")}catch(l){if(M(l))return{data:{user:null,session:null},error:l};throw l}}async verifyOtp(e){var n,t;try{e.type!=="email_change"&&e.type!=="phone_change"&&await this._removeSession();let r,s;"options"in e&&(r=(n=e.options)===null||n===void 0?void 0:n.redirectTo,s=(t=e.options)===null||t===void 0?void 0:t.captchaToken);const{data:o,error:l}=await H(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:s}}),redirectTo:r,xform:we});if(l)throw l;if(!o)throw new Error("An error occurred on token verification.");const a=o.session,u=o.user;return a!=null&&a.access_token&&(await this._saveSession(a),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",a)),{data:{user:u,session:a},error:null}}catch(r){if(M(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithSSO(e){var n,t,r;try{await this._removeSession();let s=null,o=null;return this.flowType==="pkce"&&([s,o]=await Be(this.storage,this.storageKey)),await H(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(t=(n=e.options)===null||n===void 0?void 0:n.redirectTo)!==null&&t!==void 0?t:void 0}),!((r=e==null?void 0:e.options)===null||r===void 0)&&r.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:s,code_challenge_method:o}),headers:this.headers,xform:$o})}catch(s){if(M(s))return{data:null,error:s};throw s}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:n},error:t}=e;if(t)throw t;if(!n)throw new je;const{error:r}=await H(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:n.access_token});return{data:{user:null,session:null},error:r}})}catch(e){if(M(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{e.type!="email_change"&&e.type!="phone_change"&&await this._removeSession();const n=`${this.url}/resend`;if("email"in e){const{email:t,type:r,options:s}=e,{error:o}=await H(this.fetch,"POST",n,{headers:this.headers,body:{email:t,type:r,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},redirectTo:s==null?void 0:s.emailRedirectTo});return{data:{user:null,session:null},error:o}}else if("phone"in e){const{phone:t,type:r,options:s}=e,{data:o,error:l}=await H(this.fetch,"POST",n,{headers:this.headers,body:{phone:t,type:r,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}}});return{data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:l}}throw new $t("You must provide either an email or phone number and a type")}catch(n){if(M(n))return{data:{user:null,session:null},error:n};throw n}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async n=>n))}async _acquireLock(e,n){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const t=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),r=(async()=>(await t,await n()))();return this.pendingInLock.push((async()=>{try{await r}catch{}})()),r}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const t=n();for(this.pendingInLock.push((async()=>{try{await t}catch{}})()),await t;this.pendingInLock.length;){const r=[...this.pendingInLock];await Promise.all(r),this.pendingInLock.splice(0,r.length)}return await t}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const n=await this.__loadSession();return await e(n)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const n=await gt(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",n),n!==null&&(this._isValidSession(n)?e=n:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const t=e.expires_at?e.expires_at<=Date.now()/1e3:!1;if(this._debug("#__loadSession()",`session has${t?"":" not"} expired`,"expires_at",e.expires_at),!t){if(this.storage.isServer){const o=this.suppressGetSessionWarning;e=new Proxy(e,{get(a,u,c){return!o&&u==="user"&&console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and many not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),Reflect.get(a,u,c)}})}return{data:{session:e},error:null}}const{session:r,error:s}=await this._callRefreshToken(e.refresh_token);return s?{data:{session:null},error:s}:{data:{session:r},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await H(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:ke}):await this._useSession(async n=>{var t,r,s;const{data:o,error:l}=n;if(l)throw l;return!(!((t=o.session)===null||t===void 0)&&t.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new je}:await H(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(s=(r=o.session)===null||r===void 0?void 0:r.access_token)!==null&&s!==void 0?s:void 0,xform:ke})})}catch(n){if(M(n))return{data:{user:null},error:n};throw n}}async updateUser(e,n={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,n))}async _updateUser(e,n={}){try{return await this._useSession(async t=>{const{data:r,error:s}=t;if(s)throw s;if(!r.session)throw new je;const o=r.session;let l=null,a=null;this.flowType==="pkce"&&e.email!=null&&([l,a]=await Be(this.storage,this.storageKey));const{data:u,error:c}=await H(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:n==null?void 0:n.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:l,code_challenge_method:a}),jwt:o.access_token,xform:ke});if(c)throw c;return o.user=u.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}})}catch(t){if(M(t))return{data:{user:null},error:t};throw t}}_decodeJWT(e){return Qn(e)}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new je;const n=Date.now()/1e3;let t=n,r=!0,s=null;const o=Qn(e.access_token);if(o.exp&&(t=o.exp,r=t<=n),r){const{session:l,error:a}=await this._callRefreshToken(e.refresh_token);if(a)return{data:{user:null,session:null},error:a};if(!l)return{data:{user:null,session:null},error:null};s=l}else{const{data:l,error:a}=await this._getUser(e.access_token);if(a)throw a;s={access_token:e.access_token,refresh_token:e.refresh_token,user:l.user,token_type:"bearer",expires_in:t-n,expires_at:t},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return{data:{user:s.user,session:s},error:null}}catch(n){if(M(n))return{data:{session:null,user:null},error:n};throw n}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async n=>{var t;if(!e){const{data:o,error:l}=n;if(l)throw l;e=(t=o.session)!==null&&t!==void 0?t:void 0}if(!(e!=null&&e.refresh_token))throw new je;const{session:r,error:s}=await this._callRefreshToken(e.refresh_token);return s?{data:{user:null,session:null},error:s}:r?{data:{user:r.user,session:r},error:null}:{data:{user:null,session:null},error:null}})}catch(n){if(M(n))return{data:{user:null,session:null},error:n};throw n}}async _getSessionFromURL(e){try{if(!he())throw new bt("No browser detected.");if(this.flowType==="implicit"&&!this._isImplicitGrantFlow())throw new bt("Not a valid implicit grant flow url.");if(this.flowType=="pkce"&&!e)throw new Yn("Not a valid PKCE flow url.");const n=Vt(window.location.href);if(e){if(!n.code)throw new Yn("No code detected.");const{data:T,error:j}=await this._exchangeCodeForSession(n.code);if(j)throw j;const P=new URL(window.location.href);return P.searchParams.delete("code"),window.history.replaceState(window.history.state,"",P.toString()),{data:{session:T.session,redirectType:null},error:null}}if(n.error||n.error_description||n.error_code)throw new bt(n.error_description||"Error in URL with unspecified error_description",{error:n.error||"unspecified_error",code:n.error_code||"unspecified_code"});const{provider_token:t,provider_refresh_token:r,access_token:s,refresh_token:o,expires_in:l,expires_at:a,token_type:u}=n;if(!s||!l||!o||!u)throw new bt("No session defined in URL");const c=Math.round(Date.now()/1e3),h=parseInt(l);let d=c+h;a&&(d=parseInt(a));const f=d-c;f*1e3<=tt&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${f}s, should have been closer to ${h}s`);const p=d-h;c-p>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",p,d,c):c-p<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clok for skew",p,d,c);const{data:g,error:$}=await this._getUser(s);if($)throw $;const A={provider_token:t,provider_refresh_token:r,access_token:s,expires_in:h,expires_at:d,refresh_token:o,token_type:u,user:g.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:A,redirectType:n.type},error:null}}catch(n){if(M(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantFlow(){const e=Vt(window.location.href);return!!(he()&&(e.access_token||e.error_description))}async _isPKCEFlow(){const e=Vt(window.location.href),n=await gt(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&n)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async n=>{var t;const{data:r,error:s}=n;if(s)return{error:s};const o=(t=r.session)===null||t===void 0?void 0:t.access_token;if(o){const{error:l}=await this.admin.signOut(o,e);if(l&&!(ho(l)&&(l.status===404||l.status===401||l.status===403)))return{error:l}}return e!=="others"&&(await this._removeSession(),await Wt(this.storage,`${this.storageKey}-code-verifier`),await this._notifyAllSubscribers("SIGNED_OUT",null)),{error:null}})}onAuthStateChange(e){const n=xi(),t={id:n,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",n),this.stateChangeEmitters.delete(n)}};return this._debug("#onAuthStateChange()","registered callback with id",n),this.stateChangeEmitters.set(n,t),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(n)})))(),{data:{subscription:t}}}async _emitInitialSession(e){return await this._useSession(async n=>{var t,r;try{const{data:{session:s},error:o}=n;if(o)throw o;await((t=this.stateChangeEmitters.get(e))===null||t===void 0?void 0:t.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",e,"session",s)}catch(s){await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",s),console.error(s)}})}async resetPasswordForEmail(e,n={}){let t=null,r=null;this.flowType==="pkce"&&([t,r]=await Be(this.storage,this.storageKey,!0));try{return await H(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:t,code_challenge_method:r,gotrue_meta_security:{captcha_token:n.captchaToken}},headers:this.headers,redirectTo:n.redirectTo})}catch(s){if(M(s))return{data:null,error:s};throw s}}async getUserIdentities(){var e;try{const{data:n,error:t}=await this.getUser();if(t)throw t;return{data:{identities:(e=n.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(n){if(M(n))return{data:null,error:n};throw n}}async linkIdentity(e){var n;try{const{data:t,error:r}=await this._useSession(async s=>{var o,l,a,u,c;const{data:h,error:d}=s;if(d)throw d;const f=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(l=e.options)===null||l===void 0?void 0:l.scopes,queryParams:(a=e.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:!0});return await H(this.fetch,"GET",f,{headers:this.headers,jwt:(c=(u=h.session)===null||u===void 0?void 0:u.access_token)!==null&&c!==void 0?c:void 0})});if(r)throw r;return he()&&!(!((n=e.options)===null||n===void 0)&&n.skipBrowserRedirect)&&window.location.assign(t==null?void 0:t.url),{data:{provider:e.provider,url:t==null?void 0:t.url},error:null}}catch(t){if(M(t))return{data:{provider:e.provider,url:null},error:t};throw t}}async unlinkIdentity(e){try{return await this._useSession(async n=>{var t,r;const{data:s,error:o}=n;if(o)throw o;return await H(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(r=(t=s.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:void 0})})}catch(n){if(M(n))return{data:null,error:n};throw n}}async _refreshAccessToken(e){const n=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{const t=Date.now();return await ro(async r=>(r>0&&await no(200*Math.pow(2,r-1)),this._debug(n,"refreshing attempt",r),await H(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:we})),(r,s)=>{const o=200*Math.pow(2,r);return s&&Yt(s)&&Date.now()+o-t<tt})}catch(t){if(this._debug(n,"error",t),M(t))return{data:{session:null,user:null},error:t};throw t}finally{this._debug(n,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,n){const t=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:n.redirectTo,scopes:n.scopes,queryParams:n.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",n,"url",t),he()&&!n.skipBrowserRedirect&&window.location.assign(t),{data:{provider:e,url:t},error:null}}async _recoverAndRefresh(){var e;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const t=await gt(this.storage,this.storageKey);if(this._debug(n,"session from storage",t),!this._isValidSession(t)){this._debug(n,"session is not valid"),t!==null&&await this._removeSession();return}const r=Math.round(Date.now()/1e3),s=((e=t.expires_at)!==null&&e!==void 0?e:1/0)<r+Wn;if(this._debug(n,`session has${s?"":" not"} expired with margin of ${Wn}s`),s){if(this.autoRefreshToken&&t.refresh_token){const{error:o}=await this._callRefreshToken(t.refresh_token);o&&(console.error(o),Yt(o)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",t)}catch(t){this._debug(n,"error",t),console.error(t);return}finally{this._debug(n,"end")}}async _callRefreshToken(e){var n,t;if(!e)throw new je;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const r=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{this.refreshingDeferred=new At;const{data:s,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!s.session)throw new je;await this._saveSession(s.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",s.session);const l={session:s.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(s){if(this._debug(r,"error",s),M(s)){const o={session:null,error:s};return Yt(s)||(await this._removeSession(),await this._notifyAllSubscribers("SIGNED_OUT",null)),(n=this.refreshingDeferred)===null||n===void 0||n.resolve(o),o}throw(t=this.refreshingDeferred)===null||t===void 0||t.reject(s),s}finally{this.refreshingDeferred=null,this._debug(r,"end")}}async _notifyAllSubscribers(e,n,t=!0){const r=`#_notifyAllSubscribers(${e})`;this._debug(r,"begin",n,`broadcast = ${t}`);try{this.broadcastChannel&&t&&this.broadcastChannel.postMessage({event:e,session:n});const s=[],o=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(e,n)}catch(a){s.push(a)}});if(await Promise.all(o),s.length>0){for(let l=0;l<s.length;l+=1)console.error(s[l]);throw s[0]}}finally{this._debug(r,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await ns(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await Wt(this.storage,this.storageKey)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&he()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(n){console.error("removing visibilitychange callback failed",n)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),tt);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async n=>{const{data:{session:t}}=n;if(!t||!t.refresh_token||!t.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const r=Math.floor((t.expires_at*1e3-e)/tt);this._debug("#_autoRefreshTokenTick()",`access token expires in ${r} ticks, a tick lasts ${tt}ms, refresh threshold is ${tr} ticks`),r<=tr&&await this._callRefreshToken(t.refresh_token)})}catch(n){console.error("Auto refresh tick failed with error. This is likely a transient error.",n)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof ss)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!he()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const n=`#_onVisibilityChanged(${e})`;this._debug(n,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(n,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,n,t){const r=[`provider=${encodeURIComponent(n)}`];if(t!=null&&t.redirectTo&&r.push(`redirect_to=${encodeURIComponent(t.redirectTo)}`),t!=null&&t.scopes&&r.push(`scopes=${encodeURIComponent(t.scopes)}`),this.flowType==="pkce"){const[s,o]=await Be(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(s)}`,code_challenge_method:`${encodeURIComponent(o)}`});r.push(l.toString())}if(t!=null&&t.queryParams){const s=new URLSearchParams(t.queryParams);r.push(s.toString())}return t!=null&&t.skipBrowserRedirect&&r.push(`skip_http_redirect=${t.skipBrowserRedirect}`),`${e}?${r.join("&")}`}async _unenroll(e){try{return await this._useSession(async n=>{var t;const{data:r,error:s}=n;return s?{data:null,error:s}:await H(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(t=r==null?void 0:r.session)===null||t===void 0?void 0:t.access_token})})}catch(n){if(M(n))return{data:null,error:n};throw n}}async _enroll(e){try{return await this._useSession(async n=>{var t,r;const{data:s,error:o}=n;if(o)return{data:null,error:o};const{data:l,error:a}=await H(this.fetch,"POST",`${this.url}/factors`,{body:{friendly_name:e.friendlyName,factor_type:e.factorType,issuer:e.issuer},headers:this.headers,jwt:(t=s==null?void 0:s.session)===null||t===void 0?void 0:t.access_token});return a?{data:null,error:a}:(!((r=l==null?void 0:l.totp)===null||r===void 0)&&r.qr_code&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})})}catch(n){if(M(n))return{data:null,error:n};throw n}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var t;const{data:r,error:s}=n;if(s)return{data:null,error:s};const{data:o,error:l}=await H(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(t=r==null?void 0:r.session)===null||t===void 0?void 0:t.access_token});return l?{data:null,error:l}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:l})})}catch(n){if(M(n))return{data:null,error:n};throw n}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var t;const{data:r,error:s}=n;return s?{data:null,error:s}:await H(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{headers:this.headers,jwt:(t=r==null?void 0:r.session)===null||t===void 0?void 0:t.access_token})})}catch(n){if(M(n))return{data:null,error:n};throw n}})}async _challengeAndVerify(e){const{data:n,error:t}=await this._challenge({factorId:e.factorId});return t?{data:null,error:t}:await this._verify({factorId:e.factorId,challengeId:n.id,code:e.code})}async _listFactors(){const{data:{user:e},error:n}=await this.getUser();if(n)return{data:null,error:n};const t=(e==null?void 0:e.factors)||[],r=t.filter(s=>s.factor_type==="totp"&&s.status==="verified");return{data:{all:t,totp:r},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var n,t;const{data:{session:r},error:s}=e;if(s)return{data:null,error:s};if(!r)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const o=this._decodeJWT(r.access_token);let l=null;o.aal&&(l=o.aal);let a=l;((t=(n=r.user.factors)===null||n===void 0?void 0:n.filter(h=>h.status==="verified"))!==null&&t!==void 0?t:[]).length>0&&(a="aal2");const c=o.amr||[];return{data:{currentLevel:l,nextLevel:a,currentAuthenticationMethods:c},error:null}}))}}lt.nextInstanceID=0;const Ao=lt;class jo extends Ao{constructor(e){super(e)}}var Po=function(i,e,n,t){function r(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function l(c){try{u(t.next(c))}catch(h){o(h)}}function a(c){try{u(t.throw(c))}catch(h){o(h)}}function u(c){c.done?s(c.value):r(c.value).then(l,a)}u((t=t.apply(i,e||[])).next())})};class Io{constructor(e,n,t){var r,s,o;if(this.supabaseUrl=e,this.supabaseKey=n,!e)throw new Error("supabaseUrl is required.");if(!n)throw new Error("supabaseKey is required.");const l=Vi(e);this.realtimeUrl=`${l}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${l}/auth/v1`,this.storageUrl=`${l}/storage/v1`,this.functionsUrl=`${l}/functions/v1`;const a=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,u={db:Mi,realtime:Hi,auth:Object.assign(Object.assign({},Fi),{storageKey:a}),global:Bi},c=Wi(t??{},u);this.storageKey=(r=c.auth.storageKey)!==null&&r!==void 0?r:"",this.headers=(s=c.global.headers)!==null&&s!==void 0?s:{},this.auth=this._initSupabaseAuthClient((o=c.auth)!==null&&o!==void 0?o:{},this.headers,c.global.fetch),this.fetch=Gi(n,this._getAccessToken.bind(this),c.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers},c.realtime)),this.rest=new dn(`${l}/rest/v1`,{headers:this.headers,schema:c.db.schema,fetch:this.fetch}),this._listenForAuthEvents()}get functions(){return new xs(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new qi(this.storageUrl,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,n={},t={}){return this.rest.rpc(e,n,t)}channel(e,n={config:{}}){return this.realtime.channel(e,n)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,n;return Po(this,void 0,void 0,function*(){const{data:t}=yield this.auth.getSession();return(n=(e=t.session)===null||e===void 0?void 0:e.access_token)!==null&&n!==void 0?n:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:n,detectSessionInUrl:t,storage:r,storageKey:s,flowType:o,debug:l},a,u){var c;const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new jo({url:this.authUrl,headers:Object.assign(Object.assign({},h),a),storageKey:s,autoRefreshToken:e,persistSession:n,detectSessionInUrl:t,storage:r,flowType:o,debug:l,fetch:u,hasCustomAuthorizationHeader:(c="Authorization"in this.headers)!==null&&c!==void 0?c:!1})}_initRealtimeClient(e){return new yi(this.realtimeUrl,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((n,t)=>{this._handleTokenChanged(n,"CLIENT",t==null?void 0:t.access_token)})}_handleTokenChanged(e,n,t){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==t?(this.realtime.setAuth(t??null),this.changedAccessToken=t):e==="SIGNED_OUT"&&(this.realtime.setAuth(this.supabaseKey),n=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const is=(i,e,n)=>new Io(i,e,n),os="supabase-config",Ro=()=>{const i=localStorage.getItem(os);if(!i)return null;const e=JSON.parse(i);return is(e.supabaseUrl,e.supabaseKey)};let X=Ro();const Lo=i=>{X=is(i.supabaseUrl,i.supabaseKey),localStorage.setItem(os,JSON.stringify(i))},vt=Ot(null);function Do(i){let e,n,t,r;const s=i[2].default,o=Se(s,i,i[1],null);return{c(){e=O("button"),o&&o.c(),S(e,"class","text-blue-600 hover:text-blue-700")},m(l,a){C(l,e,a),o&&o.m(e,null),n=!0,t||(r=Ye(e,"click",function(){Qe(i[0])&&i[0].apply(this,arguments)}),t=!0)},p(l,[a]){i=l,o&&o.p&&(!n||a&2)&&Oe(o,s,i,i[1],n?Ee(s,i[1],a,null):Te(i[1]),null)},i(l){n||(m(o,l),n=!0)},o(l){_(o,l),n=!1},d(l){l&&y(e),o&&o.d(l),t=!1,r()}}}function qo(i,e,n){let{$$slots:t={},$$scope:r}=e,{onClick:s}=e;return i.$$set=o=>{"onClick"in o&&n(0,s=o.onClick),"$$scope"in o&&n(1,r=o.$$scope)},[s,r,t]}class me extends q{constructor(e){super(),D(this,e,qo,Do,L,{onClick:0})}}function Uo(i){let e,n;return{c(){e=Z("svg"),n=Z("path"),S(n,"stroke-linecap","round"),S(n,"stroke-linejoin","round"),S(n,"d","m2.25 12 8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25"),S(e,"xmlns","http://www.w3.org/2000/svg"),S(e,"fill","none"),S(e,"viewBox","0 0 24 24"),S(e,"stroke-width","1.5"),S(e,"stroke","currentColor"),S(e,"class","size-6 hover:stroke-2")},m(t,r){C(t,e,r),b(e,n)},p:I,d(t){t&&y(e)}}}function No(i){let e,n;return e=new me({props:{onClick:i[0],$$slots:{default:[Uo]},$$scope:{ctx:i}}}),{c(){k(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p(t,[r]){const s={};r&1&&(s.onClick=t[0]),r&2&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function Bo(i,e,n){let{onClick:t}=e;return i.$$set=r=>{"onClick"in r&&n(0,t=r.onClick)},[t]}class Mo extends q{constructor(e){super(),D(this,e,Bo,No,L,{onClick:0})}}function Fo(i){let e,n;return{c(){e=Z("svg"),n=Z("path"),S(n,"stroke-linecap","round"),S(n,"stroke-linejoin","round"),S(n,"d","m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"),S(e,"xmlns","http://www.w3.org/2000/svg"),S(e,"fill","none"),S(e,"viewBox","0 0 24 24"),S(e,"stroke-width","1.5"),S(e,"stroke","currentColor"),S(e,"class","size-6 hover:stroke-2")},m(t,r){C(t,e,r),b(e,n)},p:I,d(t){t&&y(e)}}}function Ho(i){let e,n;return e=new me({props:{onClick:i[0],$$slots:{default:[Fo]},$$scope:{ctx:i}}}),{c(){k(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p(t,[r]){const s={};r&1&&(s.onClick=t[0]),r&2&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function zo(i,e,n){let{onClick:t}=e;return i.$$set=r=>{"onClick"in r&&n(0,t=r.onClick)},[t]}class Jo extends q{constructor(e){super(),D(this,e,zo,Ho,L,{onClick:0})}}function Ko(i){let e,n;return{c(){e=Z("svg"),n=Z("path"),S(n,"stroke-linecap","round"),S(n,"stroke-linejoin","round"),S(n,"d","M12 6.042A8.967 8.967 0 0 0 6 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 0 1 6 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 0 1 6-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0 0 18 18a8.967 8.967 0 0 0-6 2.292m0-14.25v14.25"),S(e,"xmlns","http://www.w3.org/2000/svg"),S(e,"fill","none"),S(e,"viewBox","0 0 24 24"),S(e,"stroke-width","1.5"),S(e,"stroke","currentColor"),S(e,"class","size-6 hover:stroke-2")},m(t,r){C(t,e,r),b(e,n)},p:I,d(t){t&&y(e)}}}function Go(i){let e,n;return e=new me({props:{onClick:i[0],$$slots:{default:[Ko]},$$scope:{ctx:i}}}),{c(){k(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p(t,[r]){const s={};r&1&&(s.onClick=t[0]),r&2&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function Vo(i,e,n){let{onClick:t}=e;return i.$$set=r=>{"onClick"in r&&n(0,t=r.onClick)},[t]}class Wo extends q{constructor(e){super(),D(this,e,Vo,Go,L,{onClick:0})}}function Qo(i){let e,n;return{c(){e=Z("svg"),n=Z("path"),S(n,"stroke-linecap","round"),S(n,"stroke-linejoin","round"),S(n,"d","M6 6.878V6a2.25 2.25 0 0 1 2.25-2.25h7.5A2.25 2.25 0 0 1 18 6v.878m-12 0c.235-.083.487-.128.75-.128h10.5c.263 0 .515.045.75.128m-12 0A2.25 2.25 0 0 0 4.5 9v.878m13.5-3A2.25 2.25 0 0 1 19.5 9v.878m0 0a2.246 2.246 0 0 0-.75-.128H5.25c-.263 0-.515.045-.75.128m15 0A2.25 2.25 0 0 1 21 12v6a2.25 2.25 0 0 1-2.25 2.25H5.25A2.25 2.25 0 0 1 3 18v-6c0-.98.626-1.813 1.5-2.122"),S(e,"xmlns","http://www.w3.org/2000/svg"),S(e,"fill","none"),S(e,"viewBox","0 0 24 24"),S(e,"stroke-width","1.5"),S(e,"stroke","currentColor"),S(e,"class","size-6 hover:stroke-2")},m(t,r){C(t,e,r),b(e,n)},p:I,d(t){t&&y(e)}}}function Yo(i){let e,n;return e=new me({props:{onClick:i[0],$$slots:{default:[Qo]},$$scope:{ctx:i}}}),{c(){k(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p(t,[r]){const s={};r&1&&(s.onClick=t[0]),r&2&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function Xo(i,e,n){let{onClick:t}=e;return i.$$set=r=>{"onClick"in r&&n(0,t=r.onClick)},[t]}class Zo extends q{constructor(e){super(),D(this,e,Xo,Yo,L,{onClick:0})}}function xo(i){let e,n;return{c(){e=Z("svg"),n=Z("path"),S(n,"stroke-linecap","round"),S(n,"stroke-linejoin","round"),S(n,"d","M15.75 9V5.25A2.25 2.25 0 0 0 13.5 3h-6a2.25 2.25 0 0 0-2.25 2.25v13.5A2.25 2.25 0 0 0 7.5 21h6a2.25 2.25 0 0 0 2.25-2.25V15m3 0 3-3m0 0-3-3m3 3H9"),S(e,"xmlns","http://www.w3.org/2000/svg"),S(e,"fill","none"),S(e,"viewBox","0 0 24 24"),S(e,"stroke-width","1.5"),S(e,"stroke","currentColor"),S(e,"class","size-6 hover:stroke-2")},m(t,r){C(t,e,r),b(e,n)},p:I,d(t){t&&y(e)}}}function ea(i){let e,n;return e=new me({props:{onClick:i[0],$$slots:{default:[xo]},$$scope:{ctx:i}}}),{c(){k(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p(t,[r]){const s={};r&1&&(s.onClick=t[0]),r&2&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function ta(i,e,n){let{onClick:t}=e;return i.$$set=r=>{"onClick"in r&&n(0,t=r.onClick)},[t]}class na extends q{constructor(e){super(),D(this,e,ta,ea,L,{onClick:0})}}function ra(i){let e,n;return{c(){e=Z("svg"),n=Z("path"),S(n,"stroke-linecap","round"),S(n,"stroke-linejoin","round"),S(n,"d","M15.75 6a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0ZM4.501 20.118a7.5 7.5 0 0 1 14.998 0A17.933 17.933 0 0 1 12 21.75c-2.676 0-5.216-.584-7.499-1.632Z"),S(e,"xmlns","http://www.w3.org/2000/svg"),S(e,"fill","none"),S(e,"viewBox","0 0 24 24"),S(e,"stroke-width","1.5"),S(e,"stroke","currentColor"),S(e,"class","size-6 hover:stroke-2")},m(t,r){C(t,e,r),b(e,n)},p:I,d(t){t&&y(e)}}}function sa(i){let e,n;return e=new me({props:{onClick:i[0],$$slots:{default:[ra]},$$scope:{ctx:i}}}),{c(){k(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p(t,[r]){const s={};r&1&&(s.onClick=t[0]),r&2&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function ia(i,e,n){let{onClick:t}=e;return i.$$set=r=>{"onClick"in r&&n(0,t=r.onClick)},[t]}class oa extends q{constructor(e){super(),D(this,e,ia,sa,L,{onClick:0})}}function aa(i){let e,n;return{c(){e=Z("svg"),n=Z("path"),S(n,"stroke-linecap","round"),S(n,"stroke-linejoin","round"),S(n,"d","m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"),S(e,"xmlns","http://www.w3.org/2000/svg"),S(e,"fill","none"),S(e,"viewBox","0 0 24 24"),S(e,"stroke-width","1.5"),S(e,"stroke","currentColor"),S(e,"class","size-6 hover:stroke-2")},m(t,r){C(t,e,r),b(e,n)},p:I,d(t){t&&y(e)}}}function la(i){let e,n;return e=new me({props:{onClick:i[0],$$slots:{default:[aa]},$$scope:{ctx:i}}}),{c(){k(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p(t,[r]){const s={};r&1&&(s.onClick=t[0]),r&2&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function ua(i,e,n){let{onClick:t}=e;return i.$$set=r=>{"onClick"in r&&n(0,t=r.onClick)},[t]}class ca extends q{constructor(e){super(),D(this,e,ua,la,L,{onClick:0})}}function fa(i){let e,n,t,r,s,o,l,a,u,c,h,d,f,p,g;return n=new Mo({props:{onClick:i[1]}}),r=new Wo({props:{onClick:i[2]}}),o=new ca({props:{onClick:i[3]}}),a=new Zo({props:{onClick:i[4]}}),c=new Jo({props:{onClick:i[5]}}),d=new oa({props:{onClick:i[6]}}),p=new na({props:{onClick:i[0]}}),{c(){e=O("nav"),k(n.$$.fragment),t=E(),k(r.$$.fragment),s=E(),k(o.$$.fragment),l=E(),k(a.$$.fragment),u=E(),k(c.$$.fragment),h=E(),k(d.$$.fragment),f=E(),k(p.$$.fragment),S(e,"class","flex justify-end items-center gap-2 mb-4")},m($,A){C($,e,A),w(n,e,null),b(e,t),w(r,e,null),b(e,s),w(o,e,null),b(e,l),w(a,e,null),b(e,u),w(c,e,null),b(e,h),w(d,e,null),b(e,f),w(p,e,null),g=!0},p($,[A]){const T={};A&1&&(T.onClick=$[0]),p.$set(T)},i($){g||(m(n.$$.fragment,$),m(r.$$.fragment,$),m(o.$$.fragment,$),m(a.$$.fragment,$),m(c.$$.fragment,$),m(d.$$.fragment,$),m(p.$$.fragment,$),g=!0)},o($){_(n.$$.fragment,$),_(r.$$.fragment,$),_(o.$$.fragment,$),_(a.$$.fragment,$),_(c.$$.fragment,$),_(d.$$.fragment,$),_(p.$$.fragment,$),g=!1},d($){$&&y(e),v(n),v(r),v(o),v(a),v(c),v(d),v(p)}}}function ha(i,e,n){let{onLogout:t}=e;const r=()=>z("/"),s=()=>z("/books/list"),o=()=>z("/info"),l=()=>z("/cache"),a=()=>z("/search"),u=()=>z("/user");return i.$$set=c=>{"onLogout"in c&&n(0,t=c.onLogout)},[t,r,s,o,l,a,u]}class da extends q{constructor(e){super(),D(this,e,ha,fa,L,{onLogout:0})}}const ae=i=>new Date(i).toLocaleString(),ue=i=>i?"":"Please enter a value!",pa=(i,e)=>Math.floor(Math.random()*(e-i+1)+i),ma=i=>{for(let e=0;e<i.length;e++){const n=pa(0,i.length-1);if(e===n)continue;const t=i[e];i[e]=i[n],i[n]=t}},as=i=>(i=i.trim(),i||null);function _a(i){let e,n,t,r;const s=i[2].default,o=Se(s,i,i[1],null);return{c(){e=O("form"),o&&o.c(),S(e,"class","flex flex-col gap-5 max-w-md")},m(l,a){C(l,e,a),o&&o.m(e,null),n=!0,t||(r=Ye(e,"submit",ps(function(){Qe(i[0])&&i[0].apply(this,arguments)})),t=!0)},p(l,[a]){i=l,o&&o.p&&(!n||a&2)&&Oe(o,s,i,i[1],n?Ee(s,i[1],a,null):Te(i[1]),null)},i(l){n||(m(o,l),n=!0)},o(l){_(o,l),n=!1},d(l){l&&y(e),o&&o.d(l),t=!1,r()}}}function ga(i,e,n){let{$$slots:t={},$$scope:r}=e,{onSubmit:s}=e;return i.$$set=o=>{"onSubmit"in o&&n(0,s=o.onSubmit),"$$scope"in o&&n(1,r=o.$$scope)},[s,r,t]}class ge extends q{constructor(e){super(),D(this,e,ga,_a,L,{onSubmit:0})}}function rr(i){let e,n;return{c(){e=O("p"),n=N(i[2]),S(e,"class","text-red-600 text-sm mt-1")},m(t,r){C(t,e,r),b(e,n)},p(t,r){r&4&&B(n,t[2])},d(t){t&&y(e)}}}function $a(i){let e,n,t,r,s,o;const l=i[4].default,a=Se(l,i,i[3],null);let u=i[2]&&rr(i);return{c(){e=O("div"),n=O("label"),t=N(i[1]),r=E(),a&&a.c(),s=E(),u&&u.c(),S(n,"class","block text-gray-700 text-sm font-bold mb-2"),S(n,"for",i[0])},m(c,h){C(c,e,h),b(e,n),b(n,t),b(e,r),a&&a.m(e,null),b(e,s),u&&u.m(e,null),o=!0},p(c,[h]){(!o||h&2)&&B(t,c[1]),(!o||h&1)&&S(n,"for",c[0]),a&&a.p&&(!o||h&8)&&Oe(a,l,c,c[3],o?Ee(l,c[3],h,null):Te(c[3]),null),c[2]?u?u.p(c,h):(u=rr(c),u.c(),u.m(e,null)):u&&(u.d(1),u=null)},i(c){o||(m(a,c),o=!0)},o(c){_(a,c),o=!1},d(c){c&&y(e),a&&a.d(c),u&&u.d()}}}function ba(i,e,n){let{$$slots:t={},$$scope:r}=e,{id:s}=e,{label:o}=e,{error:l}=e;return i.$$set=a=>{"id"in a&&n(0,s=a.id),"label"in a&&n(1,o=a.label),"error"in a&&n(2,l=a.error),"$$scope"in a&&n(3,r=a.$$scope)},[s,o,l,r,t]}class gn extends q{constructor(e){super(),D(this,e,ba,$a,L,{id:0,label:1,error:2})}}function wa(i){let e,n,t;return{c(){e=O("input"),S(e,"class","input"),S(e,"id",i[2])},m(r,s){C(r,e,s),Ke(e,i[0]),n||(t=Ye(e,"input",i[4]),n=!0)},p(r,s){s&4&&S(e,"id",r[2]),s&1&&e.value!==r[0]&&Ke(e,r[0])},d(r){r&&y(e),n=!1,t()}}}function va(i){let e,n;return e=new gn({props:{id:i[2],label:i[1],error:i[3],$$slots:{default:[wa]},$$scope:{ctx:i}}}),{c(){k(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p(t,[r]){const s={};r&4&&(s.id=t[2]),r&2&&(s.label=t[1]),r&8&&(s.error=t[3]),r&37&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function ka(i,e,n){let{label:t}=e,{id:r}=e,{value:s}=e,{error:o=""}=e;function l(){s=this.value,n(0,s)}return i.$$set=a=>{"label"in a&&n(1,t=a.label),"id"in a&&n(2,r=a.id),"value"in a&&n(0,s=a.value),"error"in a&&n(3,o=a.error)},[s,t,r,o,l]}class Ce extends q{constructor(e){super(),D(this,e,ka,va,L,{label:1,id:2,value:0,error:3})}}function ya(i){let e,n;return e=new F({props:{label:"Save"}}),{c(){k(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p:I,i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function Ca(i){let e,n,t,r,s,o,l,a;function u(f){i[6](f)}let c={id:"url",label:"Supabase URL",error:i[1]};i[0]!==void 0&&(c.value=i[0]),e=new Ce({props:c}),ee.push(()=>ne(e,"value",u));function h(f){i[7](f)}let d={id:"key",label:"Supabase key",error:i[3]};return i[2]!==void 0&&(d.value=i[2]),r=new Ce({props:d}),ee.push(()=>ne(r,"value",h)),l=new Q({props:{$$slots:{default:[ya]},$$scope:{ctx:i}}}),{c(){k(e.$$.fragment),t=E(),k(r.$$.fragment),o=E(),k(l.$$.fragment)},m(f,p){w(e,f,p),C(f,t,p),w(r,f,p),C(f,o,p),w(l,f,p),a=!0},p(f,p){const g={};p&2&&(g.error=f[1]),!n&&p&1&&(n=!0,g.value=f[0],te(()=>n=!1)),e.$set(g);const $={};p&8&&($.error=f[3]),!s&&p&4&&(s=!0,$.value=f[2],te(()=>s=!1)),r.$set($);const A={};p&256&&(A.$$scope={dirty:p,ctx:f}),l.$set(A)},i(f){a||(m(e.$$.fragment,f),m(r.$$.fragment,f),m(l.$$.fragment,f),a=!0)},o(f){_(e.$$.fragment,f),_(r.$$.fragment,f),_(l.$$.fragment,f),a=!1},d(f){f&&(y(t),y(o)),v(e,f),v(r,f),v(l,f)}}}function Sa(i){let e,n;return e=new ge({props:{onSubmit:i[4],$$slots:{default:[Ca]},$$scope:{ctx:i}}}),{c(){k(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p(t,[r]){const s={};r&271&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function Ea(i,e,n){let{onConfig:t}=e,r="",s="",o="",l="";const a=()=>{n(1,s=ue(r)),n(3,l=ue(o)),!(s||l)&&t({supabaseUrl:r,supabaseKey:o})};function u(h){r=h,n(0,r)}function c(h){o=h,n(2,o)}return i.$$set=h=>{"onConfig"in h&&n(5,t=h.onConfig)},[r,s,o,l,a,t,u,c]}class Oa extends q{constructor(e){super(),D(this,e,Ea,Sa,L,{onConfig:5})}}function Ta(i){let e,n;return e=new ge({props:{onSubmit:i[4],$$slots:{default:[Pa]},$$scope:{ctx:i}}}),{c(){k(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p(t,r){const s={};r&71&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function Aa(i){let e,n,t;return{c(){e=O("div"),e.textContent="Magic link was successfully send!",n=E(),t=O("div"),t.textContent="Please check your E-Mail"},m(r,s){C(r,e,s),C(r,n,s),C(r,t,s)},p:I,i:I,o:I,d(r){r&&(y(e),y(n),y(t))}}}function ja(i){let e,n;return e=new F({props:{disabled:i[2],label:"Magic Link"}}),{c(){k(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p(t,r){const s={};r&4&&(s.disabled=t[2]),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function Pa(i){let e,n,t,r,s;function o(a){i[5](a)}let l={id:"email",label:"E-Mail",error:i[1]};return i[0]!==void 0&&(l.value=i[0]),e=new Ce({props:l}),ee.push(()=>ne(e,"value",o)),r=new Q({props:{$$slots:{default:[ja]},$$scope:{ctx:i}}}),{c(){k(e.$$.fragment),t=E(),k(r.$$.fragment)},m(a,u){w(e,a,u),C(a,t,u),w(r,a,u),s=!0},p(a,u){const c={};u&2&&(c.error=a[1]),!n&&u&1&&(n=!0,c.value=a[0],te(()=>n=!1)),e.$set(c);const h={};u&68&&(h.$$scope={dirty:u,ctx:a}),r.$set(h)},i(a){s||(m(e.$$.fragment,a),m(r.$$.fragment,a),s=!0)},o(a){_(e.$$.fragment,a),_(r.$$.fragment,a),s=!1},d(a){a&&y(t),v(e,a),v(r,a)}}}function Ia(i){let e,n,t,r;const s=[Aa,Ta],o=[];function l(a,u){return a[3]?0:1}return e=l(i),n=o[e]=s[e](i),{c(){n.c(),t=x()},m(a,u){o[e].m(a,u),C(a,t,u),r=!0},p(a,[u]){let c=e;e=l(a),e===c?o[e].p(a,u):(K(),_(o[c],1,1,()=>{o[c]=null}),G(),n=o[e],n?n.p(a,u):(n=o[e]=s[e](a),n.c()),m(n,1),n.m(t.parentNode,t))},i(a){r||(m(n),r=!0)},o(a){_(n),r=!1},d(a){a&&y(t),o[e].d(a)}}}function Ra(i,e,n){let t="",r="",s=!1,o=!1;const l=async()=>{if(n(1,r=ue(t)),r)return;n(2,s=!0);const{data:u,error:c}=await X.auth.signInWithOtp({email:t});if(n(2,s=!1),c){W.setAuthError(c);return}u&&(console.log("data",u),n(3,o=!0))};function a(u){t=u,n(0,t)}return[t,r,s,o,l,a]}class La extends q{constructor(e){super(),D(this,e,Ra,Ia,L,{})}}function Da(i){let e;return{c(){e=O("div"),e.innerHTML='<svg class="h-8 w-8 animate-spin text-blue-600" viewBox="0 0 100 100"><circle fill="none" stroke-width="10" class="stroke-current opacity-40" cx="50" cy="50" r="40"></circle><circle fill="none" stroke-width="10" class="stroke-current" stroke-dasharray="250" stroke-dashoffset="210" cx="50" cy="50" r="40"></circle></svg>',S(e,"class","flex justify-center")},m(n,t){C(n,e,t)},p:I,i:I,o:I,d(n){n&&y(e)}}}class qa extends q{constructor(e){super(),D(this,e,null,Da,L,{})}}function Ua(i){let e,n,t;e=new da({props:{onLogout:i[4]}});const r=i[6].default,s=Se(r,i,i[5],null);return{c(){k(e.$$.fragment),n=E(),s&&s.c()},m(o,l){w(e,o,l),C(o,n,l),s&&s.m(o,l),t=!0},p(o,l){s&&s.p&&(!t||l&32)&&Oe(s,r,o,o[5],t?Ee(r,o[5],l,null):Te(o[5]),null)},i(o){t||(m(e.$$.fragment,o),m(s,o),t=!0)},o(o){_(e.$$.fragment,o),_(s,o),t=!1},d(o){o&&y(n),v(e,o),s&&s.d(o)}}}function Na(i){let e,n,t,r;const s=[Fa,Ma],o=[];function l(a,u){return a[1]?0:1}return e=l(i),n=o[e]=s[e](i),{c(){n.c(),t=x()},m(a,u){o[e].m(a,u),C(a,t,u),r=!0},p(a,u){let c=e;e=l(a),e!==c&&(K(),_(o[c],1,1,()=>{o[c]=null}),G(),n=o[e],n||(n=o[e]=s[e](a),n.c()),m(n,1),n.m(t.parentNode,t))},i(a){r||(m(n),r=!0)},o(a){_(n),r=!1},d(a){a&&y(t),o[e].d(a)}}}function Ba(i){let e,n;return e=new Oa({props:{onConfig:i[3]}}),{c(){k(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p:I,i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function Ma(i){let e,n;return e=new qa({}),{c(){k(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function Fa(i){let e,n;return e=new La({}),{c(){k(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function Ha(i){let e,n,t,r;const s=[Ba,Na,Ua],o=[];function l(a,u){return a[0]?a[2]?2:1:0}return e=l(i),n=o[e]=s[e](i),{c(){n.c(),t=x()},m(a,u){o[e].m(a,u),C(a,t,u),r=!0},p(a,[u]){let c=e;e=l(a),e===c?o[e].p(a,u):(K(),_(o[c],1,1,()=>{o[c]=null}),G(),n=o[e],n?n.p(a,u):(n=o[e]=s[e](a),n.c()),m(n,1),n.m(t.parentNode,t))},i(a){r||(m(n),r=!0)},o(a){_(n),r=!1},d(a){a&&y(t),o[e].d(a)}}}function za(i,e,n){let t;ln(i,vt,h=>n(2,t=h));let{$$slots:r={},$$scope:s}=e,o=!1,l=!1;const a=()=>X?(X.auth.onAuthStateChange((h,d)=>{console.log("auth changed:",d==null?void 0:d.user),d!=null&&d.user?vt.set(d.user):vt.set(null),n(1,l=!0)}),!0):(console.log("supabase is not initialized!"),!1),u=h=>{Lo(h),n(0,o=a())},c=()=>{X&&t&&X.auth.signOut()};return pe(()=>{n(0,o=a())}),i.$$set=h=>{"$$scope"in h&&n(5,s=h.$$scope)},[o,l,t,u,c,s,r]}class Ja extends q{constructor(e){super(),D(this,e,za,Ha,L,{})}}function Ka(i){let e,n;return{c(){e=O("h2"),n=N(i[0]),S(e,"class","text-2xl font-extrabold")},m(t,r){C(t,e,r),b(e,n)},p(t,[r]){r&1&&B(n,t[0])},i:I,o:I,d(t){t&&y(e)}}}function Ga(i,e,n){let{header:t}=e;return i.$$set=r=>{"header"in r&&n(0,t=r.header)},[t]}class se extends q{constructor(e){super(),D(this,e,Ga,Ka,L,{header:0})}}const ht="cache-",ls=()=>{const i=[];for(let e in localStorage)e.startsWith(ht)&&i.push(e);return i.sort()},Va=()=>{const i=[];for(let e in localStorage)e.startsWith(ht)&&localStorage.removeItem(e);return i},Wa=i=>(localStorage.removeItem(i),ls()),Qa=ht+"questions",jt=i=>`${Qa}#${i}`,Ya=async i=>{let{data:e,error:n}=await X.from("questions").select("*").eq("id",i).single();return n&&W.setDBError(n),e||null},dt=async i=>{const e=jt(i),n=localStorage.getItem(e);if(n)return JSON.parse(n);let{data:t,error:r}=await X.from("questions").select("*").eq("chapter_id",i).order("id");return r&&W.setDBError(r),t?(localStorage.setItem(e,JSON.stringify(t)),t):[]},Xa=async(i,e)=>{const{error:n}=await X.from("questions").delete().eq("id",i);return n?(W.setDBError(n),[]):(localStorage.removeItem(jt(e)),dt(e))},Za=async(i,e,n,t)=>{const{error:r}=await X.from("questions").insert([{chapter_id:i,quest:e,answer:n,details:t}]);if(r)return W.setDBError(r),[];localStorage.removeItem(jt(i))},xa=async(i,e,n,t,r)=>{const{error:s}=await X.from("questions").update({quest:n,answer:t,details:r}).eq("id",i);return s?(W.setDBError(s),[]):(localStorage.removeItem(jt(e)),dt(e))},Xt=10,el=async(i,e)=>{const{data:n,error:t}=await X.from("questions").select().ilike(e,`%${i}%`).limit(Xt+1);return t?(W.setDBError(t),{questions:[],hasMore:!1}):(console.log("search-like:",i,"where:",e,"data:",n),{questions:n.slice(0,Xt),hasMore:n.length==Xt+1})},ut="session",tl=(i,e,n)=>{if(i.length==0)return;const t=i.map(s=>({question:s,progress:e}));ma(t);const r={learning:t,learned:[],reverse:n};localStorage.setItem(ut,JSON.stringify(r))},us=()=>{const i=localStorage.getItem(ut);return i?JSON.parse(i):null},nl=i=>i.learning.length>0?(localStorage.setItem(ut,JSON.stringify(i)),!0):(localStorage.removeItem(ut),!1),rl=()=>{localStorage.removeItem(ut)},sr=i=>{const e=[0,0,0,i.learned.length];return i.learning.forEach(n=>{if(n.progress>2)throw Error(`Invalid progress ${n.progress}`);e[n.progress]++}),e},sl=()=>{let i=-1,e=[];return async n=>{n.chapter_id!==i&&(i=n.chapter_id,e=await dt(i),console.log("loaded chapter for refresh:",i));const t=e.find(r=>r.id===n.id);return t===void 0?(W.setString("Unable to refresh lession!",`Question not found: ${n.id}`),n):t}},il=async i=>{let e=sl();for(let n of i.learned)n.question=await e(n.question);for(let n of i.learning)n.question=await e(n.question);return i};function ol(i){let e,n;const t=i[1].default,r=Se(t,i,i[0],null);return{c(){e=O("div"),r&&r.c(),S(e,"class","flex flex-col gap-5")},m(s,o){C(s,e,o),r&&r.m(e,null),n=!0},p(s,[o]){r&&r.p&&(!n||o&1)&&Oe(r,t,s,s[0],n?Ee(t,s[0],o,null):Te(s[0]),null)},i(s){n||(m(r,s),n=!0)},o(s){_(r,s),n=!1},d(s){s&&y(e),r&&r.d(s)}}}function al(i,e,n){let{$$slots:t={},$$scope:r}=e;return i.$$set=s=>{"$$scope"in s&&n(0,r=s.$$scope)},[r,t]}class ie extends q{constructor(e){super(),D(this,e,al,ol,L,{})}}function ir(i){let e,n;return e=new Q({props:{$$slots:{default:[ll]},$$scope:{ctx:i}}}),{c(){k(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p(t,r){const s={};r&8&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function ll(i){let e,n,t,r;return e=new F({props:{label:"Continue",onClick:i[1]}}),t=new F({props:{label:"End",onClick:i[2]}}),{c(){k(e.$$.fragment),n=E(),k(t.$$.fragment)},m(s,o){w(e,s,o),C(s,n,o),w(t,s,o),r=!0},p:I,i(s){r||(m(e.$$.fragment,s),m(t.$$.fragment,s),r=!0)},o(s){_(e.$$.fragment,s),_(t.$$.fragment,s),r=!1},d(s){s&&y(n),v(e,s),v(t,s)}}}function ul(i){let e,n,t,r;e=new se({props:{header:"Home"}});let s=i[0]&&ir(i);return{c(){k(e.$$.fragment),n=E(),s&&s.c(),t=x()},m(o,l){w(e,o,l),C(o,n,l),s&&s.m(o,l),C(o,t,l),r=!0},p(o,l){o[0]?s?(s.p(o,l),l&1&&m(s,1)):(s=ir(o),s.c(),m(s,1),s.m(t.parentNode,t)):s&&(K(),_(s,1,1,()=>{s=null}),G())},i(o){r||(m(e.$$.fragment,o),m(s),r=!0)},o(o){_(e.$$.fragment,o),_(s),r=!1},d(o){o&&(y(n),y(t)),v(e,o),s&&s.d(o)}}}function cl(i){let e,n;return e=new ie({props:{$$slots:{default:[ul]},$$scope:{ctx:i}}}),{c(){k(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p(t,[r]){const s={};r&9&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function fl(i,e,n){let t=!1;const r=()=>{z("/lession/process")},s=()=>{rl(),n(0,t=!1)};return pe(()=>{us()&&n(0,t=!0)}),[t,r,s]}class hl extends q{constructor(e){super(),D(this,e,fl,cl,L,{})}}function dl(i){let e,n;return{c(){e=Z("svg"),n=Z("path"),S(n,"stroke-linecap","round"),S(n,"stroke-linejoin","round"),S(n,"d","m9.75 9.75 4.5 4.5m0-4.5-4.5 4.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"),S(e,"xmlns","http://www.w3.org/2000/svg"),S(e,"fill","none"),S(e,"viewBox","0 0 24 24"),S(e,"stroke-width","1.5"),S(e,"stroke","currentColor"),S(e,"class","size-6 hover:stroke-2")},m(t,r){C(t,e,r),b(e,n)},p:I,d(t){t&&y(e)}}}function pl(i){let e,n;return e=new me({props:{onClick:i[0],$$slots:{default:[dl]},$$scope:{ctx:i}}}),{c(){k(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p(t,[r]){const s={};r&1&&(s.onClick=t[0]),r&2&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function ml(i,e,n){let{onClick:t}=e;return i.$$set=r=>{"onClick"in r&&n(0,t=r.onClick)},[t]}class Pt extends q{constructor(e){super(),D(this,e,ml,pl,L,{onClick:0})}}function or(i,e,n){const t=i.slice();return t[4]=e[n],t}function _l(i){let e;return{c(){e=N("Cache is empty!")},m(n,t){C(n,e,t)},p:I,i:I,o:I,d(n){n&&y(e)}}}function gl(i){let e,n,t,r,s,o,l,a=re(i[0]),u=[];for(let h=0;h<a.length;h+=1)u[h]=ar(or(i,a,h));const c=h=>_(u[h],1,1,()=>{u[h]=null});return o=new Q({props:{$$slots:{default:[bl]},$$scope:{ctx:i}}}),{c(){e=O("table"),n=O("thead"),n.innerHTML="<tr><th>Cache Key</th> <th>Actions</th></tr>",t=E(),r=O("tbody");for(let h=0;h<u.length;h+=1)u[h].c();s=E(),k(o.$$.fragment),S(e,"class","w-full")},m(h,d){C(h,e,d),b(e,n),b(e,t),b(e,r);for(let f=0;f<u.length;f+=1)u[f]&&u[f].m(r,null);C(h,s,d),w(o,h,d),l=!0},p(h,d){if(d&1){a=re(h[0]);let p;for(p=0;p<a.length;p+=1){const g=or(h,a,p);u[p]?(u[p].p(g,d),m(u[p],1)):(u[p]=ar(g),u[p].c(),m(u[p],1),u[p].m(r,null))}for(K(),p=a.length;p<u.length;p+=1)c(p);G()}const f={};d&129&&(f.$$scope={dirty:d,ctx:h}),o.$set(f)},i(h){if(!l){for(let d=0;d<a.length;d+=1)m(u[d]);m(o.$$.fragment,h),l=!0}},o(h){u=u.filter(Boolean);for(let d=0;d<u.length;d+=1)_(u[d]);_(o.$$.fragment,h),l=!1},d(h){h&&(y(e),y(s)),$e(u,h),v(o,h)}}}function $l(i){let e,n;function t(){return i[1](i[4])}return e=new Pt({props:{onClick:t}}),{c(){k(e.$$.fragment)},m(r,s){w(e,r,s),n=!0},p(r,s){i=r;const o={};s&1&&(o.onClick=t),e.$set(o)},i(r){n||(m(e.$$.fragment,r),n=!0)},o(r){_(e.$$.fragment,r),n=!1},d(r){v(e,r)}}}function ar(i){let e,n,t=i[4]+"",r,s,o,l,a,u;return l=new Q({props:{$$slots:{default:[$l]},$$scope:{ctx:i}}}),{c(){e=O("tr"),n=O("td"),r=N(t),s=E(),o=O("td"),k(l.$$.fragment),a=E()},m(c,h){C(c,e,h),b(e,n),b(n,r),b(e,s),b(e,o),w(l,o,null),b(e,a),u=!0},p(c,h){(!u||h&1)&&t!==(t=c[4]+"")&&B(r,t);const d={};h&129&&(d.$$scope={dirty:h,ctx:c}),l.$set(d)},i(c){u||(m(l.$$.fragment,c),u=!0)},o(c){_(l.$$.fragment,c),u=!1},d(c){c&&y(e),v(l)}}}function bl(i){let e,n,t,r;return e=new F({props:{onClick:i[2],label:"Cancel"}}),t=new F({props:{onClick:i[3],label:"Delete all"}}),{c(){k(e.$$.fragment),n=E(),k(t.$$.fragment)},m(s,o){w(e,s,o),C(s,n,o),w(t,s,o),r=!0},p(s,o){const l={};o&1&&(l.onClick=s[3]),t.$set(l)},i(s){r||(m(e.$$.fragment,s),m(t.$$.fragment,s),r=!0)},o(s){_(e.$$.fragment,s),_(t.$$.fragment,s),r=!1},d(s){s&&y(n),v(e,s),v(t,s)}}}function wl(i){let e,n,t,r,s,o;e=new se({props:{header:"Cache"}});const l=[gl,_l],a=[];function u(c,h){return c[0].length>0?0:1}return t=u(i),r=a[t]=l[t](i),{c(){k(e.$$.fragment),n=E(),r.c(),s=x()},m(c,h){w(e,c,h),C(c,n,h),a[t].m(c,h),C(c,s,h),o=!0},p(c,h){let d=t;t=u(c),t===d?a[t].p(c,h):(K(),_(a[d],1,1,()=>{a[d]=null}),G(),r=a[t],r?r.p(c,h):(r=a[t]=l[t](c),r.c()),m(r,1),r.m(s.parentNode,s))},i(c){o||(m(e.$$.fragment,c),m(r),o=!0)},o(c){_(e.$$.fragment,c),_(r),o=!1},d(c){c&&(y(n),y(s)),v(e,c),a[t].d(c)}}}function vl(i){let e,n;return e=new ie({props:{$$slots:{default:[wl]},$$scope:{ctx:i}}}),{c(){k(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p(t,[r]){const s={};r&129&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function kl(i,e,n){let t=[];return pe(()=>{n(0,t=ls())}),[t,l=>{n(0,t=Wa(l))},()=>z("/"),()=>n(0,t=Va())]}class yl extends q{constructor(e){super(),D(this,e,kl,vl,L,{})}}function Cl(i){let e,n,t,r;return e=new se({props:{header:"Not Found"}}),{c(){k(e.$$.fragment),n=E(),t=O("div"),t.textContent="Not Found"},m(s,o){w(e,s,o),C(s,n,o),C(s,t,o),r=!0},p:I,i(s){r||(m(e.$$.fragment,s),r=!0)},o(s){_(e.$$.fragment,s),r=!1},d(s){s&&(y(n),y(t)),v(e,s)}}}function Sl(i){let e,n;return e=new ie({props:{$$slots:{default:[Cl]},$$scope:{ctx:i}}}),{c(){k(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p(t,[r]){const s={};r&1&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}class El extends q{constructor(e){super(),D(this,e,null,Sl,L,{})}}const ct=ht+"books",It=async i=>{let{data:e,error:n}=await X.from("books").select("*").eq("id",i).single();return n&&W.setDBError(n),e||null},$n=async()=>{const i=localStorage.getItem(ct);if(i)return JSON.parse(i);let{data:e,error:n}=await X.from("books").select("*");return n&&W.setDBError(n),e?(localStorage.setItem(ct,JSON.stringify(e)),e):[]},Ol=async i=>{const{error:e}=await X.from("books").delete().eq("id",i);return e?(W.setDBError(e),[]):(localStorage.removeItem(ct),$n())},Tl=async(i,e)=>{const{error:n}=await X.from("books").insert([{name:i,description:e}]);if(n)return W.setDBError(n),[];localStorage.removeItem(ct)},Al=async(i,e,n)=>{const{error:t}=await X.from("books").update({name:e,description:n}).eq("id",i);return t?(W.setDBError(t),[]):(localStorage.removeItem(ct),$n())};function jl(i){let e,n;return{c(){e=Z("svg"),n=Z("path"),S(n,"stroke-linecap","round"),S(n,"stroke-linejoin","round"),S(n,"d","M3.75 12h16.5m-16.5 3.75h16.5M3.75 19.5h16.5M5.625 4.5h12.75a1.875 1.875 0 0 1 0 3.75H5.625a1.875 1.875 0 0 1 0-3.75Z"),S(e,"xmlns","http://www.w3.org/2000/svg"),S(e,"fill","none"),S(e,"viewBox","0 0 24 24"),S(e,"stroke-width","1.5"),S(e,"stroke","currentColor"),S(e,"class","size-6 hover:stroke-2")},m(t,r){C(t,e,r),b(e,n)},p:I,d(t){t&&y(e)}}}function Pl(i){let e,n;return e=new me({props:{onClick:i[0],$$slots:{default:[jl]},$$scope:{ctx:i}}}),{c(){k(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p(t,[r]){const s={};r&1&&(s.onClick=t[0]),r&2&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function Il(i,e,n){let{onClick:t}=e;return i.$$set=r=>{"onClick"in r&&n(0,t=r.onClick)},[t]}class cs extends q{constructor(e){super(),D(this,e,Il,Pl,L,{onClick:0})}}function Rl(i){let e,n;return{c(){e=Z("svg"),n=Z("path"),S(n,"stroke-linecap","round"),S(n,"stroke-linejoin","round"),S(n,"d","m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"),S(e,"xmlns","http://www.w3.org/2000/svg"),S(e,"fill","none"),S(e,"viewBox","0 0 24 24"),S(e,"stroke-width","1.5"),S(e,"stroke","currentColor"),S(e,"class","size-6 hover:stroke-2")},m(t,r){C(t,e,r),b(e,n)},p:I,d(t){t&&y(e)}}}function Ll(i){let e,n;return e=new me({props:{onClick:i[0],$$slots:{default:[Rl]},$$scope:{ctx:i}}}),{c(){k(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p(t,[r]){const s={};r&1&&(s.onClick=t[0]),r&2&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function Dl(i,e,n){let{onClick:t}=e;return i.$$set=r=>{"onClick"in r&&n(0,t=r.onClick)},[t]}class bn extends q{constructor(e){super(),D(this,e,Dl,Ll,L,{onClick:0})}}function lr(i){let e,n;return e=new Gr({props:{title:i[1],buttons:i[2],$$slots:{default:[ql]},$$scope:{ctx:i}}}),{c(){k(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p(t,r){const s={};r&2&&(s.title=t[1]),r&9&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function ql(i){let e=i[0].getMessage(i[0])+"",n;return{c(){n=N(e)},m(t,r){C(t,n,r)},p(t,r){r&1&&e!==(e=t[0].getMessage(t[0])+"")&&B(n,e)},d(t){t&&y(n)}}}function Ul(i){let e,n,t=i[0].entry&&lr(i);return{c(){t&&t.c(),e=x()},m(r,s){t&&t.m(r,s),C(r,e,s),n=!0},p(r,[s]){r[0].entry?t?(t.p(r,s),s&1&&m(t,1)):(t=lr(r),t.c(),m(t,1),t.m(e.parentNode,e)):t&&(K(),_(t,1,1,()=>{t=null}),G())},i(r){n||(m(t),n=!0)},o(r){_(t),n=!1},d(r){r&&y(e),t&&t.d(r)}}}function Nl(i,e,n){let{title:t}=e,{deleteEntry:r}=e;const s=[{label:"Close",onclick:()=>{n(0,r.entry=null,r)}},{label:"Delete",onclick:()=>{r.entry&&(r.onDelete(r.entry),n(0,r.entry=null,r))}}];return i.$$set=o=>{"title"in o&&n(1,t=o.title),"deleteEntry"in o&&n(0,r=o.deleteEntry)},[r,t,s]}class wn extends q{constructor(e){super(),D(this,e,Nl,Ul,L,{title:1,deleteEntry:0})}}function ur(i,e,n){const t=i.slice();return t[7]=e[n],t}function Bl(i){let e,n,t,r,s,o;function l(){return i[2](i[7])}e=new Pt({props:{onClick:l}});function a(){return i[3](i[7])}t=new bn({props:{onClick:a}});function u(){return i[4](i[7])}return s=new cs({props:{onClick:u}}),{c(){k(e.$$.fragment),n=E(),k(t.$$.fragment),r=E(),k(s.$$.fragment)},m(c,h){w(e,c,h),C(c,n,h),w(t,c,h),C(c,r,h),w(s,c,h),o=!0},p(c,h){i=c;const d={};h&3&&(d.onClick=l),e.$set(d);const f={};h&1&&(f.onClick=a),t.$set(f);const p={};h&1&&(p.onClick=u),s.$set(p)},i(c){o||(m(e.$$.fragment,c),m(t.$$.fragment,c),m(s.$$.fragment,c),o=!0)},o(c){_(e.$$.fragment,c),_(t.$$.fragment,c),_(s.$$.fragment,c),o=!1},d(c){c&&(y(n),y(r)),v(e,c),v(t,c),v(s,c)}}}function cr(i){let e,n,t=i[7].id+"",r,s,o,l=i[7].name+"",a,u,c,h=i[7].description+"",d,f,p,g=ae(i[7].modified)+"",$,A,T,j,P,R;return j=new Q({props:{$$slots:{default:[Bl]},$$scope:{ctx:i}}}),{c(){e=O("tr"),n=O("td"),r=N(t),s=E(),o=O("td"),a=N(l),u=E(),c=O("td"),d=N(h),f=E(),p=O("td"),$=N(g),A=E(),T=O("td"),k(j.$$.fragment),P=E()},m(U,J){C(U,e,J),b(e,n),b(n,r),b(e,s),b(e,o),b(o,a),b(e,u),b(e,c),b(c,d),b(e,f),b(e,p),b(p,$),b(e,A),b(e,T),w(j,T,null),b(e,P),R=!0},p(U,J){(!R||J&1)&&t!==(t=U[7].id+"")&&B(r,t),(!R||J&1)&&l!==(l=U[7].name+"")&&B(a,l),(!R||J&1)&&h!==(h=U[7].description+"")&&B(d,h),(!R||J&1)&&g!==(g=ae(U[7].modified)+"")&&B($,g);const Y={};J&1027&&(Y.$$scope={dirty:J,ctx:U}),j.$set(Y)},i(U){R||(m(j.$$.fragment,U),R=!0)},o(U){_(j.$$.fragment,U),R=!1},d(U){U&&y(e),v(j)}}}function Ml(i){let e,n,t,r;return e=new F({props:{onClick:i[5],label:"Cancel"}}),t=new F({props:{onClick:i[6],label:"Create"}}),{c(){k(e.$$.fragment),n=E(),k(t.$$.fragment)},m(s,o){w(e,s,o),C(s,n,o),w(t,s,o),r=!0},p:I,i(s){r||(m(e.$$.fragment,s),m(t.$$.fragment,s),r=!0)},o(s){_(e.$$.fragment,s),_(t.$$.fragment,s),r=!1},d(s){s&&y(n),v(e,s),v(t,s)}}}function Fl(i){let e,n,t,r,s,o,l,a,u;e=new se({props:{header:"List Books"}});let c=re(i[0]),h=[];for(let f=0;f<c.length;f+=1)h[f]=cr(ur(i,c,f));const d=f=>_(h[f],1,1,()=>{h[f]=null});return a=new Q({props:{$$slots:{default:[Ml]},$$scope:{ctx:i}}}),{c(){k(e.$$.fragment),n=E(),t=O("table"),r=O("thead"),r.innerHTML="<tr><th>ID</th> <th>Name</th> <th>Description</th> <th>Modified</th> <th>Actions</th></tr>",s=E(),o=O("tbody");for(let f=0;f<h.length;f+=1)h[f].c();l=E(),k(a.$$.fragment),S(t,"class","w-full")},m(f,p){w(e,f,p),C(f,n,p),C(f,t,p),b(t,r),b(t,s),b(t,o);for(let g=0;g<h.length;g+=1)h[g]&&h[g].m(o,null);C(f,l,p),w(a,f,p),u=!0},p(f,p){if(p&3){c=re(f[0]);let $;for($=0;$<c.length;$+=1){const A=ur(f,c,$);h[$]?(h[$].p(A,p),m(h[$],1)):(h[$]=cr(A),h[$].c(),m(h[$],1),h[$].m(o,null))}for(K(),$=c.length;$<h.length;$+=1)d($);G()}const g={};p&1024&&(g.$$scope={dirty:p,ctx:f}),a.$set(g)},i(f){if(!u){m(e.$$.fragment,f);for(let p=0;p<c.length;p+=1)m(h[p]);m(a.$$.fragment,f),u=!0}},o(f){_(e.$$.fragment,f),h=h.filter(Boolean);for(let p=0;p<h.length;p+=1)_(h[p]);_(a.$$.fragment,f),u=!1},d(f){f&&(y(n),y(t),y(l)),v(e,f),$e(h,f),v(a,f)}}}function Hl(i){let e,n,t,r;return e=new ie({props:{$$slots:{default:[Fl]},$$scope:{ctx:i}}}),t=new wn({props:{title:"Delete Book",deleteEntry:i[1]}}),{c(){k(e.$$.fragment),n=E(),k(t.$$.fragment)},m(s,o){w(e,s,o),C(s,n,o),w(t,s,o),r=!0},p(s,[o]){const l={};o&1027&&(l.$$scope={dirty:o,ctx:s}),e.$set(l);const a={};o&2&&(a.deleteEntry=s[1]),t.$set(a)},i(s){r||(m(e.$$.fragment,s),m(t.$$.fragment,s),r=!0)},o(s){_(e.$$.fragment,s),_(t.$$.fragment,s),r=!1},d(s){s&&y(n),v(e,s),v(t,s)}}}function zl(i,e,n){let t=[],r={entry:null,onDelete:c=>{Ol(c.id).then(h=>{n(0,t=h)})},getMessage:c=>`Do you wnat to delete the book: '${c.id}'?`};return pe(async()=>{n(0,t=await $n())}),[t,r,async c=>{n(1,r.entry=c,r)},c=>{z("/books/update/"+c.id)},c=>{z("/chapters/list/"+c.id)},()=>z("/books/list"),()=>z("/books/create")]}class Jl extends q{constructor(e){super(),D(this,e,zl,Hl,L,{})}}function Kl(i){let e,n,t;return{c(){e=O("textarea"),S(e,"class","input"),S(e,"id",i[2])},m(r,s){C(r,e,s),Ke(e,i[0]),n||(t=Ye(e,"input",i[4]),n=!0)},p(r,s){s&4&&S(e,"id",r[2]),s&1&&Ke(e,r[0])},d(r){r&&y(e),n=!1,t()}}}function Gl(i){let e,n;return e=new gn({props:{id:i[2],label:i[1],error:i[3],$$slots:{default:[Kl]},$$scope:{ctx:i}}}),{c(){k(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p(t,[r]){const s={};r&4&&(s.id=t[2]),r&2&&(s.label=t[1]),r&8&&(s.error=t[3]),r&37&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function Vl(i,e,n){let{label:t}=e,{id:r}=e,{value:s}=e,{error:o}=e;function l(){s=this.value,n(0,s)}return i.$$set=a=>{"label"in a&&n(1,t=a.label),"id"in a&&n(2,r=a.id),"value"in a&&n(0,s=a.value),"error"in a&&n(3,o=a.error)},[s,t,r,o,l]}class ye extends q{constructor(e){super(),D(this,e,Vl,Gl,L,{label:1,id:2,value:0,error:3})}}function Wl(i){let e,n,t,r;return e=new F({props:{onClick:i[7],label:"Cancel"}}),t=new F({props:{label:"Create"}}),{c(){k(e.$$.fragment),n=E(),k(t.$$.fragment)},m(s,o){w(e,s,o),C(s,n,o),w(t,s,o),r=!0},p:I,i(s){r||(m(e.$$.fragment,s),m(t.$$.fragment,s),r=!0)},o(s){_(e.$$.fragment,s),_(t.$$.fragment,s),r=!1},d(s){s&&y(n),v(e,s),v(t,s)}}}function Ql(i){let e,n,t,r,s,o,l,a;function u(f){i[5](f)}let c={id:"name",label:"Book name",error:i[1]};i[0]!==void 0&&(c.value=i[0]),e=new Ce({props:c}),ee.push(()=>ne(e,"value",u));function h(f){i[6](f)}let d={id:"description",label:"Book description",error:i[3]};return i[2]!==void 0&&(d.value=i[2]),r=new ye({props:d}),ee.push(()=>ne(r,"value",h)),l=new Q({props:{$$slots:{default:[Wl]},$$scope:{ctx:i}}}),{c(){k(e.$$.fragment),t=E(),k(r.$$.fragment),o=E(),k(l.$$.fragment)},m(f,p){w(e,f,p),C(f,t,p),w(r,f,p),C(f,o,p),w(l,f,p),a=!0},p(f,p){const g={};p&2&&(g.error=f[1]),!n&&p&1&&(n=!0,g.value=f[0],te(()=>n=!1)),e.$set(g);const $={};p&8&&($.error=f[3]),!s&&p&4&&(s=!0,$.value=f[2],te(()=>s=!1)),r.$set($);const A={};p&256&&(A.$$scope={dirty:p,ctx:f}),l.$set(A)},i(f){a||(m(e.$$.fragment,f),m(r.$$.fragment,f),m(l.$$.fragment,f),a=!0)},o(f){_(e.$$.fragment,f),_(r.$$.fragment,f),_(l.$$.fragment,f),a=!1},d(f){f&&(y(t),y(o)),v(e,f),v(r,f),v(l,f)}}}function Yl(i){let e,n,t,r;return e=new se({props:{header:"Create Book"}}),t=new ge({props:{onSubmit:i[4],$$slots:{default:[Ql]},$$scope:{ctx:i}}}),{c(){k(e.$$.fragment),n=E(),k(t.$$.fragment)},m(s,o){w(e,s,o),C(s,n,o),w(t,s,o),r=!0},p(s,o){const l={};o&271&&(l.$$scope={dirty:o,ctx:s}),t.$set(l)},i(s){r||(m(e.$$.fragment,s),m(t.$$.fragment,s),r=!0)},o(s){_(e.$$.fragment,s),_(t.$$.fragment,s),r=!1},d(s){s&&y(n),v(e,s),v(t,s)}}}function Xl(i){let e,n;return e=new ie({props:{$$slots:{default:[Yl]},$$scope:{ctx:i}}}),{c(){k(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p(t,[r]){const s={};r&271&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function Zl(i,e,n){let t="",r="",s="",o="";const l=async()=>{n(1,r=ue(t)),n(3,o=ue(s)),!(r||o)&&(await Tl(t,s),z("/books/list"))};function a(h){t=h,n(0,t)}function u(h){s=h,n(2,s)}return[t,r,s,o,l,a,u,()=>z("/books/list")]}class xl extends q{constructor(e){super(),D(this,e,Zl,Xl,L,{})}}function fr(i){let e,n,t=i[0].id+"",r,s,o,l=ae(i[0].modified)+"",a,u,c,h;return c=new ge({props:{onSubmit:i[5],$$slots:{default:[tu]},$$scope:{ctx:i}}}),{c(){e=O("div"),n=O("span"),r=N(t),s=E(),o=O("span"),a=N(l),u=E(),k(c.$$.fragment),S(e,"class","mb-4 text-small")},m(d,f){C(d,e,f),b(e,n),b(n,r),b(e,s),b(e,o),b(o,a),C(d,u,f),w(c,d,f),h=!0},p(d,f){(!h||f&1)&&t!==(t=d[0].id+"")&&B(r,t),(!h||f&1)&&l!==(l=ae(d[0].modified)+"")&&B(a,l);const p={};f&1054&&(p.$$scope={dirty:f,ctx:d}),c.$set(p)},i(d){h||(m(c.$$.fragment,d),h=!0)},o(d){_(c.$$.fragment,d),h=!1},d(d){d&&(y(e),y(u)),v(c,d)}}}function eu(i){let e,n,t,r;return e=new F({props:{onClick:i[9],label:"Cancel"}}),t=new F({props:{label:"Update"}}),{c(){k(e.$$.fragment),n=E(),k(t.$$.fragment)},m(s,o){w(e,s,o),C(s,n,o),w(t,s,o),r=!0},p:I,i(s){r||(m(e.$$.fragment,s),m(t.$$.fragment,s),r=!0)},o(s){_(e.$$.fragment,s),_(t.$$.fragment,s),r=!1},d(s){s&&y(n),v(e,s),v(t,s)}}}function tu(i){let e,n,t,r,s,o,l,a;function u(f){i[7](f)}let c={id:"name",label:"Book name",error:i[2]};i[1]!==void 0&&(c.value=i[1]),e=new Ce({props:c}),ee.push(()=>ne(e,"value",u));function h(f){i[8](f)}let d={id:"description",label:"Book description",error:i[4]};return i[3]!==void 0&&(d.value=i[3]),r=new ye({props:d}),ee.push(()=>ne(r,"value",h)),l=new Q({props:{$$slots:{default:[eu]},$$scope:{ctx:i}}}),{c(){k(e.$$.fragment),t=E(),k(r.$$.fragment),o=E(),k(l.$$.fragment)},m(f,p){w(e,f,p),C(f,t,p),w(r,f,p),C(f,o,p),w(l,f,p),a=!0},p(f,p){const g={};p&4&&(g.error=f[2]),!n&&p&2&&(n=!0,g.value=f[1],te(()=>n=!1)),e.$set(g);const $={};p&16&&($.error=f[4]),!s&&p&8&&(s=!0,$.value=f[3],te(()=>s=!1)),r.$set($);const A={};p&1024&&(A.$$scope={dirty:p,ctx:f}),l.$set(A)},i(f){a||(m(e.$$.fragment,f),m(r.$$.fragment,f),m(l.$$.fragment,f),a=!0)},o(f){_(e.$$.fragment,f),_(r.$$.fragment,f),_(l.$$.fragment,f),a=!1},d(f){f&&(y(t),y(o)),v(e,f),v(r,f),v(l,f)}}}function nu(i){let e,n,t,r;e=new se({props:{header:"Update Book"}});let s=i[0]&&fr(i);return{c(){k(e.$$.fragment),n=E(),s&&s.c(),t=x()},m(o,l){w(e,o,l),C(o,n,l),s&&s.m(o,l),C(o,t,l),r=!0},p(o,l){o[0]?s?(s.p(o,l),l&1&&m(s,1)):(s=fr(o),s.c(),m(s,1),s.m(t.parentNode,t)):s&&(K(),_(s,1,1,()=>{s=null}),G())},i(o){r||(m(e.$$.fragment,o),m(s),r=!0)},o(o){_(e.$$.fragment,o),_(s),r=!1},d(o){o&&(y(n),y(t)),v(e,o),s&&s.d(o)}}}function ru(i){let e,n;return e=new ie({props:{$$slots:{default:[nu]},$$scope:{ctx:i}}}),{c(){k(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p(t,[r]){const s={};r&1055&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function su(i,e,n){let{params:t={id:""}}=e,r=null,s="",o="",l="",a="";const u=async()=>{if(n(2,o=ue(s)),n(4,a=ue(l)),!(o||a)){if(!r){W.setString("No book!!");return}await Al(r.id,s,l),z("/books/list")}};pe(async()=>{n(0,r=await It(parseInt(t.id))),r&&(n(1,s=r.name),n(3,l=r.description))});function c(f){s=f,n(1,s)}function h(f){l=f,n(3,l)}const d=()=>z("/books/list");return i.$$set=f=>{"params"in f&&n(6,t=f.params)},[r,s,o,l,a,u,t,c,h,d]}class iu extends q{constructor(e){super(),D(this,e,su,ru,L,{params:6})}}const ou=ht+"chapters",Rt=i=>`${ou}#${i}`,vn=async i=>{let{data:e,error:n}=await X.from("chapters").select("*").eq("id",i).single();return n&&W.setDBError(n),e||null},kn=async i=>{const e=Rt(i),n=localStorage.getItem(e);if(n)return JSON.parse(n);let{data:t,error:r}=await X.from("chapters").select("*").eq("book_id",i).order("id");return r&&W.setDBError(r),t?(localStorage.setItem(e,JSON.stringify(t)),t):[]},au=async(i,e)=>{const{error:n}=await X.from("chapters").delete().eq("id",i);return n?(W.setDBError(n),[]):(localStorage.removeItem(Rt(e)),kn(e))},lu=async(i,e,n)=>{const{error:t}=await X.from("chapters").update({name:n}).eq("id",i);return t?(W.setDBError(t),[]):(localStorage.removeItem(Rt(e)),kn(e))},uu=async(i,e)=>{const{error:n}=await X.from("chapters").insert([{book_id:i,name:e}]);if(n)return W.setDBError(n),[];localStorage.removeItem(Rt(i))};function cu(i){let e,n;const t=i[1].default,r=Se(t,i,i[0],null);return{c(){e=O("div"),r&&r.c(),S(e,"class","border rounded shadow px-4 py-4")},m(s,o){C(s,e,o),r&&r.m(e,null),n=!0},p(s,[o]){r&&r.p&&(!n||o&1)&&Oe(r,t,s,s[0],n?Ee(t,s[0],o,null):Te(s[0]),null)},i(s){n||(m(r,s),n=!0)},o(s){_(r,s),n=!1},d(s){s&&y(e),r&&r.d(s)}}}function fu(i,e,n){let{$$slots:t={},$$scope:r}=e;return i.$$set=s=>{"$$scope"in s&&n(0,r=s.$$scope)},[r,t]}class hu extends q{constructor(e){super(),D(this,e,fu,cu,L,{})}}function hr(i){let e,n,t,r=i[0].name+"",s,o,l,a,u=i[0].id+"",c,h,d=ae(i[0].modified)+"",f,p,g=i[0].description&&dr(i);return{c(){e=O("div"),n=O("div"),t=O("div"),s=N(r),o=E(),l=O("div"),a=N("Book-Id: "),c=N(u),h=N(" - Modified: "),f=N(d),p=E(),g&&g.c(),S(t,"class","text-lg font-semibold"),S(l,"class","text-sm"),S(n,"class","flex justify-between mb-2")},m($,A){C($,e,A),b(e,n),b(n,t),b(t,s),b(n,o),b(n,l),b(l,a),b(l,c),b(l,h),b(l,f),b(e,p),g&&g.m(e,null)},p($,A){A&1&&r!==(r=$[0].name+"")&&B(s,r),A&1&&u!==(u=$[0].id+"")&&B(c,u),A&1&&d!==(d=ae($[0].modified)+"")&&B(f,d),$[0].description?g?g.p($,A):(g=dr($),g.c(),g.m(e,null)):g&&(g.d(1),g=null)},d($){$&&y(e),g&&g.d()}}}function dr(i){let e,n=i[0].description+"",t;return{c(){e=O("p"),t=N(n),S(e,"class","mt-2 pt-2 border-t text-sm")},m(r,s){C(r,e,s),b(e,t)},p(r,s){s&1&&n!==(n=r[0].description+"")&&B(t,n)},d(r){r&&y(e)}}}function pr(i){let e,n,t=i[1].name+"",r,s,o,l,a=i[1].id+"",u,c,h=ae(i[1].modified)+"",d;return{c(){e=O("div"),n=O("div"),r=N(t),s=E(),o=O("div"),l=N("Chapter-Id: "),u=N(a),c=N(" - Modified: "),d=N(h),S(n,"class","text font-medium"),S(o,"class","text-sm"),S(e,"class","flex justify-between mb-2")},m(f,p){C(f,e,p),b(e,n),b(n,r),b(e,s),b(e,o),b(o,l),b(o,u),b(o,c),b(o,d)},p(f,p){p&2&&t!==(t=f[1].name+"")&&B(r,t),p&2&&a!==(a=f[1].id+"")&&B(u,a),p&2&&h!==(h=ae(f[1].modified)+"")&&B(d,h)},d(f){f&&y(e)}}}function du(i){let e,n,t=i[0]&&hr(i),r=i[1]&&pr(i);return{c(){e=O("div"),t&&t.c(),n=E(),r&&r.c(),S(e,"class","flex flex-col gap-5")},m(s,o){C(s,e,o),t&&t.m(e,null),b(e,n),r&&r.m(e,null)},p(s,o){s[0]?t?t.p(s,o):(t=hr(s),t.c(),t.m(e,n)):t&&(t.d(1),t=null),s[1]?r?r.p(s,o):(r=pr(s),r.c(),r.m(e,null)):r&&(r.d(1),r=null)},d(s){s&&y(e),t&&t.d(),r&&r.d()}}}function pu(i){let e,n;return e=new hu({props:{$$slots:{default:[du]},$$scope:{ctx:i}}}),{c(){k(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p(t,[r]){const s={};r&7&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function mu(i,e,n){let{book:t=null}=e,{chapter:r=null}=e;return i.$$set=s=>{"book"in s&&n(0,t=s.book),"chapter"in s&&n(1,r=s.chapter)},[t,r]}class yn extends q{constructor(e){super(),D(this,e,mu,pu,L,{book:0,chapter:1})}}function _u(i){let e,n;return{c(){e=Z("svg"),n=Z("path"),S(n,"stroke-linecap","round"),S(n,"stroke-linejoin","round"),S(n,"d","m12.75 15 3-3m0 0-3-3m3 3h-7.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"),S(e,"xmlns","http://www.w3.org/2000/svg"),S(e,"fill","none"),S(e,"viewBox","0 0 24 24"),S(e,"stroke-width","1.5"),S(e,"stroke","currentColor"),S(e,"class","size-6 hover:stroke-2")},m(t,r){C(t,e,r),b(e,n)},p:I,d(t){t&&y(e)}}}function gu(i){let e,n;return e=new me({props:{onClick:i[0],$$slots:{default:[_u]},$$scope:{ctx:i}}}),{c(){k(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p(t,[r]){const s={};r&1&&(s.onClick=t[0]),r&2&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function $u(i,e,n){let{onClick:t}=e;return i.$$set=r=>{"onClick"in r&&n(0,t=r.onClick)},[t]}class bu extends q{constructor(e){super(),D(this,e,$u,gu,L,{onClick:0})}}function mr(i,e,n){const t=i.slice();return t[10]=e[n],t}function wu(i){let e,n,t,r,s,o,l,a;function u(){return i[4](i[10])}e=new Pt({props:{onClick:u}});function c(){return i[5](i[10])}t=new bn({props:{onClick:c}});function h(){return i[6](i[10])}s=new cs({props:{onClick:h}});function d(){return i[7](i[10])}return l=new bu({props:{onClick:d}}),{c(){k(e.$$.fragment),n=E(),k(t.$$.fragment),r=E(),k(s.$$.fragment),o=E(),k(l.$$.fragment)},m(f,p){w(e,f,p),C(f,n,p),w(t,f,p),C(f,r,p),w(s,f,p),C(f,o,p),w(l,f,p),a=!0},p(f,p){i=f;const g={};p&12&&(g.onClick=u),e.$set(g);const $={};p&4&&($.onClick=c),t.$set($);const A={};p&4&&(A.onClick=h),s.$set(A);const T={};p&4&&(T.onClick=d),l.$set(T)},i(f){a||(m(e.$$.fragment,f),m(t.$$.fragment,f),m(s.$$.fragment,f),m(l.$$.fragment,f),a=!0)},o(f){_(e.$$.fragment,f),_(t.$$.fragment,f),_(s.$$.fragment,f),_(l.$$.fragment,f),a=!1},d(f){f&&(y(n),y(r),y(o)),v(e,f),v(t,f),v(s,f),v(l,f)}}}function _r(i){let e,n,t=i[10].id+"",r,s,o,l=i[10].name+"",a,u,c,h=ae(i[10].modified)+"",d,f,p,g,$,A;return g=new Q({props:{$$slots:{default:[wu]},$$scope:{ctx:i}}}),{c(){e=O("tr"),n=O("td"),r=N(t),s=E(),o=O("td"),a=N(l),u=E(),c=O("td"),d=N(h),f=E(),p=O("td"),k(g.$$.fragment),$=E()},m(T,j){C(T,e,j),b(e,n),b(n,r),b(e,s),b(e,o),b(o,a),b(e,u),b(e,c),b(c,d),b(e,f),b(e,p),w(g,p,null),b(e,$),A=!0},p(T,j){(!A||j&4)&&t!==(t=T[10].id+"")&&B(r,t),(!A||j&4)&&l!==(l=T[10].name+"")&&B(a,l),(!A||j&4)&&h!==(h=ae(T[10].modified)+"")&&B(d,h);const P={};j&8204&&(P.$$scope={dirty:j,ctx:T}),g.$set(P)},i(T){A||(m(g.$$.fragment,T),A=!0)},o(T){_(g.$$.fragment,T),A=!1},d(T){T&&y(e),v(g)}}}function vu(i){let e,n,t,r;return e=new F({props:{onClick:i[8],label:"Cancel"}}),t=new F({props:{onClick:i[9],label:"Create"}}),{c(){k(e.$$.fragment),n=E(),k(t.$$.fragment)},m(s,o){w(e,s,o),C(s,n,o),w(t,s,o),r=!0},p(s,o){const l={};o&1&&(l.onClick=s[9]),t.$set(l)},i(s){r||(m(e.$$.fragment,s),m(t.$$.fragment,s),r=!0)},o(s){_(e.$$.fragment,s),_(t.$$.fragment,s),r=!1},d(s){s&&y(n),v(e,s),v(t,s)}}}function ku(i){let e,n,t,r,s,o,l,a,u,c,h;e=new se({props:{header:"List Chapters"}}),t=new yn({props:{book:i[1]}});let d=re(i[2]),f=[];for(let g=0;g<d.length;g+=1)f[g]=_r(mr(i,d,g));const p=g=>_(f[g],1,1,()=>{f[g]=null});return c=new Q({props:{$$slots:{default:[vu]},$$scope:{ctx:i}}}),{c(){k(e.$$.fragment),n=E(),k(t.$$.fragment),r=E(),s=O("table"),o=O("thead"),o.innerHTML="<tr><th>ID</th> <th>Name</th> <th>Modified</th> <th>Actions</th></tr>",l=E(),a=O("tbody");for(let g=0;g<f.length;g+=1)f[g].c();u=E(),k(c.$$.fragment),S(s,"class","w-full")},m(g,$){w(e,g,$),C(g,n,$),w(t,g,$),C(g,r,$),C(g,s,$),b(s,o),b(s,l),b(s,a);for(let A=0;A<f.length;A+=1)f[A]&&f[A].m(a,null);C(g,u,$),w(c,g,$),h=!0},p(g,$){const A={};if($&2&&(A.book=g[1]),t.$set(A),$&12){d=re(g[2]);let j;for(j=0;j<d.length;j+=1){const P=mr(g,d,j);f[j]?(f[j].p(P,$),m(f[j],1)):(f[j]=_r(P),f[j].c(),m(f[j],1),f[j].m(a,null))}for(K(),j=d.length;j<f.length;j+=1)p(j);G()}const T={};$&8193&&(T.$$scope={dirty:$,ctx:g}),c.$set(T)},i(g){if(!h){m(e.$$.fragment,g),m(t.$$.fragment,g);for(let $=0;$<d.length;$+=1)m(f[$]);m(c.$$.fragment,g),h=!0}},o(g){_(e.$$.fragment,g),_(t.$$.fragment,g),f=f.filter(Boolean);for(let $=0;$<f.length;$+=1)_(f[$]);_(c.$$.fragment,g),h=!1},d(g){g&&(y(n),y(r),y(s),y(u)),v(e,g),v(t,g),$e(f,g),v(c,g)}}}function yu(i){let e,n,t,r;return e=new ie({props:{$$slots:{default:[ku]},$$scope:{ctx:i}}}),t=new wn({props:{title:"Delete Chapter",deleteEntry:i[3]}}),{c(){k(e.$$.fragment),n=E(),k(t.$$.fragment)},m(s,o){w(e,s,o),C(s,n,o),w(t,s,o),r=!0},p(s,[o]){const l={};o&8207&&(l.$$scope={dirty:o,ctx:s}),e.$set(l);const a={};o&8&&(a.deleteEntry=s[3]),t.$set(a)},i(s){r||(m(e.$$.fragment,s),m(t.$$.fragment,s),r=!0)},o(s){_(e.$$.fragment,s),_(t.$$.fragment,s),r=!1},d(s){s&&y(n),v(e,s),v(t,s)}}}function Cu(i,e,n){let{params:t={id:0}}=e,r,s=[],o={entry:null,onDelete:f=>{au(f.id,f.book_id).then(p=>n(2,s=p))},getMessage:f=>`Do you wnat to delete the chapter: '${f.id}'?`};pe(async()=>{n(1,r=await It(t.id)),r&&n(2,s=await kn(r.id))});const l=async f=>{n(3,o.entry=f,o)},a=f=>{z("/chapters/update/"+f.id)},u=f=>{z("/questions/list/"+f.id)},c=f=>{z("/lession/prepare/"+f.id)},h=()=>z("/books/list"),d=()=>z("/chapters/create/"+t.id);return i.$$set=f=>{"params"in f&&n(0,t=f.params)},[t,r,s,o,l,a,u,c,h,d]}class Su extends q{constructor(e){super(),D(this,e,Cu,yu,L,{params:0})}}function Eu(i){let e,n,t,r;return e=new F({props:{onClick:i[5],label:"Cancel"}}),t=new F({props:{label:"Create"}}),{c(){k(e.$$.fragment),n=E(),k(t.$$.fragment)},m(s,o){w(e,s,o),C(s,n,o),w(t,s,o),r=!0},p(s,o){const l={};o&1&&(l.onClick=s[5]),e.$set(l)},i(s){r||(m(e.$$.fragment,s),m(t.$$.fragment,s),r=!0)},o(s){_(e.$$.fragment,s),_(t.$$.fragment,s),r=!1},d(s){s&&y(n),v(e,s),v(t,s)}}}function Ou(i){let e,n,t,r,s;function o(a){i[4](a)}let l={id:"name",label:"Chapter name",error:i[2]};return i[1]!==void 0&&(l.value=i[1]),e=new Ce({props:l}),ee.push(()=>ne(e,"value",o)),r=new Q({props:{$$slots:{default:[Eu]},$$scope:{ctx:i}}}),{c(){k(e.$$.fragment),t=E(),k(r.$$.fragment)},m(a,u){w(e,a,u),C(a,t,u),w(r,a,u),s=!0},p(a,u){const c={};u&4&&(c.error=a[2]),!n&&u&2&&(n=!0,c.value=a[1],te(()=>n=!1)),e.$set(c);const h={};u&65&&(h.$$scope={dirty:u,ctx:a}),r.$set(h)},i(a){s||(m(e.$$.fragment,a),m(r.$$.fragment,a),s=!0)},o(a){_(e.$$.fragment,a),_(r.$$.fragment,a),s=!1},d(a){a&&y(t),v(e,a),v(r,a)}}}function Tu(i){let e,n,t,r;return e=new se({props:{header:"Create Book"}}),t=new ge({props:{onSubmit:i[3],$$slots:{default:[Ou]},$$scope:{ctx:i}}}),{c(){k(e.$$.fragment),n=E(),k(t.$$.fragment)},m(s,o){w(e,s,o),C(s,n,o),w(t,s,o),r=!0},p(s,o){const l={};o&71&&(l.$$scope={dirty:o,ctx:s}),t.$set(l)},i(s){r||(m(e.$$.fragment,s),m(t.$$.fragment,s),r=!0)},o(s){_(e.$$.fragment,s),_(t.$$.fragment,s),r=!1},d(s){s&&y(n),v(e,s),v(t,s)}}}function Au(i){let e,n;return e=new ie({props:{$$slots:{default:[Tu]},$$scope:{ctx:i}}}),{c(){k(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p(t,[r]){const s={};r&71&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function ju(i,e,n){let{params:t={book_id:0}}=e,r="",s="";const o=async()=>{n(2,s=ue(r)),!s&&(await uu(t.book_id,r),z("/chapters/list/"+t.book_id))};function l(u){r=u,n(1,r)}const a=()=>z("/chapters/list/"+t.book_id);return i.$$set=u=>{"params"in u&&n(0,t=u.params)},[t,r,s,o,l,a]}class Pu extends q{constructor(e){super(),D(this,e,ju,Au,L,{params:0})}}function gr(i){let e,n,t=i[0].id+"",r,s,o,l=ae(i[0].modified)+"",a,u,c,h;return c=new ge({props:{onSubmit:i[3],$$slots:{default:[Ru]},$$scope:{ctx:i}}}),{c(){e=O("div"),n=O("span"),r=N(t),s=E(),o=O("span"),a=N(l),u=E(),k(c.$$.fragment),S(e,"class","mb-4 text-small")},m(d,f){C(d,e,f),b(e,n),b(n,r),b(e,s),b(e,o),b(o,a),C(d,u,f),w(c,d,f),h=!0},p(d,f){(!h||f&1)&&t!==(t=d[0].id+"")&&B(r,t),(!h||f&1)&&l!==(l=ae(d[0].modified)+"")&&B(a,l);const p={};f&135&&(p.$$scope={dirty:f,ctx:d}),c.$set(p)},i(d){h||(m(c.$$.fragment,d),h=!0)},o(d){_(c.$$.fragment,d),h=!1},d(d){d&&(y(e),y(u)),v(c,d)}}}function Iu(i){let e,n,t,r;return e=new F({props:{onClick:i[6],label:"Cancel"}}),t=new F({props:{label:"Create"}}),{c(){k(e.$$.fragment),n=E(),k(t.$$.fragment)},m(s,o){w(e,s,o),C(s,n,o),w(t,s,o),r=!0},p(s,o){const l={};o&1&&(l.onClick=s[6]),e.$set(l)},i(s){r||(m(e.$$.fragment,s),m(t.$$.fragment,s),r=!0)},o(s){_(e.$$.fragment,s),_(t.$$.fragment,s),r=!1},d(s){s&&y(n),v(e,s),v(t,s)}}}function Ru(i){let e,n,t,r,s;function o(a){i[5](a)}let l={id:"name",label:"Chapter name",error:i[2]};return i[1]!==void 0&&(l.value=i[1]),e=new Ce({props:l}),ee.push(()=>ne(e,"value",o)),r=new Q({props:{$$slots:{default:[Iu]},$$scope:{ctx:i}}}),{c(){k(e.$$.fragment),t=E(),k(r.$$.fragment)},m(a,u){w(e,a,u),C(a,t,u),w(r,a,u),s=!0},p(a,u){const c={};u&4&&(c.error=a[2]),!n&&u&2&&(n=!0,c.value=a[1],te(()=>n=!1)),e.$set(c);const h={};u&129&&(h.$$scope={dirty:u,ctx:a}),r.$set(h)},i(a){s||(m(e.$$.fragment,a),m(r.$$.fragment,a),s=!0)},o(a){_(e.$$.fragment,a),_(r.$$.fragment,a),s=!1},d(a){a&&y(t),v(e,a),v(r,a)}}}function Lu(i){let e,n,t,r;e=new se({props:{header:"Update Book"}});let s=i[0]&&gr(i);return{c(){k(e.$$.fragment),n=E(),s&&s.c(),t=x()},m(o,l){w(e,o,l),C(o,n,l),s&&s.m(o,l),C(o,t,l),r=!0},p(o,l){o[0]?s?(s.p(o,l),l&1&&m(s,1)):(s=gr(o),s.c(),m(s,1),s.m(t.parentNode,t)):s&&(K(),_(s,1,1,()=>{s=null}),G())},i(o){r||(m(e.$$.fragment,o),m(s),r=!0)},o(o){_(e.$$.fragment,o),_(s),r=!1},d(o){o&&(y(n),y(t)),v(e,o),s&&s.d(o)}}}function Du(i){let e,n;return e=new ie({props:{$$slots:{default:[Lu]},$$scope:{ctx:i}}}),{c(){k(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p(t,[r]){const s={};r&135&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function qu(i,e,n){let{params:t={id:""}}=e,r=null,s="",o="";const l=async()=>{if(n(2,o=ue(s)),!o){if(!r){W.setString("No chapter!!");return}await lu(r.id,r.book_id,s),z("/chapters/list/"+r.book_id)}};pe(async()=>{n(0,r=await vn(parseInt(t.id))),r&&n(1,s=r.name)});function a(c){s=c,n(1,s)}const u=()=>z("/chapters/list/"+(r==null?void 0:r.book_id));return i.$$set=c=>{"params"in c&&n(4,t=c.params)},[r,s,o,l,t,a,u]}class Uu extends q{constructor(e){super(),D(this,e,qu,Du,L,{params:4})}}const Nu=new RegExp(/[<>]/,"g"),Bu=[{pattern:new RegExp(/^(.+)=#/,"g"),replace:'<span class="md-it">$1</span>'},{pattern:new RegExp(/#=(.+)$/,"g"),replace:'<span class="md-it">$1</span>'},{pattern:new RegExp(/#([^#]+)#/,"g"),replace:'<span class="md-it">$1</span>'},{pattern:new RegExp(/\*\*(.)/,"g"),replace:'<span class="md-em">$1</span>'},{pattern:new RegExp(/\*([^*]+)\*/,"g"),replace:'<span class="md-em">$1</span>'},{pattern:new RegExp(/^- /,"g"),replace:'<span class="md-right">&#9702;</span>'}],Mu=i=>(Bu.forEach(e=>{i=i.replaceAll(e.pattern,e.replace)}),i),Le=i=>{const e=i.replace(Nu,"").split(`
`);let n=[];for(const t of e)n.push(Mu(t.trim()));return n.join(`
`)};function Fu(i){let e,n;return{c(){e=O("div"),n=N(i[0]),S(e,"class","text-xs font-bold rounded-full shadow-sm bg-teal-600 text-white py-1.5 px-3")},m(t,r){C(t,e,r),b(e,n)},p(t,[r]){r&1&&B(n,t[0])},i:I,o:I,d(t){t&&y(e)}}}function Hu(i,e,n){let{text:t}=e;return i.$$set=r=>{"text"in r&&n(0,t=r.text)},[t]}class zu extends q{constructor(e){super(),D(this,e,Hu,Fu,L,{text:0})}}function $r(i){let e,n;return e=new zu({props:{text:`Progress: ${i[1]} / 3`}}),{c(){k(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p(t,r){const s={};r&2&&(s.text=`Progress: ${t[1]} / 3`),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function Ju(i){let e,n,t,r=i[0].id+"",s,o,l,a,u,c=ae(i[0].modified)+"",h,d,f=i[1]>=0&&$r(i);return{c(){e=O("div"),n=O("div"),t=N("Question Id: "),s=N(r),o=E(),f&&f.c(),l=E(),a=O("div"),u=N("Modified: "),h=N(c),S(n,"class","text-sm font-bold"),S(a,"class","text-sm"),S(e,"class","flex justify-between items-end")},m(p,g){C(p,e,g),b(e,n),b(n,t),b(n,s),b(e,o),f&&f.m(e,null),b(e,l),b(e,a),b(a,u),b(a,h),d=!0},p(p,[g]){(!d||g&1)&&r!==(r=p[0].id+"")&&B(s,r),p[1]>=0?f?(f.p(p,g),g&2&&m(f,1)):(f=$r(p),f.c(),m(f,1),f.m(e,l)):f&&(K(),_(f,1,1,()=>{f=null}),G()),(!d||g&1)&&c!==(c=ae(p[0].modified)+"")&&B(h,c)},i(p){d||(m(f),d=!0)},o(p){_(f),d=!1},d(p){p&&y(e),f&&f.d()}}}function Ku(i,e,n){let{question:t}=e,{progress:r=-1}=e;return i.$$set=s=>{"question"in s&&n(0,t=s.question),"progress"in s&&n(1,r=s.progress)},[t,r]}class Gu extends q{constructor(e){super(),D(this,e,Ku,Ju,L,{question:0,progress:1})}}function br(i){let e,n;return e=new Pt({props:{onClick:i[1]}}),{c(){k(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p(t,r){const s={};r&2&&(s.onClick=t[1]),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function Vu(i){let e,n,t,r=i[1]&&br(i);return n=new bn({props:{onClick:i[2]}}),{c(){r&&r.c(),e=E(),k(n.$$.fragment)},m(s,o){r&&r.m(s,o),C(s,e,o),w(n,s,o),t=!0},p(s,o){s[1]?r?(r.p(s,o),o&2&&m(r,1)):(r=br(s),r.c(),m(r,1),r.m(e.parentNode,e)):r&&(K(),_(r,1,1,()=>{r=null}),G());const l={};o&1&&(l.onClick=s[2]),n.$set(l)},i(s){t||(m(r),m(n.$$.fragment,s),t=!0)},o(s){_(r),_(n.$$.fragment,s),t=!1},d(s){s&&y(e),r&&r.d(s),v(n,s)}}}function Wu(i){let e,n,t;return n=new Q({props:{$$slots:{default:[Vu]},$$scope:{ctx:i}}}),{c(){e=O("div"),k(n.$$.fragment),S(e,"class","mt-2 flex justify-end")},m(r,s){C(r,e,s),w(n,e,null),t=!0},p(r,[s]){const o={};s&11&&(o.$$scope={dirty:s,ctx:r}),n.$set(o)},i(r){t||(m(n.$$.fragment,r),t=!0)},o(r){_(n.$$.fragment,r),t=!1},d(r){r&&y(e),v(n)}}}function Qu(i,e,n){let{question:t}=e,{onDelete:r=null}=e;const s=()=>z("/questions/update/"+t.id);return i.$$set=o=>{"question"in o&&n(0,t=o.question),"onDelete"in o&&n(1,r=o.onDelete)},[t,r,s]}class Yu extends q{constructor(e){super(),D(this,e,Qu,Wu,L,{question:0,onDelete:1})}}function wr(i){let e,n,t,r,s=Le(i[3]?i[0].quest:i[0].answer)+"",o,l,a=i[0].details&&vr(i);return{c(){e=O("div"),n=O("div"),n.textContent="Answer",t=E(),r=O("div"),o=E(),a&&a.c(),l=x(),S(n,"class","text-sm font-bold"),S(r,"class","px-4 py-3 mt-2 border border-gray-300 rounded shadow-sm whitespace-pre-line bg-yellow-50")},m(u,c){C(u,e,c),b(e,n),b(e,t),b(e,r),r.innerHTML=s,C(u,o,c),a&&a.m(u,c),C(u,l,c)},p(u,c){c&9&&s!==(s=Le(u[3]?u[0].quest:u[0].answer)+"")&&(r.innerHTML=s),u[0].details?a?a.p(u,c):(a=vr(u),a.c(),a.m(l.parentNode,l)):a&&(a.d(1),a=null)},d(u){u&&(y(e),y(o),y(l)),a&&a.d(u)}}}function vr(i){let e,n,t,r,s=Le(i[0].details)+"";return{c(){e=O("div"),n=O("div"),n.textContent="Details",t=E(),r=O("div"),S(n,"class","text-sm font-bold"),S(r,"class","px-4 py-3 mt-2 border border-gray-300 rounded shadow-sm whitespace-pre-line bg-yellow-50")},m(o,l){C(o,e,l),b(e,n),b(e,t),b(e,r),r.innerHTML=s},p(o,l){l&1&&s!==(s=Le(o[0].details)+"")&&(r.innerHTML=s)},d(o){o&&y(e)}}}function Xu(i){let e,n,t,r,s,o,l=Le(i[3]?i[0].answer:i[0].quest)+"",a,u,c,h;r=new Gu({props:{question:i[0],progress:i[1]}});let d=i[2]&&wr(i);return c=new Yu({props:{question:i[0],onDelete:i[4]}}),{c(){e=O("div"),n=O("div"),t=O("div"),k(r.$$.fragment),s=E(),o=O("div"),a=E(),d&&d.c(),u=E(),k(c.$$.fragment),S(o,"class","px-4 py-3 mt-2 border border-gray-300 rounded shadow-sm whitespace-pre-line bg-yellow-100"),S(n,"class","flex flex-col gap-3")},m(f,p){C(f,e,p),b(e,n),b(n,t),w(r,t,null),b(t,s),b(t,o),o.innerHTML=l,b(n,a),d&&d.m(n,null),b(e,u),w(c,e,null),h=!0},p(f,[p]){const g={};p&1&&(g.question=f[0]),p&2&&(g.progress=f[1]),r.$set(g),(!h||p&9)&&l!==(l=Le(f[3]?f[0].answer:f[0].quest)+"")&&(o.innerHTML=l),f[2]?d?d.p(f,p):(d=wr(f),d.c(),d.m(n,null)):d&&(d.d(1),d=null);const $={};p&1&&($.question=f[0]),p&16&&($.onDelete=f[4]),c.$set($)},i(f){h||(m(r.$$.fragment,f),m(c.$$.fragment,f),h=!0)},o(f){_(r.$$.fragment,f),_(c.$$.fragment,f),h=!1},d(f){f&&y(e),v(r),d&&d.d(),v(c)}}}function Zu(i,e,n){let{question:t}=e,{progress:r=-1}=e,{showAnswer:s=!0}=e,{reverse:o=!1}=e,{onDelete:l=null}=e;return i.$$set=a=>{"question"in a&&n(0,t=a.question),"progress"in a&&n(1,r=a.progress),"showAnswer"in a&&n(2,s=a.showAnswer),"reverse"in a&&n(3,o=a.reverse),"onDelete"in a&&n(4,l=a.onDelete)},[t,r,s,o,l]}class Cn extends q{constructor(e){super(),D(this,e,Zu,Xu,L,{question:0,progress:1,showAnswer:2,reverse:3,onDelete:4})}}function kr(i,e,n){const t=i.slice();return t[8]=e[n],t}function yr(i){let e,n;function t(){return i[5](i[8])}return e=new Cn({props:{question:i[8],onDelete:t}}),{c(){k(e.$$.fragment)},m(r,s){w(e,r,s),n=!0},p(r,s){i=r;const o={};s&8&&(o.question=i[8]),s&24&&(o.onDelete=t),e.$set(o)},i(r){n||(m(e.$$.fragment,r),n=!0)},o(r){_(e.$$.fragment,r),n=!1},d(r){v(e,r)}}}function xu(i){let e,n,t,r;return e=new F({props:{onClick:i[6],label:"Cancel"}}),t=new F({props:{onClick:i[7],label:"Create"}}),{c(){k(e.$$.fragment),n=E(),k(t.$$.fragment)},m(s,o){w(e,s,o),C(s,n,o),w(t,s,o),r=!0},p(s,o){const l={};o&4&&(l.onClick=s[6]),e.$set(l);const a={};o&1&&(a.onClick=s[7]),t.$set(a)},i(s){r||(m(e.$$.fragment,s),m(t.$$.fragment,s),r=!0)},o(s){_(e.$$.fragment,s),_(t.$$.fragment,s),r=!1},d(s){s&&y(n),v(e,s),v(t,s)}}}function ec(i){let e,n,t,r,s,o,l,a;e=new se({props:{header:"List Chapters"}}),t=new yn({props:{book:i[1],chapter:i[2]}});let u=re(i[3]),c=[];for(let d=0;d<u.length;d+=1)c[d]=yr(kr(i,u,d));const h=d=>_(c[d],1,1,()=>{c[d]=null});return l=new Q({props:{$$slots:{default:[xu]},$$scope:{ctx:i}}}),{c(){k(e.$$.fragment),n=E(),k(t.$$.fragment),r=E(),s=O("div");for(let d=0;d<c.length;d+=1)c[d].c();o=E(),k(l.$$.fragment),S(s,"class","flex flex-col gap-5")},m(d,f){w(e,d,f),C(d,n,f),w(t,d,f),C(d,r,f),C(d,s,f);for(let p=0;p<c.length;p+=1)c[p]&&c[p].m(s,null);C(d,o,f),w(l,d,f),a=!0},p(d,f){const p={};if(f&2&&(p.book=d[1]),f&4&&(p.chapter=d[2]),t.$set(p),f&24){u=re(d[3]);let $;for($=0;$<u.length;$+=1){const A=kr(d,u,$);c[$]?(c[$].p(A,f),m(c[$],1)):(c[$]=yr(A),c[$].c(),m(c[$],1),c[$].m(s,null))}for(K(),$=u.length;$<c.length;$+=1)h($);G()}const g={};f&2053&&(g.$$scope={dirty:f,ctx:d}),l.$set(g)},i(d){if(!a){m(e.$$.fragment,d),m(t.$$.fragment,d);for(let f=0;f<u.length;f+=1)m(c[f]);m(l.$$.fragment,d),a=!0}},o(d){_(e.$$.fragment,d),_(t.$$.fragment,d),c=c.filter(Boolean);for(let f=0;f<c.length;f+=1)_(c[f]);_(l.$$.fragment,d),a=!1},d(d){d&&(y(n),y(r),y(s),y(o)),v(e,d),v(t,d),$e(c,d),v(l,d)}}}function tc(i){let e,n,t,r;return e=new ie({props:{$$slots:{default:[ec]},$$scope:{ctx:i}}}),t=new wn({props:{title:"Delete Question",deleteEntry:i[4]}}),{c(){k(e.$$.fragment),n=E(),k(t.$$.fragment)},m(s,o){w(e,s,o),C(s,n,o),w(t,s,o),r=!0},p(s,[o]){const l={};o&2079&&(l.$$scope={dirty:o,ctx:s}),e.$set(l);const a={};o&16&&(a.deleteEntry=s[4]),t.$set(a)},i(s){r||(m(e.$$.fragment,s),m(t.$$.fragment,s),r=!0)},o(s){_(e.$$.fragment,s),_(t.$$.fragment,s),r=!1},d(s){s&&y(n),v(e,s),v(t,s)}}}function nc(i,e,n){let{params:t={id:0}}=e,r,s,o=[];pe(async()=>{n(2,s=await vn(t.id)),s&&(n(3,o=await dt(s.id)),n(1,r=await It(s.book_id)))});let l={entry:null,onDelete:h=>{Xa(h.id,h.chapter_id).then(d=>{n(3,o=d)})},getMessage:h=>`Do you wnat to delete the question: '${h.id}'?`};const a=h=>{n(4,l.entry=h,l)},u=()=>z("/chapters/list/"+(s==null?void 0:s.book_id)),c=()=>z("/questions/create/"+t.id);return i.$$set=h=>{"params"in h&&n(0,t=h.params)},[t,r,s,o,l,a,u,c]}class rc extends q{constructor(e){super(),D(this,e,nc,tc,L,{params:0})}}function Cr(i){let e,n,t=i[0].id+"",r,s,o,l=ae(i[0].modified)+"",a,u,c,h;return c=new ge({props:{onSubmit:i[6],$$slots:{default:[ic]},$$scope:{ctx:i}}}),{c(){e=O("div"),n=O("span"),r=N(t),s=E(),o=O("span"),a=N(l),u=E(),k(c.$$.fragment),S(e,"class","mb-4 text-small")},m(d,f){C(d,e,f),b(e,n),b(n,r),b(e,s),b(e,o),b(o,a),C(d,u,f),w(c,d,f),h=!0},p(d,f){(!h||f&1)&&t!==(t=d[0].id+"")&&B(r,t),(!h||f&1)&&l!==(l=ae(d[0].modified)+"")&&B(a,l);const p={};f&4158&&(p.$$scope={dirty:f,ctx:d}),c.$set(p)},i(d){h||(m(c.$$.fragment,d),h=!0)},o(d){_(c.$$.fragment,d),h=!1},d(d){d&&(y(e),y(u)),v(c,d)}}}function sc(i){let e,n,t,r;return e=new F({props:{onClick:i[11],label:"Back"}}),t=new F({props:{label:"Update"}}),{c(){k(e.$$.fragment),n=E(),k(t.$$.fragment)},m(s,o){w(e,s,o),C(s,n,o),w(t,s,o),r=!0},p:I,i(s){r||(m(e.$$.fragment,s),m(t.$$.fragment,s),r=!0)},o(s){_(e.$$.fragment,s),_(t.$$.fragment,s),r=!1},d(s){s&&y(n),v(e,s),v(t,s)}}}function ic(i){let e,n,t,r,s,o,l,a,u,c,h;function d(T){i[8](T)}let f={id:"question",label:"Questione",error:i[2]};i[1]!==void 0&&(f.value=i[1]),e=new ye({props:f}),ee.push(()=>ne(e,"value",d));function p(T){i[9](T)}let g={id:"answer",label:"Answer",error:i[4]};i[3]!==void 0&&(g.value=i[3]),r=new ye({props:g}),ee.push(()=>ne(r,"value",p));function $(T){i[10](T)}let A={id:"details",label:"Details",error:lc};return i[5]!==void 0&&(A.value=i[5]),l=new ye({props:A}),ee.push(()=>ne(l,"value",$)),c=new Q({props:{$$slots:{default:[sc]},$$scope:{ctx:i}}}),{c(){k(e.$$.fragment),t=E(),k(r.$$.fragment),o=E(),k(l.$$.fragment),u=E(),k(c.$$.fragment)},m(T,j){w(e,T,j),C(T,t,j),w(r,T,j),C(T,o,j),w(l,T,j),C(T,u,j),w(c,T,j),h=!0},p(T,j){const P={};j&4&&(P.error=T[2]),!n&&j&2&&(n=!0,P.value=T[1],te(()=>n=!1)),e.$set(P);const R={};j&16&&(R.error=T[4]),!s&&j&8&&(s=!0,R.value=T[3],te(()=>s=!1)),r.$set(R);const U={};!a&&j&32&&(a=!0,U.value=T[5],te(()=>a=!1)),l.$set(U);const J={};j&4096&&(J.$$scope={dirty:j,ctx:T}),c.$set(J)},i(T){h||(m(e.$$.fragment,T),m(r.$$.fragment,T),m(l.$$.fragment,T),m(c.$$.fragment,T),h=!0)},o(T){_(e.$$.fragment,T),_(r.$$.fragment,T),_(l.$$.fragment,T),_(c.$$.fragment,T),h=!1},d(T){T&&(y(t),y(o),y(u)),v(e,T),v(r,T),v(l,T),v(c,T)}}}function oc(i){let e,n,t,r;e=new se({props:{header:"Update Book"}});let s=i[0]&&Cr(i);return{c(){k(e.$$.fragment),n=E(),s&&s.c(),t=x()},m(o,l){w(e,o,l),C(o,n,l),s&&s.m(o,l),C(o,t,l),r=!0},p(o,l){o[0]?s?(s.p(o,l),l&1&&m(s,1)):(s=Cr(o),s.c(),m(s,1),s.m(t.parentNode,t)):s&&(K(),_(s,1,1,()=>{s=null}),G())},i(o){r||(m(e.$$.fragment,o),m(s),r=!0)},o(o){_(e.$$.fragment,o),_(s),r=!1},d(o){o&&(y(n),y(t)),v(e,o),s&&s.d(o)}}}function ac(i){let e,n;return e=new ie({props:{$$slots:{default:[oc]},$$scope:{ctx:i}}}),{c(){k(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p(t,[r]){const s={};r&4159&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}let lc="";function uc(i,e,n){let{params:t={id:""}}=e,r=null,s="",o="",l="",a="",u="";const c=async()=>{const g={quest:s.trim(),answer:l.trim()};if(n(2,o=ue(g.quest)),n(4,a=ue(g.answer)),!(o||a)){if(!r){W.setString("No question!!");return}await xa(r.id,r.chapter_id,g.quest,g.answer,as(u)),Dn()}};pe(async()=>{n(0,r=await Ya(parseInt(t.id))),r&&(n(1,s=r.quest),n(3,l=r.answer),n(5,u=r.details?r.details:""))});function h(g){s=g,n(1,s)}function d(g){l=g,n(3,l)}function f(g){u=g,n(5,u)}const p=()=>Dn();return i.$$set=g=>{"params"in g&&n(7,t=g.params)},[r,s,o,l,a,u,c,t,h,d,f,p]}class cc extends q{constructor(e){super(),D(this,e,uc,ac,L,{params:7})}}function fc(i){let e,n,t,r;return e=new F({props:{onClick:i[10],label:"Cancel"}}),t=new F({props:{label:"Create"}}),{c(){k(e.$$.fragment),n=E(),k(t.$$.fragment)},m(s,o){w(e,s,o),C(s,n,o),w(t,s,o),r=!0},p(s,o){const l={};o&1&&(l.onClick=s[10]),e.$set(l)},i(s){r||(m(e.$$.fragment,s),m(t.$$.fragment,s),r=!0)},o(s){_(e.$$.fragment,s),_(t.$$.fragment,s),r=!1},d(s){s&&y(n),v(e,s),v(t,s)}}}function hc(i){let e,n,t,r,s,o,l,a,u,c,h;function d(T){i[7](T)}let f={id:"question",label:"Question",error:i[2]};i[1]!==void 0&&(f.value=i[1]),e=new ye({props:f}),ee.push(()=>ne(e,"value",d));function p(T){i[8](T)}let g={id:"answer",label:"Answer",error:i[4]};i[3]!==void 0&&(g.value=i[3]),r=new ye({props:g}),ee.push(()=>ne(r,"value",p));function $(T){i[9](T)}let A={id:"details",label:"Details",error:mc};return i[5]!==void 0&&(A.value=i[5]),l=new ye({props:A}),ee.push(()=>ne(l,"value",$)),c=new Q({props:{$$slots:{default:[fc]},$$scope:{ctx:i}}}),{c(){k(e.$$.fragment),t=E(),k(r.$$.fragment),o=E(),k(l.$$.fragment),u=E(),k(c.$$.fragment)},m(T,j){w(e,T,j),C(T,t,j),w(r,T,j),C(T,o,j),w(l,T,j),C(T,u,j),w(c,T,j),h=!0},p(T,j){const P={};j&4&&(P.error=T[2]),!n&&j&2&&(n=!0,P.value=T[1],te(()=>n=!1)),e.$set(P);const R={};j&16&&(R.error=T[4]),!s&&j&8&&(s=!0,R.value=T[3],te(()=>s=!1)),r.$set(R);const U={};!a&&j&32&&(a=!0,U.value=T[5],te(()=>a=!1)),l.$set(U);const J={};j&2049&&(J.$$scope={dirty:j,ctx:T}),c.$set(J)},i(T){h||(m(e.$$.fragment,T),m(r.$$.fragment,T),m(l.$$.fragment,T),m(c.$$.fragment,T),h=!0)},o(T){_(e.$$.fragment,T),_(r.$$.fragment,T),_(l.$$.fragment,T),_(c.$$.fragment,T),h=!1},d(T){T&&(y(t),y(o),y(u)),v(e,T),v(r,T),v(l,T),v(c,T)}}}function dc(i){let e,n,t,r;return e=new se({props:{header:"Create Question"}}),t=new ge({props:{onSubmit:i[6],$$slots:{default:[hc]},$$scope:{ctx:i}}}),{c(){k(e.$$.fragment),n=E(),k(t.$$.fragment)},m(s,o){w(e,s,o),C(s,n,o),w(t,s,o),r=!0},p(s,o){const l={};o&2111&&(l.$$scope={dirty:o,ctx:s}),t.$set(l)},i(s){r||(m(e.$$.fragment,s),m(t.$$.fragment,s),r=!0)},o(s){_(e.$$.fragment,s),_(t.$$.fragment,s),r=!1},d(s){s&&y(n),v(e,s),v(t,s)}}}function pc(i){let e,n;return e=new ie({props:{$$slots:{default:[dc]},$$scope:{ctx:i}}}),{c(){k(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p(t,[r]){const s={};r&2111&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}let mc="";function _c(i,e,n){let{params:t={chapter_id:0}}=e,r="",s="",o="",l="",a="";const u=async()=>{const p={question:r.trim(),answer:o.trim()};n(2,s=ue(p.question)),n(4,l=ue(p.answer)),!(s||l)&&(await Za(t.chapter_id,p.question,p.answer,as(a)),z("/questions/list/"+t.chapter_id))};function c(p){r=p,n(1,r)}function h(p){o=p,n(3,o)}function d(p){a=p,n(5,a)}const f=()=>z("/questions/list/"+t.chapter_id);return i.$$set=p=>{"params"in p&&n(0,t=p.params)},[t,r,s,o,l,a,u,c,h,d,f]}class gc extends q{constructor(e){super(),D(this,e,_c,pc,L,{params:0})}}function Sr(i,e,n){const t=i.slice();return t[6]=e[n],t}function Er(i){let e,n=i[6].label+"",t,r,s;return{c(){e=O("option"),t=N(n),e.__value=r=i[6].value,Ke(e,e.__value),e.selected=s=i[6].value===i[0]},m(o,l){C(o,e,l),b(e,t)},p(o,l){l&8&&n!==(n=o[6].label+"")&&B(t,n),l&8&&r!==(r=o[6].value)&&(e.__value=r,Ke(e,e.__value)),l&9&&s!==(s=o[6].value===o[0])&&(e.selected=s)},d(o){o&&y(e)}}}function $c(i){let e,n,t,r=re(i[3]),s=[];for(let o=0;o<r.length;o+=1)s[o]=Er(Sr(i,r,o));return{c(){e=O("select");for(let o=0;o<s.length;o+=1)s[o].c();S(e,"id",i[2]),S(e,"name",i[2]),S(e,"class","input"),i[0]===void 0&&yt(()=>i[5].call(e))},m(o,l){C(o,e,l);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(e,null);Pn(e,i[0],!0),n||(t=Ye(e,"change",i[5]),n=!0)},p(o,l){if(l&9){r=re(o[3]);let a;for(a=0;a<r.length;a+=1){const u=Sr(o,r,a);s[a]?s[a].p(u,l):(s[a]=Er(u),s[a].c(),s[a].m(e,null))}for(;a<s.length;a+=1)s[a].d(1);s.length=r.length}l&4&&S(e,"id",o[2]),l&4&&S(e,"name",o[2]),l&9&&Pn(e,o[0])},d(o){o&&y(e),$e(s,o),n=!1,t()}}}function bc(i){let e,n;return e=new gn({props:{id:i[2],label:i[1],error:i[4],$$slots:{default:[$c]},$$scope:{ctx:i}}}),{c(){k(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p(t,[r]){const s={};r&4&&(s.id=t[2]),r&2&&(s.label=t[1]),r&16&&(s.error=t[4]),r&525&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function wc(i,e,n){let{label:t}=e,{id:r}=e,{value:s}=e,{options:o}=e,{error:l=""}=e;function a(){s=_s(this),n(0,s),n(3,o)}return i.$$set=u=>{"label"in u&&n(1,t=u.label),"id"in u&&n(2,r=u.id),"value"in u&&n(0,s=u.value),"options"in u&&n(3,o=u.options),"error"in u&&n(4,l=u.error)},[s,t,r,o,l,a]}class an extends q{constructor(e){super(),D(this,e,wc,bc,L,{label:1,id:2,value:0,options:3,error:4})}}function Or(i){let e,n,t=i[2].length+"",r;return{c(){e=O("div"),n=N("Length: "),r=N(t)},m(s,o){C(s,e,o),b(e,n),b(e,r)},p(s,o){o&4&&t!==(t=s[2].length+"")&&B(r,t)},d(s){s&&y(e)}}}function Tr(i){let e,n;return e=new ge({props:{onSubmit:i[9],$$slots:{default:[kc]},$$scope:{ctx:i}}}),{c(){k(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p(t,r){const s={};r&16410&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function vc(i){let e,n,t,r;return e=new F({props:{onClick:i[13],label:"Cancel"}}),t=new F({props:{label:"Start"}}),{c(){k(e.$$.fragment),n=E(),k(t.$$.fragment)},m(s,o){w(e,s,o),C(s,n,o),w(t,s,o),r=!0},p(s,o){const l={};o&2&&(l.onClick=s[13]),e.$set(l)},i(s){r||(m(e.$$.fragment,s),m(t.$$.fragment,s),r=!0)},o(s){_(e.$$.fragment,s),_(t.$$.fragment,s),r=!1},d(s){s&&y(n),v(e,s),v(t,s)}}}function kc(i){let e,n,t,r,s,o,l,a,u;function c(p){i[11](p)}let h={id:"correct",label:"Correct Answers",options:i[6],error:i[5]};i[3]!==void 0&&(h.value=i[3]),n=new an({props:h}),ee.push(()=>ne(n,"value",c));function d(p){i[12](p)}let f={id:"reverse",label:"Reverse Answers",options:i[8],error:i[7]};return i[4]!==void 0&&(f.value=i[4]),s=new an({props:f}),ee.push(()=>ne(s,"value",d)),a=new Q({props:{$$slots:{default:[vc]},$$scope:{ctx:i}}}),{c(){e=O("div"),k(n.$$.fragment),r=E(),k(s.$$.fragment),l=E(),k(a.$$.fragment),S(e,"class","flex flex-row gap-4")},m(p,g){C(p,e,g),w(n,e,null),b(e,r),w(s,e,null),C(p,l,g),w(a,p,g),u=!0},p(p,g){const $={};!t&&g&8&&(t=!0,$.value=p[3],te(()=>t=!1)),n.$set($);const A={};!o&&g&16&&(o=!0,A.value=p[4],te(()=>o=!1)),s.$set(A);const T={};g&16386&&(T.$$scope={dirty:g,ctx:p}),a.$set(T)},i(p){u||(m(n.$$.fragment,p),m(s.$$.fragment,p),m(a.$$.fragment,p),u=!0)},o(p){_(n.$$.fragment,p),_(s.$$.fragment,p),_(a.$$.fragment,p),u=!1},d(p){p&&(y(e),y(l)),v(n),v(s),v(a,p)}}}function yc(i){let e,n,t,r,s,o,l;e=new se({props:{header:"List Chapters"}}),t=new yn({props:{book:i[0],chapter:i[1]}});let a=i[1]&&Or(i),u=i[2].length!==0&&Tr(i);return{c(){k(e.$$.fragment),n=E(),k(t.$$.fragment),r=E(),a&&a.c(),s=E(),u&&u.c(),o=x()},m(c,h){w(e,c,h),C(c,n,h),w(t,c,h),C(c,r,h),a&&a.m(c,h),C(c,s,h),u&&u.m(c,h),C(c,o,h),l=!0},p(c,h){const d={};h&1&&(d.book=c[0]),h&2&&(d.chapter=c[1]),t.$set(d),c[1]?a?a.p(c,h):(a=Or(c),a.c(),a.m(s.parentNode,s)):a&&(a.d(1),a=null),c[2].length!==0?u?(u.p(c,h),h&4&&m(u,1)):(u=Tr(c),u.c(),m(u,1),u.m(o.parentNode,o)):u&&(K(),_(u,1,1,()=>{u=null}),G())},i(c){l||(m(e.$$.fragment,c),m(t.$$.fragment,c),m(u),l=!0)},o(c){_(e.$$.fragment,c),_(t.$$.fragment,c),_(u),l=!1},d(c){c&&(y(n),y(r),y(s),y(o)),v(e,c),v(t,c),a&&a.d(c),u&&u.d(c)}}}function Cc(i){let e,n;return e=new ie({props:{$$slots:{default:[yc]},$$scope:{ctx:i}}}),{c(){k(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p(t,[r]){const s={};r&16415&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function Sc(i,e,n){let{params:t={id:0}}=e,r,s,o=[],l="1",a,u=[{label:"0",value:"0"},{label:"1",value:"1"},{label:"2",value:"2"},{label:"3",value:"3"}],c="false",h,d=[{label:"True",value:"true"},{label:"False",value:"false"}];pe(async()=>{n(1,s=await vn(t.id)),s&&(n(2,o=await dt(s.id)),n(0,r=await It(s.book_id)),o.length===0&&W.setString("No questions found for this chapter!"))});const f=async()=>{tl(o,parseInt(l),c==="true"),z("/lession/process")};function p(A){l=A,n(3,l)}function g(A){c=A,n(4,c)}const $=()=>z("/chapters/list/"+(s==null?void 0:s.book_id));return i.$$set=A=>{"params"in A&&n(10,t=A.params)},[r,s,o,l,c,a,u,h,d,f,t,p,g,$]}class Ec extends q{constructor(e){super(),D(this,e,Sc,Cc,L,{params:10})}}function Ar(i,e,n){const t=i.slice();return t[2]=e[n],t[4]=n,t}function jr(i){let e,n,t=i[2]+"",r;return{c(){e=O("dt"),e.textContent=`${i[1][i[4]]}`,n=O("dd"),r=N(t),S(e,"class","col-span-3 px-4 py-1"),S(n,"class","border-l border-gray-300 px-4 py-1 text-right")},m(s,o){C(s,e,o),C(s,n,o),b(n,r)},p(s,o){o&1&&t!==(t=s[2]+"")&&B(r,t)},d(s){s&&(y(e),y(n))}}}function Oc(i){let e,n=re(i[0]),t=[];for(let r=0;r<n.length;r+=1)t[r]=jr(Ar(i,n,r));return{c(){e=O("dl");for(let r=0;r<t.length;r+=1)t[r].c();S(e,"class","border border-gray-300 shadow-sm rounded grid grid-cols-4 w-64 py-2")},m(r,s){C(r,e,s);for(let o=0;o<t.length;o+=1)t[o]&&t[o].m(e,null)},p(r,[s]){if(s&3){n=re(r[0]);let o;for(o=0;o<n.length;o+=1){const l=Ar(r,n,o);t[o]?t[o].p(l,s):(t[o]=jr(l),t[o].c(),t[o].m(e,null))}for(;o<t.length;o+=1)t[o].d(1);t.length=n.length}},i:I,o:I,d(r){r&&y(e),$e(t,r)}}}function Tc(i,e,n){let{progress:t}=e,r=["No correct answers","One correct answer","Two correct answers","Learned"];return i.$$set=s=>{"progress"in s&&n(0,t=s.progress)},[t,r]}class Ac extends q{constructor(e){super(),D(this,e,Tc,Oc,L,{progress:0})}}function jc(i){let e,n;return e=new Cn({props:{question:i[2].question,showAnswer:i[4],progress:i[2].progress,reverse:i[0].reverse}}),{c(){k(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p(t,r){const s={};r&4&&(s.question=t[2].question),r&16&&(s.showAnswer=t[4]),r&4&&(s.progress=t[2].progress),r&1&&(s.reverse=t[0].reverse),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function Pc(i){let e;return{c(){e=O("p"),e.textContent="End"},m(n,t){C(n,e,t)},p:I,i:I,o:I,d(n){n&&y(e)}}}function Pr(i){let e,n,t=i[2]&&Ir(i);return{c(){t&&t.c(),e=x()},m(r,s){t&&t.m(r,s),C(r,e,s),n=!0},p(r,s){r[2]?t?(t.p(r,s),s&4&&m(t,1)):(t=Ir(r),t.c(),m(t,1),t.m(e.parentNode,e)):t&&(K(),_(t,1,1,()=>{t=null}),G())},i(r){n||(m(t),n=!0)},o(r){_(t),n=!1},d(r){r&&y(e),t&&t.d(r)}}}function Ir(i){let e,n,t,r;const s=[Rc,Ic],o=[];function l(a,u){return a[4]?1:0}return e=l(i),n=o[e]=s[e](i),{c(){n.c(),t=x()},m(a,u){o[e].m(a,u),C(a,t,u),r=!0},p(a,u){let c=e;e=l(a),e===c?o[e].p(a,u):(K(),_(o[c],1,1,()=>{o[c]=null}),G(),n=o[e],n?n.p(a,u):(n=o[e]=s[e](a),n.c()),m(n,1),n.m(t.parentNode,t))},i(a){r||(m(n),r=!0)},o(a){_(n),r=!1},d(a){a&&y(t),o[e].d(a)}}}function Ic(i){let e,n,t,r,s,o,l,a;return e=new F({props:{label:"Correct",onClick:i[6]}}),t=new F({props:{label:"Wrong",onClick:i[7]}}),s=new F({props:{label:"Learned",onClick:i[8]}}),l=new F({props:{label:"Skip",onClick:i[9]}}),{c(){k(e.$$.fragment),n=E(),k(t.$$.fragment),r=E(),k(s.$$.fragment),o=E(),k(l.$$.fragment)},m(u,c){w(e,u,c),C(u,n,c),w(t,u,c),C(u,r,c),w(s,u,c),C(u,o,c),w(l,u,c),a=!0},p:I,i(u){a||(m(e.$$.fragment,u),m(t.$$.fragment,u),m(s.$$.fragment,u),m(l.$$.fragment,u),a=!0)},o(u){_(e.$$.fragment,u),_(t.$$.fragment,u),_(s.$$.fragment,u),_(l.$$.fragment,u),a=!1},d(u){u&&(y(n),y(r),y(o)),v(e,u),v(t,u),v(s,u),v(l,u)}}}function Rc(i){let e,n;return e=new F({props:{label:"Show",onClick:i[5]}}),{c(){k(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p:I,i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function Lc(i){let e,n,t,r;e=new F({props:{label:"Stop",onClick:i[10]}});let s=!i[3]&&Pr(i);return{c(){k(e.$$.fragment),n=E(),s&&s.c(),t=x()},m(o,l){w(e,o,l),C(o,n,l),s&&s.m(o,l),C(o,t,l),r=!0},p(o,l){o[3]?s&&(K(),_(s,1,1,()=>{s=null}),G()):s?(s.p(o,l),l&8&&m(s,1)):(s=Pr(o),s.c(),m(s,1),s.m(t.parentNode,t))},i(o){r||(m(e.$$.fragment,o),m(s),r=!0)},o(o){_(e.$$.fragment,o),_(s),r=!1},d(o){o&&(y(n),y(t)),v(e,o),s&&s.d(o)}}}function Dc(i){let e,n,t,r,s,o,l,a,u;e=new se({props:{header:"Lession"}}),t=new Ac({props:{progress:i[1]}});const c=[Pc,jc],h=[];function d(f,p){return f[3]?0:f[2]?1:-1}return~(s=d(i))&&(o=h[s]=c[s](i)),a=new Q({props:{$$slots:{default:[Lc]},$$scope:{ctx:i}}}),{c(){k(e.$$.fragment),n=E(),k(t.$$.fragment),r=E(),o&&o.c(),l=E(),k(a.$$.fragment)},m(f,p){w(e,f,p),C(f,n,p),w(t,f,p),C(f,r,p),~s&&h[s].m(f,p),C(f,l,p),w(a,f,p),u=!0},p(f,p){const g={};p&2&&(g.progress=f[1]),t.$set(g);let $=s;s=d(f),s===$?~s&&h[s].p(f,p):(o&&(K(),_(h[$],1,1,()=>{h[$]=null}),G()),~s?(o=h[s],o?o.p(f,p):(o=h[s]=c[s](f),o.c()),m(o,1),o.m(l.parentNode,l)):o=null);const A={};p&8220&&(A.$$scope={dirty:p,ctx:f}),a.$set(A)},i(f){u||(m(e.$$.fragment,f),m(t.$$.fragment,f),m(o),m(a.$$.fragment,f),u=!0)},o(f){_(e.$$.fragment,f),_(t.$$.fragment,f),_(o),_(a.$$.fragment,f),u=!1},d(f){f&&(y(n),y(r),y(l)),v(e,f),v(t,f),~s&&h[s].d(f),v(a,f)}}}function qc(i){let e,n;return e=new ie({props:{$$slots:{default:[Dc]},$$scope:{ctx:i}}}),{c(){k(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p(t,[r]){const s={};r&8223&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function Uc(i,e,n){let t,r=[0,0,0,0],s,o=!1,l=!1;const a=()=>{n(4,l=!0)},u=$=>{if(n(2,s.progress=$,s),s.progress<3?t.learning.push(s):t.learned.push(s),n(1,r=sr(t)),!nl(t)){n(3,o=!0);return}g()},c=()=>{u(s.progress+1)},h=()=>{u(0)},d=()=>{u(3)},f=()=>{u(s.progress)},p=()=>{z("/")},g=()=>{const $=t.learning.shift();$?(n(2,s=$),n(4,l=!1)):n(3,o=!0)};return pe(async()=>{const $=us();if(!$){W.setString("No lession found!");return}n(0,t=await il($)),n(1,r=sr(t)),g()}),[t,r,s,o,l,a,c,h,d,f,p]}class Nc extends q{constructor(e){super(),D(this,e,Uc,qc,L,{})}}function Rr(i,e,n){const t=i.slice();return t[8]=e[n],t}function Bc(i){let e,n;return e=new F({props:{disabled:i[4],label:"Search"}}),{c(){k(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p(t,r){const s={};r&16&&(s.disabled=t[4]),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function Mc(i){let e,n,t,r,s,o,l,a;function u(f){i[6](f)}let c={id:"search",label:"Search Text"};i[0]!==void 0&&(c.value=i[0]),e=new Ce({props:c}),ee.push(()=>ne(e,"value",u));function h(f){i[7](f)}let d={id:"where",label:"Where",options:[{label:"Question",value:"quest"},{label:"Answer",value:"answer"},{label:"Details",value:"details"}]};return i[2]!==void 0&&(d.value=i[2]),r=new an({props:d}),ee.push(()=>ne(r,"value",h)),l=new Q({props:{$$slots:{default:[Bc]},$$scope:{ctx:i}}}),{c(){k(e.$$.fragment),t=E(),k(r.$$.fragment),o=E(),k(l.$$.fragment)},m(f,p){w(e,f,p),C(f,t,p),w(r,f,p),C(f,o,p),w(l,f,p),a=!0},p(f,p){const g={};!n&&p&1&&(n=!0,g.value=f[0],te(()=>n=!1)),e.$set(g);const $={};!s&&p&4&&(s=!0,$.value=f[2],te(()=>s=!1)),r.$set($);const A={};p&2064&&(A.$$scope={dirty:p,ctx:f}),l.$set(A)},i(f){a||(m(e.$$.fragment,f),m(r.$$.fragment,f),m(l.$$.fragment,f),a=!0)},o(f){_(e.$$.fragment,f),_(r.$$.fragment,f),_(l.$$.fragment,f),a=!1},d(f){f&&(y(t),y(o)),v(e,f),v(r,f),v(l,f)}}}function Fc(i){let e;return{c(){e=O("p"),e.textContent="Nothing found ..."},m(n,t){C(n,e,t)},p:I,i:I,o:I,d(n){n&&y(e)}}}function Hc(i){let e,n,t,r=i[3].hasMore&&Lr(),s=re(i[3].questions),o=[];for(let a=0;a<s.length;a+=1)o[a]=Dr(Rr(i,s,a));const l=a=>_(o[a],1,1,()=>{o[a]=null});return{c(){r&&r.c(),e=E(),n=O("div");for(let a=0;a<o.length;a+=1)o[a].c();S(n,"class","flex flex-col gap-5")},m(a,u){r&&r.m(a,u),C(a,e,u),C(a,n,u);for(let c=0;c<o.length;c+=1)o[c]&&o[c].m(n,null);t=!0},p(a,u){if(a[3].hasMore?r||(r=Lr(),r.c(),r.m(e.parentNode,e)):r&&(r.d(1),r=null),u&8){s=re(a[3].questions);let c;for(c=0;c<s.length;c+=1){const h=Rr(a,s,c);o[c]?(o[c].p(h,u),m(o[c],1)):(o[c]=Dr(h),o[c].c(),m(o[c],1),o[c].m(n,null))}for(K(),c=s.length;c<o.length;c+=1)l(c);G()}},i(a){if(!t){for(let u=0;u<s.length;u+=1)m(o[u]);t=!0}},o(a){o=o.filter(Boolean);for(let u=0;u<o.length;u+=1)_(o[u]);t=!1},d(a){a&&(y(e),y(n)),r&&r.d(a),$e(o,a)}}}function Lr(i){let e;return{c(){e=O("div"),e.textContent="has more ...",S(e,"class","text-red-700")},m(n,t){C(n,e,t)},d(n){n&&y(e)}}}function Dr(i){let e,n;return e=new Cn({props:{question:i[8]}}),{c(){k(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p(t,r){const s={};r&8&&(s.question=t[8]),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function zc(i){let e,n,t,r,s,o,l,a;e=new se({props:{header:"Search Questions"}}),t=new ge({props:{onSubmit:i[5],$$slots:{default:[Mc]},$$scope:{ctx:i}}});const u=[Hc,Fc],c=[];function h(d,f){return d[3]&&d[3].questions.length>0?0:d[1]!==""?1:-1}return~(s=h(i))&&(o=c[s]=u[s](i)),{c(){k(e.$$.fragment),n=E(),k(t.$$.fragment),r=E(),o&&o.c(),l=x()},m(d,f){w(e,d,f),C(d,n,f),w(t,d,f),C(d,r,f),~s&&c[s].m(d,f),C(d,l,f),a=!0},p(d,f){const p={};f&2069&&(p.$$scope={dirty:f,ctx:d}),t.$set(p);let g=s;s=h(d),s===g?~s&&c[s].p(d,f):(o&&(K(),_(c[g],1,1,()=>{c[g]=null}),G()),~s?(o=c[s],o?o.p(d,f):(o=c[s]=u[s](d),o.c()),m(o,1),o.m(l.parentNode,l)):o=null)},i(d){a||(m(e.$$.fragment,d),m(t.$$.fragment,d),m(o),a=!0)},o(d){_(e.$$.fragment,d),_(t.$$.fragment,d),_(o),a=!1},d(d){d&&(y(n),y(r),y(l)),v(e,d),v(t,d),~s&&c[s].d(d)}}}function Jc(i){let e,n;return e=new ie({props:{$$slots:{default:[zc]},$$scope:{ctx:i}}}),{c(){k(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p(t,[r]){const s={};r&2079&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function Kc(i,e,n){let t,r="",s="",o="quest",l;const a=async()=>{n(3,l=await el(r,o)),n(1,s=r)};function u(h){r=h,n(0,r)}function c(h){o=h,n(2,o)}return i.$$.update=()=>{i.$$.dirty&3&&n(4,t=r.length<3||r===s)},[r,s,o,l,t,a,u,c]}class Gc extends q{constructor(e){super(),D(this,e,Kc,Jc,L,{})}}function Vc(i){let e;return{c(){e=O("p"),e.textContent="User is not logged in"},m(n,t){C(n,e,t)},p:I,d(n){n&&y(e)}}}function Wc(i){let e,n,t,r,s,o,l,a,u=i[0].id+"",c,h,d,f,p,g,$=i[0].email+"",A,T,j,P,R,U,J=i[0].created_at+"",Y,fe,Ze,Lt,Sn,Dt,pt=i[0].aud+"",qt,En,xe,Ut,On,Nt,mt=JSON.stringify(i[0].user_metadata)+"",Bt,Tn,et,Mt,An,Ft,_t=JSON.stringify(i[0].app_metadata)+"",Ht;return{c(){e=O("table"),n=O("thead"),n.innerHTML="<tr><th>Key</th> <th>Value</th></tr>",t=E(),r=O("tbody"),s=O("tr"),o=O("td"),o.textContent="Id",l=E(),a=O("td"),c=N(u),h=E(),d=O("tr"),f=O("td"),f.textContent="Email",p=E(),g=O("td"),A=N($),T=E(),j=O("tr"),P=O("td"),P.textContent="Created",R=E(),U=O("td"),Y=N(J),fe=E(),Ze=O("tr"),Lt=O("td"),Lt.textContent="Aud",Sn=E(),Dt=O("td"),qt=N(pt),En=E(),xe=O("tr"),Ut=O("td"),Ut.textContent="User Metadata",On=E(),Nt=O("td"),Bt=N(mt),Tn=E(),et=O("tr"),Mt=O("td"),Mt.textContent="App Metatata",An=E(),Ft=O("td"),Ht=N(_t),S(e,"class","w-full")},m(_e,be){C(_e,e,be),b(e,n),b(e,t),b(e,r),b(r,s),b(s,o),b(s,l),b(s,a),b(a,c),b(r,h),b(r,d),b(d,f),b(d,p),b(d,g),b(g,A),b(r,T),b(r,j),b(j,P),b(j,R),b(j,U),b(U,Y),b(r,fe),b(r,Ze),b(Ze,Lt),b(Ze,Sn),b(Ze,Dt),b(Dt,qt),b(r,En),b(r,xe),b(xe,Ut),b(xe,On),b(xe,Nt),b(Nt,Bt),b(r,Tn),b(r,et),b(et,Mt),b(et,An),b(et,Ft),b(Ft,Ht)},p(_e,be){be&1&&u!==(u=_e[0].id+"")&&B(c,u),be&1&&$!==($=_e[0].email+"")&&B(A,$),be&1&&J!==(J=_e[0].created_at+"")&&B(Y,J),be&1&&pt!==(pt=_e[0].aud+"")&&B(qt,pt),be&1&&mt!==(mt=JSON.stringify(_e[0].user_metadata)+"")&&B(Bt,mt),be&1&&_t!==(_t=JSON.stringify(_e[0].app_metadata)+"")&&B(Ht,_t)},d(_e){_e&&y(e)}}}function Qc(i){let e,n;return e=new F({props:{onClick:i[1],label:"Cancel"}}),{c(){k(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p:I,i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function Yc(i){let e,n,t,r,s;e=new se({props:{header:"User"}});function o(u,c){return u[0]?Wc:Vc}let l=o(i),a=l(i);return r=new Q({props:{$$slots:{default:[Qc]},$$scope:{ctx:i}}}),{c(){k(e.$$.fragment),n=E(),a.c(),t=E(),k(r.$$.fragment)},m(u,c){w(e,u,c),C(u,n,c),a.m(u,c),C(u,t,c),w(r,u,c),s=!0},p(u,c){l===(l=o(u))&&a?a.p(u,c):(a.d(1),a=l(u),a&&(a.c(),a.m(t.parentNode,t)));const h={};c&4&&(h.$$scope={dirty:c,ctx:u}),r.$set(h)},i(u){s||(m(e.$$.fragment,u),m(r.$$.fragment,u),s=!0)},o(u){_(e.$$.fragment,u),_(r.$$.fragment,u),s=!1},d(u){u&&(y(n),y(t)),v(e,u),a.d(u),v(r,u)}}}function Xc(i){let e,n;return e=new ie({props:{$$slots:{default:[Yc]},$$scope:{ctx:i}}}),{c(){k(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p(t,[r]){const s={};r&5&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function Zc(i,e,n){let t;return ln(i,vt,s=>n(0,t=s)),[t,()=>z("/")]}class xc extends q{constructor(e){super(),D(this,e,Zc,Xc,L,{})}}function qr(i,e,n){const t=i.slice();return t[2]=e[n],t}function Ur(i){let e,n,t,r,s=Le(i[2])+"",o;return{c(){e=O("tr"),n=O("td"),n.textContent=`${i[2]}`,t=E(),r=O("td"),o=E(),S(n,"class","whitespace-pre-line"),S(r,"class","whitespace-pre-line")},m(l,a){C(l,e,a),b(e,n),b(e,t),b(e,r),r.innerHTML=s,b(e,o)},p:I,d(l){l&&y(e)}}}function ef(i){let e,n;return e=new F({props:{onClick:i[1],label:"Cancel"}}),{c(){k(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p:I,i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function tf(i){let e,n,t,r,s,o,l,a,u;e=new se({props:{header:"Markdown Examples"}});let c=re(i[0]),h=[];for(let d=0;d<c.length;d+=1)h[d]=Ur(qr(i,c,d));return a=new Q({props:{$$slots:{default:[ef]},$$scope:{ctx:i}}}),{c(){k(e.$$.fragment),n=E(),t=O("table"),r=O("thead"),r.innerHTML="<tr><th>Example</th> <th>Replacement</th></tr>",s=E(),o=O("tbody");for(let d=0;d<h.length;d+=1)h[d].c();l=E(),k(a.$$.fragment),S(t,"class","w-full")},m(d,f){w(e,d,f),C(d,n,f),C(d,t,f),b(t,r),b(t,s),b(t,o);for(let p=0;p<h.length;p+=1)h[p]&&h[p].m(o,null);C(d,l,f),w(a,d,f),u=!0},p(d,f){if(f&1){c=re(d[0]);let g;for(g=0;g<c.length;g+=1){const $=qr(d,c,g);h[g]?h[g].p($,f):(h[g]=Ur($),h[g].c(),h[g].m(o,null))}for(;g<h.length;g+=1)h[g].d(1);h.length=c.length}const p={};f&32&&(p.$$scope={dirty:f,ctx:d}),a.$set(p)},i(d){u||(m(e.$$.fragment,d),m(a.$$.fragment,d),u=!0)},o(d){_(e.$$.fragment,d),_(a.$$.fragment,d),u=!1},d(d){d&&(y(n),y(t),y(l)),v(e,d),$e(h,d),v(a,d)}}}function nf(i){let e,n;return e=new ie({props:{$$slots:{default:[tf]},$$scope:{ctx:i}}}),{c(){k(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p(t,[r]){const s={};r&32&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function rf(i){return[["This is an e**xample","This is an e*xampl*e","This is #=an example","This is=# an example","This is #an# example",`List
- Item
- Item`],()=>z("/")]}class sf extends q{constructor(e){super(),D(this,e,rf,nf,L,{})}}function of(i){let e,n;return e=new Ps({props:{routes:i[0]}}),{c(){k(e.$$.fragment)},m(t,r){w(e,t,r),n=!0},p:I,i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){v(e,t)}}}function af(i){let e,n,t,r,s,o,l;return n=new Ks({}),r=new Ja({props:{$$slots:{default:[of]},$$scope:{ctx:i}}}),{c(){e=O("main"),k(n.$$.fragment),t=E(),k(r.$$.fragment),s=E(),o=O("footer"),o.textContent="by Volker Senkel 2024",S(o,"class","text-sm text-end my-4 pt-2 border-t"),S(e,"class","text-gray-600 max-w-screen-lg m-auto mt-4")},m(a,u){C(a,e,u),w(n,e,null),b(e,t),w(r,e,null),b(e,s),b(e,o),l=!0},p(a,[u]){const c={};u&2&&(c.$$scope={dirty:u,ctx:a}),r.$set(c)},i(a){l||(m(n.$$.fragment,a),m(r.$$.fragment,a),l=!0)},o(a){_(n.$$.fragment,a),_(r.$$.fragment,a),l=!1},d(a){a&&y(e),v(n),v(r)}}}function lf(i){return[{"/":hl,"/books/list":Jl,"/books/create":xl,"/books/update/:id":iu,"/chapters/list/:id":Su,"/chapters/create/:book_id":Pu,"/chapters/update/:id":Uu,"/questions/list/:id":rc,"/questions/create/:chapter_id":gc,"/questions/update/:id":cc,"/lession/prepare/:id":Ec,"/lession/process":Nc,"/cache":yl,"/search":Gc,"/user":xc,"/info":sf,"*":El}]}class uf extends q{constructor(e){super(),D(this,e,lf,af,L,{})}}new uf({target:document.getElementById("app")});
