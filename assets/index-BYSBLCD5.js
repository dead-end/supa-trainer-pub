var _s=Object.defineProperty;var $s=(i,e,n)=>e in i?_s(i,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):i[e]=n;var Kt=(i,e,n)=>($s(i,typeof e!="symbol"?e+"":e,n),n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))t(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&t(o)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function t(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}})();function P(){}function ot(i,e){for(const n in e)i[n]=e[n];return i}function Hr(i){return i()}function Rn(){return Object.create(null)}function Qe(i){i.forEach(Hr)}function Ye(i){return typeof i=="function"}function L(i,e){return i!=i?e==e:i!==e||i&&typeof i=="object"||typeof i=="function"}function gs(i){return Object.keys(i).length===0}function zr(i,...e){if(i==null){for(const t of e)t(void 0);return P}const n=i.subscribe(...e);return n.unsubscribe?()=>n.unsubscribe():n}function fn(i,e,n){i.$$.on_destroy.push(zr(e,n))}function be(i,e,n,t){if(i){const r=Jr(i,e,n,t);return i[0](r)}}function Jr(i,e,n,t){return i[1]&&t?ot(n.ctx.slice(),i[1](t(e))):n.ctx}function we(i,e,n,t){if(i[2]&&t){const r=i[2](t(n));if(e.dirty===void 0)return r;if(typeof r=="object"){const s=[],o=Math.max(e.dirty.length,r.length);for(let l=0;l<o;l+=1)s[l]=e.dirty[l]|r[l];return s}return e.dirty|r}return e.dirty}function ve(i,e,n,t,r,s){if(r){const o=Jr(e,n,t,s);i.p(o,r)}}function ke(i){if(i.ctx.length>32){const e=[],n=i.ctx.length/32;for(let t=0;t<n;t++)e[t]=-1;return e}return-1}function v(i,e){i.appendChild(e)}function C(i,e,n){i.insertBefore(e,n||null)}function y(i){i.parentNode&&i.parentNode.removeChild(i)}function ye(i,e){for(let n=0;n<i.length;n+=1)i[n]&&i[n].d(e)}function O(i){return document.createElement(i)}function Y(i){return document.createElementNS("http://www.w3.org/2000/svg",i)}function U(i){return document.createTextNode(i)}function A(){return U(" ")}function x(){return U("")}function De(i,e,n,t){return i.addEventListener(e,n,t),()=>i.removeEventListener(e,n,t)}function bs(i){return function(e){return e.preventDefault(),i.call(this,e)}}function k(i,e,n){n==null?i.removeAttribute(e):i.getAttribute(e)!==n&&i.setAttribute(e,n)}function ws(i){return Array.from(i.childNodes)}function B(i,e){e=""+e,i.data!==e&&(i.data=e)}function Oe(i,e){i.value=e??""}function Ln(i,e,n){for(let t=0;t<i.options.length;t+=1){const r=i.options[t];if(r.__value===e){r.selected=!0;return}}(!n||e!==void 0)&&(i.selectedIndex=-1)}function vs(i){const e=i.querySelector(":checked");return e&&e.__value}function ks(i,e,{bubbles:n=!1,cancelable:t=!1}={}){return new CustomEvent(i,{detail:e,bubbles:n,cancelable:t})}function yt(i,e){return new i(e)}let at;function rt(i){at=i}function Ot(){if(!at)throw new Error("Function called outside component initialization");return at}function fe(i){Ot().$$.on_mount.push(i)}function ys(i){Ot().$$.after_update.push(i)}function Cs(i){Ot().$$.on_destroy.push(i)}function Ss(){const i=Ot();return(e,n,{cancelable:t=!1}={})=>{const r=i.$$.callbacks[e];if(r){const s=ks(e,n,{cancelable:t});return r.slice().forEach(o=>{o.call(i,s)}),!s.defaultPrevented}return!0}}function Dn(i,e){const n=i.$$.callbacks[e.type];n&&n.slice().forEach(t=>t.call(this,e))}const He=[],ee=[];let Je=[];const en=[],Kr=Promise.resolve();let tn=!1;function Gr(){tn||(tn=!0,Kr.then(Vr))}function hn(){return Gr(),Kr}function Ct(i){Je.push(i)}function te(i){en.push(i)}const Gt=new Set;let Ue=0;function Vr(){if(Ue!==0)return;const i=at;do{try{for(;Ue<He.length;){const e=He[Ue];Ue++,rt(e),Es(e.$$)}}catch(e){throw He.length=0,Ue=0,e}for(rt(null),He.length=0,Ue=0;ee.length;)ee.pop()();for(let e=0;e<Je.length;e+=1){const n=Je[e];Gt.has(n)||(Gt.add(n),n())}Je.length=0}while(He.length);for(;en.length;)en.pop()();tn=!1,Gt.clear(),rt(i)}function Es(i){if(i.fragment!==null){i.update(),Qe(i.before_update);const e=i.dirty;i.dirty=[-1],i.fragment&&i.fragment.p(i.ctx,e),i.after_update.forEach(Ct)}}function As(i){const e=[],n=[];Je.forEach(t=>i.indexOf(t)===-1?e.push(t):n.push(t)),n.forEach(t=>t()),Je=e}const vt=new Set;let Le;function K(){Le={r:0,c:[],p:Le}}function G(){Le.r||Qe(Le.c),Le=Le.p}function m(i,e){i&&i.i&&(vt.delete(i),i.i(e))}function _(i,e,n,t){if(i&&i.o){if(vt.has(i))return;vt.add(i),Le.c.push(()=>{vt.delete(i),t&&(n&&i.d(1),t())}),i.o(e)}else t&&t()}function re(i){return(i==null?void 0:i.length)!==void 0?i:Array.from(i)}function St(i,e){const n={},t={},r={$$scope:1};let s=i.length;for(;s--;){const o=i[s],l=e[s];if(l){for(const a in o)a in l||(t[a]=1);for(const a in l)r[a]||(n[a]=l[a],r[a]=1);i[s]=l}else for(const a in o)r[a]=1}for(const o in t)o in n||(n[o]=void 0);return n}function Et(i){return typeof i=="object"&&i!==null?i:{}}function ne(i,e,n){const t=i.$$.props[e];t!==void 0&&(i.$$.bound[t]=n,n(i.$$.ctx[t]))}function w(i){i&&i.c()}function g(i,e,n){const{fragment:t,after_update:r}=i.$$;t&&t.m(e,n),Ct(()=>{const s=i.$$.on_mount.map(Hr).filter(Ye);i.$$.on_destroy?i.$$.on_destroy.push(...s):Qe(s),i.$$.on_mount=[]}),r.forEach(Ct)}function b(i,e){const n=i.$$;n.fragment!==null&&(As(n.after_update),Qe(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function Os(i,e){i.$$.dirty[0]===-1&&(He.push(i),Gr(),i.$$.dirty.fill(0)),i.$$.dirty[e/31|0]|=1<<e%31}function D(i,e,n,t,r,s,o=null,l=[-1]){const a=at;rt(i);const u=i.$$={fragment:null,ctx:[],props:s,update:P,not_equal:r,bound:Rn(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(a?a.$$.context:[])),callbacks:Rn(),dirty:l,skip_bound:!1,root:e.target||a.$$.root};o&&o(u.root);let c=!1;if(u.ctx=n?n(i,e.props||{},(h,d,...f)=>{const p=f.length?f[0]:d;return u.ctx&&r(u.ctx[h],u.ctx[h]=p)&&(!u.skip_bound&&u.bound[h]&&u.bound[h](p),c&&Os(i,h)),d}):[],u.update(),c=!0,Qe(u.before_update),u.fragment=t?t(u.ctx):!1,e.target){if(e.hydrate){const h=ws(e.target);u.fragment&&u.fragment.l(h),h.forEach(y)}else u.fragment&&u.fragment.c();e.intro&&m(i.$$.fragment),g(i,e.target,e.anchor),Vr()}rt(a)}class q{constructor(){Kt(this,"$$");Kt(this,"$$set")}$destroy(){b(this,1),this.$destroy=P}$on(e,n){if(!Ye(n))return P;const t=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return t.push(n),()=>{const r=t.indexOf(n);r!==-1&&t.splice(r,1)}}$set(e){this.$$set&&!gs(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const Ts="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(Ts);const Ne=[];function Wr(i,e){return{subscribe:Tt(i,e).subscribe}}function Tt(i,e=P){let n;const t=new Set;function r(l){if(L(i,l)&&(i=l,n)){const a=!Ne.length;for(const u of t)u[1](),Ne.push(u,i);if(a){for(let u=0;u<Ne.length;u+=2)Ne[u][0](Ne[u+1]);Ne.length=0}}}function s(l){r(l(i))}function o(l,a=P){const u=[l,a];return t.add(u),t.size===1&&(n=e(r,s)||P),l(i),()=>{t.delete(u),t.size===0&&n&&(n(),n=null)}}return{set:r,update:s,subscribe:o}}function Qr(i,e,n){const t=!Array.isArray(i),r=t?[i]:i;if(!r.every(Boolean))throw new Error("derived() expects stores as input, got a falsy value");const s=e.length<2;return Wr(n,(o,l)=>{let a=!1;const u=[];let c=0,h=P;const d=()=>{if(c)return;h();const p=e(t?u[0]:u,o,l);s?o(p):h=Ye(p)?p:P},f=r.map((p,$)=>zr(p,S=>{u[$]=S,c&=~(1<<$),a&&d()},()=>{c|=1<<$}));return a=!0,d(),function(){Qe(f),h(),a=!1}})}function js(i,e){if(i instanceof RegExp)return{keys:!1,pattern:i};var n,t,r,s,o=[],l="",a=i.split("/");for(a[0]||a.shift();r=a.shift();)n=r[0],n==="*"?(o.push("wild"),l+="/(.*)"):n===":"?(t=r.indexOf("?",1),s=r.indexOf(".",1),o.push(r.substring(1,~t?t:~s?s:r.length)),l+=~t&&!~s?"(?:/([^/]+?))?":"/([^/]+?)",~s&&(l+=(~t?"?":"")+"\\"+r.substring(s))):l+="/"+r;return{keys:o,pattern:new RegExp("^"+l+"/?$","i")}}function Is(i){let e,n,t;const r=[i[2]];var s=i[0];function o(l,a){let u={};for(let c=0;c<r.length;c+=1)u=ot(u,r[c]);return a!==void 0&&a&4&&(u=ot(u,St(r,[Et(l[2])]))),{props:u}}return s&&(e=yt(s,o(i)),e.$on("routeEvent",i[7])),{c(){e&&w(e.$$.fragment),n=x()},m(l,a){e&&g(e,l,a),C(l,n,a),t=!0},p(l,a){if(a&1&&s!==(s=l[0])){if(e){K();const u=e;_(u.$$.fragment,1,0,()=>{b(u,1)}),G()}s?(e=yt(s,o(l,a)),e.$on("routeEvent",l[7]),w(e.$$.fragment),m(e.$$.fragment,1),g(e,n.parentNode,n)):e=null}else if(s){const u=a&4?St(r,[Et(l[2])]):{};e.$set(u)}},i(l){t||(e&&m(e.$$.fragment,l),t=!0)},o(l){e&&_(e.$$.fragment,l),t=!1},d(l){l&&y(n),e&&b(e,l)}}}function Ps(i){let e,n,t;const r=[{params:i[1]},i[2]];var s=i[0];function o(l,a){let u={};for(let c=0;c<r.length;c+=1)u=ot(u,r[c]);return a!==void 0&&a&6&&(u=ot(u,St(r,[a&2&&{params:l[1]},a&4&&Et(l[2])]))),{props:u}}return s&&(e=yt(s,o(i)),e.$on("routeEvent",i[6])),{c(){e&&w(e.$$.fragment),n=x()},m(l,a){e&&g(e,l,a),C(l,n,a),t=!0},p(l,a){if(a&1&&s!==(s=l[0])){if(e){K();const u=e;_(u.$$.fragment,1,0,()=>{b(u,1)}),G()}s?(e=yt(s,o(l,a)),e.$on("routeEvent",l[6]),w(e.$$.fragment),m(e.$$.fragment,1),g(e,n.parentNode,n)):e=null}else if(s){const u=a&6?St(r,[a&2&&{params:l[1]},a&4&&Et(l[2])]):{};e.$set(u)}},i(l){t||(e&&m(e.$$.fragment,l),t=!0)},o(l){e&&_(e.$$.fragment,l),t=!1},d(l){l&&y(n),e&&b(e,l)}}}function Rs(i){let e,n,t,r;const s=[Ps,Is],o=[];function l(a,u){return a[1]?0:1}return e=l(i),n=o[e]=s[e](i),{c(){n.c(),t=x()},m(a,u){o[e].m(a,u),C(a,t,u),r=!0},p(a,[u]){let c=e;e=l(a),e===c?o[e].p(a,u):(K(),_(o[c],1,1,()=>{o[c]=null}),G(),n=o[e],n?n.p(a,u):(n=o[e]=s[e](a),n.c()),m(n,1),n.m(t.parentNode,t))},i(a){r||(m(n),r=!0)},o(a){_(n),r=!1},d(a){a&&y(t),o[e].d(a)}}}function qn(){const i=window.location.href.indexOf("#/");let e=i>-1?window.location.href.substr(i+1):"/";const n=e.indexOf("?");let t="";return n>-1&&(t=e.substr(n+1),e=e.substr(0,n)),{location:e,querystring:t}}const dn=Wr(null,function(e){e(qn());const n=()=>{e(qn())};return window.addEventListener("hashchange",n,!1),function(){window.removeEventListener("hashchange",n,!1)}});Qr(dn,i=>i.location);Qr(dn,i=>i.querystring);const Un=Tt(void 0);async function H(i){if(!i||i.length<1||i.charAt(0)!="/"&&i.indexOf("#/")!==0)throw Error("Invalid parameter location");await hn(),history.replaceState({...history.state,__svelte_spa_router_scrollX:window.scrollX,__svelte_spa_router_scrollY:window.scrollY},void 0),window.location.hash=(i.charAt(0)=="#"?"":"#")+i}async function Nn(){await hn(),window.history.back()}function Ls(i){i?window.scrollTo(i.__svelte_spa_router_scrollX,i.__svelte_spa_router_scrollY):window.scrollTo(0,0)}function Ds(i,e,n){let{routes:t={}}=e,{prefix:r=""}=e,{restoreScrollState:s=!1}=e;class o{constructor(R,N){if(!N||typeof N!="function"&&(typeof N!="object"||N._sveltesparouter!==!0))throw Error("Invalid component object");if(!R||typeof R=="string"&&(R.length<1||R.charAt(0)!="/"&&R.charAt(0)!="*")||typeof R=="object"&&!(R instanceof RegExp))throw Error('Invalid value for "path" argument - strings must start with / or *');const{pattern:J,keys:Z}=js(R);this.path=R,typeof N=="object"&&N._sveltesparouter===!0?(this.component=N.component,this.conditions=N.conditions||[],this.userData=N.userData,this.props=N.props||{}):(this.component=()=>Promise.resolve(N),this.conditions=[],this.props={}),this._pattern=J,this._keys=Z}match(R){if(r){if(typeof r=="string")if(R.startsWith(r))R=R.substr(r.length)||"/";else return null;else if(r instanceof RegExp){const de=R.match(r);if(de&&de[0])R=R.substr(de[0].length)||"/";else return null}}const N=this._pattern.exec(R);if(N===null)return null;if(this._keys===!1)return N;const J={};let Z=0;for(;Z<this._keys.length;){try{J[this._keys[Z]]=decodeURIComponent(N[Z+1]||"")||null}catch{J[this._keys[Z]]=null}Z++}return J}async checkConditions(R){for(let N=0;N<this.conditions.length;N++)if(!await this.conditions[N](R))return!1;return!0}}const l=[];t instanceof Map?t.forEach((I,R)=>{l.push(new o(R,I))}):Object.keys(t).forEach(I=>{l.push(new o(I,t[I]))});let a=null,u=null,c={};const h=Ss();async function d(I,R){await hn(),h(I,R)}let f=null,p=null;s&&(p=I=>{I.state&&(I.state.__svelte_spa_router_scrollY||I.state.__svelte_spa_router_scrollX)?f=I.state:f=null},window.addEventListener("popstate",p),ys(()=>{Ls(f)}));let $=null,S=null;const j=dn.subscribe(async I=>{$=I;let R=0;for(;R<l.length;){const N=l[R].match(I.location);if(!N){R++;continue}const J={route:l[R].path,location:I.location,querystring:I.querystring,userData:l[R].userData,params:N&&typeof N=="object"&&Object.keys(N).length?N:null};if(!await l[R].checkConditions(J)){n(0,a=null),S=null,d("conditionsFailed",J);return}d("routeLoading",Object.assign({},J));const Z=l[R].component;if(S!=Z){Z.loading?(n(0,a=Z.loading),S=Z,n(1,u=Z.loadingParams),n(2,c={}),d("routeLoaded",Object.assign({},J,{component:a,name:a.name,params:u}))):(n(0,a=null),S=null);const de=await Z();if(I!=$)return;n(0,a=de&&de.default||de),S=Z}N&&typeof N=="object"&&Object.keys(N).length?n(1,u=N):n(1,u=null),n(2,c=l[R].props),d("routeLoaded",Object.assign({},J,{component:a,name:a.name,params:u})).then(()=>{Un.set(u)});return}n(0,a=null),S=null,Un.set(void 0)});Cs(()=>{j(),p&&window.removeEventListener("popstate",p)});function E(I){Dn.call(this,i,I)}function T(I){Dn.call(this,i,I)}return i.$$set=I=>{"routes"in I&&n(3,t=I.routes),"prefix"in I&&n(4,r=I.prefix),"restoreScrollState"in I&&n(5,s=I.restoreScrollState)},i.$$.update=()=>{i.$$.dirty&32&&(history.scrollRestoration=s?"manual":"auto")},[a,u,c,t,r,s,E,T]}class qs extends q{constructor(e){super(),D(this,e,Ds,Rs,L,{routes:3,prefix:4,restoreScrollState:5})}}function Us(){const{subscribe:i,set:e,update:n}=Tt(null);return{subscribe:i,setDBError:t=>e({msg:t.message,details:t.details}),setAuthError:t=>{e({msg:t.message})},setString:(t,r)=>e({msg:t,details:r}),reset:()=>e(null)}}const V=Us();function Ns(i){let e,n,t,r;return{c(){e=O("button"),n=U(i[0]),k(e,"class","btn"),e.disabled=i[2],k(e,"type","button")},m(s,o){C(s,e,o),v(e,n),t||(r=De(e,"click",function(){Ye(i[1])&&i[1].apply(this,arguments)}),t=!0)},p(s,o){i=s,o&1&&B(n,i[0]),o&4&&(e.disabled=i[2])},d(s){s&&y(e),t=!1,r()}}}function Bs(i){let e,n;return{c(){e=O("button"),n=U(i[0]),k(e,"class","btn"),e.disabled=i[2],k(e,"type","submit")},m(t,r){C(t,e,r),v(e,n)},p(t,r){r&1&&B(n,t[0]),r&4&&(e.disabled=t[2])},d(t){t&&y(e)}}}function Ms(i){let e;function n(s,o){return s[1]==null?Bs:Ns}let t=n(i),r=t(i);return{c(){r.c(),e=x()},m(s,o){r.m(s,o),C(s,e,o)},p(s,[o]){t===(t=n(s))&&r?r.p(s,o):(r.d(1),r=t(s),r&&(r.c(),r.m(e.parentNode,e)))},i:P,o:P,d(s){s&&y(e),r.d(s)}}}function Fs(i,e,n){let{label:t}=e,{onClick:r=null}=e,{disabled:s=!1}=e;return i.$$set=o=>{"label"in o&&n(0,t=o.label),"onClick"in o&&n(1,r=o.onClick),"disabled"in o&&n(2,s=o.disabled)},[t,r,s]}class M extends q{constructor(e){super(),D(this,e,Fs,Ms,L,{label:0,onClick:1,disabled:2})}}function Hs(i){let e,n;const t=i[1].default,r=be(t,i,i[0],null);return{c(){e=O("div"),r&&r.c(),k(e,"class","flex gap-4")},m(s,o){C(s,e,o),r&&r.m(e,null),n=!0},p(s,[o]){r&&r.p&&(!n||o&1)&&ve(r,t,s,s[0],n?we(t,s[0],o,null):ke(s[0]),null)},i(s){n||(m(r,s),n=!0)},o(s){_(r,s),n=!1},d(s){s&&y(e),r&&r.d(s)}}}function zs(i,e,n){let{$$slots:t={},$$scope:r}=e;return i.$$set=s=>{"$$scope"in s&&n(0,r=s.$$scope)},[r,t]}class X extends q{constructor(e){super(),D(this,e,zs,Hs,L,{})}}function Bn(i,e,n){const t=i.slice();return t[5]=e[n],t}function Mn(i){let e,n;return e=new M({props:{label:i[5].label,onClick:i[5].onclick}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,r){const s={};r&2&&(s.label=t[5].label),r&2&&(s.onClick=t[5].onclick),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function Js(i){let e,n,t=re(i[1]),r=[];for(let o=0;o<t.length;o+=1)r[o]=Mn(Bn(i,t,o));const s=o=>_(r[o],1,1,()=>{r[o]=null});return{c(){for(let o=0;o<r.length;o+=1)r[o].c();e=x()},m(o,l){for(let a=0;a<r.length;a+=1)r[a]&&r[a].m(o,l);C(o,e,l),n=!0},p(o,l){if(l&2){t=re(o[1]);let a;for(a=0;a<t.length;a+=1){const u=Bn(o,t,a);r[a]?(r[a].p(u,l),m(r[a],1)):(r[a]=Mn(u),r[a].c(),m(r[a],1),r[a].m(e.parentNode,e))}for(K(),a=t.length;a<r.length;a+=1)s(a);G()}},i(o){if(!n){for(let l=0;l<t.length;l+=1)m(r[l]);n=!0}},o(o){r=r.filter(Boolean);for(let l=0;l<r.length;l+=1)_(r[l]);n=!1},d(o){o&&y(e),ye(r,o)}}}function Ks(i){let e,n,t,r,s,o,l,a,u,c,h;const d=i[3].default,f=be(d,i,i[4],null);return c=new X({props:{$$slots:{default:[Js]},$$scope:{ctx:i}}}),{c(){e=O("div"),n=O("div"),t=O("div"),r=U(i[0]),o=A(),l=O("div"),f&&f.c(),a=A(),u=O("div"),w(c.$$.fragment),k(t,"class",s="text-lg pb-2 border-b "+(i[2]==="error"?"text-red-900":"")),k(l,"class","my-6"),k(n,"class","relative top-1/3 mx-auto max-w-md bg-white rounded shadow p-6"),k(e,"class","fixed z-50 inset-0 bg-black bg-opacity-50 overflow-y-auto h-full w-full")},m(p,$){C(p,e,$),v(e,n),v(n,t),v(t,r),v(n,o),v(n,l),f&&f.m(l,null),v(n,a),v(n,u),g(c,u,null),h=!0},p(p,[$]){(!h||$&1)&&B(r,p[0]),(!h||$&4&&s!==(s="text-lg pb-2 border-b "+(p[2]==="error"?"text-red-900":"")))&&k(t,"class",s),f&&f.p&&(!h||$&16)&&ve(f,d,p,p[4],h?we(d,p[4],$,null):ke(p[4]),null);const S={};$&18&&(S.$$scope={dirty:$,ctx:p}),c.$set(S)},i(p){h||(m(f,p),m(c.$$.fragment,p),h=!0)},o(p){_(f,p),_(c.$$.fragment,p),h=!1},d(p){p&&y(e),f&&f.d(p),b(c)}}}function Gs(i,e,n){let{$$slots:t={},$$scope:r}=e,{title:s}=e,{buttons:o}=e,{type:l="ok"}=e;return i.$$set=a=>{"title"in a&&n(0,s=a.title),"buttons"in a&&n(1,o=a.buttons),"type"in a&&n(2,l=a.type),"$$scope"in a&&n(4,r=a.$$scope)},[s,o,l,t,r]}class Yr extends q{constructor(e){super(),D(this,e,Gs,Ks,L,{title:0,buttons:1,type:2})}}function Fn(i){let e,n;return e=new Yr({props:{title:"Errors",buttons:i[1],type:"error",$$slots:{default:[Vs]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,r){const s={};r&5&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function Hn(i){let e,n=i[0].details+"",t;return{c(){e=O("p"),t=U(n),k(e,"class","text-sm pt-3")},m(r,s){C(r,e,s),v(e,t)},p(r,s){s&1&&n!==(n=r[0].details+"")&&B(t,n)},d(r){r&&y(e)}}}function Vs(i){let e=i[0].msg+"",n,t,r,s=i[0].details&&Hn(i);return{c(){n=U(e),t=A(),s&&s.c(),r=x()},m(o,l){C(o,n,l),C(o,t,l),s&&s.m(o,l),C(o,r,l)},p(o,l){l&1&&e!==(e=o[0].msg+"")&&B(n,e),o[0].details?s?s.p(o,l):(s=Hn(o),s.c(),s.m(r.parentNode,r)):s&&(s.d(1),s=null)},d(o){o&&(y(n),y(t),y(r)),s&&s.d(o)}}}function Ws(i){let e,n,t=i[0]!==null&&Fn(i);return{c(){t&&t.c(),e=x()},m(r,s){t&&t.m(r,s),C(r,e,s),n=!0},p(r,[s]){r[0]!==null?t?(t.p(r,s),s&1&&m(t,1)):(t=Fn(r),t.c(),m(t,1),t.m(e.parentNode,e)):t&&(K(),_(t,1,1,()=>{t=null}),G())},i(r){n||(m(t),n=!0)},o(r){_(t),n=!1},d(r){r&&y(e),t&&t.d(r)}}}function Qs(i,e,n){let t;return fn(i,V,s=>n(0,t=s)),[t,[{label:"OK",onclick:()=>{V.reset()}}]]}class Ys extends q{constructor(e){super(),D(this,e,Qs,Ws,L,{})}}const Xs="modulepreload",Zs=function(i,e){return new URL(i,e).href},zn={},Ve=function(e,n,t){let r=Promise.resolve();if(n&&n.length>0){const s=document.getElementsByTagName("link"),o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));r=Promise.all(n.map(a=>{if(a=Zs(a,t),a in zn)return;zn[a]=!0;const u=a.endsWith(".css"),c=u?'[rel="stylesheet"]':"";if(!!t)for(let f=s.length-1;f>=0;f--){const p=s[f];if(p.href===a&&(!u||p.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${a}"]${c}`))return;const d=document.createElement("link");if(d.rel=u?"stylesheet":Xs,u||(d.as="script",d.crossOrigin=""),d.href=a,l&&d.setAttribute("nonce",l),document.head.appendChild(d),u)return new Promise((f,p)=>{d.addEventListener("load",f),d.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${a}`)))})}))}return r.then(()=>e()).catch(s=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=s,window.dispatchEvent(o),!o.defaultPrevented)throw s})},xs=i=>{let e;return i?e=i:typeof fetch>"u"?e=(...n)=>Ve(()=>Promise.resolve().then(()=>ft),void 0,import.meta.url).then(({default:t})=>t(...n)):e=fetch,(...n)=>e(...n)};class pn extends Error{constructor(e,n="FunctionsError",t){super(e),this.name=n,this.context=t}}class ei extends pn{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class ti extends pn{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class ni extends pn{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var nn;(function(i){i.Any="any",i.ApNortheast1="ap-northeast-1",i.ApNortheast2="ap-northeast-2",i.ApSouth1="ap-south-1",i.ApSoutheast1="ap-southeast-1",i.ApSoutheast2="ap-southeast-2",i.CaCentral1="ca-central-1",i.EuCentral1="eu-central-1",i.EuWest1="eu-west-1",i.EuWest2="eu-west-2",i.EuWest3="eu-west-3",i.SaEast1="sa-east-1",i.UsEast1="us-east-1",i.UsWest1="us-west-1",i.UsWest2="us-west-2"})(nn||(nn={}));var ri=function(i,e,n,t){function r(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function l(c){try{u(t.next(c))}catch(h){o(h)}}function a(c){try{u(t.throw(c))}catch(h){o(h)}}function u(c){c.done?s(c.value):r(c.value).then(l,a)}u((t=t.apply(i,e||[])).next())})};class si{constructor(e,{headers:n={},customFetch:t,region:r=nn.Any}={}){this.url=e,this.headers=n,this.region=r,this.fetch=xs(t)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,n={}){var t;return ri(this,void 0,void 0,function*(){try{const{headers:r,method:s,body:o}=n;let l={},{region:a}=n;a||(a=this.region),a&&a!=="any"&&(l["x-region"]=a);let u;o&&(r&&!Object.prototype.hasOwnProperty.call(r,"Content-Type")||!r)&&(typeof Blob<"u"&&o instanceof Blob||o instanceof ArrayBuffer?(l["Content-Type"]="application/octet-stream",u=o):typeof o=="string"?(l["Content-Type"]="text/plain",u=o):typeof FormData<"u"&&o instanceof FormData?u=o:(l["Content-Type"]="application/json",u=JSON.stringify(o)));const c=yield this.fetch(`${this.url}/${e}`,{method:s||"POST",headers:Object.assign(Object.assign(Object.assign({},l),this.headers),r),body:u}).catch(p=>{throw new ei(p)}),h=c.headers.get("x-relay-error");if(h&&h==="true")throw new ti(c);if(!c.ok)throw new ni(c);let d=((t=c.headers.get("Content-Type"))!==null&&t!==void 0?t:"text/plain").split(";")[0].trim(),f;return d==="application/json"?f=yield c.json():d==="application/octet-stream"?f=yield c.blob():d==="text/event-stream"?f=c:d==="multipart/form-data"?f=yield c.formData():f=yield c.text(),{data:f,error:null}}catch(r){return{data:null,error:r}}})}}var ii=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},We=ii();const oi=We.fetch,mn=We.fetch.bind(We),Xr=We.Headers,ai=We.Request,li=We.Response,ft=Object.freeze(Object.defineProperty({__proto__:null,Headers:Xr,Request:ai,Response:li,default:mn,fetch:oi},Symbol.toStringTag,{value:"Module"}));class ui extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}}class ci{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=mn:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}then(e,n){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const t=this.fetch;let r=t(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async s=>{var o,l,a;let u=null,c=null,h=null,d=s.status,f=s.statusText;if(s.ok){if(this.method!=="HEAD"){const j=await s.text();j===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?c=j:c=JSON.parse(j))}const $=(o=this.headers.Prefer)===null||o===void 0?void 0:o.match(/count=(exact|planned|estimated)/),S=(l=s.headers.get("content-range"))===null||l===void 0?void 0:l.split("/");$&&S&&S.length>1&&(h=parseInt(S[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(c)&&(c.length>1?(u={code:"PGRST116",details:`Results contain ${c.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},c=null,h=null,d=406,f="Not Acceptable"):c.length===1?c=c[0]:c=null)}else{const $=await s.text();try{u=JSON.parse($),Array.isArray(u)&&s.status===404&&(c=[],u=null,d=200,f="OK")}catch{s.status===404&&$===""?(d=204,f="No Content"):u={message:$}}if(u&&this.isMaybeSingle&&(!((a=u==null?void 0:u.details)===null||a===void 0)&&a.includes("0 rows"))&&(u=null,d=200,f="OK"),u&&this.shouldThrowOnError)throw new ui(u)}return{error:u,data:c,count:h,status:d,statusText:f}});return this.shouldThrowOnError||(r=r.catch(s=>{var o,l,a;return{error:{message:`${(o=s==null?void 0:s.name)!==null&&o!==void 0?o:"FetchError"}: ${s==null?void 0:s.message}`,details:`${(l=s==null?void 0:s.stack)!==null&&l!==void 0?l:""}`,hint:"",code:`${(a=s==null?void 0:s.code)!==null&&a!==void 0?a:""}`},data:null,count:null,status:0,statusText:""}})),r.then(e,n)}}class fi extends ci{select(e){let n=!1;const t=(e??"*").split("").map(r=>/\s/.test(r)&&!n?"":(r==='"'&&(n=!n),r)).join("");return this.url.searchParams.set("select",t),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e,{ascending:n=!0,nullsFirst:t,foreignTable:r,referencedTable:s=r}={}){const o=s?`${s}.order`:"order",l=this.url.searchParams.get(o);return this.url.searchParams.set(o,`${l?`${l},`:""}${e}.${n?"asc":"desc"}${t===void 0?"":t?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:n,referencedTable:t=n}={}){const r=typeof t>"u"?"limit":`${t}.limit`;return this.url.searchParams.set(r,`${e}`),this}range(e,n,{foreignTable:t,referencedTable:r=t}={}){const s=typeof r>"u"?"offset":`${r}.offset`,o=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(s,`${e}`),this.url.searchParams.set(o,`${n-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:e=!1,verbose:n=!1,settings:t=!1,buffers:r=!1,wal:s=!1,format:o="text"}={}){var l;const a=[e?"analyze":null,n?"verbose":null,t?"settings":null,r?"buffers":null,s?"wal":null].filter(Boolean).join("|"),u=(l=this.headers.Accept)!==null&&l!==void 0?l:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${o}; for="${u}"; options=${a};`,o==="json"?this:this}rollback(){var e;return((e=this.headers.Prefer)!==null&&e!==void 0?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}class ze extends fi{eq(e,n){return this.url.searchParams.append(e,`eq.${n}`),this}neq(e,n){return this.url.searchParams.append(e,`neq.${n}`),this}gt(e,n){return this.url.searchParams.append(e,`gt.${n}`),this}gte(e,n){return this.url.searchParams.append(e,`gte.${n}`),this}lt(e,n){return this.url.searchParams.append(e,`lt.${n}`),this}lte(e,n){return this.url.searchParams.append(e,`lte.${n}`),this}like(e,n){return this.url.searchParams.append(e,`like.${n}`),this}likeAllOf(e,n){return this.url.searchParams.append(e,`like(all).{${n.join(",")}}`),this}likeAnyOf(e,n){return this.url.searchParams.append(e,`like(any).{${n.join(",")}}`),this}ilike(e,n){return this.url.searchParams.append(e,`ilike.${n}`),this}ilikeAllOf(e,n){return this.url.searchParams.append(e,`ilike(all).{${n.join(",")}}`),this}ilikeAnyOf(e,n){return this.url.searchParams.append(e,`ilike(any).{${n.join(",")}}`),this}is(e,n){return this.url.searchParams.append(e,`is.${n}`),this}in(e,n){const t=Array.from(new Set(n)).map(r=>typeof r=="string"&&new RegExp("[,()]").test(r)?`"${r}"`:`${r}`).join(",");return this.url.searchParams.append(e,`in.(${t})`),this}contains(e,n){return typeof n=="string"?this.url.searchParams.append(e,`cs.${n}`):Array.isArray(n)?this.url.searchParams.append(e,`cs.{${n.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(n)}`),this}containedBy(e,n){return typeof n=="string"?this.url.searchParams.append(e,`cd.${n}`):Array.isArray(n)?this.url.searchParams.append(e,`cd.{${n.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(n)}`),this}rangeGt(e,n){return this.url.searchParams.append(e,`sr.${n}`),this}rangeGte(e,n){return this.url.searchParams.append(e,`nxl.${n}`),this}rangeLt(e,n){return this.url.searchParams.append(e,`sl.${n}`),this}rangeLte(e,n){return this.url.searchParams.append(e,`nxr.${n}`),this}rangeAdjacent(e,n){return this.url.searchParams.append(e,`adj.${n}`),this}overlaps(e,n){return typeof n=="string"?this.url.searchParams.append(e,`ov.${n}`):this.url.searchParams.append(e,`ov.{${n.join(",")}}`),this}textSearch(e,n,{config:t,type:r}={}){let s="";r==="plain"?s="pl":r==="phrase"?s="ph":r==="websearch"&&(s="w");const o=t===void 0?"":`(${t})`;return this.url.searchParams.append(e,`${s}fts${o}.${n}`),this}match(e){return Object.entries(e).forEach(([n,t])=>{this.url.searchParams.append(n,`eq.${t}`)}),this}not(e,n,t){return this.url.searchParams.append(e,`not.${n}.${t}`),this}or(e,{foreignTable:n,referencedTable:t=n}={}){const r=t?`${t}.or`:"or";return this.url.searchParams.append(r,`(${e})`),this}filter(e,n,t){return this.url.searchParams.append(e,`${n}.${t}`),this}}class hi{constructor(e,{headers:n={},schema:t,fetch:r}){this.url=e,this.headers=n,this.schema=t,this.fetch=r}select(e,{head:n=!1,count:t}={}){const r=n?"HEAD":"GET";let s=!1;const o=(e??"*").split("").map(l=>/\s/.test(l)&&!s?"":(l==='"'&&(s=!s),l)).join("");return this.url.searchParams.set("select",o),t&&(this.headers.Prefer=`count=${t}`),new ze({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e,{count:n,defaultToNull:t=!0}={}){const r="POST",s=[];if(this.headers.Prefer&&s.push(this.headers.Prefer),n&&s.push(`count=${n}`),t||s.push("missing=default"),this.headers.Prefer=s.join(","),Array.isArray(e)){const o=e.reduce((l,a)=>l.concat(Object.keys(a)),[]);if(o.length>0){const l=[...new Set(o)].map(a=>`"${a}"`);this.url.searchParams.set("columns",l.join(","))}}return new ze({method:r,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e,{onConflict:n,ignoreDuplicates:t=!1,count:r,defaultToNull:s=!0}={}){const o="POST",l=[`resolution=${t?"ignore":"merge"}-duplicates`];if(n!==void 0&&this.url.searchParams.set("on_conflict",n),this.headers.Prefer&&l.push(this.headers.Prefer),r&&l.push(`count=${r}`),s||l.push("missing=default"),this.headers.Prefer=l.join(","),Array.isArray(e)){const a=e.reduce((u,c)=>u.concat(Object.keys(c)),[]);if(a.length>0){const u=[...new Set(a)].map(c=>`"${c}"`);this.url.searchParams.set("columns",u.join(","))}}return new ze({method:o,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e,{count:n}={}){const t="PATCH",r=[];return this.headers.Prefer&&r.push(this.headers.Prefer),n&&r.push(`count=${n}`),this.headers.Prefer=r.join(","),new ze({method:t,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete({count:e}={}){const n="DELETE",t=[];return e&&t.push(`count=${e}`),this.headers.Prefer&&t.unshift(this.headers.Prefer),this.headers.Prefer=t.join(","),new ze({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}const di="1.15.2",pi={"X-Client-Info":`postgrest-js/${di}`};class _n{constructor(e,{headers:n={},schema:t,fetch:r}={}){this.url=e,this.headers=Object.assign(Object.assign({},pi),n),this.schemaName=t,this.fetch=r}from(e){const n=new URL(`${this.url}/${e}`);return new hi(n,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new _n(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,n={},{head:t=!1,get:r=!1,count:s}={}){let o;const l=new URL(`${this.url}/rpc/${e}`);let a;t||r?(o=t?"HEAD":"GET",Object.entries(n).filter(([c,h])=>h!==void 0).map(([c,h])=>[c,Array.isArray(h)?`{${h.join(",")}}`:`${h}`]).forEach(([c,h])=>{l.searchParams.append(c,h)})):(o="POST",a=n);const u=Object.assign({},this.headers);return s&&(u.Prefer=`count=${s}`),new ze({method:o,url:l,headers:u,schema:this.schemaName,body:a,fetch:this.fetch,allowEmpty:!1})}}const mi="2.9.5",_i={"X-Client-Info":`realtime-js/${mi}`},$i="1.0.0",Zr=1e4,gi=1e3;var Ke;(function(i){i[i.connecting=0]="connecting",i[i.open=1]="open",i[i.closing=2]="closing",i[i.closed=3]="closed"})(Ke||(Ke={}));var le;(function(i){i.closed="closed",i.errored="errored",i.joined="joined",i.joining="joining",i.leaving="leaving"})(le||(le={}));var me;(function(i){i.close="phx_close",i.error="phx_error",i.join="phx_join",i.reply="phx_reply",i.leave="phx_leave",i.access_token="access_token"})(me||(me={}));var rn;(function(i){i.websocket="websocket"})(rn||(rn={}));var Re;(function(i){i.Connecting="connecting",i.Open="open",i.Closing="closing",i.Closed="closed"})(Re||(Re={}));class xr{constructor(e,n){this.callback=e,this.timerCalc=n,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=n}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}class bi{constructor(){this.HEADER_LENGTH=1}decode(e,n){return e.constructor===ArrayBuffer?n(this._binaryDecode(e)):n(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const n=new DataView(e),t=new TextDecoder;return this._decodeBroadcast(e,n,t)}_decodeBroadcast(e,n,t){const r=n.getUint8(1),s=n.getUint8(2);let o=this.HEADER_LENGTH+2;const l=t.decode(e.slice(o,o+r));o=o+r;const a=t.decode(e.slice(o,o+s));o=o+s;const u=JSON.parse(t.decode(e.slice(o,e.byteLength)));return{ref:null,topic:l,event:a,payload:u}}}class Vt{constructor(e,n,t={},r=Zr){this.channel=e,this.event=n,this.payload=t,this.timeout=r,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,n){var t;return this._hasReceived(e)&&n((t=this.receivedResp)===null||t===void 0?void 0:t.response),this.recHooks.push({status:e,callback:n}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=n=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=n,this._matchReceive(n)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,n){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:n})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:n}){this.recHooks.filter(t=>t.status===e).forEach(t=>t.callback(n))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Jn;(function(i){i.SYNC="sync",i.JOIN="join",i.LEAVE="leave"})(Jn||(Jn={}));class st{constructor(e,n){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const t=(n==null?void 0:n.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(t.state,{},r=>{const{onJoin:s,onLeave:o,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=st.syncState(this.state,r,s,o),this.pendingDiffs.forEach(a=>{this.state=st.syncDiff(this.state,a,s,o)}),this.pendingDiffs=[],l()}),this.channel._on(t.diff,{},r=>{const{onJoin:s,onLeave:o,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(r):(this.state=st.syncDiff(this.state,r,s,o),l())}),this.onJoin((r,s,o)=>{this.channel._trigger("presence",{event:"join",key:r,currentPresences:s,newPresences:o})}),this.onLeave((r,s,o)=>{this.channel._trigger("presence",{event:"leave",key:r,currentPresences:s,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,n,t,r){const s=this.cloneDeep(e),o=this.transformState(n),l={},a={};return this.map(s,(u,c)=>{o[u]||(a[u]=c)}),this.map(o,(u,c)=>{const h=s[u];if(h){const d=c.map(S=>S.presence_ref),f=h.map(S=>S.presence_ref),p=c.filter(S=>f.indexOf(S.presence_ref)<0),$=h.filter(S=>d.indexOf(S.presence_ref)<0);p.length>0&&(l[u]=p),$.length>0&&(a[u]=$)}else l[u]=c}),this.syncDiff(s,{joins:l,leaves:a},t,r)}static syncDiff(e,n,t,r){const{joins:s,leaves:o}={joins:this.transformState(n.joins),leaves:this.transformState(n.leaves)};return t||(t=()=>{}),r||(r=()=>{}),this.map(s,(l,a)=>{var u;const c=(u=e[l])!==null&&u!==void 0?u:[];if(e[l]=this.cloneDeep(a),c.length>0){const h=e[l].map(f=>f.presence_ref),d=c.filter(f=>h.indexOf(f.presence_ref)<0);e[l].unshift(...d)}t(l,c,a)}),this.map(o,(l,a)=>{let u=e[l];if(!u)return;const c=a.map(h=>h.presence_ref);u=u.filter(h=>c.indexOf(h.presence_ref)<0),e[l]=u,r(l,u,a),u.length===0&&delete e[l]}),e}static map(e,n){return Object.getOwnPropertyNames(e).map(t=>n(t,e[t]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((n,t)=>{const r=e[t];return"metas"in r?n[t]=r.metas.map(s=>(s.presence_ref=s.phx_ref,delete s.phx_ref,delete s.phx_ref_prev,s)):n[t]=r,n},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var W;(function(i){i.abstime="abstime",i.bool="bool",i.date="date",i.daterange="daterange",i.float4="float4",i.float8="float8",i.int2="int2",i.int4="int4",i.int4range="int4range",i.int8="int8",i.int8range="int8range",i.json="json",i.jsonb="jsonb",i.money="money",i.numeric="numeric",i.oid="oid",i.reltime="reltime",i.text="text",i.time="time",i.timestamp="timestamp",i.timestamptz="timestamptz",i.timetz="timetz",i.tsrange="tsrange",i.tstzrange="tstzrange"})(W||(W={}));const Kn=(i,e,n={})=>{var t;const r=(t=n.skipTypes)!==null&&t!==void 0?t:[];return Object.keys(e).reduce((s,o)=>(s[o]=wi(o,i,e,r),s),{})},wi=(i,e,n,t)=>{const r=e.find(l=>l.name===i),s=r==null?void 0:r.type,o=n[i];return s&&!t.includes(s)?es(s,o):sn(o)},es=(i,e)=>{if(i.charAt(0)==="_"){const n=i.slice(1,i.length);return Ci(e,n)}switch(i){case W.bool:return vi(e);case W.float4:case W.float8:case W.int2:case W.int4:case W.int8:case W.numeric:case W.oid:return ki(e);case W.json:case W.jsonb:return yi(e);case W.timestamp:return Si(e);case W.abstime:case W.date:case W.daterange:case W.int4range:case W.int8range:case W.money:case W.reltime:case W.text:case W.time:case W.timestamptz:case W.timetz:case W.tsrange:case W.tstzrange:return sn(e);default:return sn(e)}},sn=i=>i,vi=i=>{switch(i){case"t":return!0;case"f":return!1;default:return i}},ki=i=>{if(typeof i=="string"){const e=parseFloat(i);if(!Number.isNaN(e))return e}return i},yi=i=>{if(typeof i=="string")try{return JSON.parse(i)}catch(e){return console.log(`JSON parse error: ${e}`),i}return i},Ci=(i,e)=>{if(typeof i!="string")return i;const n=i.length-1,t=i[n];if(i[0]==="{"&&t==="}"){let s;const o=i.slice(1,n);try{s=JSON.parse("["+o+"]")}catch{s=o?o.split(","):[]}return s.map(l=>es(e,l))}return i},Si=i=>typeof i=="string"?i.replace(" ","T"):i;var Gn;(function(i){i.ALL="*",i.INSERT="INSERT",i.UPDATE="UPDATE",i.DELETE="DELETE"})(Gn||(Gn={}));var Vn;(function(i){i.BROADCAST="broadcast",i.PRESENCE="presence",i.POSTGRES_CHANGES="postgres_changes"})(Vn||(Vn={}));var Wn;(function(i){i.SUBSCRIBED="SUBSCRIBED",i.TIMED_OUT="TIMED_OUT",i.CLOSED="CLOSED",i.CHANNEL_ERROR="CHANNEL_ERROR"})(Wn||(Wn={}));class $n{constructor(e,n={config:{}},t){this.topic=e,this.params=n,this.socket=t,this.bindings={},this.state=le.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""}},n.config),this.timeout=this.socket.timeout,this.joinPush=new Vt(this,me.join,this.params,this.timeout),this.rejoinTimer=new xr(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=le.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(r=>r.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=le.closed,this.socket._remove(this)}),this._onError(r=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,r),this.state=le.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=le.errored,this.rejoinTimer.scheduleTimeout())}),this._on(me.reply,{},(r,s)=>{this._trigger(this._replyEventName(s),r)}),this.presence=new st(this),this.broadcastEndpointURL=this._broadcastEndpointURL()}subscribe(e,n=this.timeout){var t,r;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:s,presence:o}}=this.params;this._onError(u=>e&&e("CHANNEL_ERROR",u)),this._onClose(()=>e&&e("CLOSED"));const l={},a={broadcast:s,presence:o,postgres_changes:(r=(t=this.bindings.postgres_changes)===null||t===void 0?void 0:t.map(u=>u.filter))!==null&&r!==void 0?r:[]};this.socket.accessToken&&(l.access_token=this.socket.accessToken),this.updateJoinPayload(Object.assign({config:a},l)),this.joinedOnce=!0,this._rejoin(n),this.joinPush.receive("ok",({postgres_changes:u})=>{var c;if(this.socket.accessToken&&this.socket.setAuth(this.socket.accessToken),u===void 0){e&&e("SUBSCRIBED");return}else{const h=this.bindings.postgres_changes,d=(c=h==null?void 0:h.length)!==null&&c!==void 0?c:0,f=[];for(let p=0;p<d;p++){const $=h[p],{filter:{event:S,schema:j,table:E,filter:T}}=$,I=u&&u[p];if(I&&I.event===S&&I.schema===j&&I.table===E&&I.filter===T)f.push(Object.assign(Object.assign({},$),{id:I.id}));else{this.unsubscribe(),e&&e("CHANNEL_ERROR",new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=f,e&&e("SUBSCRIBED");return}}).receive("error",u=>{e&&e("CHANNEL_ERROR",new Error(JSON.stringify(Object.values(u).join(", ")||"error")))}).receive("timeout",()=>{e&&e("TIMED_OUT")})}return this}presenceState(){return this.presence.state}async track(e,n={}){return await this.send({type:"presence",event:"track",payload:e},n.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,n,t){return this._on(e,n,t)}async send(e,n={}){var t,r;if(!this._canPush()&&e.type==="broadcast"){const{event:s,payload:o}=e,l={method:"POST",headers:{apikey:(t=this.socket.apiKey)!==null&&t!==void 0?t:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:o}]})};try{return(await this._fetchWithTimeout(this.broadcastEndpointURL,l,(r=n.timeout)!==null&&r!==void 0?r:this.timeout)).ok?"ok":"error"}catch(a){return a.name==="AbortError"?"timed out":"error"}}else return new Promise(s=>{var o,l,a;const u=this._push(e.type,e,n.timeout||this.timeout);e.type==="broadcast"&&!(!((a=(l=(o=this.params)===null||o===void 0?void 0:o.config)===null||l===void 0?void 0:l.broadcast)===null||a===void 0)&&a.ack)&&s("ok"),u.receive("ok",()=>s("ok")),u.receive("error",()=>s("error")),u.receive("timeout",()=>s("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=le.leaving;const n=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(me.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(t=>{const r=new Vt(this,me.leave,{},e);r.receive("ok",()=>{n(),t("ok")}).receive("timeout",()=>{n(),t("timed out")}).receive("error",()=>{t("error")}),r.send(),this._canPush()||r.trigger("ok",{})})}_broadcastEndpointURL(){let e=this.socket.endPoint;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")+"/api/broadcast"}async _fetchWithTimeout(e,n,t){const r=new AbortController,s=setTimeout(()=>r.abort(),t),o=await this.socket.fetch(e,Object.assign(Object.assign({},n),{signal:r.signal}));return clearTimeout(s),o}_push(e,n,t=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let r=new Vt(this,e,n,t);return this._canPush()?r.send():(r.startTimeout(),this.pushBuffer.push(r)),r}_onMessage(e,n,t){return n}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,n,t){var r,s;const o=e.toLocaleLowerCase(),{close:l,error:a,leave:u,join:c}=me;if(t&&[l,a,u,c].indexOf(o)>=0&&t!==this._joinRef())return;let d=this._onMessage(o,n,t);if(n&&!d)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(r=this.bindings.postgres_changes)===null||r===void 0||r.filter(f=>{var p,$,S;return((p=f.filter)===null||p===void 0?void 0:p.event)==="*"||((S=($=f.filter)===null||$===void 0?void 0:$.event)===null||S===void 0?void 0:S.toLocaleLowerCase())===o}).map(f=>f.callback(d,t)):(s=this.bindings[o])===null||s===void 0||s.filter(f=>{var p,$,S,j,E,T;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in f){const I=f.id,R=(p=f.filter)===null||p===void 0?void 0:p.event;return I&&(($=n.ids)===null||$===void 0?void 0:$.includes(I))&&(R==="*"||(R==null?void 0:R.toLocaleLowerCase())===((S=n.data)===null||S===void 0?void 0:S.type.toLocaleLowerCase()))}else{const I=(E=(j=f==null?void 0:f.filter)===null||j===void 0?void 0:j.event)===null||E===void 0?void 0:E.toLocaleLowerCase();return I==="*"||I===((T=n==null?void 0:n.event)===null||T===void 0?void 0:T.toLocaleLowerCase())}else return f.type.toLocaleLowerCase()===o}).map(f=>{if(typeof d=="object"&&"ids"in d){const p=d.data,{schema:$,table:S,commit_timestamp:j,type:E,errors:T}=p;d=Object.assign(Object.assign({},{schema:$,table:S,commit_timestamp:j,eventType:E,new:{},old:{},errors:T}),this._getPayloadRecords(p))}f.callback(d,t)})}_isClosed(){return this.state===le.closed}_isJoined(){return this.state===le.joined}_isJoining(){return this.state===le.joining}_isLeaving(){return this.state===le.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,n,t){const r=e.toLocaleLowerCase(),s={type:r,filter:n,callback:t};return this.bindings[r]?this.bindings[r].push(s):this.bindings[r]=[s],this}_off(e,n){const t=e.toLocaleLowerCase();return this.bindings[t]=this.bindings[t].filter(r=>{var s;return!(((s=r.type)===null||s===void 0?void 0:s.toLocaleLowerCase())===t&&$n.isEqual(r.filter,n))}),this}static isEqual(e,n){if(Object.keys(e).length!==Object.keys(n).length)return!1;for(const t in e)if(e[t]!==n[t])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(me.close,{},e)}_onError(e){this._on(me.error,{},n=>e(n))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=le.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const n={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(n.new=Kn(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(n.old=Kn(e.columns,e.old_record)),n}}const Ei=()=>{},Ai=typeof WebSocket<"u";class Oi{constructor(e,n){var t;this.accessToken=null,this.apiKey=null,this.channels=[],this.endPoint="",this.headers=_i,this.params={},this.timeout=Zr,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=Ei,this.conn=null,this.sendBuffer=[],this.serializer=new bi,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this._resolveFetch=s=>{let o;return s?o=s:typeof fetch>"u"?o=(...l)=>Ve(()=>Promise.resolve().then(()=>ft),void 0,import.meta.url).then(({default:a})=>a(...l)):o=fetch,(...l)=>o(...l)},this.endPoint=`${e}/${rn.websocket}`,n!=null&&n.transport?this.transport=n.transport:this.transport=null,n!=null&&n.params&&(this.params=n.params),n!=null&&n.headers&&(this.headers=Object.assign(Object.assign({},this.headers),n.headers)),n!=null&&n.timeout&&(this.timeout=n.timeout),n!=null&&n.logger&&(this.logger=n.logger),n!=null&&n.heartbeatIntervalMs&&(this.heartbeatIntervalMs=n.heartbeatIntervalMs);const r=(t=n==null?void 0:n.params)===null||t===void 0?void 0:t.apikey;r&&(this.accessToken=r,this.apiKey=r),this.reconnectAfterMs=n!=null&&n.reconnectAfterMs?n.reconnectAfterMs:s=>[1e3,2e3,5e3,1e4][s-1]||1e4,this.encode=n!=null&&n.encode?n.encode:(s,o)=>o(JSON.stringify(s)),this.decode=n!=null&&n.decode?n.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new xr(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(n==null?void 0:n.fetch)}connect(){if(!this.conn){if(this.transport){this.conn=new this.transport(this._endPointURL(),void 0,{headers:this.headers});return}if(Ai){this.conn=new WebSocket(this._endPointURL()),this.setupConnection();return}this.conn=new Ti(this._endPointURL(),void 0,{close:()=>{this.conn=null}}),Ve(()=>import("./browser-BImCA5dO.js").then(e=>e.b),[],import.meta.url).then(({default:e})=>{this.conn=new e(this._endPointURL(),void 0,{headers:this.headers}),this.setupConnection()})}}disconnect(e,n){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,n??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(e){const n=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),n}async removeAllChannels(){const e=await Promise.all(this.channels.map(n=>n.unsubscribe()));return this.disconnect(),e}log(e,n,t){this.logger(e,n,t)}connectionState(){switch(this.conn&&this.conn.readyState){case Ke.connecting:return Re.Connecting;case Ke.open:return Re.Open;case Ke.closing:return Re.Closing;default:return Re.Closed}}isConnected(){return this.connectionState()===Re.Open}channel(e,n={config:{}}){const t=new $n(`realtime:${e}`,n,this);return this.channels.push(t),t}push(e){const{topic:n,event:t,payload:r,ref:s}=e,o=()=>{this.encode(e,l=>{var a;(a=this.conn)===null||a===void 0||a.send(l)})};this.log("push",`${n} ${t} (${s})`,r),this.isConnected()?o():this.sendBuffer.push(o)}setAuth(e){this.accessToken=e,this.channels.forEach(n=>{e&&n.updateJoinPayload({access_token:e}),n.joinedOnce&&n._isJoined()&&n._push(me.access_token,{access_token:e})})}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let n=this.channels.find(t=>t.topic===e&&(t._isJoined()||t._isJoining()));n&&(this.log("transport",`leaving duplicate topic "${e}"`),n.unsubscribe())}_remove(e){this.channels=this.channels.filter(n=>n._joinRef()!==e._joinRef())}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_endPointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:$i}))}_onConnMessage(e){this.decode(e.data,n=>{let{topic:t,event:r,payload:s,ref:o}=n;(o&&o===this.pendingHeartbeatRef||r===(s==null?void 0:s.type))&&(this.pendingHeartbeatRef=null),this.log("receive",`${s.status||""} ${t} ${r} ${o&&"("+o+")"||""}`,s),this.channels.filter(l=>l._isMember(t)).forEach(l=>l._trigger(r,s,o)),this.stateChangeCallbacks.message.forEach(l=>l(n))})}_onConnOpen(){this.log("transport",`connected to ${this._endPointURL()}`),this._flushSendBuffer(),this.reconnectTimer.reset(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this._sendHeartbeat(),this.heartbeatIntervalMs),this.stateChangeCallbacks.open.forEach(e=>e())}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(n=>n(e))}_onConnError(e){this.log("transport",e.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(n=>n(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(me.error))}_appendParams(e,n){if(Object.keys(n).length===0)return e;const t=e.match(/\?/)?"&":"?",r=new URLSearchParams(n);return`${e}${t}${r}`}_flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(e=this.conn)===null||e===void 0||e.close(gi,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth(this.accessToken)}}}class Ti{constructor(e,n,t){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=Ke.connecting,this.send=()=>{},this.url=null,this.url=e,this.close=t.close}}class gn extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function oe(i){return typeof i=="object"&&i!==null&&"__isStorageError"in i}class ji extends gn{constructor(e,n){super(e),this.name="StorageApiError",this.status=n}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class Qn extends gn{constructor(e,n){super(e),this.name="StorageUnknownError",this.originalError=n}}var Ii=function(i,e,n,t){function r(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function l(c){try{u(t.next(c))}catch(h){o(h)}}function a(c){try{u(t.throw(c))}catch(h){o(h)}}function u(c){c.done?s(c.value):r(c.value).then(l,a)}u((t=t.apply(i,e||[])).next())})};const ts=i=>{let e;return i?e=i:typeof fetch>"u"?e=(...n)=>Ve(()=>Promise.resolve().then(()=>ft),void 0,import.meta.url).then(({default:t})=>t(...n)):e=fetch,(...n)=>e(...n)},Pi=()=>Ii(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Ve(()=>Promise.resolve().then(()=>ft),void 0,import.meta.url)).Response:Response});var Xe=function(i,e,n,t){function r(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function l(c){try{u(t.next(c))}catch(h){o(h)}}function a(c){try{u(t.throw(c))}catch(h){o(h)}}function u(c){c.done?s(c.value):r(c.value).then(l,a)}u((t=t.apply(i,e||[])).next())})};const Wt=i=>i.msg||i.message||i.error_description||i.error||JSON.stringify(i),Ri=(i,e)=>Xe(void 0,void 0,void 0,function*(){const n=yield Pi();i instanceof n?i.json().then(t=>{e(new ji(Wt(t),i.status||500))}).catch(t=>{e(new Qn(Wt(t),t))}):e(new Qn(Wt(i),i))}),Li=(i,e,n,t)=>{const r={method:i,headers:(e==null?void 0:e.headers)||{}};return i==="GET"?r:(r.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),r.body=JSON.stringify(t),Object.assign(Object.assign({},r),n))};function jt(i,e,n,t,r,s){return Xe(this,void 0,void 0,function*(){return new Promise((o,l)=>{i(n,Li(e,t,r,s)).then(a=>{if(!a.ok)throw a;return t!=null&&t.noResolveJson?a:a.json()}).then(a=>o(a)).catch(a=>Ri(a,l))})})}function on(i,e,n,t){return Xe(this,void 0,void 0,function*(){return jt(i,"GET",e,n,t)})}function Ee(i,e,n,t,r){return Xe(this,void 0,void 0,function*(){return jt(i,"POST",e,t,r,n)})}function Di(i,e,n,t,r){return Xe(this,void 0,void 0,function*(){return jt(i,"PUT",e,t,r,n)})}function ns(i,e,n,t,r){return Xe(this,void 0,void 0,function*(){return jt(i,"DELETE",e,t,r,n)})}var ce=function(i,e,n,t){function r(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function l(c){try{u(t.next(c))}catch(h){o(h)}}function a(c){try{u(t.throw(c))}catch(h){o(h)}}function u(c){c.done?s(c.value):r(c.value).then(l,a)}u((t=t.apply(i,e||[])).next())})};const qi={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Yn={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Ui{constructor(e,n={},t,r){this.url=e,this.headers=n,this.bucketId=t,this.fetch=ts(r)}uploadOrUpdate(e,n,t,r){return ce(this,void 0,void 0,function*(){try{let s;const o=Object.assign(Object.assign({},Yn),r),l=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(o.upsert)});typeof Blob<"u"&&t instanceof Blob?(s=new FormData,s.append("cacheControl",o.cacheControl),s.append("",t)):typeof FormData<"u"&&t instanceof FormData?(s=t,s.append("cacheControl",o.cacheControl)):(s=t,l["cache-control"]=`max-age=${o.cacheControl}`,l["content-type"]=o.contentType);const a=this._removeEmptyFolders(n),u=this._getFinalPath(a),c=yield this.fetch(`${this.url}/object/${u}`,Object.assign({method:e,body:s,headers:l},o!=null&&o.duplex?{duplex:o.duplex}:{})),h=yield c.json();return c.ok?{data:{path:a,id:h.Id,fullPath:h.Key},error:null}:{data:null,error:h}}catch(s){if(oe(s))return{data:null,error:s};throw s}})}upload(e,n,t){return ce(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,n,t)})}uploadToSignedUrl(e,n,t,r){return ce(this,void 0,void 0,function*(){const s=this._removeEmptyFolders(e),o=this._getFinalPath(s),l=new URL(this.url+`/object/upload/sign/${o}`);l.searchParams.set("token",n);try{let a;const u=Object.assign({upsert:Yn.upsert},r),c=Object.assign(Object.assign({},this.headers),{"x-upsert":String(u.upsert)});typeof Blob<"u"&&t instanceof Blob?(a=new FormData,a.append("cacheControl",u.cacheControl),a.append("",t)):typeof FormData<"u"&&t instanceof FormData?(a=t,a.append("cacheControl",u.cacheControl)):(a=t,c["cache-control"]=`max-age=${u.cacheControl}`,c["content-type"]=u.contentType);const h=yield this.fetch(l.toString(),{method:"PUT",body:a,headers:c}),d=yield h.json();return h.ok?{data:{path:s,fullPath:d.Key},error:null}:{data:null,error:d}}catch(a){if(oe(a))return{data:null,error:a};throw a}})}createSignedUploadUrl(e){return ce(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e);const t=yield Ee(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:this.headers}),r=new URL(this.url+t.url),s=r.searchParams.get("token");if(!s)throw new gn("No token returned by API");return{data:{signedUrl:r.toString(),path:e,token:s},error:null}}catch(n){if(oe(n))return{data:null,error:n};throw n}})}update(e,n,t){return ce(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,n,t)})}move(e,n){return ce(this,void 0,void 0,function*(){try{return{data:yield Ee(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n},{headers:this.headers}),error:null}}catch(t){if(oe(t))return{data:null,error:t};throw t}})}copy(e,n){return ce(this,void 0,void 0,function*(){try{return{data:{path:(yield Ee(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n},{headers:this.headers})).Key},error:null}}catch(t){if(oe(t))return{data:null,error:t};throw t}})}createSignedUrl(e,n,t){return ce(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e),s=yield Ee(this.fetch,`${this.url}/object/sign/${r}`,Object.assign({expiresIn:n},t!=null&&t.transform?{transform:t.transform}:{}),{headers:this.headers});const o=t!=null&&t.download?`&download=${t.download===!0?"":t.download}`:"";return s={signedUrl:encodeURI(`${this.url}${s.signedURL}${o}`)},{data:s,error:null}}catch(r){if(oe(r))return{data:null,error:r};throw r}})}createSignedUrls(e,n,t){return ce(this,void 0,void 0,function*(){try{const r=yield Ee(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:n,paths:e},{headers:this.headers}),s=t!=null&&t.download?`&download=${t.download===!0?"":t.download}`:"";return{data:r.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${s}`):null})),error:null}}catch(r){if(oe(r))return{data:null,error:r};throw r}})}download(e,n){return ce(this,void 0,void 0,function*(){const r=typeof(n==null?void 0:n.transform)<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString((n==null?void 0:n.transform)||{}),o=s?`?${s}`:"";try{const l=this._getFinalPath(e);return{data:yield(yield on(this.fetch,`${this.url}/${r}/${l}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(l){if(oe(l))return{data:null,error:l};throw l}})}getPublicUrl(e,n){const t=this._getFinalPath(e),r=[],s=n!=null&&n.download?`download=${n.download===!0?"":n.download}`:"";s!==""&&r.push(s);const l=typeof(n==null?void 0:n.transform)<"u"?"render/image":"object",a=this.transformOptsToQueryString((n==null?void 0:n.transform)||{});a!==""&&r.push(a);let u=r.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${t}${u}`)}}}remove(e){return ce(this,void 0,void 0,function*(){try{return{data:yield ns(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(n){if(oe(n))return{data:null,error:n};throw n}})}list(e,n,t){return ce(this,void 0,void 0,function*(){try{const r=Object.assign(Object.assign(Object.assign({},qi),n),{prefix:e||""});return{data:yield Ee(this.fetch,`${this.url}/object/list/${this.bucketId}`,r,{headers:this.headers},t),error:null}}catch(r){if(oe(r))return{data:null,error:r};throw r}})}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const n=[];return e.width&&n.push(`width=${e.width}`),e.height&&n.push(`height=${e.height}`),e.resize&&n.push(`resize=${e.resize}`),e.format&&n.push(`format=${e.format}`),e.quality&&n.push(`quality=${e.quality}`),n.join("&")}}const Ni="2.5.5",Bi={"X-Client-Info":`storage-js/${Ni}`};var Be=function(i,e,n,t){function r(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function l(c){try{u(t.next(c))}catch(h){o(h)}}function a(c){try{u(t.throw(c))}catch(h){o(h)}}function u(c){c.done?s(c.value):r(c.value).then(l,a)}u((t=t.apply(i,e||[])).next())})};class Mi{constructor(e,n={},t){this.url=e,this.headers=Object.assign(Object.assign({},Bi),n),this.fetch=ts(t)}listBuckets(){return Be(this,void 0,void 0,function*(){try{return{data:yield on(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(oe(e))return{data:null,error:e};throw e}})}getBucket(e){return Be(this,void 0,void 0,function*(){try{return{data:yield on(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(n){if(oe(n))return{data:null,error:n};throw n}})}createBucket(e,n={public:!1}){return Be(this,void 0,void 0,function*(){try{return{data:yield Ee(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(t){if(oe(t))return{data:null,error:t};throw t}})}updateBucket(e,n){return Be(this,void 0,void 0,function*(){try{return{data:yield Di(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(t){if(oe(t))return{data:null,error:t};throw t}})}emptyBucket(e){return Be(this,void 0,void 0,function*(){try{return{data:yield Ee(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(n){if(oe(n))return{data:null,error:n};throw n}})}deleteBucket(e){return Be(this,void 0,void 0,function*(){try{return{data:yield ns(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(n){if(oe(n))return{data:null,error:n};throw n}})}}class Fi extends Mi{constructor(e,n={},t){super(e,n,t)}from(e){return new Ui(this.url,this.headers,e,this.fetch)}}const Hi="2.43.4";let nt="";typeof Deno<"u"?nt="deno":typeof document<"u"?nt="web":typeof navigator<"u"&&navigator.product==="ReactNative"?nt="react-native":nt="node";const zi={"X-Client-Info":`supabase-js-${nt}/${Hi}`},Ji={headers:zi},Ki={schema:"public"},Gi={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Vi={};var Wi=function(i,e,n,t){function r(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function l(c){try{u(t.next(c))}catch(h){o(h)}}function a(c){try{u(t.throw(c))}catch(h){o(h)}}function u(c){c.done?s(c.value):r(c.value).then(l,a)}u((t=t.apply(i,e||[])).next())})};const Qi=i=>{let e;return i?e=i:typeof fetch>"u"?e=mn:e=fetch,(...n)=>e(...n)},Yi=()=>typeof Headers>"u"?Xr:Headers,Xi=(i,e,n)=>{const t=Qi(n),r=Yi();return(s,o)=>Wi(void 0,void 0,void 0,function*(){var l;const a=(l=yield e())!==null&&l!==void 0?l:i;let u=new r(o==null?void 0:o.headers);return u.has("apikey")||u.set("apikey",i),u.has("Authorization")||u.set("Authorization",`Bearer ${a}`),t(s,Object.assign(Object.assign({},o),{headers:u}))})};function Zi(i){return i.replace(/\/$/,"")}function xi(i,e){const{db:n,auth:t,realtime:r,global:s}=i,{db:o,auth:l,realtime:a,global:u}=e;return{db:Object.assign(Object.assign({},o),n),auth:Object.assign(Object.assign({},l),t),realtime:Object.assign(Object.assign({},a),r),global:Object.assign(Object.assign({},u),s)}}const rs="2.64.2",eo="http://localhost:9999",to="supabase.auth.token",no={"X-Client-Info":`gotrue-js/${rs}`},Xn=10,an="X-Supabase-Api-Version",ss={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}};function ro(i){return Math.round(Date.now()/1e3)+i}function so(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(i){const e=Math.random()*16|0;return(i=="x"?e:e&3|8).toString(16)})}const pe=()=>typeof document<"u",je={tested:!1,writable:!1},it=()=>{if(!pe())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(je.tested)return je.writable;const i=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(i,i),globalThis.localStorage.removeItem(i),je.tested=!0,je.writable=!0}catch{je.tested=!0,je.writable=!1}return je.writable};function Qt(i){const e={},n=new URL(i);if(n.hash&&n.hash[0]==="#")try{new URLSearchParams(n.hash.substring(1)).forEach((r,s)=>{e[s]=r})}catch{}return n.searchParams.forEach((t,r)=>{e[r]=t}),e}const is=i=>{let e;return i?e=i:typeof fetch>"u"?e=(...n)=>Ve(()=>Promise.resolve().then(()=>ft),void 0,import.meta.url).then(({default:t})=>t(...n)):e=fetch,(...n)=>e(...n)},io=i=>typeof i=="object"&&i!==null&&"status"in i&&"ok"in i&&"json"in i&&typeof i.json=="function",os=async(i,e,n)=>{await i.setItem(e,JSON.stringify(n))},gt=async(i,e)=>{const n=await i.getItem(e);if(!n)return null;try{return JSON.parse(n)}catch{return n}},Yt=async(i,e)=>{await i.removeItem(e)};function oo(i){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let n="",t,r,s,o,l,a,u,c=0;for(i=i.replace("-","+").replace("_","/");c<i.length;)o=e.indexOf(i.charAt(c++)),l=e.indexOf(i.charAt(c++)),a=e.indexOf(i.charAt(c++)),u=e.indexOf(i.charAt(c++)),t=o<<2|l>>4,r=(l&15)<<4|a>>2,s=(a&3)<<6|u,n=n+String.fromCharCode(t),a!=64&&r!=0&&(n=n+String.fromCharCode(r)),u!=64&&s!=0&&(n=n+String.fromCharCode(s));return n}class It{constructor(){this.promise=new It.promiseConstructor((e,n)=>{this.resolve=e,this.reject=n})}}It.promiseConstructor=Promise;function Zn(i){const e=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}=?$|[a-z0-9_-]{2}(==)?$)$/i,n=i.split(".");if(n.length!==3)throw new Error("JWT is not valid: not a JWT structure");if(!e.test(n[1]))throw new Error("JWT is not valid: payload is not in base64url format");const t=n[1];return JSON.parse(oo(t))}async function ao(i){return await new Promise(e=>{setTimeout(()=>e(null),i)})}function lo(i,e){return new Promise((t,r)=>{(async()=>{for(let s=0;s<1/0;s++)try{const o=await i(s);if(!e(s,null,o)){t(o);return}}catch(o){if(!e(s,o)){r(o);return}}})()})}function uo(i){return("0"+i.toString(16)).substr(-2)}function co(){const e=new Uint32Array(56);if(typeof crypto>"u"){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",t=n.length;let r="";for(let s=0;s<56;s++)r+=n.charAt(Math.floor(Math.random()*t));return r}return crypto.getRandomValues(e),Array.from(e,uo).join("")}async function fo(i){const n=new TextEncoder().encode(i),t=await crypto.subtle.digest("SHA-256",n),r=new Uint8Array(t);return Array.from(r).map(s=>String.fromCharCode(s)).join("")}function ho(i){return btoa(i).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function po(i){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),i;const n=await fo(i);return ho(n)}async function Me(i,e,n=!1){const t=co();let r=t;n&&(r+="/PASSWORD_RECOVERY"),await os(i,`${e}-code-verifier`,r);const s=await po(t);return[s,t===s?"plain":"s256"]}const mo=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function _o(i){const e=i.headers.get(an);if(!e||!e.match(mo))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}class bn extends Error{constructor(e,n,t){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=n,this.code=t}}function F(i){return typeof i=="object"&&i!==null&&"__isAuthError"in i}class $o extends bn{constructor(e,n,t){super(e,n,t),this.name="AuthApiError",this.status=n,this.code=t}}function go(i){return F(i)&&i.name==="AuthApiError"}class as extends bn{constructor(e,n){super(e),this.name="AuthUnknownError",this.originalError=n}}class qe extends bn{constructor(e,n,t,r){super(e,t,r),this.name=n,this.status=t}}class Ie extends qe{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}class Xt extends qe{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class bt extends qe{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class wt extends qe{constructor(e,n=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class xn extends qe{constructor(e,n=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class ln extends qe{constructor(e,n){super(e,"AuthRetryableFetchError",n,void 0)}}function Zt(i){return F(i)&&i.name==="AuthRetryableFetchError"}class er extends qe{constructor(e,n,t){super(e,"AuthWeakPasswordError",n,"weak_password"),this.reasons=t}}var bo=function(i,e){var n={};for(var t in i)Object.prototype.hasOwnProperty.call(i,t)&&e.indexOf(t)<0&&(n[t]=i[t]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,t=Object.getOwnPropertySymbols(i);r<t.length;r++)e.indexOf(t[r])<0&&Object.prototype.propertyIsEnumerable.call(i,t[r])&&(n[t[r]]=i[t[r]]);return n};const Pe=i=>i.msg||i.message||i.error_description||i.error||JSON.stringify(i),wo=[502,503,504];async function tr(i){var e;if(!io(i))throw new ln(Pe(i),0);if(wo.includes(i.status))throw new ln(Pe(i),i.status);let n;try{n=await i.json()}catch(s){throw new as(Pe(s),s)}let t;const r=_o(i);if(r&&r.getTime()>=ss["2024-01-01"].timestamp&&typeof n=="object"&&n&&typeof n.code=="string"?t=n.code:typeof n=="object"&&n&&typeof n.error_code=="string"&&(t=n.error_code),t){if(t==="weak_password")throw new er(Pe(n),i.status,((e=n.weak_password)===null||e===void 0?void 0:e.reasons)||[])}else if(typeof n=="object"&&n&&typeof n.weak_password=="object"&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((s,o)=>s&&typeof o=="string",!0))throw new er(Pe(n),i.status,n.weak_password.reasons);throw new $o(Pe(n),i.status||500,t)}const vo=(i,e,n,t)=>{const r={method:i,headers:(e==null?void 0:e.headers)||{}};return i==="GET"?r:(r.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),r.body=JSON.stringify(t),Object.assign(Object.assign({},r),n))};async function z(i,e,n,t){var r;const s=Object.assign({},t==null?void 0:t.headers);s[an]||(s[an]=ss["2024-01-01"].name),t!=null&&t.jwt&&(s.Authorization=`Bearer ${t.jwt}`);const o=(r=t==null?void 0:t.query)!==null&&r!==void 0?r:{};t!=null&&t.redirectTo&&(o.redirect_to=t.redirectTo);const l=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",a=await ko(i,e,n+l,{headers:s,noResolveJson:t==null?void 0:t.noResolveJson},{},t==null?void 0:t.body);return t!=null&&t.xform?t==null?void 0:t.xform(a):{data:Object.assign({},a),error:null}}async function ko(i,e,n,t,r,s){const o=vo(e,t,r,s);let l;try{l=await i(n,Object.assign({},o))}catch(a){throw console.error(a),new ln(Pe(a),0)}if(l.ok||await tr(l),t!=null&&t.noResolveJson)return l;try{return await l.json()}catch(a){await tr(a)}}function Se(i){var e;let n=null;Eo(i)&&(n=Object.assign({},i),i.expires_at||(n.expires_at=ro(i.expires_in)));const t=(e=i.user)!==null&&e!==void 0?e:i;return{data:{session:n,user:t},error:null}}function nr(i){const e=Se(i);return!e.error&&i.weak_password&&typeof i.weak_password=="object"&&Array.isArray(i.weak_password.reasons)&&i.weak_password.reasons.length&&i.weak_password.message&&typeof i.weak_password.message=="string"&&i.weak_password.reasons.reduce((n,t)=>n&&typeof t=="string",!0)&&(e.data.weak_password=i.weak_password),e}function Ae(i){var e;return{data:{user:(e=i.user)!==null&&e!==void 0?e:i},error:null}}function yo(i){return{data:i,error:null}}function Co(i){const{action_link:e,email_otp:n,hashed_token:t,redirect_to:r,verification_type:s}=i,o=bo(i,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:e,email_otp:n,hashed_token:t,redirect_to:r,verification_type:s},a=Object.assign({},o);return{data:{properties:l,user:a},error:null}}function So(i){return i}function Eo(i){return i.access_token&&i.refresh_token&&i.expires_in}var Ao=function(i,e){var n={};for(var t in i)Object.prototype.hasOwnProperty.call(i,t)&&e.indexOf(t)<0&&(n[t]=i[t]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,t=Object.getOwnPropertySymbols(i);r<t.length;r++)e.indexOf(t[r])<0&&Object.prototype.propertyIsEnumerable.call(i,t[r])&&(n[t[r]]=i[t[r]]);return n};class Oo{constructor({url:e="",headers:n={},fetch:t}){this.url=e,this.headers=n,this.fetch=is(t),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,n="global"){try{return await z(this.fetch,"POST",`${this.url}/logout?scope=${n}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(t){if(F(t))return{data:null,error:t};throw t}}async inviteUserByEmail(e,n={}){try{return await z(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:n.data},headers:this.headers,redirectTo:n.redirectTo,xform:Ae})}catch(t){if(F(t))return{data:{user:null},error:t};throw t}}async generateLink(e){try{const{options:n}=e,t=Ao(e,["options"]),r=Object.assign(Object.assign({},t),n);return"newEmail"in t&&(r.new_email=t==null?void 0:t.newEmail,delete r.newEmail),await z(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:r,headers:this.headers,xform:Co,redirectTo:n==null?void 0:n.redirectTo})}catch(n){if(F(n))return{data:{properties:null,user:null},error:n};throw n}}async createUser(e){try{return await z(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Ae})}catch(n){if(F(n))return{data:{user:null},error:n};throw n}}async listUsers(e){var n,t,r,s,o,l,a;try{const u={nextPage:null,lastPage:0,total:0},c=await z(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(t=(n=e==null?void 0:e.page)===null||n===void 0?void 0:n.toString())!==null&&t!==void 0?t:"",per_page:(s=(r=e==null?void 0:e.perPage)===null||r===void 0?void 0:r.toString())!==null&&s!==void 0?s:""},xform:So});if(c.error)throw c.error;const h=await c.json(),d=(o=c.headers.get("x-total-count"))!==null&&o!==void 0?o:0,f=(a=(l=c.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&a!==void 0?a:[];return f.length>0&&(f.forEach(p=>{const $=parseInt(p.split(";")[0].split("=")[1].substring(0,1)),S=JSON.parse(p.split(";")[1].split("=")[1]);u[`${S}Page`]=$}),u.total=parseInt(d)),{data:Object.assign(Object.assign({},h),u),error:null}}catch(u){if(F(u))return{data:{users:[]},error:u};throw u}}async getUserById(e){try{return await z(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Ae})}catch(n){if(F(n))return{data:{user:null},error:n};throw n}}async updateUserById(e,n){try{return await z(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:n,headers:this.headers,xform:Ae})}catch(t){if(F(t))return{data:{user:null},error:t};throw t}}async deleteUser(e,n=!1){try{return await z(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:n},xform:Ae})}catch(t){if(F(t))return{data:{user:null},error:t};throw t}}async _listFactors(e){try{const{data:n,error:t}=await z(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:r=>({data:{factors:r},error:null})});return{data:n,error:t}}catch(n){if(F(n))return{data:null,error:n};throw n}}async _deleteFactor(e){try{return{data:await z(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(n){if(F(n))return{data:null,error:n};throw n}}}const To={getItem:i=>it()?globalThis.localStorage.getItem(i):null,setItem:(i,e)=>{it()&&globalThis.localStorage.setItem(i,e)},removeItem:i=>{it()&&globalThis.localStorage.removeItem(i)}};function rr(i={}){return{getItem:e=>i[e]||null,setItem:(e,n)=>{i[e]=n},removeItem:e=>{delete i[e]}}}function jo(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Fe={debug:!!(globalThis&&it()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class ls extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class Io extends ls{}async function Po(i,e,n){Fe.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",i,e);const t=new globalThis.AbortController;return e>0&&setTimeout(()=>{t.abort(),Fe.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",i)},e),await globalThis.navigator.locks.request(i,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:t.signal},async r=>{if(r){Fe.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",i,r.name);try{return await n()}finally{Fe.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",i,r.name)}}else{if(e===0)throw Fe.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",i),new Io(`Acquiring an exclusive Navigator LockManager lock "${i}" immediately failed`);if(Fe.debug)try{const s=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(s,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}})}jo();const Ro={url:eo,storageKey:to,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:no,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1},tt=30*1e3,sr=3;async function ir(i,e,n){return await n()}class lt{constructor(e){var n,t;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=lt.nextInstanceID,lt.nextInstanceID+=1,this.instanceID>0&&pe()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const r=Object.assign(Object.assign({},Ro),e);if(this.logDebugMessages=!!r.debug,typeof r.debug=="function"&&(this.logger=r.debug),this.persistSession=r.persistSession,this.storageKey=r.storageKey,this.autoRefreshToken=r.autoRefreshToken,this.admin=new Oo({url:r.url,headers:r.headers,fetch:r.fetch}),this.url=r.url,this.headers=r.headers,this.fetch=is(r.fetch),this.lock=r.lock||ir,this.detectSessionInUrl=r.detectSessionInUrl,this.flowType=r.flowType,this.hasCustomAuthorizationHeader=r.hasCustomAuthorizationHeader,r.lock?this.lock=r.lock:pe()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=Po:this.lock=ir,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?r.storage?this.storage=r.storage:it()?this.storage=To:(this.memoryStorage={},this.storage=rr(this.memoryStorage)):(this.memoryStorage={},this.storage=rr(this.memoryStorage)),pe()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(s){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",s)}(t=this.broadcastChannel)===null||t===void 0||t.addEventListener("message",async s=>{this._debug("received broadcast notification from other tab or client",s),await this._notifyAllSubscribers(s.data.event,s.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${rs}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){try{const e=pe()?await this._isPKCEFlow():!1;if(this._debug("#_initialize()","begin","is PKCE flow",e),e||this.detectSessionInUrl&&this._isImplicitGrantFlow()){const{data:n,error:t}=await this._getSessionFromURL(e);if(t)return this._debug("#_initialize()","error detecting session from URL",t),(t==null?void 0:t.message)==="Identity is already linked"||(t==null?void 0:t.message)==="Identity is already linked to another user"?{error:t}:(await this._removeSession(),{error:t});const{session:r,redirectType:s}=n;return this._debug("#_initialize()","detected session in URL",r,"redirect type",s),await this._saveSession(r),setTimeout(async()=>{s==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",r):await this._notifyAllSubscribers("SIGNED_IN",r)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(e){return F(e)?{error:e}:{error:new as("Unexpected error during initialization",e)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var n,t,r;try{await this._removeSession();const s=await z(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(t=(n=e==null?void 0:e.options)===null||n===void 0?void 0:n.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:(r=e==null?void 0:e.options)===null||r===void 0?void 0:r.captchaToken}},xform:Se}),{data:o,error:l}=s;if(l||!o)return{data:{user:null,session:null},error:l};const a=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",a)),{data:{user:u,session:a},error:null}}catch(s){if(F(s))return{data:{user:null,session:null},error:s};throw s}}async signUp(e){var n,t,r;try{await this._removeSession();let s;if("email"in e){const{email:c,password:h,options:d}=e;let f=null,p=null;this.flowType==="pkce"&&([f,p]=await Me(this.storage,this.storageKey)),s=await z(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:d==null?void 0:d.emailRedirectTo,body:{email:c,password:h,data:(n=d==null?void 0:d.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken},code_challenge:f,code_challenge_method:p},xform:Se})}else if("phone"in e){const{phone:c,password:h,options:d}=e;s=await z(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:c,password:h,data:(t=d==null?void 0:d.data)!==null&&t!==void 0?t:{},channel:(r=d==null?void 0:d.channel)!==null&&r!==void 0?r:"sms",gotrue_meta_security:{captcha_token:d==null?void 0:d.captchaToken}},xform:Se})}else throw new bt("You must provide either an email or phone number and a password");const{data:o,error:l}=s;if(l||!o)return{data:{user:null,session:null},error:l};const a=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",a)),{data:{user:u,session:a},error:null}}catch(s){if(F(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithPassword(e){try{await this._removeSession();let n;if("email"in e){const{email:s,password:o,options:l}=e;n=await z(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:nr})}else if("phone"in e){const{phone:s,password:o,options:l}=e;n=await z(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:nr})}else throw new bt("You must provide either an email or phone number and a password");const{data:t,error:r}=n;return r?{data:{user:null,session:null},error:r}:!t||!t.session||!t.user?{data:{user:null,session:null},error:new Xt}:(t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),{data:Object.assign({user:t.user,session:t.session},t.weak_password?{weakPassword:t.weak_password}:null),error:r})}catch(n){if(F(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOAuth(e){var n,t,r,s;return await this._removeSession(),await this._handleProviderSignIn(e.provider,{redirectTo:(n=e.options)===null||n===void 0?void 0:n.redirectTo,scopes:(t=e.options)===null||t===void 0?void 0:t.scopes,queryParams:(r=e.options)===null||r===void 0?void 0:r.queryParams,skipBrowserRedirect:(s=e.options)===null||s===void 0?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async _exchangeCodeForSession(e){const n=await gt(this.storage,`${this.storageKey}-code-verifier`),[t,r]=(n??"").split("/"),{data:s,error:o}=await z(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:t},xform:Se});return await Yt(this.storage,`${this.storageKey}-code-verifier`),o?{data:{user:null,session:null,redirectType:null},error:o}:!s||!s.session||!s.user?{data:{user:null,session:null,redirectType:null},error:new Xt}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign(Object.assign({},s),{redirectType:r??null}),error:o})}async signInWithIdToken(e){await this._removeSession();try{const{options:n,provider:t,token:r,access_token:s,nonce:o}=e,l=await z(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:t,id_token:r,access_token:s,nonce:o,gotrue_meta_security:{captcha_token:n==null?void 0:n.captchaToken}},xform:Se}),{data:a,error:u}=l;return u?{data:{user:null,session:null},error:u}:!a||!a.session||!a.user?{data:{user:null,session:null},error:new Xt}:(a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),{data:a,error:u})}catch(n){if(F(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOtp(e){var n,t,r,s,o;try{if(await this._removeSession(),"email"in e){const{email:l,options:a}=e;let u=null,c=null;this.flowType==="pkce"&&([u,c]=await Me(this.storage,this.storageKey));const{error:h}=await z(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(n=a==null?void 0:a.data)!==null&&n!==void 0?n:{},create_user:(t=a==null?void 0:a.shouldCreateUser)!==null&&t!==void 0?t:!0,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken},code_challenge:u,code_challenge_method:c},redirectTo:a==null?void 0:a.emailRedirectTo});return{data:{user:null,session:null},error:h}}if("phone"in e){const{phone:l,options:a}=e,{data:u,error:c}=await z(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(r=a==null?void 0:a.data)!==null&&r!==void 0?r:{},create_user:(s=a==null?void 0:a.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken},channel:(o=a==null?void 0:a.channel)!==null&&o!==void 0?o:"sms"}});return{data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:c}}throw new bt("You must provide either an email or phone number.")}catch(l){if(F(l))return{data:{user:null,session:null},error:l};throw l}}async verifyOtp(e){var n,t;try{e.type!=="email_change"&&e.type!=="phone_change"&&await this._removeSession();let r,s;"options"in e&&(r=(n=e.options)===null||n===void 0?void 0:n.redirectTo,s=(t=e.options)===null||t===void 0?void 0:t.captchaToken);const{data:o,error:l}=await z(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:s}}),redirectTo:r,xform:Se});if(l)throw l;if(!o)throw new Error("An error occurred on token verification.");const a=o.session,u=o.user;return a!=null&&a.access_token&&(await this._saveSession(a),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",a)),{data:{user:u,session:a},error:null}}catch(r){if(F(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithSSO(e){var n,t,r;try{await this._removeSession();let s=null,o=null;return this.flowType==="pkce"&&([s,o]=await Me(this.storage,this.storageKey)),await z(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(t=(n=e.options)===null||n===void 0?void 0:n.redirectTo)!==null&&t!==void 0?t:void 0}),!((r=e==null?void 0:e.options)===null||r===void 0)&&r.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:s,code_challenge_method:o}),headers:this.headers,xform:yo})}catch(s){if(F(s))return{data:null,error:s};throw s}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:n},error:t}=e;if(t)throw t;if(!n)throw new Ie;const{error:r}=await z(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:n.access_token});return{data:{user:null,session:null},error:r}})}catch(e){if(F(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{e.type!="email_change"&&e.type!="phone_change"&&await this._removeSession();const n=`${this.url}/resend`;if("email"in e){const{email:t,type:r,options:s}=e,{error:o}=await z(this.fetch,"POST",n,{headers:this.headers,body:{email:t,type:r,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},redirectTo:s==null?void 0:s.emailRedirectTo});return{data:{user:null,session:null},error:o}}else if("phone"in e){const{phone:t,type:r,options:s}=e,{data:o,error:l}=await z(this.fetch,"POST",n,{headers:this.headers,body:{phone:t,type:r,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}}});return{data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:l}}throw new bt("You must provide either an email or phone number and a type")}catch(n){if(F(n))return{data:{user:null,session:null},error:n};throw n}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async n=>n))}async _acquireLock(e,n){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const t=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),r=(async()=>(await t,await n()))();return this.pendingInLock.push((async()=>{try{await r}catch{}})()),r}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const t=n();for(this.pendingInLock.push((async()=>{try{await t}catch{}})()),await t;this.pendingInLock.length;){const r=[...this.pendingInLock];await Promise.all(r),this.pendingInLock.splice(0,r.length)}return await t}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const n=await this.__loadSession();return await e(n)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const n=await gt(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",n),n!==null&&(this._isValidSession(n)?e=n:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const t=e.expires_at?e.expires_at<=Date.now()/1e3:!1;if(this._debug("#__loadSession()",`session has${t?"":" not"} expired`,"expires_at",e.expires_at),!t){if(this.storage.isServer){const o=this.suppressGetSessionWarning;e=new Proxy(e,{get(a,u,c){return!o&&u==="user"&&console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and many not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),Reflect.get(a,u,c)}})}return{data:{session:e},error:null}}const{session:r,error:s}=await this._callRefreshToken(e.refresh_token);return s?{data:{session:null},error:s}:{data:{session:r},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await z(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Ae}):await this._useSession(async n=>{var t,r,s;const{data:o,error:l}=n;if(l)throw l;return!(!((t=o.session)===null||t===void 0)&&t.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Ie}:await z(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(s=(r=o.session)===null||r===void 0?void 0:r.access_token)!==null&&s!==void 0?s:void 0,xform:Ae})})}catch(n){if(F(n))return{data:{user:null},error:n};throw n}}async updateUser(e,n={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,n))}async _updateUser(e,n={}){try{return await this._useSession(async t=>{const{data:r,error:s}=t;if(s)throw s;if(!r.session)throw new Ie;const o=r.session;let l=null,a=null;this.flowType==="pkce"&&e.email!=null&&([l,a]=await Me(this.storage,this.storageKey));const{data:u,error:c}=await z(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:n==null?void 0:n.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:l,code_challenge_method:a}),jwt:o.access_token,xform:Ae});if(c)throw c;return o.user=u.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}})}catch(t){if(F(t))return{data:{user:null},error:t};throw t}}_decodeJWT(e){return Zn(e)}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Ie;const n=Date.now()/1e3;let t=n,r=!0,s=null;const o=Zn(e.access_token);if(o.exp&&(t=o.exp,r=t<=n),r){const{session:l,error:a}=await this._callRefreshToken(e.refresh_token);if(a)return{data:{user:null,session:null},error:a};if(!l)return{data:{user:null,session:null},error:null};s=l}else{const{data:l,error:a}=await this._getUser(e.access_token);if(a)throw a;s={access_token:e.access_token,refresh_token:e.refresh_token,user:l.user,token_type:"bearer",expires_in:t-n,expires_at:t},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return{data:{user:s.user,session:s},error:null}}catch(n){if(F(n))return{data:{session:null,user:null},error:n};throw n}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async n=>{var t;if(!e){const{data:o,error:l}=n;if(l)throw l;e=(t=o.session)!==null&&t!==void 0?t:void 0}if(!(e!=null&&e.refresh_token))throw new Ie;const{session:r,error:s}=await this._callRefreshToken(e.refresh_token);return s?{data:{user:null,session:null},error:s}:r?{data:{user:r.user,session:r},error:null}:{data:{user:null,session:null},error:null}})}catch(n){if(F(n))return{data:{user:null,session:null},error:n};throw n}}async _getSessionFromURL(e){try{if(!pe())throw new wt("No browser detected.");if(this.flowType==="implicit"&&!this._isImplicitGrantFlow())throw new wt("Not a valid implicit grant flow url.");if(this.flowType=="pkce"&&!e)throw new xn("Not a valid PKCE flow url.");const n=Qt(window.location.href);if(e){if(!n.code)throw new xn("No code detected.");const{data:E,error:T}=await this._exchangeCodeForSession(n.code);if(T)throw T;const I=new URL(window.location.href);return I.searchParams.delete("code"),window.history.replaceState(window.history.state,"",I.toString()),{data:{session:E.session,redirectType:null},error:null}}if(n.error||n.error_description||n.error_code)throw new wt(n.error_description||"Error in URL with unspecified error_description",{error:n.error||"unspecified_error",code:n.error_code||"unspecified_code"});const{provider_token:t,provider_refresh_token:r,access_token:s,refresh_token:o,expires_in:l,expires_at:a,token_type:u}=n;if(!s||!l||!o||!u)throw new wt("No session defined in URL");const c=Math.round(Date.now()/1e3),h=parseInt(l);let d=c+h;a&&(d=parseInt(a));const f=d-c;f*1e3<=tt&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${f}s, should have been closer to ${h}s`);const p=d-h;c-p>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",p,d,c):c-p<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clok for skew",p,d,c);const{data:$,error:S}=await this._getUser(s);if(S)throw S;const j={provider_token:t,provider_refresh_token:r,access_token:s,expires_in:h,expires_at:d,refresh_token:o,token_type:u,user:$.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:j,redirectType:n.type},error:null}}catch(n){if(F(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantFlow(){const e=Qt(window.location.href);return!!(pe()&&(e.access_token||e.error_description))}async _isPKCEFlow(){const e=Qt(window.location.href),n=await gt(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&n)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async n=>{var t;const{data:r,error:s}=n;if(s)return{error:s};const o=(t=r.session)===null||t===void 0?void 0:t.access_token;if(o){const{error:l}=await this.admin.signOut(o,e);if(l&&!(go(l)&&(l.status===404||l.status===401||l.status===403)))return{error:l}}return e!=="others"&&(await this._removeSession(),await Yt(this.storage,`${this.storageKey}-code-verifier`),await this._notifyAllSubscribers("SIGNED_OUT",null)),{error:null}})}onAuthStateChange(e){const n=so(),t={id:n,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",n),this.stateChangeEmitters.delete(n)}};return this._debug("#onAuthStateChange()","registered callback with id",n),this.stateChangeEmitters.set(n,t),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(n)})))(),{data:{subscription:t}}}async _emitInitialSession(e){return await this._useSession(async n=>{var t,r;try{const{data:{session:s},error:o}=n;if(o)throw o;await((t=this.stateChangeEmitters.get(e))===null||t===void 0?void 0:t.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",e,"session",s)}catch(s){await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",s),console.error(s)}})}async resetPasswordForEmail(e,n={}){let t=null,r=null;this.flowType==="pkce"&&([t,r]=await Me(this.storage,this.storageKey,!0));try{return await z(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:t,code_challenge_method:r,gotrue_meta_security:{captcha_token:n.captchaToken}},headers:this.headers,redirectTo:n.redirectTo})}catch(s){if(F(s))return{data:null,error:s};throw s}}async getUserIdentities(){var e;try{const{data:n,error:t}=await this.getUser();if(t)throw t;return{data:{identities:(e=n.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(n){if(F(n))return{data:null,error:n};throw n}}async linkIdentity(e){var n;try{const{data:t,error:r}=await this._useSession(async s=>{var o,l,a,u,c;const{data:h,error:d}=s;if(d)throw d;const f=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(l=e.options)===null||l===void 0?void 0:l.scopes,queryParams:(a=e.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:!0});return await z(this.fetch,"GET",f,{headers:this.headers,jwt:(c=(u=h.session)===null||u===void 0?void 0:u.access_token)!==null&&c!==void 0?c:void 0})});if(r)throw r;return pe()&&!(!((n=e.options)===null||n===void 0)&&n.skipBrowserRedirect)&&window.location.assign(t==null?void 0:t.url),{data:{provider:e.provider,url:t==null?void 0:t.url},error:null}}catch(t){if(F(t))return{data:{provider:e.provider,url:null},error:t};throw t}}async unlinkIdentity(e){try{return await this._useSession(async n=>{var t,r;const{data:s,error:o}=n;if(o)throw o;return await z(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(r=(t=s.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:void 0})})}catch(n){if(F(n))return{data:null,error:n};throw n}}async _refreshAccessToken(e){const n=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{const t=Date.now();return await lo(async r=>(r>0&&await ao(200*Math.pow(2,r-1)),this._debug(n,"refreshing attempt",r),await z(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Se})),(r,s)=>{const o=200*Math.pow(2,r);return s&&Zt(s)&&Date.now()+o-t<tt})}catch(t){if(this._debug(n,"error",t),F(t))return{data:{session:null,user:null},error:t};throw t}finally{this._debug(n,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,n){const t=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:n.redirectTo,scopes:n.scopes,queryParams:n.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",n,"url",t),pe()&&!n.skipBrowserRedirect&&window.location.assign(t),{data:{provider:e,url:t},error:null}}async _recoverAndRefresh(){var e;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const t=await gt(this.storage,this.storageKey);if(this._debug(n,"session from storage",t),!this._isValidSession(t)){this._debug(n,"session is not valid"),t!==null&&await this._removeSession();return}const r=Math.round(Date.now()/1e3),s=((e=t.expires_at)!==null&&e!==void 0?e:1/0)<r+Xn;if(this._debug(n,`session has${s?"":" not"} expired with margin of ${Xn}s`),s){if(this.autoRefreshToken&&t.refresh_token){const{error:o}=await this._callRefreshToken(t.refresh_token);o&&(console.error(o),Zt(o)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",t)}catch(t){this._debug(n,"error",t),console.error(t);return}finally{this._debug(n,"end")}}async _callRefreshToken(e){var n,t;if(!e)throw new Ie;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const r=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{this.refreshingDeferred=new It;const{data:s,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!s.session)throw new Ie;await this._saveSession(s.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",s.session);const l={session:s.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(s){if(this._debug(r,"error",s),F(s)){const o={session:null,error:s};return Zt(s)||(await this._removeSession(),await this._notifyAllSubscribers("SIGNED_OUT",null)),(n=this.refreshingDeferred)===null||n===void 0||n.resolve(o),o}throw(t=this.refreshingDeferred)===null||t===void 0||t.reject(s),s}finally{this.refreshingDeferred=null,this._debug(r,"end")}}async _notifyAllSubscribers(e,n,t=!0){const r=`#_notifyAllSubscribers(${e})`;this._debug(r,"begin",n,`broadcast = ${t}`);try{this.broadcastChannel&&t&&this.broadcastChannel.postMessage({event:e,session:n});const s=[],o=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(e,n)}catch(a){s.push(a)}});if(await Promise.all(o),s.length>0){for(let l=0;l<s.length;l+=1)console.error(s[l]);throw s[0]}}finally{this._debug(r,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await os(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await Yt(this.storage,this.storageKey)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&pe()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(n){console.error("removing visibilitychange callback failed",n)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),tt);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async n=>{const{data:{session:t}}=n;if(!t||!t.refresh_token||!t.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const r=Math.floor((t.expires_at*1e3-e)/tt);this._debug("#_autoRefreshTokenTick()",`access token expires in ${r} ticks, a tick lasts ${tt}ms, refresh threshold is ${sr} ticks`),r<=sr&&await this._callRefreshToken(t.refresh_token)})}catch(n){console.error("Auto refresh tick failed with error. This is likely a transient error.",n)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof ls)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!pe()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const n=`#_onVisibilityChanged(${e})`;this._debug(n,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(n,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,n,t){const r=[`provider=${encodeURIComponent(n)}`];if(t!=null&&t.redirectTo&&r.push(`redirect_to=${encodeURIComponent(t.redirectTo)}`),t!=null&&t.scopes&&r.push(`scopes=${encodeURIComponent(t.scopes)}`),this.flowType==="pkce"){const[s,o]=await Me(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(s)}`,code_challenge_method:`${encodeURIComponent(o)}`});r.push(l.toString())}if(t!=null&&t.queryParams){const s=new URLSearchParams(t.queryParams);r.push(s.toString())}return t!=null&&t.skipBrowserRedirect&&r.push(`skip_http_redirect=${t.skipBrowserRedirect}`),`${e}?${r.join("&")}`}async _unenroll(e){try{return await this._useSession(async n=>{var t;const{data:r,error:s}=n;return s?{data:null,error:s}:await z(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(t=r==null?void 0:r.session)===null||t===void 0?void 0:t.access_token})})}catch(n){if(F(n))return{data:null,error:n};throw n}}async _enroll(e){try{return await this._useSession(async n=>{var t,r;const{data:s,error:o}=n;if(o)return{data:null,error:o};const{data:l,error:a}=await z(this.fetch,"POST",`${this.url}/factors`,{body:{friendly_name:e.friendlyName,factor_type:e.factorType,issuer:e.issuer},headers:this.headers,jwt:(t=s==null?void 0:s.session)===null||t===void 0?void 0:t.access_token});return a?{data:null,error:a}:(!((r=l==null?void 0:l.totp)===null||r===void 0)&&r.qr_code&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})})}catch(n){if(F(n))return{data:null,error:n};throw n}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var t;const{data:r,error:s}=n;if(s)return{data:null,error:s};const{data:o,error:l}=await z(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(t=r==null?void 0:r.session)===null||t===void 0?void 0:t.access_token});return l?{data:null,error:l}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:l})})}catch(n){if(F(n))return{data:null,error:n};throw n}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var t;const{data:r,error:s}=n;return s?{data:null,error:s}:await z(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{headers:this.headers,jwt:(t=r==null?void 0:r.session)===null||t===void 0?void 0:t.access_token})})}catch(n){if(F(n))return{data:null,error:n};throw n}})}async _challengeAndVerify(e){const{data:n,error:t}=await this._challenge({factorId:e.factorId});return t?{data:null,error:t}:await this._verify({factorId:e.factorId,challengeId:n.id,code:e.code})}async _listFactors(){const{data:{user:e},error:n}=await this.getUser();if(n)return{data:null,error:n};const t=(e==null?void 0:e.factors)||[],r=t.filter(s=>s.factor_type==="totp"&&s.status==="verified");return{data:{all:t,totp:r},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var n,t;const{data:{session:r},error:s}=e;if(s)return{data:null,error:s};if(!r)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const o=this._decodeJWT(r.access_token);let l=null;o.aal&&(l=o.aal);let a=l;((t=(n=r.user.factors)===null||n===void 0?void 0:n.filter(h=>h.status==="verified"))!==null&&t!==void 0?t:[]).length>0&&(a="aal2");const c=o.amr||[];return{data:{currentLevel:l,nextLevel:a,currentAuthenticationMethods:c},error:null}}))}}lt.nextInstanceID=0;const Lo=lt;class Do extends Lo{constructor(e){super(e)}}var qo=function(i,e,n,t){function r(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function l(c){try{u(t.next(c))}catch(h){o(h)}}function a(c){try{u(t.throw(c))}catch(h){o(h)}}function u(c){c.done?s(c.value):r(c.value).then(l,a)}u((t=t.apply(i,e||[])).next())})};class Uo{constructor(e,n,t){var r,s,o;if(this.supabaseUrl=e,this.supabaseKey=n,!e)throw new Error("supabaseUrl is required.");if(!n)throw new Error("supabaseKey is required.");const l=Zi(e);this.realtimeUrl=`${l}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${l}/auth/v1`,this.storageUrl=`${l}/storage/v1`,this.functionsUrl=`${l}/functions/v1`;const a=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,u={db:Ki,realtime:Vi,auth:Object.assign(Object.assign({},Gi),{storageKey:a}),global:Ji},c=xi(t??{},u);this.storageKey=(r=c.auth.storageKey)!==null&&r!==void 0?r:"",this.headers=(s=c.global.headers)!==null&&s!==void 0?s:{},this.auth=this._initSupabaseAuthClient((o=c.auth)!==null&&o!==void 0?o:{},this.headers,c.global.fetch),this.fetch=Xi(n,this._getAccessToken.bind(this),c.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers},c.realtime)),this.rest=new _n(`${l}/rest/v1`,{headers:this.headers,schema:c.db.schema,fetch:this.fetch}),this._listenForAuthEvents()}get functions(){return new si(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new Fi(this.storageUrl,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,n={},t={}){return this.rest.rpc(e,n,t)}channel(e,n={config:{}}){return this.realtime.channel(e,n)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,n;return qo(this,void 0,void 0,function*(){const{data:t}=yield this.auth.getSession();return(n=(e=t.session)===null||e===void 0?void 0:e.access_token)!==null&&n!==void 0?n:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:n,detectSessionInUrl:t,storage:r,storageKey:s,flowType:o,debug:l},a,u){var c;const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Do({url:this.authUrl,headers:Object.assign(Object.assign({},h),a),storageKey:s,autoRefreshToken:e,persistSession:n,detectSessionInUrl:t,storage:r,flowType:o,debug:l,fetch:u,hasCustomAuthorizationHeader:(c="Authorization"in this.headers)!==null&&c!==void 0?c:!1})}_initRealtimeClient(e){return new Oi(this.realtimeUrl,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((n,t)=>{this._handleTokenChanged(n,"CLIENT",t==null?void 0:t.access_token)})}_handleTokenChanged(e,n,t){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==t?(this.realtime.setAuth(t??null),this.changedAccessToken=t):e==="SIGNED_OUT"&&(this.realtime.setAuth(this.supabaseKey),n=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const us=(i,e,n)=>new Uo(i,e,n),cs="supabase-config",No=()=>{const i=localStorage.getItem(cs);if(!i)return null;const e=JSON.parse(i);return us(e.supabaseUrl,e.supabaseKey)};let Q=No();const Bo=i=>{Q=us(i.supabaseUrl,i.supabaseKey),localStorage.setItem(cs,JSON.stringify(i))},kt=Tt(null);function Mo(i){let e,n,t,r;const s=i[2].default,o=be(s,i,i[1],null);return{c(){e=O("button"),o&&o.c(),k(e,"class","text-blue-600 hover:text-blue-700")},m(l,a){C(l,e,a),o&&o.m(e,null),n=!0,t||(r=De(e,"click",function(){Ye(i[0])&&i[0].apply(this,arguments)}),t=!0)},p(l,[a]){i=l,o&&o.p&&(!n||a&2)&&ve(o,s,i,i[1],n?we(s,i[1],a,null):ke(i[1]),null)},i(l){n||(m(o,l),n=!0)},o(l){_(o,l),n=!1},d(l){l&&y(e),o&&o.d(l),t=!1,r()}}}function Fo(i,e,n){let{$$slots:t={},$$scope:r}=e,{onClick:s}=e;return i.$$set=o=>{"onClick"in o&&n(0,s=o.onClick),"$$scope"in o&&n(1,r=o.$$scope)},[s,r,t]}class he extends q{constructor(e){super(),D(this,e,Fo,Mo,L,{onClick:0})}}function Ho(i){let e,n;return{c(){e=Y("svg"),n=Y("path"),k(n,"stroke-linecap","round"),k(n,"stroke-linejoin","round"),k(n,"d","m2.25 12 8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25"),k(e,"xmlns","http://www.w3.org/2000/svg"),k(e,"fill","none"),k(e,"viewBox","0 0 24 24"),k(e,"stroke-width","1.5"),k(e,"stroke","currentColor"),k(e,"class","size-6 hover:stroke-2")},m(t,r){C(t,e,r),v(e,n)},p:P,d(t){t&&y(e)}}}function zo(i){let e,n;return e=new he({props:{onClick:i[0],$$slots:{default:[Ho]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,[r]){const s={};r&1&&(s.onClick=t[0]),r&2&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function Jo(i,e,n){let{onClick:t}=e;return i.$$set=r=>{"onClick"in r&&n(0,t=r.onClick)},[t]}class Ko extends q{constructor(e){super(),D(this,e,Jo,zo,L,{onClick:0})}}function Go(i){let e,n;return{c(){e=Y("svg"),n=Y("path"),k(n,"stroke-linecap","round"),k(n,"stroke-linejoin","round"),k(n,"d","m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"),k(e,"xmlns","http://www.w3.org/2000/svg"),k(e,"fill","none"),k(e,"viewBox","0 0 24 24"),k(e,"stroke-width","1.5"),k(e,"stroke","currentColor"),k(e,"class","size-6 hover:stroke-2")},m(t,r){C(t,e,r),v(e,n)},p:P,d(t){t&&y(e)}}}function Vo(i){let e,n;return e=new he({props:{onClick:i[0],$$slots:{default:[Go]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,[r]){const s={};r&1&&(s.onClick=t[0]),r&2&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function Wo(i,e,n){let{onClick:t}=e;return i.$$set=r=>{"onClick"in r&&n(0,t=r.onClick)},[t]}class Qo extends q{constructor(e){super(),D(this,e,Wo,Vo,L,{onClick:0})}}function Yo(i){let e,n;return{c(){e=Y("svg"),n=Y("path"),k(n,"stroke-linecap","round"),k(n,"stroke-linejoin","round"),k(n,"d","M12 6.042A8.967 8.967 0 0 0 6 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 0 1 6 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 0 1 6-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0 0 18 18a8.967 8.967 0 0 0-6 2.292m0-14.25v14.25"),k(e,"xmlns","http://www.w3.org/2000/svg"),k(e,"fill","none"),k(e,"viewBox","0 0 24 24"),k(e,"stroke-width","1.5"),k(e,"stroke","currentColor"),k(e,"class","size-6 hover:stroke-2")},m(t,r){C(t,e,r),v(e,n)},p:P,d(t){t&&y(e)}}}function Xo(i){let e,n;return e=new he({props:{onClick:i[0],$$slots:{default:[Yo]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,[r]){const s={};r&1&&(s.onClick=t[0]),r&2&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function Zo(i,e,n){let{onClick:t}=e;return i.$$set=r=>{"onClick"in r&&n(0,t=r.onClick)},[t]}class xo extends q{constructor(e){super(),D(this,e,Zo,Xo,L,{onClick:0})}}function ea(i){let e,n;return{c(){e=Y("svg"),n=Y("path"),k(n,"stroke-linecap","round"),k(n,"stroke-linejoin","round"),k(n,"d","M6 6.878V6a2.25 2.25 0 0 1 2.25-2.25h7.5A2.25 2.25 0 0 1 18 6v.878m-12 0c.235-.083.487-.128.75-.128h10.5c.263 0 .515.045.75.128m-12 0A2.25 2.25 0 0 0 4.5 9v.878m13.5-3A2.25 2.25 0 0 1 19.5 9v.878m0 0a2.246 2.246 0 0 0-.75-.128H5.25c-.263 0-.515.045-.75.128m15 0A2.25 2.25 0 0 1 21 12v6a2.25 2.25 0 0 1-2.25 2.25H5.25A2.25 2.25 0 0 1 3 18v-6c0-.98.626-1.813 1.5-2.122"),k(e,"xmlns","http://www.w3.org/2000/svg"),k(e,"fill","none"),k(e,"viewBox","0 0 24 24"),k(e,"stroke-width","1.5"),k(e,"stroke","currentColor"),k(e,"class","size-6 hover:stroke-2")},m(t,r){C(t,e,r),v(e,n)},p:P,d(t){t&&y(e)}}}function ta(i){let e,n;return e=new he({props:{onClick:i[0],$$slots:{default:[ea]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,[r]){const s={};r&1&&(s.onClick=t[0]),r&2&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function na(i,e,n){let{onClick:t}=e;return i.$$set=r=>{"onClick"in r&&n(0,t=r.onClick)},[t]}class ra extends q{constructor(e){super(),D(this,e,na,ta,L,{onClick:0})}}function sa(i){let e,n;return{c(){e=Y("svg"),n=Y("path"),k(n,"stroke-linecap","round"),k(n,"stroke-linejoin","round"),k(n,"d","M15.75 9V5.25A2.25 2.25 0 0 0 13.5 3h-6a2.25 2.25 0 0 0-2.25 2.25v13.5A2.25 2.25 0 0 0 7.5 21h6a2.25 2.25 0 0 0 2.25-2.25V15m3 0 3-3m0 0-3-3m3 3H9"),k(e,"xmlns","http://www.w3.org/2000/svg"),k(e,"fill","none"),k(e,"viewBox","0 0 24 24"),k(e,"stroke-width","1.5"),k(e,"stroke","currentColor"),k(e,"class","size-6 hover:stroke-2")},m(t,r){C(t,e,r),v(e,n)},p:P,d(t){t&&y(e)}}}function ia(i){let e,n;return e=new he({props:{onClick:i[0],$$slots:{default:[sa]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,[r]){const s={};r&1&&(s.onClick=t[0]),r&2&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function oa(i,e,n){let{onClick:t}=e;return i.$$set=r=>{"onClick"in r&&n(0,t=r.onClick)},[t]}class aa extends q{constructor(e){super(),D(this,e,oa,ia,L,{onClick:0})}}function la(i){let e,n;return{c(){e=Y("svg"),n=Y("path"),k(n,"stroke-linecap","round"),k(n,"stroke-linejoin","round"),k(n,"d","M15.75 6a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0ZM4.501 20.118a7.5 7.5 0 0 1 14.998 0A17.933 17.933 0 0 1 12 21.75c-2.676 0-5.216-.584-7.499-1.632Z"),k(e,"xmlns","http://www.w3.org/2000/svg"),k(e,"fill","none"),k(e,"viewBox","0 0 24 24"),k(e,"stroke-width","1.5"),k(e,"stroke","currentColor"),k(e,"class","size-6 hover:stroke-2")},m(t,r){C(t,e,r),v(e,n)},p:P,d(t){t&&y(e)}}}function ua(i){let e,n;return e=new he({props:{onClick:i[0],$$slots:{default:[la]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,[r]){const s={};r&1&&(s.onClick=t[0]),r&2&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function ca(i,e,n){let{onClick:t}=e;return i.$$set=r=>{"onClick"in r&&n(0,t=r.onClick)},[t]}class fa extends q{constructor(e){super(),D(this,e,ca,ua,L,{onClick:0})}}function ha(i){let e,n;return{c(){e=Y("svg"),n=Y("path"),k(n,"stroke-linecap","round"),k(n,"stroke-linejoin","round"),k(n,"d","m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"),k(e,"xmlns","http://www.w3.org/2000/svg"),k(e,"fill","none"),k(e,"viewBox","0 0 24 24"),k(e,"stroke-width","1.5"),k(e,"stroke","currentColor"),k(e,"class","size-6 hover:stroke-2")},m(t,r){C(t,e,r),v(e,n)},p:P,d(t){t&&y(e)}}}function da(i){let e,n;return e=new he({props:{onClick:i[0],$$slots:{default:[ha]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,[r]){const s={};r&1&&(s.onClick=t[0]),r&2&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function pa(i,e,n){let{onClick:t}=e;return i.$$set=r=>{"onClick"in r&&n(0,t=r.onClick)},[t]}class ma extends q{constructor(e){super(),D(this,e,pa,da,L,{onClick:0})}}function _a(i){let e,n;return{c(){e=Y("svg"),n=Y("path"),k(n,"stroke-linecap","round"),k(n,"stroke-linejoin","round"),k(n,"d","M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m5.231 13.481L15 17.25m-4.5-15H5.625c-.621 0-1.125.504-1.125 1.125v16.5c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Zm3.75 11.625a2.625 2.625 0 1 1-5.25 0 2.625 2.625 0 0 1 5.25 0Z"),k(e,"xmlns","http://www.w3.org/2000/svg"),k(e,"fill","none"),k(e,"viewBox","0 0 24 24"),k(e,"stroke-width","1.5"),k(e,"stroke","currentColor"),k(e,"class","size-6 hover:stroke-2")},m(t,r){C(t,e,r),v(e,n)},p:P,d(t){t&&y(e)}}}function $a(i){let e,n;return e=new he({props:{onClick:i[0],$$slots:{default:[_a]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,[r]){const s={};r&1&&(s.onClick=t[0]),r&2&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function ga(i,e,n){let{onClick:t}=e;return i.$$set=r=>{"onClick"in r&&n(0,t=r.onClick)},[t]}class ba extends q{constructor(e){super(),D(this,e,ga,$a,L,{onClick:0})}}function wa(i){let e,n,t,r,s,o,l,a,u,c,h,d,f,p,$,S,j;return n=new Ko({props:{onClick:i[1]}}),r=new xo({props:{onClick:i[2]}}),o=new ma({props:{onClick:i[3]}}),a=new ra({props:{onClick:i[4]}}),c=new ba({props:{onClick:i[5]}}),d=new Qo({props:{onClick:i[6]}}),p=new fa({props:{onClick:i[7]}}),S=new aa({props:{onClick:i[0]}}),{c(){e=O("nav"),w(n.$$.fragment),t=A(),w(r.$$.fragment),s=A(),w(o.$$.fragment),l=A(),w(a.$$.fragment),u=A(),w(c.$$.fragment),h=A(),w(d.$$.fragment),f=A(),w(p.$$.fragment),$=A(),w(S.$$.fragment),k(e,"class","flex justify-end items-center gap-2 mb-4")},m(E,T){C(E,e,T),g(n,e,null),v(e,t),g(r,e,null),v(e,s),g(o,e,null),v(e,l),g(a,e,null),v(e,u),g(c,e,null),v(e,h),g(d,e,null),v(e,f),g(p,e,null),v(e,$),g(S,e,null),j=!0},p(E,[T]){const I={};T&1&&(I.onClick=E[0]),S.$set(I)},i(E){j||(m(n.$$.fragment,E),m(r.$$.fragment,E),m(o.$$.fragment,E),m(a.$$.fragment,E),m(c.$$.fragment,E),m(d.$$.fragment,E),m(p.$$.fragment,E),m(S.$$.fragment,E),j=!0)},o(E){_(n.$$.fragment,E),_(r.$$.fragment,E),_(o.$$.fragment,E),_(a.$$.fragment,E),_(c.$$.fragment,E),_(d.$$.fragment,E),_(p.$$.fragment,E),_(S.$$.fragment,E),j=!1},d(E){E&&y(e),b(n),b(r),b(o),b(a),b(c),b(d),b(p),b(S)}}}function va(i,e,n){let{onLogout:t}=e;const r=()=>H("/"),s=()=>H("/books/list"),o=()=>H("/info"),l=()=>H("/cache"),a=()=>H("/questions/index"),u=()=>H("/questions/search"),c=()=>H("/user");return i.$$set=h=>{"onLogout"in h&&n(0,t=h.onLogout)},[t,r,s,o,l,a,u,c]}class ka extends q{constructor(e){super(),D(this,e,va,wa,L,{onLogout:0})}}const ae=i=>new Date(i).toLocaleString(),or=i=>new Date(i).toLocaleDateString(),ue=i=>i?"":"Please enter a value!",ya=(i,e)=>Math.floor(Math.random()*(e-i+1)+i),Ca=i=>{for(let e=0;e<i.length;e++){const n=ya(0,i.length-1);if(e===n)continue;const t=i[e];i[e]=i[n],i[n]=t}},fs=i=>(i=i.trim(),i||void 0);function Sa(i){let e,n,t,r;const s=i[2].default,o=be(s,i,i[1],null);return{c(){e=O("form"),o&&o.c(),k(e,"class","flex flex-col gap-5 lg:w-2/3")},m(l,a){C(l,e,a),o&&o.m(e,null),n=!0,t||(r=De(e,"submit",bs(function(){Ye(i[0])&&i[0].apply(this,arguments)})),t=!0)},p(l,[a]){i=l,o&&o.p&&(!n||a&2)&&ve(o,s,i,i[1],n?we(s,i[1],a,null):ke(i[1]),null)},i(l){n||(m(o,l),n=!0)},o(l){_(o,l),n=!1},d(l){l&&y(e),o&&o.d(l),t=!1,r()}}}function Ea(i,e,n){let{$$slots:t={},$$scope:r}=e,{onSubmit:s}=e;return i.$$set=o=>{"onSubmit"in o&&n(0,s=o.onSubmit),"$$scope"in o&&n(1,r=o.$$scope)},[s,r,t]}class _e extends q{constructor(e){super(),D(this,e,Ea,Sa,L,{onSubmit:0})}}function ar(i){let e,n;return{c(){e=O("p"),n=U(i[2]),k(e,"class","text-red-600 text-sm mt-1")},m(t,r){C(t,e,r),v(e,n)},p(t,r){r&4&&B(n,t[2])},d(t){t&&y(e)}}}function Aa(i){let e,n,t,r,s,o;const l=i[4].default,a=be(l,i,i[3],null);let u=i[2]&&ar(i);return{c(){e=O("div"),n=O("label"),t=U(i[1]),r=A(),a&&a.c(),s=A(),u&&u.c(),k(n,"class","block text-gray-700 text-sm font-bold mb-2"),k(n,"for",i[0])},m(c,h){C(c,e,h),v(e,n),v(n,t),v(e,r),a&&a.m(e,null),v(e,s),u&&u.m(e,null),o=!0},p(c,[h]){(!o||h&2)&&B(t,c[1]),(!o||h&1)&&k(n,"for",c[0]),a&&a.p&&(!o||h&8)&&ve(a,l,c,c[3],o?we(l,c[3],h,null):ke(c[3]),null),c[2]?u?u.p(c,h):(u=ar(c),u.c(),u.m(e,null)):u&&(u.d(1),u=null)},i(c){o||(m(a,c),o=!0)},o(c){_(a,c),o=!1},d(c){c&&y(e),a&&a.d(c),u&&u.d()}}}function Oa(i,e,n){let{$$slots:t={},$$scope:r}=e,{id:s}=e,{label:o}=e,{error:l=""}=e;return i.$$set=a=>{"id"in a&&n(0,s=a.id),"label"in a&&n(1,o=a.label),"error"in a&&n(2,l=a.error),"$$scope"in a&&n(3,r=a.$$scope)},[s,o,l,r,t]}class Pt extends q{constructor(e){super(),D(this,e,Oa,Aa,L,{id:0,label:1,error:2})}}function Ta(i){let e,n,t;return{c(){e=O("input"),k(e,"class","input"),k(e,"id",i[2])},m(r,s){C(r,e,s),Oe(e,i[0]),n||(t=De(e,"input",i[4]),n=!0)},p(r,s){s&4&&k(e,"id",r[2]),s&1&&e.value!==r[0]&&Oe(e,r[0])},d(r){r&&y(e),n=!1,t()}}}function ja(i){let e,n;return e=new Pt({props:{id:i[2],label:i[1],error:i[3],$$slots:{default:[Ta]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,[r]){const s={};r&4&&(s.id=t[2]),r&2&&(s.label=t[1]),r&8&&(s.error=t[3]),r&37&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function Ia(i,e,n){let{label:t}=e,{id:r}=e,{value:s}=e,{error:o=""}=e;function l(){s=this.value,n(0,s)}return i.$$set=a=>{"label"in a&&n(1,t=a.label),"id"in a&&n(2,r=a.id),"value"in a&&n(0,s=a.value),"error"in a&&n(3,o=a.error)},[s,t,r,o,l]}class Te extends q{constructor(e){super(),D(this,e,Ia,ja,L,{label:1,id:2,value:0,error:3})}}function Pa(i){let e,n;return e=new M({props:{label:"Save"}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p:P,i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function Ra(i){let e,n,t,r,s,o,l,a;function u(f){i[6](f)}let c={id:"url",label:"Supabase URL",error:i[1]};i[0]!==void 0&&(c.value=i[0]),e=new Te({props:c}),ee.push(()=>ne(e,"value",u));function h(f){i[7](f)}let d={id:"key",label:"Supabase key",error:i[3]};return i[2]!==void 0&&(d.value=i[2]),r=new Te({props:d}),ee.push(()=>ne(r,"value",h)),l=new X({props:{$$slots:{default:[Pa]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment),t=A(),w(r.$$.fragment),o=A(),w(l.$$.fragment)},m(f,p){g(e,f,p),C(f,t,p),g(r,f,p),C(f,o,p),g(l,f,p),a=!0},p(f,p){const $={};p&2&&($.error=f[1]),!n&&p&1&&(n=!0,$.value=f[0],te(()=>n=!1)),e.$set($);const S={};p&8&&(S.error=f[3]),!s&&p&4&&(s=!0,S.value=f[2],te(()=>s=!1)),r.$set(S);const j={};p&256&&(j.$$scope={dirty:p,ctx:f}),l.$set(j)},i(f){a||(m(e.$$.fragment,f),m(r.$$.fragment,f),m(l.$$.fragment,f),a=!0)},o(f){_(e.$$.fragment,f),_(r.$$.fragment,f),_(l.$$.fragment,f),a=!1},d(f){f&&(y(t),y(o)),b(e,f),b(r,f),b(l,f)}}}function La(i){let e,n;return e=new _e({props:{onSubmit:i[4],$$slots:{default:[Ra]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,[r]){const s={};r&271&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function Da(i,e,n){let{onConfig:t}=e,r="",s="",o="",l="";const a=()=>{n(1,s=ue(r)),n(3,l=ue(o)),!(s||l)&&t({supabaseUrl:r,supabaseKey:o})};function u(h){r=h,n(0,r)}function c(h){o=h,n(2,o)}return i.$$set=h=>{"onConfig"in h&&n(5,t=h.onConfig)},[r,s,o,l,a,t,u,c]}class qa extends q{constructor(e){super(),D(this,e,Da,La,L,{onConfig:5})}}function Ua(i){let e,n;return e=new _e({props:{onSubmit:i[4],$$slots:{default:[Ma]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,r){const s={};r&71&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function Na(i){let e,n,t;return{c(){e=O("div"),e.textContent="Magic link was successfully send!",n=A(),t=O("div"),t.textContent="Please check your E-Mail"},m(r,s){C(r,e,s),C(r,n,s),C(r,t,s)},p:P,i:P,o:P,d(r){r&&(y(e),y(n),y(t))}}}function Ba(i){let e,n;return e=new M({props:{disabled:i[2],label:"Magic Link"}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,r){const s={};r&4&&(s.disabled=t[2]),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function Ma(i){let e,n,t,r,s;function o(a){i[5](a)}let l={id:"email",label:"E-Mail",error:i[1]};return i[0]!==void 0&&(l.value=i[0]),e=new Te({props:l}),ee.push(()=>ne(e,"value",o)),r=new X({props:{$$slots:{default:[Ba]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment),t=A(),w(r.$$.fragment)},m(a,u){g(e,a,u),C(a,t,u),g(r,a,u),s=!0},p(a,u){const c={};u&2&&(c.error=a[1]),!n&&u&1&&(n=!0,c.value=a[0],te(()=>n=!1)),e.$set(c);const h={};u&68&&(h.$$scope={dirty:u,ctx:a}),r.$set(h)},i(a){s||(m(e.$$.fragment,a),m(r.$$.fragment,a),s=!0)},o(a){_(e.$$.fragment,a),_(r.$$.fragment,a),s=!1},d(a){a&&y(t),b(e,a),b(r,a)}}}function Fa(i){let e,n,t,r;const s=[Na,Ua],o=[];function l(a,u){return a[3]?0:1}return e=l(i),n=o[e]=s[e](i),{c(){n.c(),t=x()},m(a,u){o[e].m(a,u),C(a,t,u),r=!0},p(a,[u]){let c=e;e=l(a),e===c?o[e].p(a,u):(K(),_(o[c],1,1,()=>{o[c]=null}),G(),n=o[e],n?n.p(a,u):(n=o[e]=s[e](a),n.c()),m(n,1),n.m(t.parentNode,t))},i(a){r||(m(n),r=!0)},o(a){_(n),r=!1},d(a){a&&y(t),o[e].d(a)}}}function Ha(i,e,n){let t="",r="",s=!1,o=!1;const l=async()=>{if(n(1,r=ue(t)),r)return;n(2,s=!0);const{data:u,error:c}=await Q.auth.signInWithOtp({email:t});if(n(2,s=!1),c){V.setAuthError(c);return}u&&(console.log("data",u),n(3,o=!0))};function a(u){t=u,n(0,t)}return[t,r,s,o,l,a]}class za extends q{constructor(e){super(),D(this,e,Ha,Fa,L,{})}}function Ja(i){let e;return{c(){e=O("div"),e.innerHTML='<svg class="h-8 w-8 animate-spin text-blue-600" viewBox="0 0 100 100"><circle fill="none" stroke-width="10" class="stroke-current opacity-40" cx="50" cy="50" r="40"></circle><circle fill="none" stroke-width="10" class="stroke-current" stroke-dasharray="250" stroke-dashoffset="210" cx="50" cy="50" r="40"></circle></svg>',k(e,"class","flex justify-center")},m(n,t){C(n,e,t)},p:P,i:P,o:P,d(n){n&&y(e)}}}class Ka extends q{constructor(e){super(),D(this,e,null,Ja,L,{})}}function Ga(i){let e,n,t;e=new ka({props:{onLogout:i[4]}});const r=i[6].default,s=be(r,i,i[5],null);return{c(){w(e.$$.fragment),n=A(),s&&s.c()},m(o,l){g(e,o,l),C(o,n,l),s&&s.m(o,l),t=!0},p(o,l){s&&s.p&&(!t||l&32)&&ve(s,r,o,o[5],t?we(r,o[5],l,null):ke(o[5]),null)},i(o){t||(m(e.$$.fragment,o),m(s,o),t=!0)},o(o){_(e.$$.fragment,o),_(s,o),t=!1},d(o){o&&y(n),b(e,o),s&&s.d(o)}}}function Va(i){let e,n,t,r;const s=[Ya,Qa],o=[];function l(a,u){return a[1]?0:1}return e=l(i),n=o[e]=s[e](i),{c(){n.c(),t=x()},m(a,u){o[e].m(a,u),C(a,t,u),r=!0},p(a,u){let c=e;e=l(a),e!==c&&(K(),_(o[c],1,1,()=>{o[c]=null}),G(),n=o[e],n||(n=o[e]=s[e](a),n.c()),m(n,1),n.m(t.parentNode,t))},i(a){r||(m(n),r=!0)},o(a){_(n),r=!1},d(a){a&&y(t),o[e].d(a)}}}function Wa(i){let e,n;return e=new qa({props:{onConfig:i[3]}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p:P,i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function Qa(i){let e,n;return e=new Ka({}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function Ya(i){let e,n;return e=new za({}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function Xa(i){let e,n,t,r;const s=[Wa,Va,Ga],o=[];function l(a,u){return a[0]?a[2]?2:1:0}return e=l(i),n=o[e]=s[e](i),{c(){n.c(),t=x()},m(a,u){o[e].m(a,u),C(a,t,u),r=!0},p(a,[u]){let c=e;e=l(a),e===c?o[e].p(a,u):(K(),_(o[c],1,1,()=>{o[c]=null}),G(),n=o[e],n?n.p(a,u):(n=o[e]=s[e](a),n.c()),m(n,1),n.m(t.parentNode,t))},i(a){r||(m(n),r=!0)},o(a){_(n),r=!1},d(a){a&&y(t),o[e].d(a)}}}function Za(i,e,n){let t;fn(i,kt,h=>n(2,t=h));let{$$slots:r={},$$scope:s}=e,o=!1,l=!1;const a=()=>Q?(Q.auth.onAuthStateChange((h,d)=>{console.log("auth changed:",d==null?void 0:d.user),d!=null&&d.user?kt.set(d.user):kt.set(null),n(1,l=!0)}),!0):(console.log("supabase is not initialized!"),!1),u=h=>{Bo(h),n(0,o=a())},c=()=>{Q&&t&&Q.auth.signOut()};return fe(()=>{n(0,o=a())}),i.$$set=h=>{"$$scope"in h&&n(5,s=h.$$scope)},[o,l,t,u,c,s,r]}class xa extends q{constructor(e){super(),D(this,e,Za,Xa,L,{})}}function el(i){let e,n;return{c(){e=O("h2"),n=U(i[0]),k(e,"class","text-2xl font-extrabold")},m(t,r){C(t,e,r),v(e,n)},p(t,[r]){r&1&&B(n,t[0])},i:P,o:P,d(t){t&&y(e)}}}function tl(i,e,n){let{header:t}=e;return i.$$set=r=>{"header"in r&&n(0,t=r.header)},[t]}class se extends q{constructor(e){super(),D(this,e,tl,el,L,{header:0})}}const ht="cache-",hs=()=>{const i=[];for(let e in localStorage)e.startsWith(ht)&&i.push(e);return i.sort()},nl=()=>{const i=[];for(let e in localStorage)e.startsWith(ht)&&localStorage.removeItem(e);return i},rl=i=>(localStorage.removeItem(i),hs()),sl=ht+"questions",dt=i=>`${sl}#${i}`,il=new RegExp(/[\*.,;!?()'"#/&=+-]/,"g"),wn=(i,e,n)=>{let t=i+" "+e;n&&(t=t+" "+n),t=t.replaceAll(il,"");let r=t.split(/\s+/);const s=new Set;return r.forEach(o=>{o.length>2&&s.add(o.toLowerCase())}),Array.from(s).join(" ")},ol=async i=>{let{data:e,error:n}=await Q.from("questions").select("*").eq("id",i).single();return n&&V.setDBError(n),e||null},pt=async i=>{const e=dt(i),n=localStorage.getItem(e);if(n)return JSON.parse(n);let{data:t,error:r}=await Q.from("questions").select("*").eq("chapter_id",i).order("id");return r&&V.setDBError(r),t?(localStorage.setItem(e,JSON.stringify(t)),t):[]},al=async(i,e)=>{const{error:n}=await Q.from("questions").delete().eq("id",i);return n?(V.setDBError(n),[]):(localStorage.removeItem(dt(e)),pt(e))},ll=async(i,e,n,t)=>{const{error:r}=await Q.from("questions").insert([{chapter_id:i,quest:e,answer:n,details:t,search:wn(e,n,t)}]);if(r)return V.setDBError(r),[];localStorage.removeItem(dt(i))},ul=async(i,e,n,t,r)=>{const{error:s}=await Q.from("questions").update({quest:n,answer:t,details:r,search:wn(n,t,r)}).eq("id",i);return s?(V.setDBError(s),[]):(localStorage.removeItem(dt(e)),pt(e))},xt=10,cl=async i=>{const{data:e,error:n}=await Q.from("questions").select().like("search",`%${i.toLocaleLowerCase()}%`).limit(xt+1);return n?(V.setDBError(n),{questions:[],hasMore:!1}):(console.log("search-like:",i,"data:",e),{questions:e.slice(0,xt),hasMore:e.length==xt+1})},lr=async()=>{const{count:i,error:e}=await Q.from("questions").select("*",{count:"exact",head:!0}).is("search",null);return e?(V.setDBError(e),-2):i===null?-1:i},fl=async i=>{const{data:e,error:n}=await Q.from("questions").select("*").is("search",null).limit(i);return n?(V.setDBError(n),[]):e===null?[]:e},hl=async i=>{const e=[];i.forEach(r=>{r.search=wn(r.quest,r.answer,r.details),e.includes(r.chapter_id)||e.push(r.chapter_id)});const{data:n,error:t}=await Q.from("questions").upsert(i);if(t){V.setDBError(t);return}e.forEach(r=>{localStorage.removeItem(dt(r))}),console.log("clear cache chapters",e)},ut="session",dl=(i,e,n)=>{if(i.length==0)return;const t=i.map(s=>({question:s,progress:e}));Ca(t);const r={learning:t,learned:[],reverse:n};localStorage.setItem(ut,JSON.stringify(r))},ds=()=>{const i=localStorage.getItem(ut);return i?JSON.parse(i):null},pl=i=>i.learning.length>0?(localStorage.setItem(ut,JSON.stringify(i)),!0):(localStorage.removeItem(ut),!1),ml=()=>{localStorage.removeItem(ut)},ur=i=>{const e=[0,0,0,i.learned.length];return i.learning.forEach(n=>{if(n.progress>2)throw Error(`Invalid progress ${n.progress}`);e[n.progress]++}),e},_l=()=>{let i=-1,e=[];return async n=>{n.chapter_id!==i&&(i=n.chapter_id,e=await pt(i),console.log("loaded chapter for refresh:",i));const t=e.find(r=>r.id===n.id);return t===void 0?(V.setString("Unable to refresh lession!",`Question not found: ${n.id}`),n):t}},$l=async i=>{let e=_l();for(let n of i.learned)n.question=await e(n.question);for(let n of i.learning)n.question=await e(n.question);return i};function gl(i){let e,n;const t=i[1].default,r=be(t,i,i[0],null);return{c(){e=O("div"),r&&r.c(),k(e,"class","flex flex-col gap-5")},m(s,o){C(s,e,o),r&&r.m(e,null),n=!0},p(s,[o]){r&&r.p&&(!n||o&1)&&ve(r,t,s,s[0],n?we(t,s[0],o,null):ke(s[0]),null)},i(s){n||(m(r,s),n=!0)},o(s){_(r,s),n=!1},d(s){s&&y(e),r&&r.d(s)}}}function bl(i,e,n){let{$$slots:t={},$$scope:r}=e;return i.$$set=s=>{"$$scope"in s&&n(0,r=s.$$scope)},[r,t]}class ie extends q{constructor(e){super(),D(this,e,bl,gl,L,{})}}function cr(i){let e,n;return e=new X({props:{$$slots:{default:[wl]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,r){const s={};r&8&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function wl(i){let e,n,t,r;return e=new M({props:{label:"Continue",onClick:i[1]}}),t=new M({props:{label:"End",onClick:i[2]}}),{c(){w(e.$$.fragment),n=A(),w(t.$$.fragment)},m(s,o){g(e,s,o),C(s,n,o),g(t,s,o),r=!0},p:P,i(s){r||(m(e.$$.fragment,s),m(t.$$.fragment,s),r=!0)},o(s){_(e.$$.fragment,s),_(t.$$.fragment,s),r=!1},d(s){s&&y(n),b(e,s),b(t,s)}}}function vl(i){let e,n,t,r;e=new se({props:{header:"Home"}});let s=i[0]&&cr(i);return{c(){w(e.$$.fragment),n=A(),s&&s.c(),t=x()},m(o,l){g(e,o,l),C(o,n,l),s&&s.m(o,l),C(o,t,l),r=!0},p(o,l){o[0]?s?(s.p(o,l),l&1&&m(s,1)):(s=cr(o),s.c(),m(s,1),s.m(t.parentNode,t)):s&&(K(),_(s,1,1,()=>{s=null}),G())},i(o){r||(m(e.$$.fragment,o),m(s),r=!0)},o(o){_(e.$$.fragment,o),_(s),r=!1},d(o){o&&(y(n),y(t)),b(e,o),s&&s.d(o)}}}function kl(i){let e,n;return e=new ie({props:{$$slots:{default:[vl]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,[r]){const s={};r&9&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function yl(i,e,n){let t=!1;const r=()=>{H("/lession/process")},s=()=>{ml(),n(0,t=!1)};return fe(()=>{ds()&&n(0,t=!0)}),[t,r,s]}class Cl extends q{constructor(e){super(),D(this,e,yl,kl,L,{})}}function Sl(i){let e,n;return{c(){e=Y("svg"),n=Y("path"),k(n,"stroke-linecap","round"),k(n,"stroke-linejoin","round"),k(n,"d","m9.75 9.75 4.5 4.5m0-4.5-4.5 4.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"),k(e,"xmlns","http://www.w3.org/2000/svg"),k(e,"fill","none"),k(e,"viewBox","0 0 24 24"),k(e,"stroke-width","1.5"),k(e,"stroke","currentColor"),k(e,"class","size-6 hover:stroke-2")},m(t,r){C(t,e,r),v(e,n)},p:P,d(t){t&&y(e)}}}function El(i){let e,n;return e=new he({props:{onClick:i[0],$$slots:{default:[Sl]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,[r]){const s={};r&1&&(s.onClick=t[0]),r&2&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function Al(i,e,n){let{onClick:t}=e;return i.$$set=r=>{"onClick"in r&&n(0,t=r.onClick)},[t]}class Rt extends q{constructor(e){super(),D(this,e,Al,El,L,{onClick:0})}}function fr(i,e,n){const t=i.slice();return t[4]=e[n],t}function Ol(i){let e;return{c(){e=U("Cache is empty!")},m(n,t){C(n,e,t)},p:P,i:P,o:P,d(n){n&&y(e)}}}function Tl(i){let e,n,t,r,s,o,l,a=re(i[0]),u=[];for(let h=0;h<a.length;h+=1)u[h]=hr(fr(i,a,h));const c=h=>_(u[h],1,1,()=>{u[h]=null});return o=new X({props:{$$slots:{default:[Il]},$$scope:{ctx:i}}}),{c(){e=O("table"),n=O("thead"),n.innerHTML="<tr><th>Cache Key</th> <th>Actions</th></tr>",t=A(),r=O("tbody");for(let h=0;h<u.length;h+=1)u[h].c();s=A(),w(o.$$.fragment),k(e,"class","w-full")},m(h,d){C(h,e,d),v(e,n),v(e,t),v(e,r);for(let f=0;f<u.length;f+=1)u[f]&&u[f].m(r,null);C(h,s,d),g(o,h,d),l=!0},p(h,d){if(d&1){a=re(h[0]);let p;for(p=0;p<a.length;p+=1){const $=fr(h,a,p);u[p]?(u[p].p($,d),m(u[p],1)):(u[p]=hr($),u[p].c(),m(u[p],1),u[p].m(r,null))}for(K(),p=a.length;p<u.length;p+=1)c(p);G()}const f={};d&129&&(f.$$scope={dirty:d,ctx:h}),o.$set(f)},i(h){if(!l){for(let d=0;d<a.length;d+=1)m(u[d]);m(o.$$.fragment,h),l=!0}},o(h){u=u.filter(Boolean);for(let d=0;d<u.length;d+=1)_(u[d]);_(o.$$.fragment,h),l=!1},d(h){h&&(y(e),y(s)),ye(u,h),b(o,h)}}}function jl(i){let e,n;function t(){return i[1](i[4])}return e=new Rt({props:{onClick:t}}),{c(){w(e.$$.fragment)},m(r,s){g(e,r,s),n=!0},p(r,s){i=r;const o={};s&1&&(o.onClick=t),e.$set(o)},i(r){n||(m(e.$$.fragment,r),n=!0)},o(r){_(e.$$.fragment,r),n=!1},d(r){b(e,r)}}}function hr(i){let e,n,t=i[4]+"",r,s,o,l,a,u;return l=new X({props:{$$slots:{default:[jl]},$$scope:{ctx:i}}}),{c(){e=O("tr"),n=O("td"),r=U(t),s=A(),o=O("td"),w(l.$$.fragment),a=A()},m(c,h){C(c,e,h),v(e,n),v(n,r),v(e,s),v(e,o),g(l,o,null),v(e,a),u=!0},p(c,h){(!u||h&1)&&t!==(t=c[4]+"")&&B(r,t);const d={};h&129&&(d.$$scope={dirty:h,ctx:c}),l.$set(d)},i(c){u||(m(l.$$.fragment,c),u=!0)},o(c){_(l.$$.fragment,c),u=!1},d(c){c&&y(e),b(l)}}}function Il(i){let e,n,t,r;return e=new M({props:{onClick:i[2],label:"Cancel"}}),t=new M({props:{onClick:i[3],label:"Delete all"}}),{c(){w(e.$$.fragment),n=A(),w(t.$$.fragment)},m(s,o){g(e,s,o),C(s,n,o),g(t,s,o),r=!0},p(s,o){const l={};o&1&&(l.onClick=s[3]),t.$set(l)},i(s){r||(m(e.$$.fragment,s),m(t.$$.fragment,s),r=!0)},o(s){_(e.$$.fragment,s),_(t.$$.fragment,s),r=!1},d(s){s&&y(n),b(e,s),b(t,s)}}}function Pl(i){let e,n,t,r,s,o;e=new se({props:{header:"Cache"}});const l=[Tl,Ol],a=[];function u(c,h){return c[0].length>0?0:1}return t=u(i),r=a[t]=l[t](i),{c(){w(e.$$.fragment),n=A(),r.c(),s=x()},m(c,h){g(e,c,h),C(c,n,h),a[t].m(c,h),C(c,s,h),o=!0},p(c,h){let d=t;t=u(c),t===d?a[t].p(c,h):(K(),_(a[d],1,1,()=>{a[d]=null}),G(),r=a[t],r?r.p(c,h):(r=a[t]=l[t](c),r.c()),m(r,1),r.m(s.parentNode,s))},i(c){o||(m(e.$$.fragment,c),m(r),o=!0)},o(c){_(e.$$.fragment,c),_(r),o=!1},d(c){c&&(y(n),y(s)),b(e,c),a[t].d(c)}}}function Rl(i){let e,n;return e=new ie({props:{$$slots:{default:[Pl]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,[r]){const s={};r&129&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function Ll(i,e,n){let t=[];return fe(()=>{n(0,t=hs())}),[t,l=>{n(0,t=rl(l))},()=>H("/"),()=>n(0,t=nl())]}class Dl extends q{constructor(e){super(),D(this,e,Ll,Rl,L,{})}}function ql(i){let e,n,t,r;return e=new se({props:{header:"Not Found"}}),{c(){w(e.$$.fragment),n=A(),t=O("div"),t.textContent="Not Found"},m(s,o){g(e,s,o),C(s,n,o),C(s,t,o),r=!0},p:P,i(s){r||(m(e.$$.fragment,s),r=!0)},o(s){_(e.$$.fragment,s),r=!1},d(s){s&&(y(n),y(t)),b(e,s)}}}function Ul(i){let e,n;return e=new ie({props:{$$slots:{default:[ql]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,[r]){const s={};r&1&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}class Nl extends q{constructor(e){super(),D(this,e,null,Ul,L,{})}}const ct=ht+"books",Lt=async i=>{let{data:e,error:n}=await Q.from("books").select("*").eq("id",i).single();return n&&V.setDBError(n),e||null},vn=async()=>{const i=localStorage.getItem(ct);if(i)return JSON.parse(i);let{data:e,error:n}=await Q.from("books").select("*");return n&&V.setDBError(n),e?(localStorage.setItem(ct,JSON.stringify(e)),e):[]},Bl=async i=>{const{error:e}=await Q.from("books").delete().eq("id",i);return e?(V.setDBError(e),[]):(localStorage.removeItem(ct),vn())},Ml=async(i,e)=>{const{error:n}=await Q.from("books").insert([{name:i,description:e}]);if(n)return V.setDBError(n),[];localStorage.removeItem(ct)},Fl=async(i,e,n)=>{const{error:t}=await Q.from("books").update({name:e,description:n}).eq("id",i);return t?(V.setDBError(t),[]):(localStorage.removeItem(ct),vn())};function Hl(i){let e,n;return{c(){e=Y("svg"),n=Y("path"),k(n,"stroke-linecap","round"),k(n,"stroke-linejoin","round"),k(n,"d","M3.75 12h16.5m-16.5 3.75h16.5M3.75 19.5h16.5M5.625 4.5h12.75a1.875 1.875 0 0 1 0 3.75H5.625a1.875 1.875 0 0 1 0-3.75Z"),k(e,"xmlns","http://www.w3.org/2000/svg"),k(e,"fill","none"),k(e,"viewBox","0 0 24 24"),k(e,"stroke-width","1.5"),k(e,"stroke","currentColor"),k(e,"class","size-6 hover:stroke-2")},m(t,r){C(t,e,r),v(e,n)},p:P,d(t){t&&y(e)}}}function zl(i){let e,n;return e=new he({props:{onClick:i[0],$$slots:{default:[Hl]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,[r]){const s={};r&1&&(s.onClick=t[0]),r&2&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function Jl(i,e,n){let{onClick:t}=e;return i.$$set=r=>{"onClick"in r&&n(0,t=r.onClick)},[t]}class ps extends q{constructor(e){super(),D(this,e,Jl,zl,L,{onClick:0})}}function Kl(i){let e,n;return{c(){e=Y("svg"),n=Y("path"),k(n,"stroke-linecap","round"),k(n,"stroke-linejoin","round"),k(n,"d","m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"),k(e,"xmlns","http://www.w3.org/2000/svg"),k(e,"fill","none"),k(e,"viewBox","0 0 24 24"),k(e,"stroke-width","1.5"),k(e,"stroke","currentColor"),k(e,"class","size-6 hover:stroke-2")},m(t,r){C(t,e,r),v(e,n)},p:P,d(t){t&&y(e)}}}function Gl(i){let e,n;return e=new he({props:{onClick:i[0],$$slots:{default:[Kl]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,[r]){const s={};r&1&&(s.onClick=t[0]),r&2&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function Vl(i,e,n){let{onClick:t}=e;return i.$$set=r=>{"onClick"in r&&n(0,t=r.onClick)},[t]}class kn extends q{constructor(e){super(),D(this,e,Vl,Gl,L,{onClick:0})}}function dr(i){let e,n;return e=new Yr({props:{title:i[1],buttons:i[2],$$slots:{default:[Wl]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,r){const s={};r&2&&(s.title=t[1]),r&9&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function Wl(i){let e=i[0].getMessage(i[0])+"",n;return{c(){n=U(e)},m(t,r){C(t,n,r)},p(t,r){r&1&&e!==(e=t[0].getMessage(t[0])+"")&&B(n,e)},d(t){t&&y(n)}}}function Ql(i){let e,n,t=i[0].entry&&dr(i);return{c(){t&&t.c(),e=x()},m(r,s){t&&t.m(r,s),C(r,e,s),n=!0},p(r,[s]){r[0].entry?t?(t.p(r,s),s&1&&m(t,1)):(t=dr(r),t.c(),m(t,1),t.m(e.parentNode,e)):t&&(K(),_(t,1,1,()=>{t=null}),G())},i(r){n||(m(t),n=!0)},o(r){_(t),n=!1},d(r){r&&y(e),t&&t.d(r)}}}function Yl(i,e,n){let{title:t}=e,{deleteEntry:r}=e;const s=[{label:"Close",onclick:()=>{n(0,r.entry=null,r)}},{label:"Delete",onclick:()=>{r.entry&&(r.onDelete(r.entry),n(0,r.entry=null,r))}}];return i.$$set=o=>{"title"in o&&n(1,t=o.title),"deleteEntry"in o&&n(0,r=o.deleteEntry)},[r,t,s]}class yn extends q{constructor(e){super(),D(this,e,Yl,Ql,L,{title:1,deleteEntry:0})}}function pr(i,e,n){const t=i.slice();return t[7]=e[n],t}function Xl(i){let e,n,t,r,s,o;function l(){return i[2](i[7])}e=new Rt({props:{onClick:l}});function a(){return i[3](i[7])}t=new kn({props:{onClick:a}});function u(){return i[4](i[7])}return s=new ps({props:{onClick:u}}),{c(){w(e.$$.fragment),n=A(),w(t.$$.fragment),r=A(),w(s.$$.fragment)},m(c,h){g(e,c,h),C(c,n,h),g(t,c,h),C(c,r,h),g(s,c,h),o=!0},p(c,h){i=c;const d={};h&3&&(d.onClick=l),e.$set(d);const f={};h&1&&(f.onClick=a),t.$set(f);const p={};h&1&&(p.onClick=u),s.$set(p)},i(c){o||(m(e.$$.fragment,c),m(t.$$.fragment,c),m(s.$$.fragment,c),o=!0)},o(c){_(e.$$.fragment,c),_(t.$$.fragment,c),_(s.$$.fragment,c),o=!1},d(c){c&&(y(n),y(r)),b(e,c),b(t,c),b(s,c)}}}function mr(i){let e,n,t=i[7].id+"",r,s,o,l=i[7].name+"",a,u,c,h=i[7].description+"",d,f,p,$=ae(i[7].modified)+"",S,j,E,T,I,R;return T=new X({props:{$$slots:{default:[Xl]},$$scope:{ctx:i}}}),{c(){e=O("tr"),n=O("td"),r=U(t),s=A(),o=O("td"),a=U(l),u=A(),c=O("td"),d=U(h),f=A(),p=O("td"),S=U($),j=A(),E=O("td"),w(T.$$.fragment),I=A()},m(N,J){C(N,e,J),v(e,n),v(n,r),v(e,s),v(e,o),v(o,a),v(e,u),v(e,c),v(c,d),v(e,f),v(e,p),v(p,S),v(e,j),v(e,E),g(T,E,null),v(e,I),R=!0},p(N,J){(!R||J&1)&&t!==(t=N[7].id+"")&&B(r,t),(!R||J&1)&&l!==(l=N[7].name+"")&&B(a,l),(!R||J&1)&&h!==(h=N[7].description+"")&&B(d,h),(!R||J&1)&&$!==($=ae(N[7].modified)+"")&&B(S,$);const Z={};J&1027&&(Z.$$scope={dirty:J,ctx:N}),T.$set(Z)},i(N){R||(m(T.$$.fragment,N),R=!0)},o(N){_(T.$$.fragment,N),R=!1},d(N){N&&y(e),b(T)}}}function Zl(i){let e,n,t,r;return e=new M({props:{onClick:i[5],label:"Cancel"}}),t=new M({props:{onClick:i[6],label:"Create"}}),{c(){w(e.$$.fragment),n=A(),w(t.$$.fragment)},m(s,o){g(e,s,o),C(s,n,o),g(t,s,o),r=!0},p:P,i(s){r||(m(e.$$.fragment,s),m(t.$$.fragment,s),r=!0)},o(s){_(e.$$.fragment,s),_(t.$$.fragment,s),r=!1},d(s){s&&y(n),b(e,s),b(t,s)}}}function xl(i){let e,n,t,r,s,o,l,a,u;e=new se({props:{header:"List Books"}});let c=re(i[0]),h=[];for(let f=0;f<c.length;f+=1)h[f]=mr(pr(i,c,f));const d=f=>_(h[f],1,1,()=>{h[f]=null});return a=new X({props:{$$slots:{default:[Zl]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment),n=A(),t=O("table"),r=O("thead"),r.innerHTML="<tr><th>ID</th> <th>Name</th> <th>Description</th> <th>Modified</th> <th>Actions</th></tr>",s=A(),o=O("tbody");for(let f=0;f<h.length;f+=1)h[f].c();l=A(),w(a.$$.fragment),k(t,"class","w-full")},m(f,p){g(e,f,p),C(f,n,p),C(f,t,p),v(t,r),v(t,s),v(t,o);for(let $=0;$<h.length;$+=1)h[$]&&h[$].m(o,null);C(f,l,p),g(a,f,p),u=!0},p(f,p){if(p&3){c=re(f[0]);let S;for(S=0;S<c.length;S+=1){const j=pr(f,c,S);h[S]?(h[S].p(j,p),m(h[S],1)):(h[S]=mr(j),h[S].c(),m(h[S],1),h[S].m(o,null))}for(K(),S=c.length;S<h.length;S+=1)d(S);G()}const $={};p&1024&&($.$$scope={dirty:p,ctx:f}),a.$set($)},i(f){if(!u){m(e.$$.fragment,f);for(let p=0;p<c.length;p+=1)m(h[p]);m(a.$$.fragment,f),u=!0}},o(f){_(e.$$.fragment,f),h=h.filter(Boolean);for(let p=0;p<h.length;p+=1)_(h[p]);_(a.$$.fragment,f),u=!1},d(f){f&&(y(n),y(t),y(l)),b(e,f),ye(h,f),b(a,f)}}}function eu(i){let e,n,t,r;return e=new ie({props:{$$slots:{default:[xl]},$$scope:{ctx:i}}}),t=new yn({props:{title:"Delete Book",deleteEntry:i[1]}}),{c(){w(e.$$.fragment),n=A(),w(t.$$.fragment)},m(s,o){g(e,s,o),C(s,n,o),g(t,s,o),r=!0},p(s,[o]){const l={};o&1027&&(l.$$scope={dirty:o,ctx:s}),e.$set(l);const a={};o&2&&(a.deleteEntry=s[1]),t.$set(a)},i(s){r||(m(e.$$.fragment,s),m(t.$$.fragment,s),r=!0)},o(s){_(e.$$.fragment,s),_(t.$$.fragment,s),r=!1},d(s){s&&y(n),b(e,s),b(t,s)}}}function tu(i,e,n){let t=[],r={entry:null,onDelete:c=>{Bl(c.id).then(h=>{n(0,t=h)})},getMessage:c=>`Do you wnat to delete the book: '${c.id}'?`};return fe(async()=>{n(0,t=await vn())}),[t,r,async c=>{n(1,r.entry=c,r)},c=>{H("/books/update/"+c.id)},c=>{H("/chapters/list/"+c.id)},()=>H("/books/list"),()=>H("/books/create")]}class nu extends q{constructor(e){super(),D(this,e,tu,eu,L,{})}}function ru(i){let e,n,t;return{c(){e=O("textarea"),k(e,"class","input"),k(e,"id",i[2])},m(r,s){C(r,e,s),Oe(e,i[0]),n||(t=De(e,"input",i[4]),n=!0)},p(r,s){s&4&&k(e,"id",r[2]),s&1&&Oe(e,r[0])},d(r){r&&y(e),n=!1,t()}}}function su(i){let e,n;return e=new Pt({props:{id:i[2],label:i[1],error:i[3],$$slots:{default:[ru]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,[r]){const s={};r&4&&(s.id=t[2]),r&2&&(s.label=t[1]),r&8&&(s.error=t[3]),r&37&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function iu(i,e,n){let{label:t}=e,{id:r}=e,{value:s}=e,{error:o}=e;function l(){s=this.value,n(0,s)}return i.$$set=a=>{"label"in a&&n(1,t=a.label),"id"in a&&n(2,r=a.id),"value"in a&&n(0,s=a.value),"error"in a&&n(3,o=a.error)},[s,t,r,o,l]}class ms extends q{constructor(e){super(),D(this,e,iu,su,L,{label:1,id:2,value:0,error:3})}}function ou(i){let e,n,t,r;return e=new M({props:{onClick:i[7],label:"Cancel"}}),t=new M({props:{label:"Create"}}),{c(){w(e.$$.fragment),n=A(),w(t.$$.fragment)},m(s,o){g(e,s,o),C(s,n,o),g(t,s,o),r=!0},p:P,i(s){r||(m(e.$$.fragment,s),m(t.$$.fragment,s),r=!0)},o(s){_(e.$$.fragment,s),_(t.$$.fragment,s),r=!1},d(s){s&&y(n),b(e,s),b(t,s)}}}function au(i){let e,n,t,r,s,o,l,a;function u(f){i[5](f)}let c={id:"name",label:"Book name",error:i[1]};i[0]!==void 0&&(c.value=i[0]),e=new Te({props:c}),ee.push(()=>ne(e,"value",u));function h(f){i[6](f)}let d={id:"description",label:"Book description",error:i[3]};return i[2]!==void 0&&(d.value=i[2]),r=new ms({props:d}),ee.push(()=>ne(r,"value",h)),l=new X({props:{$$slots:{default:[ou]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment),t=A(),w(r.$$.fragment),o=A(),w(l.$$.fragment)},m(f,p){g(e,f,p),C(f,t,p),g(r,f,p),C(f,o,p),g(l,f,p),a=!0},p(f,p){const $={};p&2&&($.error=f[1]),!n&&p&1&&(n=!0,$.value=f[0],te(()=>n=!1)),e.$set($);const S={};p&8&&(S.error=f[3]),!s&&p&4&&(s=!0,S.value=f[2],te(()=>s=!1)),r.$set(S);const j={};p&256&&(j.$$scope={dirty:p,ctx:f}),l.$set(j)},i(f){a||(m(e.$$.fragment,f),m(r.$$.fragment,f),m(l.$$.fragment,f),a=!0)},o(f){_(e.$$.fragment,f),_(r.$$.fragment,f),_(l.$$.fragment,f),a=!1},d(f){f&&(y(t),y(o)),b(e,f),b(r,f),b(l,f)}}}function lu(i){let e,n,t,r;return e=new se({props:{header:"Create Book"}}),t=new _e({props:{onSubmit:i[4],$$slots:{default:[au]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment),n=A(),w(t.$$.fragment)},m(s,o){g(e,s,o),C(s,n,o),g(t,s,o),r=!0},p(s,o){const l={};o&271&&(l.$$scope={dirty:o,ctx:s}),t.$set(l)},i(s){r||(m(e.$$.fragment,s),m(t.$$.fragment,s),r=!0)},o(s){_(e.$$.fragment,s),_(t.$$.fragment,s),r=!1},d(s){s&&y(n),b(e,s),b(t,s)}}}function uu(i){let e,n;return e=new ie({props:{$$slots:{default:[lu]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,[r]){const s={};r&271&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function cu(i,e,n){let t="",r="",s="",o="";const l=async()=>{n(1,r=ue(t)),n(3,o=ue(s)),!(r||o)&&(await Ml(t,s),H("/books/list"))};function a(h){t=h,n(0,t)}function u(h){s=h,n(2,s)}return[t,r,s,o,l,a,u,()=>H("/books/list")]}class fu extends q{constructor(e){super(),D(this,e,cu,uu,L,{})}}function _r(i){let e,n,t=i[0].id+"",r,s,o,l=ae(i[0].modified)+"",a,u,c,h;return c=new _e({props:{onSubmit:i[5],$$slots:{default:[du]},$$scope:{ctx:i}}}),{c(){e=O("div"),n=O("span"),r=U(t),s=A(),o=O("span"),a=U(l),u=A(),w(c.$$.fragment),k(e,"class","mb-4 text-small")},m(d,f){C(d,e,f),v(e,n),v(n,r),v(e,s),v(e,o),v(o,a),C(d,u,f),g(c,d,f),h=!0},p(d,f){(!h||f&1)&&t!==(t=d[0].id+"")&&B(r,t),(!h||f&1)&&l!==(l=ae(d[0].modified)+"")&&B(a,l);const p={};f&1054&&(p.$$scope={dirty:f,ctx:d}),c.$set(p)},i(d){h||(m(c.$$.fragment,d),h=!0)},o(d){_(c.$$.fragment,d),h=!1},d(d){d&&(y(e),y(u)),b(c,d)}}}function hu(i){let e,n,t,r;return e=new M({props:{onClick:i[9],label:"Cancel"}}),t=new M({props:{label:"Update"}}),{c(){w(e.$$.fragment),n=A(),w(t.$$.fragment)},m(s,o){g(e,s,o),C(s,n,o),g(t,s,o),r=!0},p:P,i(s){r||(m(e.$$.fragment,s),m(t.$$.fragment,s),r=!0)},o(s){_(e.$$.fragment,s),_(t.$$.fragment,s),r=!1},d(s){s&&y(n),b(e,s),b(t,s)}}}function du(i){let e,n,t,r,s,o,l,a;function u(f){i[7](f)}let c={id:"name",label:"Book name",error:i[2]};i[1]!==void 0&&(c.value=i[1]),e=new Te({props:c}),ee.push(()=>ne(e,"value",u));function h(f){i[8](f)}let d={id:"description",label:"Book description",error:i[4]};return i[3]!==void 0&&(d.value=i[3]),r=new ms({props:d}),ee.push(()=>ne(r,"value",h)),l=new X({props:{$$slots:{default:[hu]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment),t=A(),w(r.$$.fragment),o=A(),w(l.$$.fragment)},m(f,p){g(e,f,p),C(f,t,p),g(r,f,p),C(f,o,p),g(l,f,p),a=!0},p(f,p){const $={};p&4&&($.error=f[2]),!n&&p&2&&(n=!0,$.value=f[1],te(()=>n=!1)),e.$set($);const S={};p&16&&(S.error=f[4]),!s&&p&8&&(s=!0,S.value=f[3],te(()=>s=!1)),r.$set(S);const j={};p&1024&&(j.$$scope={dirty:p,ctx:f}),l.$set(j)},i(f){a||(m(e.$$.fragment,f),m(r.$$.fragment,f),m(l.$$.fragment,f),a=!0)},o(f){_(e.$$.fragment,f),_(r.$$.fragment,f),_(l.$$.fragment,f),a=!1},d(f){f&&(y(t),y(o)),b(e,f),b(r,f),b(l,f)}}}function pu(i){let e,n,t,r;e=new se({props:{header:"Update Book"}});let s=i[0]&&_r(i);return{c(){w(e.$$.fragment),n=A(),s&&s.c(),t=x()},m(o,l){g(e,o,l),C(o,n,l),s&&s.m(o,l),C(o,t,l),r=!0},p(o,l){o[0]?s?(s.p(o,l),l&1&&m(s,1)):(s=_r(o),s.c(),m(s,1),s.m(t.parentNode,t)):s&&(K(),_(s,1,1,()=>{s=null}),G())},i(o){r||(m(e.$$.fragment,o),m(s),r=!0)},o(o){_(e.$$.fragment,o),_(s),r=!1},d(o){o&&(y(n),y(t)),b(e,o),s&&s.d(o)}}}function mu(i){let e,n;return e=new ie({props:{$$slots:{default:[pu]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,[r]){const s={};r&1055&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function _u(i,e,n){let{params:t={id:""}}=e,r=null,s="",o="",l="",a="";const u=async()=>{if(n(2,o=ue(s)),n(4,a=ue(l)),!(o||a)){if(!r){V.setString("No book!!");return}await Fl(r.id,s,l),H("/books/list")}};fe(async()=>{n(0,r=await Lt(parseInt(t.id))),r&&(n(1,s=r.name),n(3,l=r.description))});function c(f){s=f,n(1,s)}function h(f){l=f,n(3,l)}const d=()=>H("/books/list");return i.$$set=f=>{"params"in f&&n(6,t=f.params)},[r,s,o,l,a,u,t,c,h,d]}class $u extends q{constructor(e){super(),D(this,e,_u,mu,L,{params:6})}}const gu=ht+"chapters",Dt=i=>`${gu}#${i}`,Cn=async i=>{let{data:e,error:n}=await Q.from("chapters").select("*").eq("id",i).single();return n&&V.setDBError(n),e||null},Sn=async i=>{const e=Dt(i),n=localStorage.getItem(e);if(n)return JSON.parse(n);let{data:t,error:r}=await Q.from("chapters").select("*").eq("book_id",i).order("id");return r&&V.setDBError(r),t?(localStorage.setItem(e,JSON.stringify(t)),t):[]},bu=async(i,e)=>{const{error:n}=await Q.from("chapters").delete().eq("id",i);return n?(V.setDBError(n),[]):(localStorage.removeItem(Dt(e)),Sn(e))},wu=async(i,e,n)=>{const{error:t}=await Q.from("chapters").update({name:n}).eq("id",i);return t?(V.setDBError(t),[]):(localStorage.removeItem(Dt(e)),Sn(e))},vu=async(i,e)=>{const{error:n}=await Q.from("chapters").insert([{book_id:i,name:e}]);if(n)return V.setDBError(n),[];localStorage.removeItem(Dt(i))};function ku(i){let e,n;const t=i[1].default,r=be(t,i,i[0],null);return{c(){e=O("div"),r&&r.c(),k(e,"class","border rounded shadow px-4 py-4")},m(s,o){C(s,e,o),r&&r.m(e,null),n=!0},p(s,[o]){r&&r.p&&(!n||o&1)&&ve(r,t,s,s[0],n?we(t,s[0],o,null):ke(s[0]),null)},i(s){n||(m(r,s),n=!0)},o(s){_(r,s),n=!1},d(s){s&&y(e),r&&r.d(s)}}}function yu(i,e,n){let{$$slots:t={},$$scope:r}=e;return i.$$set=s=>{"$$scope"in s&&n(0,r=s.$$scope)},[r,t]}class Cu extends q{constructor(e){super(),D(this,e,yu,ku,L,{})}}function $r(i){let e,n,t,r=i[0].name+"",s,o,l,a,u=i[0].id+"",c,h,d=ae(i[0].modified)+"",f,p,$=i[0].description&&gr(i);return{c(){e=O("div"),n=O("div"),t=O("div"),s=U(r),o=A(),l=O("div"),a=U("Book-Id: "),c=U(u),h=U(" - Modified: "),f=U(d),p=A(),$&&$.c(),k(t,"class","text-lg font-semibold"),k(l,"class","text-sm"),k(n,"class","flex justify-between mb-2")},m(S,j){C(S,e,j),v(e,n),v(n,t),v(t,s),v(n,o),v(n,l),v(l,a),v(l,c),v(l,h),v(l,f),v(e,p),$&&$.m(e,null)},p(S,j){j&1&&r!==(r=S[0].name+"")&&B(s,r),j&1&&u!==(u=S[0].id+"")&&B(c,u),j&1&&d!==(d=ae(S[0].modified)+"")&&B(f,d),S[0].description?$?$.p(S,j):($=gr(S),$.c(),$.m(e,null)):$&&($.d(1),$=null)},d(S){S&&y(e),$&&$.d()}}}function gr(i){let e,n=i[0].description+"",t;return{c(){e=O("p"),t=U(n),k(e,"class","mt-2 pt-2 border-t text-sm")},m(r,s){C(r,e,s),v(e,t)},p(r,s){s&1&&n!==(n=r[0].description+"")&&B(t,n)},d(r){r&&y(e)}}}function br(i){let e,n,t=i[1].name+"",r,s,o,l,a=i[1].id+"",u,c,h=ae(i[1].modified)+"",d;return{c(){e=O("div"),n=O("div"),r=U(t),s=A(),o=O("div"),l=U("Chapter-Id: "),u=U(a),c=U(" - Modified: "),d=U(h),k(n,"class","text font-medium"),k(o,"class","text-sm"),k(e,"class","flex justify-between mb-2")},m(f,p){C(f,e,p),v(e,n),v(n,r),v(e,s),v(e,o),v(o,l),v(o,u),v(o,c),v(o,d)},p(f,p){p&2&&t!==(t=f[1].name+"")&&B(r,t),p&2&&a!==(a=f[1].id+"")&&B(u,a),p&2&&h!==(h=ae(f[1].modified)+"")&&B(d,h)},d(f){f&&y(e)}}}function Su(i){let e,n,t=i[0]&&$r(i),r=i[1]&&br(i);return{c(){e=O("div"),t&&t.c(),n=A(),r&&r.c(),k(e,"class","flex flex-col gap-5")},m(s,o){C(s,e,o),t&&t.m(e,null),v(e,n),r&&r.m(e,null)},p(s,o){s[0]?t?t.p(s,o):(t=$r(s),t.c(),t.m(e,n)):t&&(t.d(1),t=null),s[1]?r?r.p(s,o):(r=br(s),r.c(),r.m(e,null)):r&&(r.d(1),r=null)},d(s){s&&y(e),t&&t.d(),r&&r.d()}}}function Eu(i){let e,n;return e=new Cu({props:{$$slots:{default:[Su]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,[r]){const s={};r&7&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function Au(i,e,n){let{book:t=null}=e,{chapter:r=null}=e;return i.$$set=s=>{"book"in s&&n(0,t=s.book),"chapter"in s&&n(1,r=s.chapter)},[t,r]}class En extends q{constructor(e){super(),D(this,e,Au,Eu,L,{book:0,chapter:1})}}function Ou(i){let e,n;return{c(){e=Y("svg"),n=Y("path"),k(n,"stroke-linecap","round"),k(n,"stroke-linejoin","round"),k(n,"d","m12.75 15 3-3m0 0-3-3m3 3h-7.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"),k(e,"xmlns","http://www.w3.org/2000/svg"),k(e,"fill","none"),k(e,"viewBox","0 0 24 24"),k(e,"stroke-width","1.5"),k(e,"stroke","currentColor"),k(e,"class","size-6 hover:stroke-2")},m(t,r){C(t,e,r),v(e,n)},p:P,d(t){t&&y(e)}}}function Tu(i){let e,n;return e=new he({props:{onClick:i[0],$$slots:{default:[Ou]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,[r]){const s={};r&1&&(s.onClick=t[0]),r&2&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function ju(i,e,n){let{onClick:t}=e;return i.$$set=r=>{"onClick"in r&&n(0,t=r.onClick)},[t]}class Iu extends q{constructor(e){super(),D(this,e,ju,Tu,L,{onClick:0})}}function wr(i,e,n){const t=i.slice();return t[10]=e[n],t}function Pu(i){let e,n,t,r,s,o,l,a;function u(){return i[4](i[10])}e=new Rt({props:{onClick:u}});function c(){return i[5](i[10])}t=new kn({props:{onClick:c}});function h(){return i[6](i[10])}s=new ps({props:{onClick:h}});function d(){return i[7](i[10])}return l=new Iu({props:{onClick:d}}),{c(){w(e.$$.fragment),n=A(),w(t.$$.fragment),r=A(),w(s.$$.fragment),o=A(),w(l.$$.fragment)},m(f,p){g(e,f,p),C(f,n,p),g(t,f,p),C(f,r,p),g(s,f,p),C(f,o,p),g(l,f,p),a=!0},p(f,p){i=f;const $={};p&12&&($.onClick=u),e.$set($);const S={};p&4&&(S.onClick=c),t.$set(S);const j={};p&4&&(j.onClick=h),s.$set(j);const E={};p&4&&(E.onClick=d),l.$set(E)},i(f){a||(m(e.$$.fragment,f),m(t.$$.fragment,f),m(s.$$.fragment,f),m(l.$$.fragment,f),a=!0)},o(f){_(e.$$.fragment,f),_(t.$$.fragment,f),_(s.$$.fragment,f),_(l.$$.fragment,f),a=!1},d(f){f&&(y(n),y(r),y(o)),b(e,f),b(t,f),b(s,f),b(l,f)}}}function vr(i){let e,n,t=i[10].id+"",r,s,o,l=i[10].name+"",a,u,c,h=ae(i[10].modified)+"",d,f,p,$,S,j;return $=new X({props:{$$slots:{default:[Pu]},$$scope:{ctx:i}}}),{c(){e=O("tr"),n=O("td"),r=U(t),s=A(),o=O("td"),a=U(l),u=A(),c=O("td"),d=U(h),f=A(),p=O("td"),w($.$$.fragment),S=A()},m(E,T){C(E,e,T),v(e,n),v(n,r),v(e,s),v(e,o),v(o,a),v(e,u),v(e,c),v(c,d),v(e,f),v(e,p),g($,p,null),v(e,S),j=!0},p(E,T){(!j||T&4)&&t!==(t=E[10].id+"")&&B(r,t),(!j||T&4)&&l!==(l=E[10].name+"")&&B(a,l),(!j||T&4)&&h!==(h=ae(E[10].modified)+"")&&B(d,h);const I={};T&8204&&(I.$$scope={dirty:T,ctx:E}),$.$set(I)},i(E){j||(m($.$$.fragment,E),j=!0)},o(E){_($.$$.fragment,E),j=!1},d(E){E&&y(e),b($)}}}function Ru(i){let e,n,t,r;return e=new M({props:{onClick:i[8],label:"Cancel"}}),t=new M({props:{onClick:i[9],label:"Create"}}),{c(){w(e.$$.fragment),n=A(),w(t.$$.fragment)},m(s,o){g(e,s,o),C(s,n,o),g(t,s,o),r=!0},p(s,o){const l={};o&1&&(l.onClick=s[9]),t.$set(l)},i(s){r||(m(e.$$.fragment,s),m(t.$$.fragment,s),r=!0)},o(s){_(e.$$.fragment,s),_(t.$$.fragment,s),r=!1},d(s){s&&y(n),b(e,s),b(t,s)}}}function Lu(i){let e,n,t,r,s,o,l,a,u,c,h;e=new se({props:{header:"List Chapters"}}),t=new En({props:{book:i[1]}});let d=re(i[2]),f=[];for(let $=0;$<d.length;$+=1)f[$]=vr(wr(i,d,$));const p=$=>_(f[$],1,1,()=>{f[$]=null});return c=new X({props:{$$slots:{default:[Ru]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment),n=A(),w(t.$$.fragment),r=A(),s=O("table"),o=O("thead"),o.innerHTML="<tr><th>ID</th> <th>Name</th> <th>Modified</th> <th>Actions</th></tr>",l=A(),a=O("tbody");for(let $=0;$<f.length;$+=1)f[$].c();u=A(),w(c.$$.fragment),k(s,"class","w-full")},m($,S){g(e,$,S),C($,n,S),g(t,$,S),C($,r,S),C($,s,S),v(s,o),v(s,l),v(s,a);for(let j=0;j<f.length;j+=1)f[j]&&f[j].m(a,null);C($,u,S),g(c,$,S),h=!0},p($,S){const j={};if(S&2&&(j.book=$[1]),t.$set(j),S&12){d=re($[2]);let T;for(T=0;T<d.length;T+=1){const I=wr($,d,T);f[T]?(f[T].p(I,S),m(f[T],1)):(f[T]=vr(I),f[T].c(),m(f[T],1),f[T].m(a,null))}for(K(),T=d.length;T<f.length;T+=1)p(T);G()}const E={};S&8193&&(E.$$scope={dirty:S,ctx:$}),c.$set(E)},i($){if(!h){m(e.$$.fragment,$),m(t.$$.fragment,$);for(let S=0;S<d.length;S+=1)m(f[S]);m(c.$$.fragment,$),h=!0}},o($){_(e.$$.fragment,$),_(t.$$.fragment,$),f=f.filter(Boolean);for(let S=0;S<f.length;S+=1)_(f[S]);_(c.$$.fragment,$),h=!1},d($){$&&(y(n),y(r),y(s),y(u)),b(e,$),b(t,$),ye(f,$),b(c,$)}}}function Du(i){let e,n,t,r;return e=new ie({props:{$$slots:{default:[Lu]},$$scope:{ctx:i}}}),t=new yn({props:{title:"Delete Chapter",deleteEntry:i[3]}}),{c(){w(e.$$.fragment),n=A(),w(t.$$.fragment)},m(s,o){g(e,s,o),C(s,n,o),g(t,s,o),r=!0},p(s,[o]){const l={};o&8207&&(l.$$scope={dirty:o,ctx:s}),e.$set(l);const a={};o&8&&(a.deleteEntry=s[3]),t.$set(a)},i(s){r||(m(e.$$.fragment,s),m(t.$$.fragment,s),r=!0)},o(s){_(e.$$.fragment,s),_(t.$$.fragment,s),r=!1},d(s){s&&y(n),b(e,s),b(t,s)}}}function qu(i,e,n){let{params:t={id:0}}=e,r,s=[],o={entry:null,onDelete:f=>{bu(f.id,f.book_id).then(p=>n(2,s=p))},getMessage:f=>`Do you wnat to delete the chapter: '${f.id}'?`};fe(async()=>{n(1,r=await Lt(t.id)),r&&n(2,s=await Sn(r.id))});const l=async f=>{n(3,o.entry=f,o)},a=f=>{H("/chapters/update/"+f.id)},u=f=>{H("/questions/list/"+f.id)},c=f=>{H("/lession/prepare/"+f.id)},h=()=>H("/books/list"),d=()=>H("/chapters/create/"+t.id);return i.$$set=f=>{"params"in f&&n(0,t=f.params)},[t,r,s,o,l,a,u,c,h,d]}class Uu extends q{constructor(e){super(),D(this,e,qu,Du,L,{params:0})}}function Nu(i){let e,n,t,r;return e=new M({props:{onClick:i[5],label:"Cancel"}}),t=new M({props:{label:"Create"}}),{c(){w(e.$$.fragment),n=A(),w(t.$$.fragment)},m(s,o){g(e,s,o),C(s,n,o),g(t,s,o),r=!0},p(s,o){const l={};o&1&&(l.onClick=s[5]),e.$set(l)},i(s){r||(m(e.$$.fragment,s),m(t.$$.fragment,s),r=!0)},o(s){_(e.$$.fragment,s),_(t.$$.fragment,s),r=!1},d(s){s&&y(n),b(e,s),b(t,s)}}}function Bu(i){let e,n,t,r,s;function o(a){i[4](a)}let l={id:"name",label:"Chapter name",error:i[2]};return i[1]!==void 0&&(l.value=i[1]),e=new Te({props:l}),ee.push(()=>ne(e,"value",o)),r=new X({props:{$$slots:{default:[Nu]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment),t=A(),w(r.$$.fragment)},m(a,u){g(e,a,u),C(a,t,u),g(r,a,u),s=!0},p(a,u){const c={};u&4&&(c.error=a[2]),!n&&u&2&&(n=!0,c.value=a[1],te(()=>n=!1)),e.$set(c);const h={};u&65&&(h.$$scope={dirty:u,ctx:a}),r.$set(h)},i(a){s||(m(e.$$.fragment,a),m(r.$$.fragment,a),s=!0)},o(a){_(e.$$.fragment,a),_(r.$$.fragment,a),s=!1},d(a){a&&y(t),b(e,a),b(r,a)}}}function Mu(i){let e,n,t,r;return e=new se({props:{header:"Create Book"}}),t=new _e({props:{onSubmit:i[3],$$slots:{default:[Bu]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment),n=A(),w(t.$$.fragment)},m(s,o){g(e,s,o),C(s,n,o),g(t,s,o),r=!0},p(s,o){const l={};o&71&&(l.$$scope={dirty:o,ctx:s}),t.$set(l)},i(s){r||(m(e.$$.fragment,s),m(t.$$.fragment,s),r=!0)},o(s){_(e.$$.fragment,s),_(t.$$.fragment,s),r=!1},d(s){s&&y(n),b(e,s),b(t,s)}}}function Fu(i){let e,n;return e=new ie({props:{$$slots:{default:[Mu]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,[r]){const s={};r&71&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function Hu(i,e,n){let{params:t={book_id:0}}=e,r="",s="";const o=async()=>{n(2,s=ue(r)),!s&&(await vu(t.book_id,r),H("/chapters/list/"+t.book_id))};function l(u){r=u,n(1,r)}const a=()=>H("/chapters/list/"+t.book_id);return i.$$set=u=>{"params"in u&&n(0,t=u.params)},[t,r,s,o,l,a]}class zu extends q{constructor(e){super(),D(this,e,Hu,Fu,L,{params:0})}}function kr(i){let e,n,t=i[0].id+"",r,s,o,l=ae(i[0].modified)+"",a,u,c,h;return c=new _e({props:{onSubmit:i[3],$$slots:{default:[Ku]},$$scope:{ctx:i}}}),{c(){e=O("div"),n=O("span"),r=U(t),s=A(),o=O("span"),a=U(l),u=A(),w(c.$$.fragment),k(e,"class","mb-4 text-small")},m(d,f){C(d,e,f),v(e,n),v(n,r),v(e,s),v(e,o),v(o,a),C(d,u,f),g(c,d,f),h=!0},p(d,f){(!h||f&1)&&t!==(t=d[0].id+"")&&B(r,t),(!h||f&1)&&l!==(l=ae(d[0].modified)+"")&&B(a,l);const p={};f&135&&(p.$$scope={dirty:f,ctx:d}),c.$set(p)},i(d){h||(m(c.$$.fragment,d),h=!0)},o(d){_(c.$$.fragment,d),h=!1},d(d){d&&(y(e),y(u)),b(c,d)}}}function Ju(i){let e,n,t,r;return e=new M({props:{onClick:i[6],label:"Cancel"}}),t=new M({props:{label:"Create"}}),{c(){w(e.$$.fragment),n=A(),w(t.$$.fragment)},m(s,o){g(e,s,o),C(s,n,o),g(t,s,o),r=!0},p(s,o){const l={};o&1&&(l.onClick=s[6]),e.$set(l)},i(s){r||(m(e.$$.fragment,s),m(t.$$.fragment,s),r=!0)},o(s){_(e.$$.fragment,s),_(t.$$.fragment,s),r=!1},d(s){s&&y(n),b(e,s),b(t,s)}}}function Ku(i){let e,n,t,r,s;function o(a){i[5](a)}let l={id:"name",label:"Chapter name",error:i[2]};return i[1]!==void 0&&(l.value=i[1]),e=new Te({props:l}),ee.push(()=>ne(e,"value",o)),r=new X({props:{$$slots:{default:[Ju]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment),t=A(),w(r.$$.fragment)},m(a,u){g(e,a,u),C(a,t,u),g(r,a,u),s=!0},p(a,u){const c={};u&4&&(c.error=a[2]),!n&&u&2&&(n=!0,c.value=a[1],te(()=>n=!1)),e.$set(c);const h={};u&129&&(h.$$scope={dirty:u,ctx:a}),r.$set(h)},i(a){s||(m(e.$$.fragment,a),m(r.$$.fragment,a),s=!0)},o(a){_(e.$$.fragment,a),_(r.$$.fragment,a),s=!1},d(a){a&&y(t),b(e,a),b(r,a)}}}function Gu(i){let e,n,t,r;e=new se({props:{header:"Update Book"}});let s=i[0]&&kr(i);return{c(){w(e.$$.fragment),n=A(),s&&s.c(),t=x()},m(o,l){g(e,o,l),C(o,n,l),s&&s.m(o,l),C(o,t,l),r=!0},p(o,l){o[0]?s?(s.p(o,l),l&1&&m(s,1)):(s=kr(o),s.c(),m(s,1),s.m(t.parentNode,t)):s&&(K(),_(s,1,1,()=>{s=null}),G())},i(o){r||(m(e.$$.fragment,o),m(s),r=!0)},o(o){_(e.$$.fragment,o),_(s),r=!1},d(o){o&&(y(n),y(t)),b(e,o),s&&s.d(o)}}}function Vu(i){let e,n;return e=new ie({props:{$$slots:{default:[Gu]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,[r]){const s={};r&135&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function Wu(i,e,n){let{params:t={id:""}}=e,r=null,s="",o="";const l=async()=>{if(n(2,o=ue(s)),!o){if(!r){V.setString("No chapter!!");return}await wu(r.id,r.book_id,s),H("/chapters/list/"+r.book_id)}};fe(async()=>{n(0,r=await Cn(parseInt(t.id))),r&&n(1,s=r.name)});function a(c){s=c,n(1,s)}const u=()=>H("/chapters/list/"+(r==null?void 0:r.book_id));return i.$$set=c=>{"params"in c&&n(4,t=c.params)},[r,s,o,l,t,a,u]}class Qu extends q{constructor(e){super(),D(this,e,Wu,Vu,L,{params:4})}}function yr(i,e,n){const t=i.slice();return t[7]=e[n],t}function Cr(i){let e,n=i[7].label+"",t,r,s;return{c(){e=O("option"),t=U(n),e.__value=r=i[7].value,Oe(e,e.__value),e.selected=s=i[7].value===i[0]},m(o,l){C(o,e,l),v(e,t)},p(o,l){l&8&&n!==(n=o[7].label+"")&&B(t,n),l&8&&r!==(r=o[7].value)&&(e.__value=r,Oe(e,e.__value)),l&9&&s!==(s=o[7].value===o[0])&&(e.selected=s)},d(o){o&&y(e)}}}function Yu(i){let e,n,t,r=re(i[3]),s=[];for(let o=0;o<r.length;o+=1)s[o]=Cr(yr(i,r,o));return{c(){e=O("select");for(let o=0;o<s.length;o+=1)s[o].c();k(e,"id",i[2]),e.disabled=i[4],k(e,"name",i[2]),k(e,"class","input"),i[0]===void 0&&Ct(()=>i[6].call(e))},m(o,l){C(o,e,l);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(e,null);Ln(e,i[0],!0),n||(t=De(e,"change",i[6]),n=!0)},p(o,l){if(l&9){r=re(o[3]);let a;for(a=0;a<r.length;a+=1){const u=yr(o,r,a);s[a]?s[a].p(u,l):(s[a]=Cr(u),s[a].c(),s[a].m(e,null))}for(;a<s.length;a+=1)s[a].d(1);s.length=r.length}l&4&&k(e,"id",o[2]),l&16&&(e.disabled=o[4]),l&4&&k(e,"name",o[2]),l&9&&Ln(e,o[0])},d(o){o&&y(e),ye(s,o),n=!1,t()}}}function Xu(i){let e,n;return e=new Pt({props:{id:i[2],label:i[1],error:i[5],$$slots:{default:[Yu]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,[r]){const s={};r&4&&(s.id=t[2]),r&2&&(s.label=t[1]),r&32&&(s.error=t[5]),r&1053&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function Zu(i,e,n){let{label:t}=e,{id:r}=e,{value:s}=e,{options:o}=e,{disabled:l=!1}=e,{error:a=""}=e;function u(){s=vs(this),n(0,s),n(3,o)}return i.$$set=c=>{"label"in c&&n(1,t=c.label),"id"in c&&n(2,r=c.id),"value"in c&&n(0,s=c.value),"options"in c&&n(3,o=c.options),"disabled"in c&&n(4,l=c.disabled),"error"in c&&n(5,a=c.error)},[s,t,r,o,l,a,u]}class un extends q{constructor(e){super(),D(this,e,Zu,Xu,L,{label:1,id:2,value:0,options:3,disabled:4,error:5})}}function Sr(i){let e,n,t=i[2].length+"",r;return{c(){e=O("div"),n=U("Length: "),r=U(t)},m(s,o){C(s,e,o),v(e,n),v(e,r)},p(s,o){o&4&&t!==(t=s[2].length+"")&&B(r,t)},d(s){s&&y(e)}}}function Er(i){let e,n;return e=new _e({props:{onSubmit:i[9],$$slots:{default:[ec]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,r){const s={};r&16410&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function xu(i){let e,n,t,r;return e=new M({props:{onClick:i[13],label:"Cancel"}}),t=new M({props:{label:"Start"}}),{c(){w(e.$$.fragment),n=A(),w(t.$$.fragment)},m(s,o){g(e,s,o),C(s,n,o),g(t,s,o),r=!0},p(s,o){const l={};o&2&&(l.onClick=s[13]),e.$set(l)},i(s){r||(m(e.$$.fragment,s),m(t.$$.fragment,s),r=!0)},o(s){_(e.$$.fragment,s),_(t.$$.fragment,s),r=!1},d(s){s&&y(n),b(e,s),b(t,s)}}}function ec(i){let e,n,t,r,s,o,l,a,u;function c(p){i[11](p)}let h={id:"correct",label:"Correct Answers",options:i[6],error:i[5]};i[3]!==void 0&&(h.value=i[3]),n=new un({props:h}),ee.push(()=>ne(n,"value",c));function d(p){i[12](p)}let f={id:"reverse",label:"Reverse Answers",options:i[8],error:i[7]};return i[4]!==void 0&&(f.value=i[4]),s=new un({props:f}),ee.push(()=>ne(s,"value",d)),a=new X({props:{$$slots:{default:[xu]},$$scope:{ctx:i}}}),{c(){e=O("div"),w(n.$$.fragment),r=A(),w(s.$$.fragment),l=A(),w(a.$$.fragment),k(e,"class","flex flex-row gap-4")},m(p,$){C(p,e,$),g(n,e,null),v(e,r),g(s,e,null),C(p,l,$),g(a,p,$),u=!0},p(p,$){const S={};!t&&$&8&&(t=!0,S.value=p[3],te(()=>t=!1)),n.$set(S);const j={};!o&&$&16&&(o=!0,j.value=p[4],te(()=>o=!1)),s.$set(j);const E={};$&16386&&(E.$$scope={dirty:$,ctx:p}),a.$set(E)},i(p){u||(m(n.$$.fragment,p),m(s.$$.fragment,p),m(a.$$.fragment,p),u=!0)},o(p){_(n.$$.fragment,p),_(s.$$.fragment,p),_(a.$$.fragment,p),u=!1},d(p){p&&(y(e),y(l)),b(n),b(s),b(a,p)}}}function tc(i){let e,n,t,r,s,o,l;e=new se({props:{header:"List Chapters"}}),t=new En({props:{book:i[0],chapter:i[1]}});let a=i[1]&&Sr(i),u=i[2].length!==0&&Er(i);return{c(){w(e.$$.fragment),n=A(),w(t.$$.fragment),r=A(),a&&a.c(),s=A(),u&&u.c(),o=x()},m(c,h){g(e,c,h),C(c,n,h),g(t,c,h),C(c,r,h),a&&a.m(c,h),C(c,s,h),u&&u.m(c,h),C(c,o,h),l=!0},p(c,h){const d={};h&1&&(d.book=c[0]),h&2&&(d.chapter=c[1]),t.$set(d),c[1]?a?a.p(c,h):(a=Sr(c),a.c(),a.m(s.parentNode,s)):a&&(a.d(1),a=null),c[2].length!==0?u?(u.p(c,h),h&4&&m(u,1)):(u=Er(c),u.c(),m(u,1),u.m(o.parentNode,o)):u&&(K(),_(u,1,1,()=>{u=null}),G())},i(c){l||(m(e.$$.fragment,c),m(t.$$.fragment,c),m(u),l=!0)},o(c){_(e.$$.fragment,c),_(t.$$.fragment,c),_(u),l=!1},d(c){c&&(y(n),y(r),y(s),y(o)),b(e,c),b(t,c),a&&a.d(c),u&&u.d(c)}}}function nc(i){let e,n;return e=new ie({props:{$$slots:{default:[tc]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,[r]){const s={};r&16415&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function rc(i,e,n){let{params:t={id:0}}=e,r,s,o=[],l="1",a,u=[{label:"0",value:"0"},{label:"1",value:"1"},{label:"2",value:"2"},{label:"3",value:"3"}],c="false",h,d=[{label:"True",value:"true"},{label:"False",value:"false"}];fe(async()=>{n(1,s=await Cn(t.id)),s&&(n(2,o=await pt(s.id)),n(0,r=await Lt(s.book_id)),o.length===0&&V.setString("No questions found for this chapter!"))});const f=async()=>{dl(o,parseInt(l),c==="true"),H("/lession/process")};function p(j){l=j,n(3,l)}function $(j){c=j,n(4,c)}const S=()=>H("/chapters/list/"+(s==null?void 0:s.book_id));return i.$$set=j=>{"params"in j&&n(10,t=j.params)},[r,s,o,l,c,a,u,h,d,f,t,p,$,S]}class sc extends q{constructor(e){super(),D(this,e,rc,nc,L,{params:10})}}function ic(i){let e,n;return{c(){e=O("div"),n=U(i[0]),k(e,"class","text-sm font-bold")},m(t,r){C(t,e,r),v(e,n)},p(t,r){r&1&&B(n,t[0])},d(t){t&&y(e)}}}function oc(i){let e,n,t,r,s,o,l,a;return{c(){e=O("div"),n=O("div"),t=U(i[0]),r=A(),s=O("div"),o=U("Progress: "),l=U(i[1]),a=U(" / 3"),k(n,"class","text-sm font-bold"),k(s,"class","text-green-800 text-sm font-medium"),k(e,"class","flex justify-between")},m(u,c){C(u,e,c),v(e,n),v(n,t),v(e,r),v(e,s),v(s,o),v(s,l),v(s,a)},p(u,c){c&1&&B(t,u[0]),c&2&&B(l,u[1])},d(u){u&&y(e)}}}function ac(i){let e;function n(s,o){return s[1]>=0?oc:ic}let t=n(i),r=t(i);return{c(){r.c(),e=x()},m(s,o){r.m(s,o),C(s,e,o)},p(s,[o]){t===(t=n(s))&&r?r.p(s,o):(r.d(1),r=t(s),r&&(r.c(),r.m(e.parentNode,e)))},i:P,o:P,d(s){s&&y(e),r.d(s)}}}function lc(i,e,n){let{text:t}=e,{progress:r=-1}=e;return i.$$set=s=>{"text"in s&&n(0,t=s.text),"progress"in s&&n(1,r=s.progress)},[t,r]}class At extends q{constructor(e){super(),D(this,e,lc,ac,L,{text:0,progress:1})}}function Ar(i){let e,n;return e=new Rt({props:{onClick:i[1]}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,r){const s={};r&2&&(s.onClick=t[1]),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function uc(i){let e,n,t,r=i[1]&&Ar(i);return n=new kn({props:{onClick:i[2]}}),{c(){r&&r.c(),e=A(),w(n.$$.fragment)},m(s,o){r&&r.m(s,o),C(s,e,o),g(n,s,o),t=!0},p(s,o){s[1]?r?(r.p(s,o),o&2&&m(r,1)):(r=Ar(s),r.c(),m(r,1),r.m(e.parentNode,e)):r&&(K(),_(r,1,1,()=>{r=null}),G());const l={};o&1&&(l.onClick=s[2]),n.$set(l)},i(s){t||(m(r),m(n.$$.fragment,s),t=!0)},o(s){_(r),_(n.$$.fragment,s),t=!1},d(s){s&&y(e),r&&r.d(s),b(n,s)}}}function cc(i){let e,n,t,r=or(i[0].modified)+"",s,o,l,a;return l=new X({props:{$$slots:{default:[uc]},$$scope:{ctx:i}}}),{c(){e=O("div"),n=O("div"),t=U("Modified: "),s=U(r),o=A(),w(l.$$.fragment),k(n,"class","text-sm"),k(e,"class","mt-2 flex justify-between")},m(u,c){C(u,e,c),v(e,n),v(n,t),v(n,s),v(e,o),g(l,e,null),a=!0},p(u,[c]){(!a||c&1)&&r!==(r=or(u[0].modified)+"")&&B(s,r);const h={};c&11&&(h.$$scope={dirty:c,ctx:u}),l.$set(h)},i(u){a||(m(l.$$.fragment,u),a=!0)},o(u){_(l.$$.fragment,u),a=!1},d(u){u&&y(e),b(l)}}}function fc(i,e,n){let{question:t}=e,{onDelete:r=null}=e;const s=()=>H("/questions/update/"+t.id);return i.$$set=o=>{"question"in o&&n(0,t=o.question),"onDelete"in o&&n(1,r=o.onDelete)},[t,r,s]}class hc extends q{constructor(e){super(),D(this,e,fc,cc,L,{question:0,onDelete:1})}}const dc=new RegExp(/[<>]/,"g"),pc=[{pattern:new RegExp(/^- (.+)=#/,"g"),replace:'<span class="md-right">&#9702;</span><span class="md-it">$1</span>'},{pattern:new RegExp(/^(.+)=#/,"g"),replace:'<span class="md-it">$1</span>'},{pattern:new RegExp(/#=(.+)$/,"g"),replace:'<span class="md-it">$1</span>'},{pattern:new RegExp(/#([^#]+)#/,"g"),replace:'<span class="md-it">$1</span>'},{pattern:new RegExp(/\*\*(.)/,"g"),replace:'<span class="md-em">$1</span>'},{pattern:new RegExp(/\*([^*]+)\*/,"g"),replace:'<span class="md-em">$1</span>'},{pattern:new RegExp(/^- /,"g"),replace:'<span class="md-right">&#9702;</span>'}],mc=i=>(pc.forEach(e=>{i=i.replaceAll(e.pattern,e.replace)}),i),cn=i=>{const e=i.replace(dc,"").split(`
`);let n=[];for(const t of e)n.push(mc(t.trim()));return n.join(`
`)};function _c(i){let e,n=cn(i[0])+"";return{c(){e=O("div"),k(e,"class","px-4 py-3 border border-gray-300 rounded shadow-sm whitespace-pre-line bg-gray-50 grow")},m(t,r){C(t,e,r),e.innerHTML=n},p(t,[r]){r&1&&n!==(n=cn(t[0])+"")&&(e.innerHTML=n)},i:P,o:P,d(t){t&&y(e)}}}function $c(i,e,n){let{text:t}=e;return i.$$set=r=>{"text"in r&&n(0,t=r.text)},[t]}class ge extends q{constructor(e){super(),D(this,e,$c,_c,L,{text:0})}}function Or(i){let e,n,t,r,s,o,l,a,u,c;return n=new At({props:{text:"Answer"}}),r=new ge({props:{text:i[3]?i[0].quest:i[0].answer}}),l=new At({props:{text:"details"}}),u=new ge({props:{text:i[0].details?i[0].details:"#No details!#"}}),{c(){e=O("div"),w(n.$$.fragment),t=A(),w(r.$$.fragment),s=A(),o=O("div"),w(l.$$.fragment),a=A(),w(u.$$.fragment),k(e,"class","flex flex-col gap-2"),k(o,"class","flex flex-col gap-2")},m(h,d){C(h,e,d),g(n,e,null),v(e,t),g(r,e,null),C(h,s,d),C(h,o,d),g(l,o,null),v(o,a),g(u,o,null),c=!0},p(h,d){const f={};d&9&&(f.text=h[3]?h[0].quest:h[0].answer),r.$set(f);const p={};d&1&&(p.text=h[0].details?h[0].details:"#No details!#"),u.$set(p)},i(h){c||(m(n.$$.fragment,h),m(r.$$.fragment,h),m(l.$$.fragment,h),m(u.$$.fragment,h),c=!0)},o(h){_(n.$$.fragment,h),_(r.$$.fragment,h),_(l.$$.fragment,h),_(u.$$.fragment,h),c=!1},d(h){h&&(y(e),y(s),y(o)),b(n),b(r),b(l),b(u)}}}function Tr(i){let e,n,t,r,s,o;return t=new At({props:{text:"Search Index"}}),s=new ge({props:{text:i[0].search?i[0].search:"#No search index!#"}}),{c(){e=O("div"),n=O("div"),w(t.$$.fragment),r=A(),w(s.$$.fragment),k(n,"class","flex flex-col gap-2"),k(e,"class","col-span-3")},m(l,a){C(l,e,a),v(e,n),g(t,n,null),v(n,r),g(s,n,null),o=!0},p(l,a){const u={};a&1&&(u.text=l[0].search?l[0].search:"#No search index!#"),s.$set(u)},i(l){o||(m(t.$$.fragment,l),m(s.$$.fragment,l),o=!0)},o(l){_(t.$$.fragment,l),_(s.$$.fragment,l),o=!1},d(l){l&&y(e),b(t),b(s)}}}function gc(i){let e,n,t,r,s,o,l,a,u,c,h;r=new At({props:{text:`Question Id: ${i[0].id}`,progress:i[1]}}),o=new ge({props:{text:i[3]?i[0].answer:i[0].quest}});let d=i[2]&&Or(i),f=i[5]&&Tr(i);return c=new hc({props:{question:i[0],onDelete:i[4]}}),{c(){e=O("div"),n=O("div"),t=O("div"),w(r.$$.fragment),s=A(),w(o.$$.fragment),l=A(),d&&d.c(),a=A(),f&&f.c(),u=A(),w(c.$$.fragment),k(t,"class","flex flex-col gap-2"),k(n,"class","grid md:grid-cols-3 grid-cols-1 gap-3")},m(p,$){C(p,e,$),v(e,n),v(n,t),g(r,t,null),v(t,s),g(o,t,null),v(n,l),d&&d.m(n,null),v(n,a),f&&f.m(n,null),v(e,u),g(c,e,null),h=!0},p(p,[$]){const S={};$&1&&(S.text=`Question Id: ${p[0].id}`),$&2&&(S.progress=p[1]),r.$set(S);const j={};$&9&&(j.text=p[3]?p[0].answer:p[0].quest),o.$set(j),p[2]?d?(d.p(p,$),$&4&&m(d,1)):(d=Or(p),d.c(),m(d,1),d.m(n,a)):d&&(K(),_(d,1,1,()=>{d=null}),G()),p[5]?f?(f.p(p,$),$&32&&m(f,1)):(f=Tr(p),f.c(),m(f,1),f.m(n,null)):f&&(K(),_(f,1,1,()=>{f=null}),G());const E={};$&1&&(E.question=p[0]),$&16&&(E.onDelete=p[4]),c.$set(E)},i(p){h||(m(r.$$.fragment,p),m(o.$$.fragment,p),m(d),m(f),m(c.$$.fragment,p),h=!0)},o(p){_(r.$$.fragment,p),_(o.$$.fragment,p),_(d),_(f),_(c.$$.fragment,p),h=!1},d(p){p&&y(e),b(r),b(o),d&&d.d(),f&&f.d(),b(c)}}}function bc(i,e,n){let{question:t}=e,{progress:r=-1}=e,{showAnswer:s=!0}=e,{reverse:o=!1}=e,{onDelete:l=null}=e,{debug:a}=e;return i.$$set=u=>{"question"in u&&n(0,t=u.question),"progress"in u&&n(1,r=u.progress),"showAnswer"in u&&n(2,s=u.showAnswer),"reverse"in u&&n(3,o=u.reverse),"onDelete"in u&&n(4,l=u.onDelete),"debug"in u&&n(5,a=u.debug)},[t,r,s,o,l,a]}class An extends q{constructor(e){super(),D(this,e,bc,gc,L,{question:0,progress:1,showAnswer:2,reverse:3,onDelete:4,debug:5})}}function jr(i,e,n){const t=i.slice();return t[2]=e[n],t[4]=n,t}function Ir(i){let e,n,t=i[2]+"",r;return{c(){e=O("dt"),e.textContent=`${i[1][i[4]]}`,n=O("dd"),r=U(t),k(e,"class","col-span-3 px-4 py-1"),k(n,"class","border-l border-gray-300 px-4 py-1 text-right")},m(s,o){C(s,e,o),C(s,n,o),v(n,r)},p(s,o){o&1&&t!==(t=s[2]+"")&&B(r,t)},d(s){s&&(y(e),y(n))}}}function wc(i){let e,n=re(i[0]),t=[];for(let r=0;r<n.length;r+=1)t[r]=Ir(jr(i,n,r));return{c(){e=O("dl");for(let r=0;r<t.length;r+=1)t[r].c();k(e,"class","border border-gray-300 shadow-sm rounded grid grid-cols-4 w-64 py-2")},m(r,s){C(r,e,s);for(let o=0;o<t.length;o+=1)t[o]&&t[o].m(e,null)},p(r,[s]){if(s&3){n=re(r[0]);let o;for(o=0;o<n.length;o+=1){const l=jr(r,n,o);t[o]?t[o].p(l,s):(t[o]=Ir(l),t[o].c(),t[o].m(e,null))}for(;o<t.length;o+=1)t[o].d(1);t.length=n.length}},i:P,o:P,d(r){r&&y(e),ye(t,r)}}}function vc(i,e,n){let{progress:t}=e,r=["No correct answers","One correct answer","Two correct answers","Learned"];return i.$$set=s=>{"progress"in s&&n(0,t=s.progress)},[t,r]}class kc extends q{constructor(e){super(),D(this,e,vc,wc,L,{progress:0})}}function yc(i){let e,n;return e=new An({props:{question:i[2].question,showAnswer:i[4],progress:i[2].progress,reverse:i[0].reverse}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,r){const s={};r&4&&(s.question=t[2].question),r&16&&(s.showAnswer=t[4]),r&4&&(s.progress=t[2].progress),r&1&&(s.reverse=t[0].reverse),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function Cc(i){let e;return{c(){e=O("p"),e.textContent="End"},m(n,t){C(n,e,t)},p:P,i:P,o:P,d(n){n&&y(e)}}}function Pr(i){let e,n,t=i[2]&&Rr(i);return{c(){t&&t.c(),e=x()},m(r,s){t&&t.m(r,s),C(r,e,s),n=!0},p(r,s){r[2]?t?(t.p(r,s),s&4&&m(t,1)):(t=Rr(r),t.c(),m(t,1),t.m(e.parentNode,e)):t&&(K(),_(t,1,1,()=>{t=null}),G())},i(r){n||(m(t),n=!0)},o(r){_(t),n=!1},d(r){r&&y(e),t&&t.d(r)}}}function Rr(i){let e,n,t,r;const s=[Ec,Sc],o=[];function l(a,u){return a[4]?1:0}return e=l(i),n=o[e]=s[e](i),{c(){n.c(),t=x()},m(a,u){o[e].m(a,u),C(a,t,u),r=!0},p(a,u){let c=e;e=l(a),e===c?o[e].p(a,u):(K(),_(o[c],1,1,()=>{o[c]=null}),G(),n=o[e],n?n.p(a,u):(n=o[e]=s[e](a),n.c()),m(n,1),n.m(t.parentNode,t))},i(a){r||(m(n),r=!0)},o(a){_(n),r=!1},d(a){a&&y(t),o[e].d(a)}}}function Sc(i){let e,n,t,r,s,o,l,a;return e=new M({props:{label:"Correct",onClick:i[6]}}),t=new M({props:{label:"Wrong",onClick:i[7]}}),s=new M({props:{label:"Learned",onClick:i[8]}}),l=new M({props:{label:"Skip",onClick:i[9]}}),{c(){w(e.$$.fragment),n=A(),w(t.$$.fragment),r=A(),w(s.$$.fragment),o=A(),w(l.$$.fragment)},m(u,c){g(e,u,c),C(u,n,c),g(t,u,c),C(u,r,c),g(s,u,c),C(u,o,c),g(l,u,c),a=!0},p:P,i(u){a||(m(e.$$.fragment,u),m(t.$$.fragment,u),m(s.$$.fragment,u),m(l.$$.fragment,u),a=!0)},o(u){_(e.$$.fragment,u),_(t.$$.fragment,u),_(s.$$.fragment,u),_(l.$$.fragment,u),a=!1},d(u){u&&(y(n),y(r),y(o)),b(e,u),b(t,u),b(s,u),b(l,u)}}}function Ec(i){let e,n;return e=new M({props:{label:"Show",onClick:i[5]}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p:P,i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function Ac(i){let e,n,t,r;e=new M({props:{label:"Stop",onClick:i[10]}});let s=!i[3]&&Pr(i);return{c(){w(e.$$.fragment),n=A(),s&&s.c(),t=x()},m(o,l){g(e,o,l),C(o,n,l),s&&s.m(o,l),C(o,t,l),r=!0},p(o,l){o[3]?s&&(K(),_(s,1,1,()=>{s=null}),G()):s?(s.p(o,l),l&8&&m(s,1)):(s=Pr(o),s.c(),m(s,1),s.m(t.parentNode,t))},i(o){r||(m(e.$$.fragment,o),m(s),r=!0)},o(o){_(e.$$.fragment,o),_(s),r=!1},d(o){o&&(y(n),y(t)),b(e,o),s&&s.d(o)}}}function Oc(i){let e,n,t,r,s,o,l,a,u;e=new se({props:{header:"Lession"}}),t=new kc({props:{progress:i[1]}});const c=[Cc,yc],h=[];function d(f,p){return f[3]?0:f[2]?1:-1}return~(s=d(i))&&(o=h[s]=c[s](i)),a=new X({props:{$$slots:{default:[Ac]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment),n=A(),w(t.$$.fragment),r=A(),o&&o.c(),l=A(),w(a.$$.fragment)},m(f,p){g(e,f,p),C(f,n,p),g(t,f,p),C(f,r,p),~s&&h[s].m(f,p),C(f,l,p),g(a,f,p),u=!0},p(f,p){const $={};p&2&&($.progress=f[1]),t.$set($);let S=s;s=d(f),s===S?~s&&h[s].p(f,p):(o&&(K(),_(h[S],1,1,()=>{h[S]=null}),G()),~s?(o=h[s],o?o.p(f,p):(o=h[s]=c[s](f),o.c()),m(o,1),o.m(l.parentNode,l)):o=null);const j={};p&8220&&(j.$$scope={dirty:p,ctx:f}),a.$set(j)},i(f){u||(m(e.$$.fragment,f),m(t.$$.fragment,f),m(o),m(a.$$.fragment,f),u=!0)},o(f){_(e.$$.fragment,f),_(t.$$.fragment,f),_(o),_(a.$$.fragment,f),u=!1},d(f){f&&(y(n),y(r),y(l)),b(e,f),b(t,f),~s&&h[s].d(f),b(a,f)}}}function Tc(i){let e,n;return e=new ie({props:{$$slots:{default:[Oc]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,[r]){const s={};r&8223&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function jc(i,e,n){let t,r=[0,0,0,0],s,o=!1,l=!1;const a=()=>{n(4,l=!0)},u=S=>{if(n(2,s.progress=S,s),s.progress<3?t.learning.push(s):t.learned.push(s),n(1,r=ur(t)),!pl(t)){n(3,o=!0);return}$()},c=()=>{u(s.progress+1)},h=()=>{u(0)},d=()=>{u(3)},f=()=>{u(s.progress)},p=()=>{H("/")},$=()=>{const S=t.learning.shift();S?(n(2,s=S),n(4,l=!1)):n(3,o=!0)};return fe(async()=>{const S=ds();if(!S){V.setString("No lession found!");return}n(0,t=await $l(S)),n(1,r=ur(t)),$()}),[t,r,s,o,l,a,c,h,d,f,p]}class Ic extends q{constructor(e){super(),D(this,e,jc,Tc,L,{})}}function Lr(i,e,n){const t=i.slice();return t[10]=e[n],t}function Dr(i){let e,n;function t(){return i[6](i[10])}return e=new An({props:{debug:i[4],question:i[10],onDelete:t}}),{c(){w(e.$$.fragment)},m(r,s){g(e,r,s),n=!0},p(r,s){i=r;const o={};s&16&&(o.debug=i[4]),s&8&&(o.question=i[10]),s&40&&(o.onDelete=t),e.$set(o)},i(r){n||(m(e.$$.fragment,r),n=!0)},o(r){_(e.$$.fragment,r),n=!1},d(r){b(e,r)}}}function Pc(i){let e,n,t,r,s,o;return e=new M({props:{onClick:i[7],label:"Cancel"}}),t=new M({props:{onClick:i[8],label:"Create"}}),s=new M({props:{onClick:i[9],label:i[4]?"Simple":"Debug"}}),{c(){w(e.$$.fragment),n=A(),w(t.$$.fragment),r=A(),w(s.$$.fragment)},m(l,a){g(e,l,a),C(l,n,a),g(t,l,a),C(l,r,a),g(s,l,a),o=!0},p(l,a){const u={};a&4&&(u.onClick=l[7]),e.$set(u);const c={};a&1&&(c.onClick=l[8]),t.$set(c);const h={};a&16&&(h.onClick=l[9]),a&16&&(h.label=l[4]?"Simple":"Debug"),s.$set(h)},i(l){o||(m(e.$$.fragment,l),m(t.$$.fragment,l),m(s.$$.fragment,l),o=!0)},o(l){_(e.$$.fragment,l),_(t.$$.fragment,l),_(s.$$.fragment,l),o=!1},d(l){l&&(y(n),y(r)),b(e,l),b(t,l),b(s,l)}}}function Rc(i){let e,n,t,r,s,o,l,a;e=new se({props:{header:"List Chapters"}}),t=new En({props:{book:i[1],chapter:i[2]}});let u=re(i[3]),c=[];for(let d=0;d<u.length;d+=1)c[d]=Dr(Lr(i,u,d));const h=d=>_(c[d],1,1,()=>{c[d]=null});return l=new X({props:{$$slots:{default:[Pc]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment),n=A(),w(t.$$.fragment),r=A(),s=O("div");for(let d=0;d<c.length;d+=1)c[d].c();o=A(),w(l.$$.fragment),k(s,"class","flex flex-col gap-5")},m(d,f){g(e,d,f),C(d,n,f),g(t,d,f),C(d,r,f),C(d,s,f);for(let p=0;p<c.length;p+=1)c[p]&&c[p].m(s,null);C(d,o,f),g(l,d,f),a=!0},p(d,f){const p={};if(f&2&&(p.book=d[1]),f&4&&(p.chapter=d[2]),t.$set(p),f&56){u=re(d[3]);let S;for(S=0;S<u.length;S+=1){const j=Lr(d,u,S);c[S]?(c[S].p(j,f),m(c[S],1)):(c[S]=Dr(j),c[S].c(),m(c[S],1),c[S].m(s,null))}for(K(),S=u.length;S<c.length;S+=1)h(S);G()}const $={};f&8213&&($.$$scope={dirty:f,ctx:d}),l.$set($)},i(d){if(!a){m(e.$$.fragment,d),m(t.$$.fragment,d);for(let f=0;f<u.length;f+=1)m(c[f]);m(l.$$.fragment,d),a=!0}},o(d){_(e.$$.fragment,d),_(t.$$.fragment,d),c=c.filter(Boolean);for(let f=0;f<c.length;f+=1)_(c[f]);_(l.$$.fragment,d),a=!1},d(d){d&&(y(n),y(r),y(s),y(o)),b(e,d),b(t,d),ye(c,d),b(l,d)}}}function Lc(i){let e,n,t,r;return e=new ie({props:{$$slots:{default:[Rc]},$$scope:{ctx:i}}}),t=new yn({props:{title:"Delete Question",deleteEntry:i[5]}}),{c(){w(e.$$.fragment),n=A(),w(t.$$.fragment)},m(s,o){g(e,s,o),C(s,n,o),g(t,s,o),r=!0},p(s,[o]){const l={};o&8255&&(l.$$scope={dirty:o,ctx:s}),e.$set(l);const a={};o&32&&(a.deleteEntry=s[5]),t.$set(a)},i(s){r||(m(e.$$.fragment,s),m(t.$$.fragment,s),r=!0)},o(s){_(e.$$.fragment,s),_(t.$$.fragment,s),r=!1},d(s){s&&y(n),b(e,s),b(t,s)}}}function Dc(i,e,n){let{params:t={id:0}}=e,r,s,o=[],l=!1;fe(async()=>{n(2,s=await Cn(t.id)),s&&(n(3,o=await pt(s.id)),n(1,r=await Lt(s.book_id)))});let a={entry:null,onDelete:f=>{al(f.id,f.chapter_id).then(p=>{n(3,o=p)})},getMessage:f=>`Do you wnat to delete the question: '${f.id}'?`};const u=f=>{n(5,a.entry=f,a)},c=()=>H("/chapters/list/"+(s==null?void 0:s.book_id)),h=()=>H("/questions/create/"+t.id),d=()=>n(4,l=!l);return i.$$set=f=>{"params"in f&&n(0,t=f.params)},[t,r,s,o,l,a,u,c,h,d]}class qc extends q{constructor(e){super(),D(this,e,Dc,Lc,L,{params:0})}}function Uc(i){let e,n,t,r,s,o;const l=i[4].default,a=be(l,i,i[6],null);return{c(){e=O("div"),n=O("textarea"),t=A(),a&&a.c(),k(n,"class","input"),k(n,"id",i[2]),k(e,"class","grid md:grid-cols-2 grid-cols-1 gap-4")},m(u,c){C(u,e,c),v(e,n),Oe(n,i[0]),v(e,t),a&&a.m(e,null),r=!0,s||(o=De(n,"input",i[5]),s=!0)},p(u,c){(!r||c&4)&&k(n,"id",u[2]),c&1&&Oe(n,u[0]),a&&a.p&&(!r||c&64)&&ve(a,l,u,u[6],r?we(l,u[6],c,null):ke(u[6]),null)},i(u){r||(m(a,u),r=!0)},o(u){_(a,u),r=!1},d(u){u&&y(e),a&&a.d(u),s=!1,o()}}}function Nc(i){let e,n;return e=new Pt({props:{id:i[2],label:i[1],error:i[3],$$slots:{default:[Uc]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,[r]){const s={};r&4&&(s.id=t[2]),r&2&&(s.label=t[1]),r&8&&(s.error=t[3]),r&69&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function Bc(i,e,n){let{$$slots:t={},$$scope:r}=e,{label:s}=e,{id:o}=e,{value:l}=e,{error:a}=e;function u(){l=this.value,n(0,l)}return i.$$set=c=>{"label"in c&&n(1,s=c.label),"id"in c&&n(2,o=c.id),"value"in c&&n(0,l=c.value),"error"in c&&n(3,a=c.error),"$$scope"in c&&n(6,r=c.$$scope)},[l,s,o,a,t,u,r]}class Ge extends q{constructor(e){super(),D(this,e,Bc,Nc,L,{label:1,id:2,value:0,error:3})}}function qr(i){let e,n,t=i[0].id+"",r,s,o,l=ae(i[0].modified)+"",a,u,c,h;return c=new _e({props:{onSubmit:i[6],$$slots:{default:[Jc]},$$scope:{ctx:i}}}),{c(){e=O("div"),n=O("span"),r=U(t),s=A(),o=O("span"),a=U(l),u=A(),w(c.$$.fragment),k(e,"class","mb-4 text-small")},m(d,f){C(d,e,f),v(e,n),v(n,r),v(e,s),v(e,o),v(o,a),C(d,u,f),g(c,d,f),h=!0},p(d,f){(!h||f&1)&&t!==(t=d[0].id+"")&&B(r,t),(!h||f&1)&&l!==(l=ae(d[0].modified)+"")&&B(a,l);const p={};f&4158&&(p.$$scope={dirty:f,ctx:d}),c.$set(p)},i(d){h||(m(c.$$.fragment,d),h=!0)},o(d){_(c.$$.fragment,d),h=!1},d(d){d&&(y(e),y(u)),b(c,d)}}}function Mc(i){let e,n;return e=new ge({props:{text:i[1]}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,r){const s={};r&2&&(s.text=t[1]),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function Fc(i){let e,n;return e=new ge({props:{text:i[3]}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,r){const s={};r&8&&(s.text=t[3]),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function Hc(i){let e,n;return e=new ge({props:{text:i[5]}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,r){const s={};r&32&&(s.text=t[5]),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function zc(i){let e,n,t,r;return e=new M({props:{onClick:i[11],label:"Back"}}),t=new M({props:{label:"Update"}}),{c(){w(e.$$.fragment),n=A(),w(t.$$.fragment)},m(s,o){g(e,s,o),C(s,n,o),g(t,s,o),r=!0},p:P,i(s){r||(m(e.$$.fragment,s),m(t.$$.fragment,s),r=!0)},o(s){_(e.$$.fragment,s),_(t.$$.fragment,s),r=!1},d(s){s&&y(n),b(e,s),b(t,s)}}}function Jc(i){let e,n,t,r,s,o,l,a,u,c,h;function d(E){i[8](E)}let f={id:"question",label:"Questione",error:i[2],$$slots:{default:[Mc]},$$scope:{ctx:i}};i[1]!==void 0&&(f.value=i[1]),e=new Ge({props:f}),ee.push(()=>ne(e,"value",d));function p(E){i[9](E)}let $={id:"answer",label:"Answer",error:i[4],$$slots:{default:[Fc]},$$scope:{ctx:i}};i[3]!==void 0&&($.value=i[3]),r=new Ge({props:$}),ee.push(()=>ne(r,"value",p));function S(E){i[10](E)}let j={id:"details",label:"Details",error:Vc,$$slots:{default:[Hc]},$$scope:{ctx:i}};return i[5]!==void 0&&(j.value=i[5]),l=new Ge({props:j}),ee.push(()=>ne(l,"value",S)),c=new X({props:{$$slots:{default:[zc]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment),t=A(),w(r.$$.fragment),o=A(),w(l.$$.fragment),u=A(),w(c.$$.fragment)},m(E,T){g(e,E,T),C(E,t,T),g(r,E,T),C(E,o,T),g(l,E,T),C(E,u,T),g(c,E,T),h=!0},p(E,T){const I={};T&4&&(I.error=E[2]),T&4098&&(I.$$scope={dirty:T,ctx:E}),!n&&T&2&&(n=!0,I.value=E[1],te(()=>n=!1)),e.$set(I);const R={};T&16&&(R.error=E[4]),T&4104&&(R.$$scope={dirty:T,ctx:E}),!s&&T&8&&(s=!0,R.value=E[3],te(()=>s=!1)),r.$set(R);const N={};T&4128&&(N.$$scope={dirty:T,ctx:E}),!a&&T&32&&(a=!0,N.value=E[5],te(()=>a=!1)),l.$set(N);const J={};T&4096&&(J.$$scope={dirty:T,ctx:E}),c.$set(J)},i(E){h||(m(e.$$.fragment,E),m(r.$$.fragment,E),m(l.$$.fragment,E),m(c.$$.fragment,E),h=!0)},o(E){_(e.$$.fragment,E),_(r.$$.fragment,E),_(l.$$.fragment,E),_(c.$$.fragment,E),h=!1},d(E){E&&(y(t),y(o),y(u)),b(e,E),b(r,E),b(l,E),b(c,E)}}}function Kc(i){let e,n,t,r;e=new se({props:{header:"Update Book"}});let s=i[0]&&qr(i);return{c(){w(e.$$.fragment),n=A(),s&&s.c(),t=x()},m(o,l){g(e,o,l),C(o,n,l),s&&s.m(o,l),C(o,t,l),r=!0},p(o,l){o[0]?s?(s.p(o,l),l&1&&m(s,1)):(s=qr(o),s.c(),m(s,1),s.m(t.parentNode,t)):s&&(K(),_(s,1,1,()=>{s=null}),G())},i(o){r||(m(e.$$.fragment,o),m(s),r=!0)},o(o){_(e.$$.fragment,o),_(s),r=!1},d(o){o&&(y(n),y(t)),b(e,o),s&&s.d(o)}}}function Gc(i){let e,n;return e=new ie({props:{$$slots:{default:[Kc]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,[r]){const s={};r&4159&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}let Vc="";function Wc(i,e,n){let{params:t={id:""}}=e,r=null,s="",o="",l="",a="",u="";const c=async()=>{const $={quest:s.trim(),answer:l.trim()};if(n(2,o=ue($.quest)),n(4,a=ue($.answer)),!(o||a)){if(!r){V.setString("No question!!");return}await ul(r.id,r.chapter_id,$.quest,$.answer,fs(u)),Nn()}};fe(async()=>{n(0,r=await ol(parseInt(t.id))),r&&(n(1,s=r.quest),n(3,l=r.answer),n(5,u=r.details?r.details:""))});function h($){s=$,n(1,s)}function d($){l=$,n(3,l)}function f($){u=$,n(5,u)}const p=()=>Nn();return i.$$set=$=>{"params"in $&&n(7,t=$.params)},[r,s,o,l,a,u,c,t,h,d,f,p]}class Qc extends q{constructor(e){super(),D(this,e,Wc,Gc,L,{params:7})}}function Yc(i){let e,n;return e=new ge({props:{text:i[1]}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,r){const s={};r&2&&(s.text=t[1]),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function Xc(i){let e,n;return e=new ge({props:{text:i[3]}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,r){const s={};r&8&&(s.text=t[3]),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function Zc(i){let e,n;return e=new ge({props:{text:i[5]}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,r){const s={};r&32&&(s.text=t[5]),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function xc(i){let e,n,t,r;return e=new M({props:{onClick:i[10],label:"Cancel"}}),t=new M({props:{label:"Create"}}),{c(){w(e.$$.fragment),n=A(),w(t.$$.fragment)},m(s,o){g(e,s,o),C(s,n,o),g(t,s,o),r=!0},p(s,o){const l={};o&1&&(l.onClick=s[10]),e.$set(l)},i(s){r||(m(e.$$.fragment,s),m(t.$$.fragment,s),r=!0)},o(s){_(e.$$.fragment,s),_(t.$$.fragment,s),r=!1},d(s){s&&y(n),b(e,s),b(t,s)}}}function ef(i){let e,n,t,r,s,o,l,a,u,c,h;function d(E){i[7](E)}let f={id:"question",label:"Question",error:i[2],$$slots:{default:[Yc]},$$scope:{ctx:i}};i[1]!==void 0&&(f.value=i[1]),e=new Ge({props:f}),ee.push(()=>ne(e,"value",d));function p(E){i[8](E)}let $={id:"answer",label:"Answer",error:i[4],$$slots:{default:[Xc]},$$scope:{ctx:i}};i[3]!==void 0&&($.value=i[3]),r=new Ge({props:$}),ee.push(()=>ne(r,"value",p));function S(E){i[9](E)}let j={id:"details",label:"Details",error:rf,$$slots:{default:[Zc]},$$scope:{ctx:i}};return i[5]!==void 0&&(j.value=i[5]),l=new Ge({props:j}),ee.push(()=>ne(l,"value",S)),c=new X({props:{$$slots:{default:[xc]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment),t=A(),w(r.$$.fragment),o=A(),w(l.$$.fragment),u=A(),w(c.$$.fragment)},m(E,T){g(e,E,T),C(E,t,T),g(r,E,T),C(E,o,T),g(l,E,T),C(E,u,T),g(c,E,T),h=!0},p(E,T){const I={};T&4&&(I.error=E[2]),T&2050&&(I.$$scope={dirty:T,ctx:E}),!n&&T&2&&(n=!0,I.value=E[1],te(()=>n=!1)),e.$set(I);const R={};T&16&&(R.error=E[4]),T&2056&&(R.$$scope={dirty:T,ctx:E}),!s&&T&8&&(s=!0,R.value=E[3],te(()=>s=!1)),r.$set(R);const N={};T&2080&&(N.$$scope={dirty:T,ctx:E}),!a&&T&32&&(a=!0,N.value=E[5],te(()=>a=!1)),l.$set(N);const J={};T&2049&&(J.$$scope={dirty:T,ctx:E}),c.$set(J)},i(E){h||(m(e.$$.fragment,E),m(r.$$.fragment,E),m(l.$$.fragment,E),m(c.$$.fragment,E),h=!0)},o(E){_(e.$$.fragment,E),_(r.$$.fragment,E),_(l.$$.fragment,E),_(c.$$.fragment,E),h=!1},d(E){E&&(y(t),y(o),y(u)),b(e,E),b(r,E),b(l,E),b(c,E)}}}function tf(i){let e,n,t,r;return e=new se({props:{header:"Create Question"}}),t=new _e({props:{onSubmit:i[6],$$slots:{default:[ef]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment),n=A(),w(t.$$.fragment)},m(s,o){g(e,s,o),C(s,n,o),g(t,s,o),r=!0},p(s,o){const l={};o&2111&&(l.$$scope={dirty:o,ctx:s}),t.$set(l)},i(s){r||(m(e.$$.fragment,s),m(t.$$.fragment,s),r=!0)},o(s){_(e.$$.fragment,s),_(t.$$.fragment,s),r=!1},d(s){s&&y(n),b(e,s),b(t,s)}}}function nf(i){let e,n;return e=new ie({props:{$$slots:{default:[tf]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,[r]){const s={};r&2111&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}let rf="";function sf(i,e,n){let{params:t={chapter_id:0}}=e,r="",s="",o="",l="",a="";const u=async()=>{const p={question:r.trim(),answer:o.trim()};n(2,s=ue(p.question)),n(4,l=ue(p.answer)),!(s||l)&&(await ll(t.chapter_id,p.question,p.answer,fs(a)),H("/questions/list/"+t.chapter_id))};function c(p){r=p,n(1,r)}function h(p){o=p,n(3,o)}function d(p){a=p,n(5,a)}const f=()=>H("/questions/list/"+t.chapter_id);return i.$$set=p=>{"params"in p&&n(0,t=p.params)},[t,r,s,o,l,a,u,c,h,d,f]}class of extends q{constructor(e){super(),D(this,e,sf,nf,L,{params:0})}}function Ur(i,e,n){const t=i.slice();return t[8]=e[n],t}function af(i){let e,n,t,r;return e=new M({props:{disabled:i[4],label:"Search"}}),t=new M({props:{disabled:!(i[2]&&i[2].questions.length>0),onClick:i[7],label:i[3]?"Simple":"Debug"}}),{c(){w(e.$$.fragment),n=A(),w(t.$$.fragment)},m(s,o){g(e,s,o),C(s,n,o),g(t,s,o),r=!0},p(s,o){const l={};o&16&&(l.disabled=s[4]),e.$set(l);const a={};o&4&&(a.disabled=!(s[2]&&s[2].questions.length>0)),o&8&&(a.onClick=s[7]),o&8&&(a.label=s[3]?"Simple":"Debug"),t.$set(a)},i(s){r||(m(e.$$.fragment,s),m(t.$$.fragment,s),r=!0)},o(s){_(e.$$.fragment,s),_(t.$$.fragment,s),r=!1},d(s){s&&y(n),b(e,s),b(t,s)}}}function lf(i){let e,n,t,r,s;function o(a){i[6](a)}let l={id:"search",label:"Search Text"};return i[0]!==void 0&&(l.value=i[0]),e=new Te({props:l}),ee.push(()=>ne(e,"value",o)),r=new X({props:{$$slots:{default:[af]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment),t=A(),w(r.$$.fragment)},m(a,u){g(e,a,u),C(a,t,u),g(r,a,u),s=!0},p(a,u){const c={};!n&&u&1&&(n=!0,c.value=a[0],te(()=>n=!1)),e.$set(c);const h={};u&2076&&(h.$$scope={dirty:u,ctx:a}),r.$set(h)},i(a){s||(m(e.$$.fragment,a),m(r.$$.fragment,a),s=!0)},o(a){_(e.$$.fragment,a),_(r.$$.fragment,a),s=!1},d(a){a&&y(t),b(e,a),b(r,a)}}}function uf(i){let e;return{c(){e=O("p"),e.textContent="Nothing found ..."},m(n,t){C(n,e,t)},p:P,i:P,o:P,d(n){n&&y(e)}}}function cf(i){let e,n,t,r=i[2].hasMore&&Nr(),s=re(i[2].questions),o=[];for(let a=0;a<s.length;a+=1)o[a]=Br(Ur(i,s,a));const l=a=>_(o[a],1,1,()=>{o[a]=null});return{c(){r&&r.c(),e=A(),n=O("div");for(let a=0;a<o.length;a+=1)o[a].c();k(n,"class","flex flex-col gap-5")},m(a,u){r&&r.m(a,u),C(a,e,u),C(a,n,u);for(let c=0;c<o.length;c+=1)o[c]&&o[c].m(n,null);t=!0},p(a,u){if(a[2].hasMore?r||(r=Nr(),r.c(),r.m(e.parentNode,e)):r&&(r.d(1),r=null),u&12){s=re(a[2].questions);let c;for(c=0;c<s.length;c+=1){const h=Ur(a,s,c);o[c]?(o[c].p(h,u),m(o[c],1)):(o[c]=Br(h),o[c].c(),m(o[c],1),o[c].m(n,null))}for(K(),c=s.length;c<o.length;c+=1)l(c);G()}},i(a){if(!t){for(let u=0;u<s.length;u+=1)m(o[u]);t=!0}},o(a){o=o.filter(Boolean);for(let u=0;u<o.length;u+=1)_(o[u]);t=!1},d(a){a&&(y(e),y(n)),r&&r.d(a),ye(o,a)}}}function Nr(i){let e;return{c(){e=O("div"),e.textContent="has more ...",k(e,"class","text-red-700")},m(n,t){C(n,e,t)},d(n){n&&y(e)}}}function Br(i){let e,n;return e=new An({props:{question:i[8],debug:i[3]}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,r){const s={};r&4&&(s.question=t[8]),r&8&&(s.debug=t[3]),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function ff(i){let e,n,t,r,s,o,l,a;e=new se({props:{header:"Search Questions"}}),t=new _e({props:{onSubmit:i[5],$$slots:{default:[lf]},$$scope:{ctx:i}}});const u=[cf,uf],c=[];function h(d,f){return d[2]&&d[2].questions.length>0?0:d[1]!==""?1:-1}return~(s=h(i))&&(o=c[s]=u[s](i)),{c(){w(e.$$.fragment),n=A(),w(t.$$.fragment),r=A(),o&&o.c(),l=x()},m(d,f){g(e,d,f),C(d,n,f),g(t,d,f),C(d,r,f),~s&&c[s].m(d,f),C(d,l,f),a=!0},p(d,f){const p={};f&2077&&(p.$$scope={dirty:f,ctx:d}),t.$set(p);let $=s;s=h(d),s===$?~s&&c[s].p(d,f):(o&&(K(),_(c[$],1,1,()=>{c[$]=null}),G()),~s?(o=c[s],o?o.p(d,f):(o=c[s]=u[s](d),o.c()),m(o,1),o.m(l.parentNode,l)):o=null)},i(d){a||(m(e.$$.fragment,d),m(t.$$.fragment,d),m(o),a=!0)},o(d){_(e.$$.fragment,d),_(t.$$.fragment,d),_(o),a=!1},d(d){d&&(y(n),y(r),y(l)),b(e,d),b(t,d),~s&&c[s].d(d)}}}function hf(i){let e,n;return e=new ie({props:{$$slots:{default:[ff]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,[r]){const s={};r&2079&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function df(i,e,n){let t,r="",s="",o,l=!1;const a=async()=>{n(2,o=await cl(r)),n(1,s=r)};function u(h){r=h,n(0,r)}const c=()=>n(3,l=!l);return i.$$.update=()=>{i.$$.dirty&3&&n(4,t=r.length<3||r===s)},[r,s,o,l,t,a,u,c]}class pf extends q{constructor(e){super(),D(this,e,df,hf,L,{})}}function mf(i){let e,n;return e=new M({props:{disabled:i[0]<=0,label:"Update"}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,r){const s={};r&1&&(s.disabled=t[0]<=0),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function _f(i){let e,n,t,r,s;function o(a){i[4](a)}let l={disabled:i[0]<=0,id:"limit",label:"Limit",options:i[2]};return i[1]!==void 0&&(l.value=i[1]),e=new un({props:l}),ee.push(()=>ne(e,"value",o)),r=new X({props:{$$slots:{default:[mf]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment),t=A(),w(r.$$.fragment)},m(a,u){g(e,a,u),C(a,t,u),g(r,a,u),s=!0},p(a,u){const c={};u&1&&(c.disabled=a[0]<=0),!n&&u&2&&(n=!0,c.value=a[1],te(()=>n=!1)),e.$set(c);const h={};u&33&&(h.$$scope={dirty:u,ctx:a}),r.$set(h)},i(a){s||(m(e.$$.fragment,a),m(r.$$.fragment,a),s=!0)},o(a){_(e.$$.fragment,a),_(r.$$.fragment,a),s=!1},d(a){a&&y(t),b(e,a),b(r,a)}}}function $f(i){let e,n,t,r,s,o,l,a;return e=new se({props:{header:"Search Index of Questions"}}),l=new _e({props:{onSubmit:i[3],$$slots:{default:[_f]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment),n=A(),t=O("p"),r=U("Number of questions without search index field: "),s=U(i[0]),o=A(),w(l.$$.fragment)},m(u,c){g(e,u,c),C(u,n,c),C(u,t,c),v(t,r),v(t,s),C(u,o,c),g(l,u,c),a=!0},p(u,c){(!a||c&1)&&B(s,u[0]);const h={};c&35&&(h.$$scope={dirty:c,ctx:u}),l.$set(h)},i(u){a||(m(e.$$.fragment,u),m(l.$$.fragment,u),a=!0)},o(u){_(e.$$.fragment,u),_(l.$$.fragment,u),a=!1},d(u){u&&(y(n),y(t),y(o)),b(e,u),b(l,u)}}}function gf(i){let e,n;return e=new ie({props:{$$slots:{default:[$f]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,[r]){const s={};r&35&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function bf(i,e,n){let t=-2,r="20";const s=[{label:"1",value:"1"},{label:"10",value:"10"},{label:"20",value:"20"},{label:"50",value:"50"},{label:"100",value:"100"}],o=async()=>{const a=await fl(Number.parseInt(r));await hl(a),n(0,t=await lr())};fe(async()=>{n(0,t=await lr())});function l(a){r=a,n(1,r)}return[t,r,s,o,l]}class wf extends q{constructor(e){super(),D(this,e,bf,gf,L,{})}}function vf(i){let e;return{c(){e=O("p"),e.textContent="User is not logged in"},m(n,t){C(n,e,t)},p:P,d(n){n&&y(e)}}}function kf(i){let e,n,t,r,s,o,l,a,u=i[0].id+"",c,h,d,f,p,$,S=i[0].email+"",j,E,T,I,R,N,J=i[0].created_at+"",Z,de,Ze,qt,On,Ut,mt=i[0].aud+"",Nt,Tn,xe,Bt,jn,Mt,_t=JSON.stringify(i[0].user_metadata)+"",Ft,In,et,Ht,Pn,zt,$t=JSON.stringify(i[0].app_metadata)+"",Jt;return{c(){e=O("table"),n=O("thead"),n.innerHTML="<tr><th>Key</th> <th>Value</th></tr>",t=A(),r=O("tbody"),s=O("tr"),o=O("td"),o.textContent="Id",l=A(),a=O("td"),c=U(u),h=A(),d=O("tr"),f=O("td"),f.textContent="Email",p=A(),$=O("td"),j=U(S),E=A(),T=O("tr"),I=O("td"),I.textContent="Created",R=A(),N=O("td"),Z=U(J),de=A(),Ze=O("tr"),qt=O("td"),qt.textContent="Aud",On=A(),Ut=O("td"),Nt=U(mt),Tn=A(),xe=O("tr"),Bt=O("td"),Bt.textContent="User Metadata",jn=A(),Mt=O("td"),Ft=U(_t),In=A(),et=O("tr"),Ht=O("td"),Ht.textContent="App Metatata",Pn=A(),zt=O("td"),Jt=U($t),k(e,"class","w-full")},m($e,Ce){C($e,e,Ce),v(e,n),v(e,t),v(e,r),v(r,s),v(s,o),v(s,l),v(s,a),v(a,c),v(r,h),v(r,d),v(d,f),v(d,p),v(d,$),v($,j),v(r,E),v(r,T),v(T,I),v(T,R),v(T,N),v(N,Z),v(r,de),v(r,Ze),v(Ze,qt),v(Ze,On),v(Ze,Ut),v(Ut,Nt),v(r,Tn),v(r,xe),v(xe,Bt),v(xe,jn),v(xe,Mt),v(Mt,Ft),v(r,In),v(r,et),v(et,Ht),v(et,Pn),v(et,zt),v(zt,Jt)},p($e,Ce){Ce&1&&u!==(u=$e[0].id+"")&&B(c,u),Ce&1&&S!==(S=$e[0].email+"")&&B(j,S),Ce&1&&J!==(J=$e[0].created_at+"")&&B(Z,J),Ce&1&&mt!==(mt=$e[0].aud+"")&&B(Nt,mt),Ce&1&&_t!==(_t=JSON.stringify($e[0].user_metadata)+"")&&B(Ft,_t),Ce&1&&$t!==($t=JSON.stringify($e[0].app_metadata)+"")&&B(Jt,$t)},d($e){$e&&y(e)}}}function yf(i){let e,n;return e=new M({props:{onClick:i[1],label:"Cancel"}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p:P,i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function Cf(i){let e,n,t,r,s;e=new se({props:{header:"User"}});function o(u,c){return u[0]?kf:vf}let l=o(i),a=l(i);return r=new X({props:{$$slots:{default:[yf]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment),n=A(),a.c(),t=A(),w(r.$$.fragment)},m(u,c){g(e,u,c),C(u,n,c),a.m(u,c),C(u,t,c),g(r,u,c),s=!0},p(u,c){l===(l=o(u))&&a?a.p(u,c):(a.d(1),a=l(u),a&&(a.c(),a.m(t.parentNode,t)));const h={};c&4&&(h.$$scope={dirty:c,ctx:u}),r.$set(h)},i(u){s||(m(e.$$.fragment,u),m(r.$$.fragment,u),s=!0)},o(u){_(e.$$.fragment,u),_(r.$$.fragment,u),s=!1},d(u){u&&(y(n),y(t)),b(e,u),a.d(u),b(r,u)}}}function Sf(i){let e,n;return e=new ie({props:{$$slots:{default:[Cf]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,[r]){const s={};r&5&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function Ef(i,e,n){let t;return fn(i,kt,s=>n(0,t=s)),[t,()=>H("/")]}class Af extends q{constructor(e){super(),D(this,e,Ef,Sf,L,{})}}function Mr(i,e,n){const t=i.slice();return t[2]=e[n],t}function Fr(i){let e,n,t,r,s=cn(i[2])+"",o;return{c(){e=O("tr"),n=O("td"),n.textContent=`${i[2]}`,t=A(),r=O("td"),o=A(),k(n,"class","whitespace-pre-line"),k(r,"class","whitespace-pre-line")},m(l,a){C(l,e,a),v(e,n),v(e,t),v(e,r),r.innerHTML=s,v(e,o)},p:P,d(l){l&&y(e)}}}function Of(i){let e,n;return e=new M({props:{onClick:i[1],label:"Cancel"}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p:P,i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function Tf(i){let e,n,t,r,s,o,l,a,u;e=new se({props:{header:"Markdown Examples"}});let c=re(i[0]),h=[];for(let d=0;d<c.length;d+=1)h[d]=Fr(Mr(i,c,d));return a=new X({props:{$$slots:{default:[Of]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment),n=A(),t=O("table"),r=O("thead"),r.innerHTML="<tr><th>Example</th> <th>Replacement</th></tr>",s=A(),o=O("tbody");for(let d=0;d<h.length;d+=1)h[d].c();l=A(),w(a.$$.fragment),k(t,"class","w-full")},m(d,f){g(e,d,f),C(d,n,f),C(d,t,f),v(t,r),v(t,s),v(t,o);for(let p=0;p<h.length;p+=1)h[p]&&h[p].m(o,null);C(d,l,f),g(a,d,f),u=!0},p(d,f){if(f&1){c=re(d[0]);let $;for($=0;$<c.length;$+=1){const S=Mr(d,c,$);h[$]?h[$].p(S,f):(h[$]=Fr(S),h[$].c(),h[$].m(o,null))}for(;$<h.length;$+=1)h[$].d(1);h.length=c.length}const p={};f&32&&(p.$$scope={dirty:f,ctx:d}),a.$set(p)},i(d){u||(m(e.$$.fragment,d),m(a.$$.fragment,d),u=!0)},o(d){_(e.$$.fragment,d),_(a.$$.fragment,d),u=!1},d(d){d&&(y(n),y(t),y(l)),b(e,d),ye(h,d),b(a,d)}}}function jf(i){let e,n;return e=new ie({props:{$$slots:{default:[Tf]},$$scope:{ctx:i}}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p(t,[r]){const s={};r&32&&(s.$$scope={dirty:r,ctx:t}),e.$set(s)},i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function If(i){return[["This is an e**xample","This is an e*xampl*e","This is #=an example","This is=# an example","This is #an# example",`List
- Item
- Item`],()=>H("/")]}class Pf extends q{constructor(e){super(),D(this,e,If,jf,L,{})}}function Rf(i){let e,n;return e=new qs({props:{routes:i[0]}}),{c(){w(e.$$.fragment)},m(t,r){g(e,t,r),n=!0},p:P,i(t){n||(m(e.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),n=!1},d(t){b(e,t)}}}function Lf(i){let e,n,t,r,s,o,l;return n=new Ys({}),r=new xa({props:{$$slots:{default:[Rf]},$$scope:{ctx:i}}}),{c(){e=O("main"),w(n.$$.fragment),t=A(),w(r.$$.fragment),s=A(),o=O("footer"),o.textContent="by Volker Senkel 2024",k(o,"class","text-sm text-end my-4 pt-2 border-t"),k(e,"class","text-gray-600 max-w-screen-lg m-auto mt-4 px-4 lg:px-0")},m(a,u){C(a,e,u),g(n,e,null),v(e,t),g(r,e,null),v(e,s),v(e,o),l=!0},p(a,[u]){const c={};u&2&&(c.$$scope={dirty:u,ctx:a}),r.$set(c)},i(a){l||(m(n.$$.fragment,a),m(r.$$.fragment,a),l=!0)},o(a){_(n.$$.fragment,a),_(r.$$.fragment,a),l=!1},d(a){a&&y(e),b(n),b(r)}}}function Df(i){return[{"/":Cl,"/books/list":nu,"/books/create":fu,"/books/update/:id":$u,"/chapters/list/:id":Uu,"/chapters/create/:book_id":zu,"/chapters/update/:id":Qu,"/lession/prepare/:id":sc,"/lession/process":Ic,"/questions/list/:id":qc,"/questions/create/:chapter_id":of,"/questions/update/:id":Qc,"/questions/search":pf,"/questions/index":wf,"/cache":Dl,"/user":Af,"/info":Pf,"*":Nl}]}class qf extends q{constructor(e){super(),D(this,e,Df,Lf,L,{})}}new qf({target:document.getElementById("app")});
